(self.webpackChunkringtone=self.webpackChunkringtone||[]).push([[860],{38860:(t,n,e)=>{e(51768)},51768:(t,n,e)=>{!function(){"use strict";var t=function(t){return function(n){return o=typeof(e=n),(null===e?"null":"object"===o&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===o&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":o)===t;var e,o}},n=function(t){return function(n){return typeof n===t}},o=t("string"),r=t("object"),i=t("array"),u=n("boolean"),a=function(t){return void 0===t},c=function(t){return!function(t){return null==t}(t)},s=n("function"),f=n("number"),l=function(t,n){if(i(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},d=function(){},m=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},g=function(t){return function(){return t}},p=function(t){return t};function h(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}var v=function(t){return function(n){return!t(n)}},b=function(t){return function(){throw new Error(t)}},y=g(!1),x=g(!0),w=tinymce.util.Tools.resolve("tinymce.ThemeManager"),S=function(){return(S=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function k(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function C(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var o=Array(t),r=0;for(n=0;n<e;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}var O,_,T,E,B=function(){return A},A=(_=function(t){return t.isNone()},{fold:function(t,n){return t()},is:y,isSome:y,isNone:x,getOr:E=function(t){return t},getOrThunk:T=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:g(null),getOrUndefined:g(void 0),or:E,orThunk:T,map:B,each:d,bind:B,exists:y,forall:x,filter:B,equals:_,equals_:_,toArray:function(){return[]},toString:g("none()")}),M=function(t){var n=g(t),e=function(){return r},o=function(n){return n(t)},r={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:x,isNone:y,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return M(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?r:A},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(y,(function(n){return e(t,n)}))}};return r},D={some:M,none:B,from:function(t){return null==t?A:M(t)}},F=Array.prototype.slice,I=Array.prototype.indexOf,R=Array.prototype.push,V=function(t,n){return I.call(t,n)},P=function(t,n){return V(t,n)>-1},H=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1},z=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},N=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=F.call(t,o,o+n);e.push(r)}return e},L=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},j=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},U=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},W=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},G=function(t,n,e){return function(t,n){for(var e=t.length-1;e>=0;e--)n(t[e])}(t,(function(t){e=n(e,t)})),e},X=function(t,n,e){return j(t,(function(t){e=n(e,t)})),e},Y=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return D.some(i);if(e(i,o))break}return D.none()}(t,n,y)},q=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return D.some(e);return D.none()},K=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!i(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);R.apply(n,t[e])}return n},J=function(t,n){return K(L(t,n))},$=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0},Q=function(t){var n=F.call(t,0);return n.reverse(),n},Z=function(t,n){return W(t,(function(t){return!P(n,t)}))},tt=function(t,n){var e=F.call(t,0);return e.sort(n),e},nt=function(t,n){return n>=0&&n<t.length?D.some(t[n]):D.none()},et=function(t){return nt(t,0)},ot=function(t){return nt(t,t.length-1)},rt=s(Array.from)?Array.from:function(t){return F.call(t)},it=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return D.none()},ut=function(t){return{is:function(n){return t===n},isValue:x,isError:y,getOr:g(t),getOrThunk:g(t),getOrDie:g(t),or:function(n){return ut(t)},orThunk:function(n){return ut(t)},fold:function(n,e){return e(t)},map:function(n){return ut(n(t))},mapError:function(n){return ut(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return D.some(t)}}},at=function(t){return{is:y,isValue:y,isError:x,getOr:p,getOrThunk:function(t){return t()},getOrDie:function(){return b(String(t))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return at(t)},mapError:function(n){return at(n(t))},each:d,bind:function(n){return at(t)},exists:y,forall:x,toOptional:D.none}},ct={value:ut,error:at,fromOption:function(t,n){return t.fold((function(){return at(n)}),ut)}};!function(t){t[t.Error=0]="Error",t[t.Value=1]="Value"}(O||(O={}));var st=function(t,n,e){return t.stype===O.Error?n(t.serror):e(t.svalue)},ft=function(t){return{stype:O.Value,svalue:t}},lt=function(t){return{stype:O.Error,serror:t}},dt=ft,mt=function(t){var n=[],e=[];return j(t,(function(t){st(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}},gt=lt,pt=function(t,n){return t.stype===O.Value?n(t.svalue):t},ht=function(t,n){return t.stype===O.Value?{stype:O.Value,svalue:n(t.svalue)}:t},vt=Object.keys,bt=Object.hasOwnProperty,yt=function(t,n){for(var e=vt(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},xt=function(t,n){return wt(t,(function(t,e){return{k:e,v:n(t,e)}}))},wt=function(t,n){var e={};return yt(t,(function(t,o){var r=n(t,o);e[r.k]=r.v})),e},St=function(t,n){var e=[];return yt(t,(function(t,o){e.push(n(t,o))})),e},kt=function(t,n){for(var e=vt(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return D.some(u)}return D.none()},Ct=function(t){return St(t,(function(t){return t}))},Ot=function(t,n){return _t(t,n)?D.from(t[n]):D.none()},_t=function(t,n){return bt.call(t,n)},Tt=function(t,n){return _t(t,n)&&void 0!==t[n]&&null!==t[n]},Et=function(t){if(!i(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return j(t,(function(o,r){var u=vt(o);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=o[a];if(void 0!==e[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!i(c))throw new Error("case arguments must be an array");n.push(a),e[a]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+i);var u=function(t){var o=vt(t);if(n.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+o.join(","));if(!$(n,(function(t){return P(o,t)})))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+n.join(", "));return t[a].apply(null,e)};return{fold:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(n.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length);var i=n[r];return i.apply(null,e)},match:u,log:function(t){console.log(t,{constructors:n,constructor:a,params:e})}}}})),e},Bt=Object.prototype.hasOwnProperty,At=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)Bt.call(i,u)&&(o[u]=t(o[u],i[u]))}return o}},Mt=At((function(t,n){return r(t)&&r(n)?Mt(t,n):n})),Dt=At((function(t,n){return n})),Ft=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},It=Et([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Rt=function(t){return It.defaultedThunk(g(t))},Vt=It.strict,Pt=It.asOption,Ht=It.defaultedThunk,zt=(It.asDefaultedOptionThunk,It.mergeWithThunk),Nt=(Et([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,n){var e;return(e={})[t]=n,e}),Lt=function(t,n){return Nt(t,n)},jt=function(t){return function(t){var n={};return j(t,(function(t){n[t.key]=t.value})),n}(t)},Ut=function(t){return m(gt,K)(t)},Wt=function(t){var n=mt(t);return n.errors.length>0?Ut(n.errors):dt(n.values)},Gt=function(t){return r(t)&&vt(t).length>100?" removed due to size":JSON.stringify(t,null,2)},Xt=function(t,n){return gt([{path:t,getErrorInfo:n}])},Yt=Et([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),qt=function(t,n,e){var o=Ot(t,n).fold((function(){return e(t)}),p);return dt(o)},Kt=function(t,n,e,o){return e.fold((function(e,r,i,u){var a=function(n){var i=u.extract(t.concat([e]),o,n);return ht(i,(function(t){return Nt(r,o(t))}))},c=function(n){return n.fold((function(){var t=Nt(r,o(D.none()));return dt(t)}),(function(n){var i=u.extract(t.concat([e]),o,n);return ht(i,(function(t){return Nt(r,o(D.some(t)))}))}))};return i.fold((function(){return pt(function(t,n,e){return Ot(n,e).fold((function(){return function(t,n,e){return Xt(t,(function(){return'Could not find valid *strict* value for "'+n+'" in '+Gt(e)}))}(t,e,n)}),dt)}(t,n,e),a)}),(function(t){return pt(qt(n,e,t),a)}),(function(){return pt(function(t,n){return dt(Ot(t,n))}(n,e),c)}),(function(t){return pt(function(t,n,e){var o=Ot(t,n).map((function(n){return!0===n?e(t):n}));return dt(o)}(n,e,t),c)}),(function(t){var o=t(n),r=ht(qt(n,e,g({})),(function(t){return Mt(o,t)}));return pt(r,a)}))}),(function(t,e){var r=e(n);return dt(Nt(t,o(r)))}))},Jt=function(t){return{extract:function(n,e,o){return r=t(o,e),i=function(t){return function(t,n){return Xt(t,(function(){return n}))}(n,t)},r.stype===O.Error?i(r.serror):r;var r,i},toString:function(){return"val"}}},$t=function(t){return vt(function(t,n){var e={};return function(t,n,e,o){yt(t,(function(t,r){(n(t,r)?e:o)(t,r)}))}(t,n,function(t){return function(n,e){t[e]=n}}(e),d),e}(t,(function(t){return null!=t})))},Qt=function(t){var n=Zt(t),e=G(t,(function(t,n){return n.fold((function(n){return Mt(t,Lt(n,!0))}),g(t))}),{});return{extract:function(t,o,r){var i=u(r)?[]:$t(r),a=W(i,(function(t){return!Tt(e,t)}));return 0===a.length?n.extract(t,o,r):function(t,n){return Xt(t,(function(){return"There are unsupported fields: ["+n.join(", ")+"] specified"}))}(t,a)},toString:n.toString}},Zt=function(t){return{extract:function(n,e,o){return function(t,n,e,o){return function(t,n){var e=mt(t);return e.errors.length>0?Ut(e.errors):function(t,n){return t.length>0?dt(Mt(n,Dt.apply(void 0,t))):dt(n)}(e.values,n)}(L(e,(function(e){return Kt(t,n,e,o)})),{})}(n,o,t,e)},toString:function(){return"obj{\n"+L(t,(function(t){return t.fold((function(t,n,e,o){return t+" -> "+o.toString()}),(function(t,n){return"state("+t+")"}))})).join("\n")+"}"}}},tn=function(t){return{extract:function(n,e,o){var r=L(o,(function(o,r){return t.extract(n.concat(["["+r+"]"]),e,o)}));return Wt(r)},toString:function(){return"array("+t.toString()+")"}}},nn=function(t){return{extract:function(n,e,o){for(var r=[],i=0,u=t;i<u.length;i++){var a=u[i].extract(n,e,o);if(a.stype===O.Value)return a;r.push(a)}return Wt(r)},toString:function(){return"oneOf("+L(t,(function(t){return t.toString()})).join(", ")+")"}}},en=g(Jt(dt)),on=m(tn,Zt),rn=Yt.state,un=Yt.field,an=function(t,n){return{extract:function(e,o,r){return Ot(r,t).fold((function(){return function(t,n){return Xt(t,(function(){return'Choice schema did not contain choice key: "'+n+'"'}))}(e,t)}),(function(t){return function(t,n,e,o,r){return Ot(o,r).fold((function(){return function(t,n,e){return Xt(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Gt(n)}))}(t,o,r)}),(function(o){return o.extract(t.concat(["branch: "+r]),n,e)}))}(e,o,r,n,t)}))},toString:function(){return"chooseOn("+t+"). Possible values: "+vt(n)}}},cn=Jt(dt),sn=function(t){return on(t)},fn=function(t){return{extract:function(n,e,o){return t().extract(n,e,o)},toString:function(){return t().toString()}}},ln=function(t){return Jt((function(n){return t(n).fold(gt,dt)}))},dn=function(t,n){return function(t,n){return{extract:function(e,o,r){var i=vt(r),u=function(n,e){return tn(Jt(t)).extract(n,p,e)}(e,i);return pt(u,(function(t){var i=L(t,(function(t){return Yt.field(t,t,Vt(),n)}));return Zt(i).extract(e,o,r)}))},toString:function(){return"setOf("+n.toString()+")"}}}((function(n){return t(n).fold(lt,ft)}),n)},mn=function(t,n,e){return o=function(t,n,e,o){return function(t,n){return t.stype===O.Error?{stype:O.Error,serror:n(t.serror)}:t}(n.extract([t],e,o),(function(t){return{input:o,errors:t}}))}(t,n,p,e),st(o,ct.error,ct.value);var o},gn=function(t){return t.fold((function(t){throw new Error(hn(t))}),p)},pn=function(t,n,e){return gn(mn(t,n,e))},hn=function(t){return"Errors: \n"+(n=t.errors,e=n.length>10?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n,L(e,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}))).join("\n")+"\n\nInput object: "+Gt(t.input);var n,e},vn=function(t,n){return an(t,n)},bn=function(t,n){return an(t,xt(n,Zt))},yn=g(cn),xn=function(t,n){return Jt((function(e){var o=typeof e;return t(e)?dt(e):gt("Expected type: "+n+" but got: "+o)}))},wn=xn(f,"number"),Sn=xn(o,"string"),kn=xn(u,"boolean"),Cn=xn(s,"function"),On=function(t){var n=function(t,n){for(var e=t.next();!e.done;){if(!n(e.value))return!1;e=t.next()}return!0};if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every((function(n){return On(t[n])}));case"Map":return n(t.keys(),On)&&n(t.values(),On);case"Set":return n(t.keys(),On);default:return!1}},_n=Jt((function(t){return On(t)?dt(t):gt("Expected value to be acceptable for sending via postMessage")})),Tn=function(t){return ln((function(n){return P(t,n)?ct.value(n):ct.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},En=function(t){return un(t,t,Vt(),en())},Bn=function(t,n){return un(t,t,Vt(),n)},An=function(t){return Bn(t,wn)},Mn=function(t){return Bn(t,Sn)},Dn=function(t,n){return un(t,t,Vt(),Tn(n))},Fn=function(t){return Bn(t,Cn)},In=function(t,n){return un(t,t,Vt(),Zt(n))},Rn=function(t,n){return un(t,t,Vt(),on(n))},Vn=function(t,n){return un(t,t,Vt(),tn(n))},Pn=function(t){return un(t,t,Pt(),en())},Hn=function(t,n){return un(t,t,Pt(),n)},zn=function(t){return Hn(t,wn)},Nn=function(t){return Hn(t,Sn)},Ln=function(t){return Hn(t,Cn)},jn=function(t,n){return Hn(t,Zt(n))},Un=function(t,n){return un(t,t,Rt(n),en())},Wn=function(t,n,e){return un(t,t,Rt(n),e)},Gn=function(t,n){return Wn(t,n,wn)},Xn=function(t,n){return Wn(t,n,Sn)},Yn=function(t,n,e){return Wn(t,n,Tn(e))},qn=function(t,n){return Wn(t,n,kn)},Kn=function(t,n){return Wn(t,n,Cn)},Jn=function(t,n,e){return Wn(t,n,tn(e))},$n=function(t,n,e){return Wn(t,n,Zt(e))},Qn=function(t,n){return rn(t,n)},Zn=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},te=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},ne=function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return te(e.childNodes[0])},ee=function(t,n){var e=(n||document).createElement(t);return te(e)},oe=function(t,n){var e=(n||document).createTextNode(t);return te(e)},re=te,ie=function(){return ue(0,0)},ue=function(t,n){return{major:t,minor:n}},ae=function(t,n){var e=String(n).toLowerCase();return 0===t.length?ie():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}}(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return ue(o(1),o(2))}(t,e)},ce=ie,se=function(t,n){var e=String(n).toLowerCase();return Y(t,(function(t){return t.search(e)}))},fe=function(t,n){return-1!==t.indexOf(n)},le=function(t,n){return function(t,n,e){return""===n||t.length>=n.length&&t.substr(e,e+n.length)===n}(t,n,t.length-n.length)},de=function(t){return function(n){return n.replace(t,"")}}(/^\s+|\s+$/g),me=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ge=function(t){return function(n){return fe(n,t)}},pe=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return fe(t,"edge/")&&fe(t,"chrome")&&fe(t,"safari")&&fe(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,me],search:function(t){return fe(t,"chrome")&&!fe(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return fe(t,"msie")||fe(t,"trident")}},{name:"Opera",versionRegexes:[me,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ge("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ge("firefox")},{name:"Safari",versionRegexes:[me,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(fe(t,"safari")||fe(t,"mobile/"))&&fe(t,"applewebkit")}}],he=[{name:"Windows",search:ge("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return fe(t,"iphone")||fe(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ge("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ge("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ge("linux"),versionRegexes:[]},{name:"Solaris",search:ge("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ge("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ge("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ve={browsers:g(pe),oses:g(he)},be="Edge",ye="Chrome",xe="Opera",we="Firefox",Se="Safari",ke=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o(be),isChrome:o(ye),isIE:o("IE"),isOpera:o(xe),isFirefox:o(we),isSafari:o(Se)}},Ce=function(){return ke({current:void 0,version:ce()})},Oe=ke,_e=(g(be),g(ye),g("IE"),g(xe),g(we),g(Se),"Windows"),Te="Android",Ee="Linux",Be="Solaris",Ae="FreeBSD",Me="ChromeOS",De=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(_e),isiOS:o("iOS"),isAndroid:o(Te),isOSX:o("OSX"),isLinux:o(Ee),isSolaris:o(Be),isFreeBSD:o(Ae),isChromeOS:o(Me)}},Fe=function(){return De({current:void 0,version:ce()})},Ie=De,Re=(g(_e),g("iOS"),g(Te),g(Ee),g("OSX"),g(Be),g(Ae),g(Me),function(t,n){var e=ve.browsers(),o=ve.oses(),r=function(t,n){return se(t,n).map((function(t){var e=ae(t.versionRegexes,n);return{current:t.name,version:e}}))}(e,t).fold(Ce,Oe),i=function(t,n){return se(t,n).map((function(t){var e=ae(t.versionRegexes,n);return{current:t.name,version:e}}))}(o,t).fold(Fe,Ie),u=function(t,n,e,o){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isiOS()||t.isAndroid(),a=u||o("(pointer:coarse)"),c=r||!i&&u&&o("(min-device-width:768px)"),s=i||u&&!c,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e),l=!s&&!c&&!f;return{isiPad:g(r),isiPhone:g(i),isTablet:g(c),isPhone:g(s),isTouch:g(a),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:g(f),isDesktop:g(l)}}(i,r,t,n);return{browser:r,os:i,deviceType:u}}),Ve=function(t){return window.matchMedia(t).matches},Pe=Ft((function(){return Re(navigator.userAgent,Ve)})),He=function(){return Pe()},ze=function(t,n){var e=t.dom;if(1!==e.nodeType)return!1;var o=e;if(void 0!==o.matches)return o.matches(n);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Ne=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},Le=function(t,n){return t.dom===n.dom},je=function(t,n){return He().browser.isIE()?function(t,n){return e=t.dom,o=n.dom,function(t,n,e){return 0!=(t.compareDocumentPosition(n)&e)}(e,o,Node.DOCUMENT_POSITION_CONTAINED_BY);var e,o}(t,n):function(t,n){var e=t.dom,o=n.dom;return e!==o&&e.contains(o)}(t,n)},Ue=function(t){return s(t)?t:y},We=function(t,n,e){for(var o=t.dom,r=Ue(e);o.parentNode;){o=o.parentNode;var i=re(o),u=n(i);if(u.isSome())return u;if(r(i))break}return D.none()},Ge=function(t,n,e){var o=n(t),r=Ue(e);return o.orThunk((function(){return r(t)?D.none():We(t,n,r)}))},Xe=function(t,n){return Le(t.element,n.event.target)},Ye=function(t){if(!Tt(t,"can")&&!Tt(t,"abort")&&!Tt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return pn("Extracting event.handler",Qt([Un("can",x),Un("abort",y),Un("run",d)]),t)},qe=g,Ke=qe("touchstart"),Je=qe("touchmove"),$e=qe("touchend"),Qe=qe("touchcancel"),Ze=qe("mousedown"),to=qe("mousemove"),no=qe("mouseout"),eo=qe("mouseup"),oo=qe("mouseover"),ro=qe("focusin"),io=qe("focusout"),uo=qe("keydown"),ao=qe("keyup"),co=qe("input"),so=qe("change"),fo=qe("click"),lo=qe("transitionend"),mo=qe("selectstart"),go=function(t){return g("alloy."+t)},po={tap:go("tap")},ho=go("focus"),vo=go("blur.post"),bo=go("paste.post"),yo=go("receive"),xo=go("execute"),wo=go("focus.item"),So=po.tap,ko=go("longpress"),Co=go("sandbox.close"),Oo=go("typeahead.cancel"),_o=go("system.init"),To=go("system.touchmove"),Eo=go("system.touchend"),Bo=go("system.scroll"),Ao=go("system.resize"),Mo=go("system.attached"),Do=go("system.detached"),Fo=go("system.dismissRequested"),Io=go("system.repositionRequested"),Ro=go("focusmanager.shifted"),Vo=go("slotcontainer.visibility"),Po=go("change.tab"),Ho=go("dismiss.tab"),zo=go("highlight"),No=go("dehighlight"),Lo=function(t,n){Go(t,t.element,n,{})},jo=function(t,n,e){Go(t,t.element,n,e)},Uo=function(t){Lo(t,xo())},Wo=function(t,n,e){Go(t,n,e,{})},Go=function(t,n,e,o){var r=S({target:n},o);t.getSystem().triggerEvent(e,n,r)},Xo=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},Yo=function(t){return jt(t)},qo=function(t,n){return{key:t,value:Ye({abort:n})}},Ko=function(t){return{key:t,value:Ye({run:function(t,n){n.event.prevent()}})}},Jo=function(t,n){return{key:t,value:Ye({run:n})}},$o=function(t,n,e){return{key:t,value:Ye({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},Qo=function(t){return function(n){return{key:t,value:Ye({run:function(t,e){Xe(t,e)&&n(t,e)}})}}},Zo=function(t,n,e){return function(t,n){return Jo(t,(function(e,o){e.getSystem().getByUid(n).each((function(n){Xo(n,n.element,t,o)}))}))}(t,n.partUids[e])},tr=function(t,n){return Jo(t,(function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).fold((function(){return Ge(o.target,(function(n){return t.getSystem().getByDom(n).toOptional()}),y).getOr(t)}),(function(t){return t}));n(t,r,e)}))},nr=function(t){return Jo(t,(function(t,n){n.cut()}))},er=function(t){return Jo(t,(function(t,n){n.stop()}))},or=function(t,n){return Qo(t)(n)},rr=Qo(Mo()),ir=Qo(Do()),ur=Qo(_o()),ar=function(t){return function(n){return Jo(t,n)}}(xo()),cr=("undefined"!=typeof window?window:Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),sr=function(t){return function(n){return function(t){return t.dom.nodeType}(n)===t}},fr=sr(1),lr=sr(3),dr=sr(9),mr=sr(11),gr=function(t){return re(t.dom.ownerDocument)},pr=function(t){return dr(t)?t:gr(t)},hr=function(t){return re(pr(t).dom.documentElement)},vr=function(t){return re(pr(t).dom.defaultView)},br=function(t){return D.from(t.dom.parentNode).map(re)},yr=function(t){return D.from(t.dom.offsetParent).map(re)},xr=function(t){return L(t.dom.childNodes,re)},wr=function(t,n){var e=t.dom.childNodes;return D.from(e[n]).map(re)},Sr=function(t){return mr(t)&&c(t.dom.host)},kr=s(Element.prototype.attachShadow)&&s(Node.prototype.getRootNode),Cr=g(kr),Or=kr?function(t){return re(t.dom.getRootNode())}:pr,_r=function(t){return Sr(t)?t:re(pr(t).dom.body)},Tr=function(t){var n=Or(t);return Sr(n)?D.some(n):D.none()},Er=function(t){return re(t.dom.host)},Br=function(t,n){br(t).each((function(e){e.dom.insertBefore(n.dom,t.dom)}))},Ar=function(t,n){(function(t){return D.from(t.dom.nextSibling).map(re)})(t).fold((function(){br(t).each((function(t){Dr(t,n)}))}),(function(t){Br(t,n)}))},Mr=function(t,n){(function(t){return wr(t,0)})(t).fold((function(){Dr(t,n)}),(function(e){t.dom.insertBefore(n.dom,e.dom)}))},Dr=function(t,n){t.dom.appendChild(n.dom)},Fr=function(t,n){j(n,(function(n){Dr(t,n)}))},Ir=function(t){t.dom.textContent="",j(xr(t),(function(t){Rr(t)}))},Rr=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Vr=function(t){var n,e=xr(t);e.length>0&&(n=t,j(e,(function(t){Br(n,t)}))),Rr(t)},Pr=function(t){return t.dom.innerHTML},Hr=function(t,n){var e,o,r=gr(t).dom,i=re(r.createDocumentFragment()),u=(e=n,(o=(r||document).createElement("div")).innerHTML=e,xr(re(o)));Fr(i,u),Ir(t),Dr(t,i)},zr=function(t,n,e){if(!(o(e)||u(e)||f(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},Nr=function(t,n,e){zr(t.dom,n,e)},Lr=function(t,n){var e=t.dom.getAttribute(n);return null===e?void 0:e},jr=function(t,n){return D.from(Lr(t,n))},Ur=function(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Wr=function(t,n){t.dom.removeAttribute(n)},Gr=function(t){return Sr(t)?"#shadow-root":function(t){var n=ee("div"),e=re(t.dom.cloneNode(!0));return Dr(n,e),Pr(n)}(function(t){return function(t,n){return re(t.dom.cloneNode(!1))}(t)}(t))},Xr=function(t){return Gr(t)},Yr=Yo([function(t,n){return{key:t,value:Ye({can:function(t,n){var e=n.event,o=e.originator,r=e.target;return!function(t,n,e){return Le(n,t.element)&&!Le(n,e)}(t,o,r)||(console.warn(ho()+" did not get interpreted by the desired target. \nOriginator: "+Xr(o)+"\nTarget: "+Xr(r)+"\nCheck the "+ho()+" event handlers"),!1)}})}}(ho())]),qr=Object.freeze({__proto__:null,events:Yr}),Kr=0,Jr=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++Kr+String(n)},$r=g("alloy-id-"),Qr=g("data-alloy-id"),Zr=$r(),ti=Qr(),ni=function(t,n){Object.defineProperty(t.dom,ti,{value:n,writable:!0})},ei=function(t){var n=fr(t)?t.dom[ti]:null;return D.from(n)},oi=function(t){return Jr(t)},ri=p,ii=function(t){var n=function(n){return function(){throw new Error("The component must be in a context to send: "+n+(t?"\n"+Xr(t().element)+" is not in context.":""))}};return{debugInfo:g("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:y}},ui=ii(),ai=function(t){return L(t,(function(t){return le(t,"/*")?t.substring(0,t.length-"/*".length):t}))},ci=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:ai(i)}},t},si=Jr("alloy-premade"),fi=function(t){return Lt(si,t)},li=function(t){return function(t,n){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ai(i.slice(1))}},t}((function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return t.apply(void 0,C([n.getApis(),n],e))}),t)},di={init:function(){return mi({readState:function(){return"No State required"}})}},mi=function(t){return t},gi=function(t,n){var e={};return yt(t,(function(t,o){yt(t,(function(t,r){var i=Ot(e,r).getOr([]);e[r]=i.concat([n(o,t)])}))})),e},pi=function(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}},hi=function(t){return t.cHandler},vi=function(t,n){return{name:t,handler:n}},bi=function(t,n,e){var o=n[e];return o?function(t,n,e,o){try{var r=tt(e,(function(n,e){var r=n.name,i=e.name,u=o.indexOf(r),a=o.indexOf(i);if(-1===u)throw new Error("The ordering for "+t+" does not have an entry for "+r+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));return u<a?-1:a<u?1:0}));return ct.value(r)}catch(t){return ct.error([t])}}("Event: "+e,0,t,o).map((function(t){return function(t){var n=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return X(t,(function(t,o){return t&&n(o).apply(void 0,e)}),!0)}}(t,(function(t){return t.can})),e=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return X(t,(function(t,o){return t||n(o).apply(void 0,e)}),!1)}}(t,(function(t){return t.abort}));return Ye({can:n,abort:e,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];j(t,(function(t){t.run.apply(void 0,n)}))}})}(L(t,(function(t){return t.handler})))})):function(t,n){return ct.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(L(n,(function(t){return t.name})),null,2)])}(e,t)},yi=function(t,n){var e,o,r,i=St(t,(function(t,e){return(1===t.length?ct.value(t[0].handler):bi(t,n,e)).map((function(o){var r=function(t){var n=function(t){return s(t)?{can:x,abort:y,run:t}:t}(t);return function(t,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[t,e].concat(o);n.abort.apply(void 0,i)?e.stop():n.can.apply(void 0,i)&&n.run.apply(void 0,i)}}(o),i=t.length>1?W(n[e],(function(n){return H(t,(function(t){return t.name===n}))})).join(" > "):t[0].name;return Lt(e,function(t,n){return{handler:t,purpose:n}}(r,i))}))}));return e={},(r=function(t){var n=[],e=[];return j(t,(function(t){t.fold((function(t){n.push(t)}),(function(t){e.push(t)}))})),{errors:n,values:e}}(i)).errors.length>0?(o=r.errors,ct.error(K(o))):function(t,n){return 0===t.length?ct.value(n):ct.value(Mt(n,Dt.apply(void 0,t)))}(r.values,e)},xi="alloy.base.behaviour",wi=function(t){return t.events},Si=function(t,n){var e=Lr(t,n);return void 0===e||""===e?[]:e.split(" ")},ki=function(t){return void 0!==t.dom.classList},Ci=function(t,n){ki(t)?t.dom.classList.add(n):function(t,n){(function(t,n,e){var o=Si(t,n).concat([e]);Nr(t,n,o.join(" "))})(t,"class",n)}(t,n)},Oi=function(t,n){ki(t)?t.dom.classList.remove(n):function(t,n){(function(t,n,e){var o=W(Si(t,n),(function(t){return t!==e}));o.length>0?Nr(t,n,o.join(" ")):Wr(t,n)})(t,"class",n)}(t,n),function(t){0===(ki(t)?t.dom.classList:function(t){return Si(t,"class")}(t)).length&&Wr(t,"class")}(t)},_i=function(t,n){return ki(t)&&t.dom.classList.contains(n)},Ti=function(t,n){j(n,(function(n){Ci(t,n)}))},Ei=function(t,n){j(n,(function(n){Oi(t,n)}))},Bi=function(t){return void 0!==t.style&&s(t.style.getPropertyValue)},Ai=function(t){var n=lr(t)?t.dom.parentNode:t.dom;if(null==n||null===n.ownerDocument)return!1;var e,o,r=n.ownerDocument;return Tr(re(n)).fold((function(){return r.body.contains(n)}),(e=Ai,o=Er,function(t){return e(o(t))}))},Mi=function(){return Di(re(document))},Di=function(t){var n=t.dom.body;if(null==n)throw new Error("Body is not available yet");return re(n)},Fi=function(t,n,e){if(!o(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);Bi(t)&&t.style.setProperty(n,e)},Ii=function(t,n){Bi(t)&&t.style.removeProperty(n)},Ri=function(t,n,e){var o=t.dom;Fi(o,n,e)},Vi=function(t,n){var e=t.dom;yt(n,(function(t,n){Fi(e,n,t)}))},Pi=function(t,n){var e=t.dom;yt(n,(function(t,n){t.fold((function(){Ii(e,n)}),(function(t){Fi(e,n,t)}))}))},Hi=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||Ai(t)?o:zi(e,n)},zi=function(t,n){return Bi(t)?t.style.getPropertyValue(n):""},Ni=function(t,n){var e=t.dom,o=zi(e,n);return D.from(o).filter((function(t){return t.length>0}))},Li=function(t){var n={},e=t.dom;if(Bi(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n},ji=function(t,n,e){var o=ee(t);return Ri(o,n,e),Ni(o,n).isSome()},Ui=function(t,n){var e=t.dom;Ii(e,n),jr(t,"style").map(de).is("")&&Wr(t,"style")},Wi=function(t){return t.dom.offsetWidth},Gi=function(t){return t.dom.value},Xi=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom.value=n},Yi=function(t){return function(t,n){return function(t,n){var e=L(n,(function(t){return jn(t.name(),[En("config"),Un("state",di)])})),o=mn("component.behaviours",Zt(e),t.behaviours).fold((function(n){throw new Error(hn(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))}),(function(t){return t}));return{list:n,data:xt(o,(function(t){var n=t.map((function(t){return{config:t.config,state:t.state.init(t.config)}}));return function(){return n}}))}}(t,n)}(t,function(t){var n=Ot(t,"behaviours").getOr({}),e=W(vt(n),(function(t){return void 0!==n[t]}));return L(e,(function(t){return n[t].me}))}(t))},qi=function(t,n,e){var o={"alloy.base.behaviour":wi(t)};return function(t,n,e,o){var r=function(t,n,e){var o=S(S({},e),function(t,n){var e={};return j(t,(function(t){e[t.name()]=t.handlers(n)})),e}(n,t));return gi(o,vi)}(t,e,o);return yi(r,n)}(e,t.eventOrder,n,o).getOrDie()},Ki=function(t){var n=function(){return l},e=Zn(ui),o=gn(function(t){var n,e;return mn("custom.definition",Zt([un("dom","dom",Vt(),Zt([En("tag"),Un("styles",{}),Un("classes",[]),Un("attributes",{}),Pn("value"),Pn("innerHtml")])),En("components"),En("uid"),Un("events",{}),Un("apis",{}),un("eventOrder","eventOrder",(n={},n[xo()]=["disabling",xi,"toggling","typeaheadevents"],n[ho()]=[xi,"focusing","keying"],n[_o()]=[xi,"disabling","toggling","representing"],n[co()]=[xi,"representing","streaming","invalidating"],n[Do()]=[xi,"representing","item-events","tooltipping"],n[Ze()]=["focusing",xi,"item-type-events"],n[Ke()]=["focusing",xi,"item-type-events"],n[oo()]=["item-type-events","tooltipping"],n[yo()]=["receiving","reflecting","tooltipping"],e=n,It.mergeWithThunk(g(e))),yn()),Pn("domModification")]),t)}(t)),r=Yi(t),i=function(t){return t.list}(r),u=function(t){return t.data}(r),a=function(t){var n=ee(t.tag);!function(t,n){var e=t.dom;yt(n,(function(t,n){zr(e,n,t)}))}(n,t.attributes),Ti(n,t.classes),Vi(n,t.styles),t.innerHtml.each((function(t){return Hr(n,t)}));var e=t.domChildren;return Fr(n,e),t.value.each((function(t){Xi(n,t)})),t.uid,ni(n,t.uid),n}(function(t,n,e){var o,r,i,u=S(S({},(o=t).dom),{uid:o.uid,domChildren:L(o.components,(function(t){return t.element}))}),a=function(t){return t.domModification.fold((function(){return pi({})}),pi)}(t),c={"alloy.base.modification":a};return i=n.length>0?function(t,n,e,o){var r=S({},n);j(e,(function(n){r[n.name()]=n.exhibit(t,o)}));var i=gi(r,(function(t,n){return{name:t,modification:n}})),u=function(t){return G(t,(function(t,n){return S(S({},n.modification),t)}),{})},a=G(i.classes,(function(t,n){return n.modification.concat(t)}),[]),c=u(i.attributes),s=u(i.styles);return pi({classes:a,attributes:c,styles:s})}(e,c,n,u):a,S(S({},r=u),{attributes:S(S({},r.attributes),i.attributes),styles:S(S({},r.styles),i.styles),classes:r.classes.concat(i.classes)})}(o,i,u)),c=qi(o,i,u),f=Zn(o.components),l={getSystem:e.get,config:function(n){var e=u;return(s(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(t){return s(u[t.name()])},spec:t,readState:function(t){return u[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},getApis:function(){return o.apis},connect:function(t){e.set(t)},disconnect:function(){e.set(ii(n))},element:a,syncComponents:function(){var t=xr(a),n=J(t,(function(t){return e.get().getByDom(t).fold((function(){return[]}),(function(t){return[t]}))}));f.set(n)},components:f.get,events:c};return l},Ji=function(t){var n=oe(t);return $i({element:n})},$i=function(t){var n=pn("external.component",Qt([En("element"),Pn("uid")]),t),e=Zn(ii());n.uid.each((function(t){ni(n.element,t)}));var o={getSystem:e.get,config:D.none,hasConfigured:y,connect:function(t){e.set(t)},disconnect:function(){e.set(ii((function(){return o})))},getApis:function(){return{}},element:n.element,spec:t,readState:g("No state"),syncComponents:d,components:g([]),events:{}};return fi(o)},Qi=oi,Zi=function(t){return function(t){return Ot(t,si)}(t).fold((function(){return function(t){var n=ri(t),e=n.events,o=k(n,["events"]),r=function(t){var n=Ot(t,"components").getOr([]);return L(n,Zi)}(o),i=S(S({},o),{events:S(S({},qr),e),components:r});return ct.value(Ki(i))}(t.hasOwnProperty("uid")?t:S({uid:Qi("")},t)).getOrDie()}),(function(t){return t}))},tu=fi,nu=function(t,n){var e=function(e){var o=n(e);if(o<=0||null===o){var r=Hi(e,t);return parseFloat(r)||0}return o},o=function(t,n){return X(n,(function(n,e){var o=Hi(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r}),0)};return{set:function(n,e){if(!f(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;Bi(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e);return n>r?n-r:0}}},eu=nu("height",(function(t){var n=t.dom;return Ai(t)?n.getBoundingClientRect().height:n.offsetHeight})),ou=function(t){return eu.get(t)},ru=function(t){return eu.getOuter(t)},iu=function(t,n){return{left:t,top:n,translate:function(e,o){return iu(t+e,n+o)}}},uu=iu,au=function(t,n){return void 0!==t?t:void 0!==n?n:0},cu=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return uu(e.offsetLeft,e.offsetTop);var i=au(null==o?void 0:o.pageYOffset,r.scrollTop),u=au(null==o?void 0:o.pageXOffset,r.scrollLeft),a=au(r.clientTop,e.clientTop),c=au(r.clientLeft,e.clientLeft);return su(t).translate(u-c,i-a)},su=function(t){var n=t.dom,e=n.ownerDocument.body;return e===n?uu(e.offsetLeft,e.offsetTop):Ai(t)?function(t){var n=t.getBoundingClientRect();return uu(n.left,n.top)}(n):uu(0,0)},fu=nu("width",(function(t){return t.dom.offsetWidth})),lu=function(t){return fu.get(t)},du=function(t){return fu.getOuter(t)},mu=function(t){var n=re(function(t){if(Cr()&&c(t.target)){var n=re(t.target);if(fr(n)&&function(t){return c(t.dom.shadowRoot)}(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return et(e)}}return D.from(t.target)}(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=m(o,e);return function(t,n,e,o,r,i,u){return{target:t,x:n,y:e,stop:o,prevent:r,kill:i,raw:u}}(n,t.clientX,t.clientY,e,o,r,t)},gu=function(t,n,e,o,r){var i=function(t,n){return function(e){t(e)&&n(mu(e))}}(e,o);return t.dom.addEventListener(n,i,r),{unbind:h(pu,t,n,i,r)}},pu=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},hu=function(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return uu(e,o)},vu=function(t,n,e){var o=(void 0!==e?e.dom:document).defaultView;o&&o.scrollTo(t,n)},bu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},yu=function(t){var n=void 0===t?window:t,e=n.document,o=hu(re(e));return function(t){var n=void 0===t?window:t;return D.from(n.visualViewport)}(n).fold((function(){var t=n.document.documentElement,e=t.clientWidth,r=t.clientHeight;return bu(o.left,o.top,e,r)}),(function(t){return bu(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)}))},xu=function(t,n){return t.view(n).fold(g([]),(function(n){var e=t.owner(n),o=xu(t,e);return[n].concat(o)}))},wu=Object.freeze({__proto__:null,view:function(t){var n;return(t.dom===document?D.none():D.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(re)},owner:function(t){return gr(t)}}),Su=function(t){var n=re(document),e=hu(n);return function(t,n){var e=n.owner(t),o=xu(n,e);return D.some(o)}(t,wu).fold(h(cu,t),(function(n){var o=su(t),r=G(n,(function(t,n){var e=su(n);return{left:t.left+e.left,top:t.top+e.top}}),{left:0,top:0});return uu(r.left+o.left+e.left,r.top+o.top+e.top)}))},ku=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Cu=function(t){var n=cu(t),e=du(t),o=ru(t);return ku(n.left,n.top,e,o)},Ou=function(t){var n=Su(t),e=du(t),o=ru(t);return ku(n.left,n.top,e,o)},_u=function(){return yu(window)};function Tu(t,n,e,o,r){return t(e,o)?D.some(e):s(r)&&r(e)?D.none():n(e,o,r)}var Eu,Bu=function(t,n,e){for(var o=t.dom,r=s(e)?e:y;o.parentNode;){o=o.parentNode;var i=re(o);if(n(i))return D.some(i);if(r(i))break}return D.none()},Au=function(t,n,e){return Tu((function(t,n){return n(t)}),Bu,t,n,e)},Mu=function(t,n,e){return Au(t,n,e).isSome()},Du=function(t,n,e){return Bu(t,(function(t){return ze(t,n)}),e)},Fu=function(t,n){return function(t,n){var e=void 0===n?document:n.dom;return Ne(e)?D.none():D.from(e.querySelector(t)).map(re)}(n,t)},Iu=function(t,n,e){return Tu((function(t,n){return ze(t,n)}),Du,t,n,e)},Ru=function(){var t=Jr("aria-owns");return{id:t,link:function(n){Nr(n,"aria-owns",t)},unlink:function(t){Wr(t,"aria-owns")}}},Vu=function(t,n){return Mu(n,(function(n){return Le(n,t.element)}),y)||function(t,n){return function(t){return Au(t,(function(t){if(!fr(t))return!1;var n=Lr(t,"id");return void 0!==n&&n.indexOf("aria-owns")>-1})).bind((function(t){var n=Lr(t,"id"),e=Or(t);return Fu(e,'[aria-owns="'+n+'"]')}))}(n).exists((function(n){return Vu(t,n)}))}(t,n)};!function(t){t[t.STOP=0]="STOP",t[t.NORMAL=1]="NORMAL",t[t.LOGGING=2]="LOGGING"}(Eu||(Eu={}));var Pu,Hu=Zn({}),zu=["alloy/data/Fields","alloy/debugging/Debugging"],Nu=function(t,n,e){return function(t,n,e){switch(Ot(Hu.get(),t).orThunk((function(){var n=vt(Hu.get());return it(n,(function(n){return t.indexOf(n)>-1?D.some(Hu.get()[n]):D.none()}))})).getOr(Eu.NORMAL)){case Eu.NORMAL:return e(Lu());case Eu.LOGGING:var o=function(t,n){var e=[],o=(new Date).getTime();return{logEventCut:function(t,n,o){e.push({outcome:"cut",target:n,purpose:o})},logEventStopped:function(t,n,o){e.push({outcome:"stopped",target:n,purpose:o})},logNoParent:function(t,n,o){e.push({outcome:"no-parent",target:n,purpose:o})},logEventNoHandlers:function(t,n){e.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,o){e.push({outcome:"response",purpose:o,target:n})},write:function(){var r=(new Date).getTime();P(["mousemove","mouseover","mouseout",_o()],t)||console.log(t,{event:t,time:r-o,target:n.dom,sequence:L(e,(function(t){return P(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Xr(t.target)+")":t.outcome}))})}}}(t,n),r=e(o);return o.write(),r;case Eu.STOP:return!0}}(t,n,e)},Lu=g({logEventCut:d,logEventStopped:d,logNoParent:d,logEventNoHandlers:d,logEventResponse:d,write:d}),ju=g([En("menu"),En("selectedMenu")]),Uu=g([En("item"),En("selectedItem")]),Wu=(g(Zt(Uu().concat(ju()))),g(Zt(Uu()))),Gu=In("initSize",[En("numColumns"),En("numRows")]),Xu=function(){return In("markers",[En("backgroundMenu")].concat(ju()).concat(Uu()))},Yu=function(t){return In("markers",L(t,En))},qu=function(t,n,e){return function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");Y(n,(function(t){return t.indexOf("alloy")>0&&!H(zu,(function(n){return t.indexOf(n)>-1}))})).getOr("unknown")}}(),un(n,n,e,ln((function(t){return ct.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)}))})))},Ku=function(t){return qu(0,t,Rt(d))},Ju=function(t){return qu(0,t,Rt(D.none))},$u=function(t){return qu(0,t,Vt())},Qu=function(t){return qu(0,t,Vt())},Zu=function(t,n){return Qn(t,g(n))},ta=function(t){return Qn(t,p)},na=g(Gu),ea=function(t,n,e,o,r,i){return{x:t,y:n,bubble:e,direction:o,boundsRestriction:r,label:i}},oa=Et([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),ra=oa.southeast,ia=oa.southwest,ua=oa.northeast,aa=oa.northwest,ca=oa.south,sa=oa.north,fa=oa.east,la=oa.west,da=function(t,n){return function(e,o){for(var r={},i=0,u=e.length;i<u;i++){var a=e[i];r[String(a)]=Ot(n,a).map((function(n){return function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(t,n)}))}return r}(["left","right","top","bottom"])},ma=function(t){return t.x},ga=function(t,n){return t.x+t.width/2-n.width/2},pa=function(t,n){return t.x+t.width-n.width},ha=function(t,n){return t.y-n.height},va=function(t){return t.y+t.height},ba=function(t,n){return t.y+t.height/2-n.height/2},ya=function(t,n,e){return ea(ma(t),va(t),e.southeast(),ra(),da(t,{left:1,top:3}),"layout-se")},xa=function(t,n,e){return ea(pa(t,n),va(t),e.southwest(),ia(),da(t,{right:0,top:3}),"layout-sw")},wa=function(t,n,e){return ea(ma(t),ha(t,n),e.northeast(),ua(),da(t,{left:1,bottom:2}),"layout-ne")},Sa=function(t,n,e){return ea(pa(t,n),ha(t,n),e.northwest(),aa(),da(t,{right:0,bottom:2}),"layout-nw")},ka=function(t,n,e){return ea(ga(t,n),ha(t,n),e.north(),sa(),da(t,{bottom:2}),"layout-n")},Ca=function(t,n,e){return ea(ga(t,n),va(t),e.south(),ca(),da(t,{top:3}),"layout-s")},Oa=function(t,n,e){return ea(function(t){return t.x+t.width}(t),ba(t,n),e.east(),fa(),da(t,{left:0}),"layout-e")},_a=function(t,n,e){return ea(function(t,n){return t.x-n.width}(t,n),ba(t,n),e.west(),la(),da(t,{right:1}),"layout-w")},Ta=function(){return[ya,xa,wa,Sa,Ca,ka,Oa,_a]},Ea=function(){return[xa,ya,Sa,wa,Ca,ka,Oa,_a]},Ba=function(){return[wa,Sa,ya,xa,ka,Ca]},Aa=function(){return[Sa,wa,xa,ya,ka,Ca]},Ma=function(){return[ya,xa,wa,Sa,Ca,ka]},Da=function(){return[xa,ya,Sa,wa,Ca,ka]},Fa=Object.freeze({__proto__:null,events:function(t){return Yo([Jo(yo(),(function(n,e){var o=t.channels,r=vt(o),i=e,u=function(t,n){return n.universal?t:W(t,(function(t){return P(n.channels,t)}))}(r,i);j(u,(function(t){var e=o[t],r=e.schema,u=pn("channel["+t+"] data\nReceiver: "+Xr(n.element),r,i.data);e.onReceive(n,u)}))}))])}}),Ia=[Bn("channels",dn(ct.value,Qt([$u("onReceive"),Un("schema",yn())])))],Ra=function(t,n,e){return ur((function(o,r){e(o,t,n)}))},Va=function(t){return{key:t,value:void 0}},Pa=function(t,n,e,o,r,i,u){var a=function(t){return Tt(t,e)?t[e]():D.none()},c=xt(r,(function(t,n){return function(t,n,e){return function(t,n,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:ai(u.slice(0,1).concat(u.slice(3)))}},t}((function(o){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var u=[o].concat(r);return o.config({name:g(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)}),(function(t){var e=Array.prototype.slice.call(u,1);return n.apply(void 0,[o,t.config,t.state].concat(e))}))}),e,n)}(e,t,n)})),s=xt(i,(function(t,n){return ci(t,n)})),f=S(S(S({},s),c),{revoke:h(Va,e),config:function(n){var o=pn(e+"-config",t,n);return{key:e,value:{config:o,me:f,configAsRaw:Ft((function(){return pn(e+"-config",t,n)})),initialConfig:n,state:u}}},schema:g(n),exhibit:function(t,n){return a(t).bind((function(t){return Ot(o,"exhibit").map((function(e){return e(n,t.config,t.state)}))})).getOr(pi({}))},name:g(e),handlers:function(t){return a(t).map((function(t){return Ot(o,"events").getOr((function(){return{}}))(t.config,t.state)})).getOr({})}});return f},Ha=function(t){return jt(t)},za=Qt([En("fields"),En("name"),Un("active",{}),Un("apis",{}),Un("state",di),Un("extra",{})]),Na=function(t){var n=pn("Creating behaviour: "+t.name,za,t);return function(t,n,e,o,r,i){var u,a=Qt(t),c=jn(n,[("config",u=t,Hn("config",Qt(u)))]);return Pa(a,c,n,e,o,r,i)}(n.fields,n.name,n.active,n.apis,n.extra,n.state)},La=Qt([En("branchKey"),En("branches"),En("name"),Un("active",{}),Un("apis",{}),Un("state",di),Un("extra",{})]),ja=function(t){var n=pn("Creating behaviour: "+t.name,La,t);return function(t,n,e,o,r,i){var u=t,a=jn(n,[Hn("config",t)]);return Pa(u,a,n,e,o,r,i)}(bn(n.branchKey,n.branches),n.name,n.active,n.apis,n.extra,n.state)},Ua=g(void 0),Wa=Na({fields:Ia,name:"receiving",active:Fa}),Ga=Object.freeze({__proto__:null,exhibit:function(t,n){return pi({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),Xa=function(t){return t.dom.focus()},Ya=function(t){return void 0===t&&(t=re(document)),D.from(t.dom.activeElement).map(re)},qa=function(t){return Ya(Or(t)).filter((function(n){return t.dom.contains(n.dom)}))},Ka=function(t,n){var e=Or(n),o=Ya(e).bind((function(t){var e,o,r=function(n){return Le(t,n)};return r(n)?D.some(n):(e=r,(o=function(t){for(var n=0;n<t.childNodes.length;n++){var r=re(t.childNodes[n]);if(e(r))return D.some(r);var i=o(t.childNodes[n]);if(i.isSome())return i}return D.none()})(n.dom))})),r=t(n);return o.each((function(t){Ya(e).filter((function(n){return Le(n,t)})).fold((function(){Xa(t)}),d)})),r},Ja=function(t,n,e,o,r){return{position:t,left:n,top:e,right:o,bottom:r}},$a=function(t,n){var e=function(t){return t+"px"};Pi(t,{position:D.some(n.position),left:n.left.map(e),top:n.top.map(e),right:n.right.map(e),bottom:n.bottom.map(e)})},Qa=Et([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Za=function(t,n,e,o,r,i){var u=n.x-e,a=n.y-o,c=r-(u+n.width),s=i-(a+n.height),f=D.some(u),l=D.some(a),d=D.some(c),m=D.some(s),g=D.none();return n.direction.fold((function(){return Ja(t,f,l,g,g)}),(function(){return Ja(t,g,l,d,g)}),(function(){return Ja(t,f,g,g,m)}),(function(){return Ja(t,g,g,d,m)}),(function(){return Ja(t,f,l,g,g)}),(function(){return Ja(t,f,g,g,m)}),(function(){return Ja(t,f,l,g,g)}),(function(){return Ja(t,g,l,d,g)}))},tc=function(t,n){var e=h(Su,n),o=t.fold(e,e,(function(){var t=hu();return Su(n).translate(-t.left,-t.top)})),r=du(n),i=ru(n);return ku(o.left,o.top,r,i)},nc=function(t,n){return n.fold((function(){return t.fold(_u,_u,ku)}),(function(n){return t.fold(n,n,(function(){var e=n(),o=ec(t,e.x,e.y);return ku(o.left,o.top,e.width,e.height)}))}))},ec=function(t,n,e){var o=uu(n,e);return t.fold(g(o),g(o),(function(){var t=hu();return o.translate(-t.left,-t.top)}))},oc=(Qa.none,Qa.relative),rc=Qa.fixed,ic=function(t,n,e,o){var r=t+n;return r>o?e:r<e?o:r},uc=function(t,n,e){return Math.min(Math.max(t,n),e)},ac=Et([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),cc=function(t,n,e,o){Ui(n,"max-height"),Ui(n,"max-width");var r,i={width:du(r=n),height:ru(r)};return function(t,n,e,o,r){var i=e.width,u=e.height,a=function(t,a,c,s){return function(t,n,e,o){var r=t.x,i=t.y,u=t.bubble.offset,a=u.left,c=u.top,s=function(t,n,e){var o=function(t,o){var r="top"===t||"bottom"===t?e.top:e.left;return Ot(n,t).bind(p).bind((function(n){return"left"===t||"top"===t?n>=o?D.some(n):D.none():n<=o?D.some(n):D.none()})).map((function(t){return t+r})).getOr(o)},r=o("left",t.x),i=o("top",t.y),u=o("right",t.right),a=o("bottom",t.bottom);return ku(r,i,u-r,a-i)}(o,t.boundsRestriction,u),f=s.y,l=s.bottom,d=s.x,m=s.right,h=i+c,v=function(t,n,e,o,r){var i=r.x,u=r.y,a=r.width,c=r.height,s=t>=i,f=n>=u,l=s&&f,d=t+e<=i+a&&n+o<=u+c,m=Math.abs(Math.min(e,s?i+a-t:i-(t+e))),g=Math.abs(Math.min(o,f?u+c-n:u-(n+o))),p=Math.max(r.x,r.right-e),h=Math.max(r.y,r.bottom-o);return{originInBounds:l,sizeInBounds:d,limitX:uc(t,r.x,p),limitY:uc(n,r.y,h),deltaW:m,deltaH:g}}(r+a,h,n,e,s),b=v.originInBounds,y=v.sizeInBounds,x=v.limitX,w=v.limitY,S=v.deltaW,k=v.deltaH,C=g(w+k-f),O=g(l-w),_=function(t,n,e,o){return t.fold(n,n,o,o,n,o,e,e)}(t.direction,O,O,C),T=g(x+S-d),E=g(m-x),B={x,y:w,width:S,height:k,maxHeight:_,maxWidth:function(t,n,e,o){return t.fold(n,o,n,o,e,e,n,o)}(t.direction,E,E,T),direction:t.direction,classes:{on:t.bubble.classesOn,off:t.bubble.classesOff},label:t.label,candidateYforTest:h};return b&&y?ac.fit(B):ac.nofit(B,S,k)}(t(n,e,o),i,u,r).fold(ac.fit,(function(t,n,e){return e>s||n>c?ac.nofit(t,n,e):ac.nofit(a,c,s)}))};return X(t,(function(t,n){var e=h(a,n);return t.fold(ac.fit,e)}),ac.nofit({x:n.x,y:n.y,width:e.width,height:e.height,maxHeight:e.height,maxWidth:e.width,direction:ra(),classes:{on:[],off:[]},label:"none",candidateYforTest:n.y},-1,-1)).fold(p,p)}(o.preference,t,i,e,o.bounds)},sc=function(t,n){!function(t,n){var e=eu.max(t,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Ri(t,"max-height",e+"px")}(t,Math.floor(n))},fc=g((function(t,n){sc(t,n),Vi(t,{"overflow-x":"hidden","overflow-y":"auto"})})),lc=g((function(t,n){sc(t,n)})),dc=function(t,n,e){return void 0===t[n]?e:t[n]},mc=function(t,n,e,o){var r=cc(t,n,e,o);(function(t,n,e){$a(t,function(t,n){return t.fold((function(){return Ja("absolute",D.some(n.x),D.some(n.y),D.none(),D.none())}),(function(t,e,o,r){return Za("absolute",n,t,e,o,r)}),(function(t,e,o,r){return Za("fixed",n,t,e,o,r)}))}(e.origin,n))})(n,r,o),function(t,n){var e=n.classes;Ei(t,e.off),Ti(t,e.on)}(n,r),function(t,n,e){(0,e.maxHeightFunction)(t,n.maxHeight)}(n,r,o),function(t,n,e){(0,e.maxWidthFunction)(t,n.maxWidth)}(n,r,o)},gc=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],pc=function(t,n,e){var o=function(t){return Ot(e,t).getOr([])},r=function(t,n,e){var r=Z(gc,e);return{offset:uu(t,n),classesOn:J(e,o),classesOff:J(r,o)}};return{southeast:function(){return r(-t,n,["top","alignLeft"])},southwest:function(){return r(t,n,["top","alignRight"])},south:function(){return r(-t/2,n,["top","alignCentre"])},northeast:function(){return r(-t,-n,["bottom","alignLeft"])},northwest:function(){return r(t,-n,["bottom","alignRight"])},north:function(){return r(-t/2,-n,["bottom","alignCentre"])},east:function(){return r(t,-n/2,["valignCentre","left"])},west:function(){return r(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return r(-t,n,["top","alignRight"])},innerNortheast:function(){return r(t,n,["top","alignLeft"])},innerNorth:function(){return r(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return r(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return r(t,-n,["bottom","alignLeft"])},innerSouth:function(){return r(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return r(t,-n/2,["valignCentre","right"])},innerEast:function(){return r(-t,-n/2,["valignCentre","left"])}}},hc=function(){return pc(0,0,{})},vc=function(t,n){return function(e){return"rtl"===bc(e)?n:t}},bc=function(t){return"rtl"===Hi(t,"direction")?"rtl":"ltr"};!function(t){t.TopToBottom="toptobottom",t.BottomToTop="bottomtotop"}(Pu||(Pu={}));var yc,xc="data-alloy-vertical-dir",wc=function(t){return Mu(t,(function(t){return fr(t)&&Lr(t,"data-alloy-vertical-dir")===Pu.BottomToTop}))},Sc=function(){return jn("layouts",[En("onLtr"),En("onRtl"),Pn("onBottomLtr"),Pn("onBottomRtl")])},kc=function(t,n,e,o,r,i,u){var a=u.map(wc).getOr(!1),c=n.layouts.map((function(n){return n.onLtr(t)})),s=n.layouts.map((function(n){return n.onRtl(t)})),f=a?n.layouts.bind((function(n){return n.onBottomLtr.map((function(n){return n(t)}))})).or(c).getOr(r):c.getOr(e),l=a?n.layouts.bind((function(n){return n.onBottomRtl.map((function(n){return n(t)}))})).or(s).getOr(i):s.getOr(o);return vc(f,l)(t)},Cc=[En("hotspot"),Pn("bubble"),Un("overrides",{}),Sc(),Zu("placement",(function(t,n,e){var o=n.hotspot,r=tc(e,o.element),i=kc(t.element,n,Ma(),Da(),Ba(),Aa(),D.some(n.hotspot.element));return D.some({anchorBox:r,bubble:n.bubble.getOr(hc()),overrides:n.overrides,layouts:i,placer:D.none()})}))],Oc=[En("x"),En("y"),Un("height",0),Un("width",0),Un("bubble",hc()),Un("overrides",{}),Sc(),Zu("placement",(function(t,n,e){var o=ec(e,n.x,n.y),r=ku(o.left,o.top,n.width,n.height),i=kc(t.element,n,Ta(),Ea(),Ta(),Ea(),D.none());return D.some({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:D.none()})}))],_c=Et([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Tc=function(t){return t.fold(p,(function(t,n,e){return t.translate(-n,-e)}))},Ec=function(t){return t.fold(p,p)},Bc=function(t){return X(t,(function(t,n){return t.translate(n.left,n.top)}),uu(0,0))},Ac=function(t){var n=L(t,Ec);return Bc(n)},Mc=_c.screen,Dc=_c.absolute,Fc=function(t,n,e){var o=gr(t.element),r=hu(o),i=function(t,n,e){var o=vr(e.root).dom;return D.from(o.frameElement).map(re).filter((function(n){var e=gr(n),o=gr(t.element);return Le(e,o)})).map(cu)}(t,0,e).getOr(r);return Dc(i,r.left,r.top)},Ic=function(t,n,e,o){var r=t,i=n,u=e,a=o;t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n);var c=Mc(uu(r,i));return D.some(function(t,n,e){return{point:t,width:n,height:e}}(c,u,a))},Rc=function(t,n,e,o,r){return t.map((function(t){var i,u,a,c,s,f,l,d=[n,t.point],m=(i=function(){return Ac(d)},u=function(){return Ac(d)},a=function(){return function(t){var n=L(t,Tc);return Bc(n)}(d)},o.fold(i,u,a)),g=(c=m.left,s=m.top,f=t.width,l=t.height,{x:c,y:s,width:f,height:l}),p=e.showAbove?Ba():Ma(),h=e.showAbove?Aa():Da(),v=kc(r,e,p,h,p,h,D.none());return{anchorBox:g,bubble:e.bubble.getOr(hc()),overrides:e.overrides,layouts:v,placer:D.none()}}))},Vc=[En("node"),En("root"),Pn("bubble"),Sc(),Un("overrides",{}),Un("showAbove",!1),Zu("placement",(function(t,n,e){var o=Fc(t,0,n);return n.node.filter(Ai).bind((function(r){var i=r.dom.getBoundingClientRect(),u=Ic(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return Rc(u,o,n,e,a)}))}))],Pc=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},Hc=Et([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),zc=(Hc.before,Hc.on,Hc.after,function(t){return t.fold(p,p,p)}),Nc=Et([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Lc={domRange:Nc.domRange,relative:Nc.relative,exact:Nc.exact,exactFromRange:function(t){return Nc.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var n=function(t){return t.match({domRange:function(t){return re(t.startContainer)},relative:function(t,n){return zc(t)},exact:function(t,n,e,o){return t}})}(t);return vr(n)},range:Pc},jc=function(t,n,e){var o,r=t.document.createRange();return o=r,n.fold((function(t){o.setStartBefore(t.dom)}),(function(t,n){o.setStart(t.dom,n)}),(function(t){o.setStartAfter(t.dom)})),function(t,n){n.fold((function(n){t.setEndBefore(n.dom)}),(function(n,e){t.setEnd(n.dom,e)}),(function(n){t.setEndAfter(n.dom)}))}(r,e),r},Uc=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},Wc=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},Gc=Et([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Xc=function(t,n,e){return n(re(e.startContainer),e.startOffset,re(e.endContainer),e.endOffset)},Yc=(Gc.ltr,Gc.rtl,function(t,n){var e=function(n){return t(n)?D.from(n.dom.nodeValue):D.none()};return{get:function(n){if(!t(n))throw new Error("Can only get text value of a text node");return e(n).getOr("")},getOption:e,set:function(n,e){if(!t(n))throw new Error("Can only set raw text value of a text node");n.dom.nodeValue=e}}}(lr)),qc=function(t){return Yc.getOption(t)},Kc=["img","br"],Jc=function(t){return qc(t).filter((function(t){return 0!==t.trim().length||t.indexOf("")>-1})).isSome()||P(Kc,cr(t))},$c=function(t,n){return function(t,n){var e=void 0===n?document:n.dom;return Ne(e)?[]:L(e.querySelectorAll(t),re)}(n,t)},Qc=function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return D.some(Pc(re(n.startContainer),n.startOffset,re(e.endContainer),e.endOffset))}return D.none()},Zc=function(t){if(null===t.anchorNode||null===t.focusNode)return Qc(t);var n=re(t.anchorNode),e=re(t.focusNode);return function(t,n,e,o){var r=function(t,n,e,o){var r=gr(t).dom.createRange();return r.setStart(t.dom,n),r.setEnd(e.dom,o),r}(t,n,e,o),i=Le(t,e)&&n===o;return r.collapsed&&!i}(n,t.anchorOffset,e,t.focusOffset)?D.some(Pc(n,t.anchorOffset,e,t.focusOffset)):Qc(t)},ts=function(t,n){return e=function(t,n){return function(t,n){return e=function(t,n){return n.match({domRange:function(t){return{ltr:g(t),rtl:D.none}},relative:function(n,e){return{ltr:Ft((function(){return jc(t,n,e)})),rtl:Ft((function(){return D.some(jc(t,e,n))}))}},exact:function(n,e,o,r){return{ltr:Ft((function(){return Uc(t,n,e,o,r)})),rtl:Ft((function(){return D.some(Uc(t,o,r,n,e))}))}}})}(t,n),(o=e.ltr()).collapsed?e.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return Gc.rtl(re(t.endContainer),t.endOffset,re(t.startContainer),t.startOffset)})).getOrThunk((function(){return Xc(0,Gc.ltr,o)})):Xc(0,Gc.ltr,o);var e,o}(t,n).match({ltr:function(n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},rtl:function(n,e,o,r){var i=t.document.createRange();return i.setStart(o.dom,r),i.setEnd(n.dom,e),i}})}(t,n),o=e.getClientRects(),(r=o.length>0?o[0]:e.getBoundingClientRect()).width>0||r.height>0?D.some(r).map(Wc):D.none();var e,o,r},ns=function(t,n){return{element:t,offset:n}},es=function(t,n){return lr(t)?ns(t,n):function(t,n){var e=xr(t);if(0===e.length)return ns(t,n);if(n<e.length)return ns(e[n],0);var o=e[e.length-1],r=lr(o)?function(t){return Yc.get(t)}(o).length:xr(o).length;return ns(o,r)}(t,n)},os=function(t,n){return n.getSelection.getOrThunk((function(){return function(){return function(t){return function(t){return D.from(t.getSelection())}(t).filter((function(t){return t.rangeCount>0})).bind(Zc)}(t)}}))().map((function(t){var n=es(t.start,t.soffset),e=es(t.finish,t.foffset);return Lc.range(n.element,n.offset,e.element,e.offset)}))},rs=[Pn("getSelection"),En("root"),Pn("bubble"),Sc(),Un("overrides",{}),Un("showAbove",!1),Zu("placement",(function(t,n,e){var o=vr(n.root).dom,r=Fc(t,0,n),i=os(o,n).bind((function(t){return ts(o,Lc.exactFromRange(t)).orThunk((function(){var n=oe("\ufeff");return Br(t.start,n),ts(o,Lc.exact(n,0,n,1)).map((function(t){return Rr(n),t}))})).bind((function(t){return Ic(t.left,t.top,t.width,t.height)}))})),u=os(o,n).bind((function(t){return fr(t.start)?D.some(t.start):function(t){return br(t)}(t.start)})).getOr(t.element);return Rc(i,r,n,e,u)}))],is=function(t){return t.x+t.width},us=function(t,n){return t.x-n.width},as=function(t,n){return t.y-n.height+t.height},cs=function(t){return t.y},ss=function(t,n,e){return ea(is(t),cs(t),e.southeast(),ra(),da(t,{left:0,top:2}),"link-layout-se")},fs=function(t,n,e){return ea(us(t,n),cs(t),e.southwest(),ia(),da(t,{right:1,top:2}),"link-layout-sw")},ls=function(t,n,e){return ea(is(t),as(t,n),e.northeast(),ua(),da(t,{left:0,bottom:3}),"link-layout-ne")},ds=function(t,n,e){return ea(us(t,n),as(t,n),e.northwest(),aa(),da(t,{right:1,bottom:3}),"link-layout-nw")},ms=function(){return[ss,fs,ls,ds]},gs=function(){return[fs,ss,ds,ls]},ps=[En("item"),Sc(),Un("overrides",{}),Zu("placement",(function(t,n,e){var o=tc(e,n.item.element),r=kc(t.element,n,ms(),gs(),ms(),gs(),D.none());return D.some({anchorBox:o,bubble:hc(),overrides:n.overrides,layouts:r,placer:D.none()})}))],hs=bn("anchor",{selection:rs,node:Vc,hotspot:Cc,submenu:ps,makeshift:Oc}),vs=function(t,n,e,o,r){!function(t,n,e,o,r,i){var u=dc(i,"maxHeightFunction",fc()),a=dc(i,"maxWidthFunction",d),c=t.anchorBox,s=t.origin,f={bounds:nc(s,r),origin:s,preference:o,maxHeightFunction:u,maxWidthFunction:a};mc(c,n,e,f)}(function(t,n){return function(t,n){return{anchorBox:t,origin:n}}(t,n)}(e.anchorBox,n),r.element,e.bubble,e.layouts,o,e.overrides)},bs=function(t,n,e,o,r,i){var u=i.map(Cu);return ys(t,n,e,o,r,u)},ys=function(t,n,e,o,r,i){var u=pn("positioning anchor.info",hs,o);Ka((function(){Ri(r.element,"position","fixed");var e=Ni(r.element,"visibility");Ri(r.element,"visibility","hidden");var o,a=n.useFixed()?(o=document.documentElement,rc(0,0,o.clientWidth,o.clientHeight)):function(t){var n=cu(t.element),e=t.element.dom.getBoundingClientRect();return oc(n.left,n.top,e.width,e.height)}(t),c=u.placement,s=i.map(g).or(n.getBounds);c(t,u,a).each((function(n){n.placer.getOr(vs)(t,a,n,s,r)})),e.fold((function(){Ui(r.element,"visibility")}),(function(t){Ri(r.element,"visibility",t)})),Ni(r.element,"left").isNone()&&Ni(r.element,"top").isNone()&&Ni(r.element,"right").isNone()&&Ni(r.element,"bottom").isNone()&&Ni(r.element,"position").is("fixed")&&Ui(r.element,"position")}),r.element)},xs=Object.freeze({__proto__:null,position:function(t,n,e,o,r){bs(t,n,e,o,r,D.none())},positionWithin:bs,positionWithinBounds:ys,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"}}),ws=[Un("useFixed",y),Pn("getBounds")],Ss=Na({fields:ws,name:"positioning",active:Ga,apis:xs}),ks=function(t){Lo(t,Do());var n=t.components();j(n,ks)},Cs=function(t){var n=t.components();j(n,Cs),Lo(t,Mo())},Os=function(t,n){Dr(t.element,n.element)},_s=function(t,n){var e=t.components();!function(t){j(t.components(),(function(t){return Rr(t.element)})),Ir(t.element),t.syncComponents()}(t);var o=Z(e,n);j(o,(function(n){ks(n),t.getSystem().removeFromWorld(n)})),j(n,(function(n){n.getSystem().isConnected()?Os(t,n):(t.getSystem().addToWorld(n),Os(t,n),Ai(t.element)&&Cs(n)),t.syncComponents()}))},Ts=function(t,n){Es(t,n,Dr)},Es=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),Ai(t.element)&&Cs(n),t.syncComponents()},Bs=function(t){ks(t),Rr(t.element),t.getSystem().removeFromWorld(t)},As=function(t){var n=br(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}));Bs(t),n.each((function(t){t.syncComponents()}))},Ms=function(t){var n=t.components();j(n,Bs),Ir(t.element),t.syncComponents()},Ds=function(t,n){Fs(t,n,Dr)},Fs=function(t,n,e){e(t,n.element);var o=xr(n.element);j(o,(function(t){n.getByDom(t).each(Cs)}))},Is=function(t){var n=xr(t.element);j(n,(function(n){t.getByDom(n).each(ks)})),Rr(t.element)},Rs=function(t,n,e,o){e.get().each((function(n){Ms(t)}));var r=n.getAttachPoint(t);Ts(r,t);var i=t.getSystem().build(o);return Ts(t,i),e.set(i),i},Vs=function(t,n,e,o){var r=Rs(t,n,e,o);return n.onOpen(t,r),r},Ps=function(t,n,e){e.get().each((function(o){Ms(t),As(t),n.onClose(t,o),e.clear()}))},Hs=function(t,n,e){return e.isOpen()},zs=function(t,n,e){var o=n.getAttachPoint(t);Ri(t.element,"position",Ss.getMode(o)),function(t,n,e,o){Ni(t.element,n).fold((function(){Wr(t.element,e)}),(function(n){Nr(t.element,e,n)})),Ri(t.element,n,"hidden")}(t,"visibility",n.cloakVisibilityAttr)},Ns=function(t,n,e){(function(t){return H(["top","left","right","bottom"],(function(n){return Ni(t,n).isSome()}))})(t.element)||Ui(t.element,"position"),function(t,n,e){jr(t.element,e).fold((function(){return Ui(t.element,n)}),(function(e){return Ri(t.element,n,e)}))}(t,"visibility",n.cloakVisibilityAttr)},Ls=Object.freeze({__proto__:null,cloak:zs,decloak:Ns,open:Vs,openWhileCloaked:function(t,n,e,o,r){zs(t,n),Vs(t,n,e,o),r(),Ns(t,n)},close:Ps,isOpen:Hs,isPartOf:function(t,n,e,o){return Hs(0,0,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map((function(){return Rs(t,n,e,o)}))}}),js=Object.freeze({__proto__:null,events:function(t,n){return Yo([Jo(Co(),(function(e,o){Ps(e,t,n)}))])}}),Us=[Ku("onOpen"),Ku("onClose"),En("isPartOf"),En("getAttachPoint"),Un("cloakVisibilityAttr","data-precloak-visibility")],Ws=Na({fields:Us,name:"sandboxing",active:js,apis:Ls,state:Object.freeze({__proto__:null,init:function(){var t=Zn(D.none()),n=g("not-implemented");return mi({readState:n,isOpen:function(){return t.get().isSome()},clear:function(){t.set(D.none())},set:function(n){t.set(D.some(n))},get:function(){return t.get()}})}})}),Gs=g("dismiss.popups"),Xs=g("reposition.popups"),Ys=g("mouse.released"),qs=Qt([Un("isExtraPart",y),jn("fireEventInstead",[Un("event",Fo())])]),Ks=function(t){var n,e=pn("Dismissal",qs,t);return(n={})[Gs()]={schema:Qt([En("target")]),onReceive:function(t,n){Ws.isOpen(t)&&(Ws.isPartOf(t,n.target)||e.isExtraPart(t,n.target)||e.fireEventInstead.fold((function(){return Ws.close(t)}),(function(n){return Lo(t,n.event)})))}},n},Js=Qt([jn("fireEventInstead",[Un("event",Io())]),Fn("doReposition")]),$s=function(t){var n,e=pn("Reposition",Js,t);return(n={})[Xs()]={onReceive:function(t){Ws.isOpen(t)&&e.fireEventInstead.fold((function(){return e.doReposition(t)}),(function(n){return Lo(t,n.event)}))}},n},Qs=function(t,n,e){n.store.manager.onLoad(t,n,e)},Zs=function(t,n,e){n.store.manager.onUnload(t,n,e)},tf=Object.freeze({__proto__:null,onLoad:Qs,onUnload:Zs,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),nf=Object.freeze({__proto__:null,events:function(t,n){var e=t.resetOnDom?[rr((function(e,o){Qs(e,t,n)})),ir((function(e,o){Zs(e,t,n)}))]:[Ra(t,n,Qs)];return Yo(e)}}),ef=function(){var t=Zn(null);return mi({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},of=function(){var t=Zn({}),n=Zn({});return mi({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return Ot(t.get(),e).orThunk((function(){return Ot(n.get(),e)}))},update:function(e){var o=t.get(),r=n.get(),i={},u={};j(e,(function(t){i[t.value]=t,Ot(t,"meta").each((function(n){Ot(n,"text").each((function(n){u[n]=t}))}))})),t.set(S(S({},o),i)),n.set(S(S({},r),u))},clear:function(){t.set({}),n.set({})}})},rf=Object.freeze({__proto__:null,memory:ef,dataset:of,manual:function(){return mi({readState:d})},init:function(t){return t.store.manager.state(t)}}),uf=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},af=[Pn("initialValue"),En("getFallbackEntry"),En("getDataKey"),En("setValue"),Zu("manager",{setValue:uf,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).fold((function(){return o.getFallbackEntry(r)}),(function(t){return t}))},onLoad:function(t,n,e){n.store.initialValue.each((function(o){uf(t,n,e,o)}))},onUnload:function(t,n,e){e.clear()},state:of})],cf=[En("getValue"),Un("setValue",d),Pn("initialValue"),Zu("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},onUnload:d,state:di.init})],sf=[Pn("initialValue"),Zu("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},onUnload:function(t,n,e){e.clear()},state:ef})],ff=[Wn("store",{mode:"memory"},bn("mode",{memory:sf,manual:cf,dataset:af})),Ku("onSetValue"),Un("resetOnDom",!1)],lf=Na({fields:ff,name:"representing",active:nf,apis:tf,extra:{setValueFrom:function(t,n){var e=lf.getValue(n);lf.setValue(t,e)}},state:rf}),df=function(t,n){return $n(t,{},L(n,(function(n){return e=n.name(),o="Cannot configure "+n.name()+" for "+t,un(e,e,Pt(),Jt((function(t){return gt("The field: "+e+" is forbidden. "+o)})));var e,o})).concat([Qn("dump",p)]))},mf=function(t){return t.dump},gf=function(t,n){return S(S({},t.dump),Ha(n))},pf=df,hf=gf,vf="placeholder",bf=Et([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),yf=function(t){return _t(t,"uiType")},xf=function(t,n,e,o){return function(t,n,e,o){return yf(e)&&e.uiType===vf?function(t,n,e,o){return t.exists((function(t){return t!==e.owner}))?bf.single(!0,g(e)):Ot(o,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+vt(o)+"]\nNamespace: "+t.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(t){return t.replace()}))}(t,0,e,o):bf.single(!1,g(e))}(t,0,e,o).fold((function(r,i){var u=yf(e)?i(n,e.config,e.validated):i(n),a=Ot(u,"components").getOr([]),c=J(a,(function(e){return xf(t,n,e,o)}));return[S(S({},u),{components:c})]}),(function(t,o){if(yf(e)){var r=o(n,e.config,e.validated);return e.validated.preprocess.getOr(p)(r)}return o(n)}))},wf=bf.single,Sf=bf.multiple,kf=g(vf),Cf=Et([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Of=Un("factory",{sketch:p}),_f=Un("schema",[]),Tf=En("name"),Ef=un("pname","pname",Ht((function(t){return"<alloy."+Jr(t.name)+">"})),yn()),Bf=Qn("schema",(function(){return[Pn("preprocess")]})),Af=Un("defaults",g({})),Mf=Un("overrides",g({})),Df=Zt([Of,_f,Tf,Ef,Af,Mf]),Ff=Zt([Of,_f,Tf,Af,Mf]),If=Zt([Of,_f,Tf,Ef,Af,Mf]),Rf=Zt([Of,Bf,Tf,En("unit"),Ef,Af,Mf]),Vf=function(t){return t.fold(D.some,D.none,D.some,D.some)},Pf=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},Hf=function(t,n){return function(e){var o=pn("Converting part type",n,e);return t(o)}},zf=Hf(Cf.required,Df),Nf=Hf(Cf.external,Ff),Lf=Hf(Cf.optional,If),jf=Hf(Cf.group,Rf),Uf=g("entirety"),Wf=Object.freeze({__proto__:null,required:zf,external:Nf,optional:Lf,group:jf,asNamedPart:Vf,name:Pf,asCommon:function(t){return t.fold(p,p,p,p)},original:Uf}),Gf=function(t,n,e,o){return Mt(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},Xf=function(t,n){var e={};return j(n,(function(n){Vf(n).each((function(n){var o=Yf(t,n.pname);e[n.name]=function(e){var r=pn("Part: "+n.name+" in "+t,Zt(n.schema),e);return S(S({},o),{config:e,validated:r})}}))})),e},Yf=function(t,n){return{uiType:kf(),owner:t,name:n}},qf=function(t,n,e){return{uiType:kf(),owner:t,name:n,config:e,validated:{}}},Kf=function(t){return J(t,(function(t){return t.fold(D.none,D.some,D.none,D.none).map((function(t){return In(t.name,t.schema.concat([ta(Uf())]))})).toArray()}))},Jf=function(t){return L(t,Pf)},$f=function(t,n,e){return function(t,n,e){var o={},r={};return j(e,(function(t){t.fold((function(t){o[t.pname]=wf(!0,(function(n,e,o){return t.factory.sketch(Gf(n,t,e,o))}))}),(function(t){var e=n.parts[t.name];r[t.name]=g(t.factory.sketch(Gf(n,t,e[Uf()]),e))}),(function(t){o[t.pname]=wf(!1,(function(n,e,o){return t.factory.sketch(Gf(n,t,e,o))}))}),(function(t){o[t.pname]=Sf(!0,(function(n,e,o){var r=n[t.name];return L(r,(function(e){return t.factory.sketch(Mt(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:g(o),externals:g(r)}}(0,n,e)},Qf=function(t,n,e){return function(t,n,e,o){var r=xt(o,(function(t,n){return o=t,r=!1,{name:g(e=n),required:function(){return o.fold((function(t,n){return t}),(function(t,n){return t}))},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+e);return r=!0,o}};var e,o,r})),i=function(t,n,e,o){return J(e,(function(e){return xf(t,n,e,o)}))}(t,n,e,r);return yt(r,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),i}(D.some(t),n,n.components,e)},Zf=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},tl=function(t,n,e){return Zf(t,n,e).getOrDie("Could not find part: "+e)},nl=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return j(e,(function(t){o[t]=g(i.getByUid(r[t]))})),o},el=function(t,n){var e=t.getSystem();return xt(n.partUids,(function(t,n){return g(e.getByUid(t))}))},ol=function(t){return vt(t.partUids)},rl=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return j(e,(function(t){o[t]=g(i.getByUid(r[t]).getOrDie())})),o},il=function(t,n){var e=Jf(n);return jt(L(e,(function(n){return{key:n,value:t+"-"+n}})))},ul=function(t){return un("partUids","partUids",zt((function(n){return il(n.uid,t)})),yn())},al=Object.freeze({__proto__:null,generate:Xf,generateOne:qf,schemas:Kf,names:Jf,substitutes:$f,components:Qf,defaultUids:il,defaultUidsSchema:ul,getAllParts:el,getAllPartNames:ol,getPart:Zf,getPartOrDie:tl,getParts:nl,getPartsOrDie:rl}),cl=function(t,n,e,o,r){var i=function(t,n){return(t.length>0?[In("parts",t)]:[]).concat([En("uid"),Un("dom",{}),Un("components",[]),ta("originalSpec"),Un("debug.sketcher",{})]).concat(n)}(o,r);return pn(t+" [SpecSchema]",Qt(i.concat(n)),e)},sl=function(t,n,e,o,r){var i=fl(r),u=Kf(e),a=ul(e),c=cl(t,n,i,u,[a]),s=$f(0,c,e);return o(c,Qf(t,c,s.internals()),i,s.externals())},fl=function(t){return function(t){return _t(t,"uid")}(t)?t:S(S({},t),{uid:oi("uid")})},ll=Qt([En("name"),En("factory"),En("configFields"),Un("apis",{}),Un("extraApis",{})]),dl=Qt([En("name"),En("factory"),En("configFields"),En("partFields"),Un("apis",{}),Un("extraApis",{})]),ml=function(t){var n=pn("Sketcher for "+t.name,ll,t),e=xt(n.apis,li),o=xt(n.extraApis,(function(t,n){return ci(t,n)}));return S(S({name:n.name,configFields:n.configFields,sketch:function(t){return function(t,n,e,o){var r=fl(o);return e(cl(t,n,r,[],[]),r)}(n.name,n.configFields,n.factory,t)}},e),o)},gl=function(t){var n=pn("Sketcher for "+t.name,dl,t),e=Xf(n.name,n.partFields),o=xt(n.apis,li),r=xt(n.extraApis,(function(t,n){return ci(t,n)}));return S(S({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return sl(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},pl=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},hl=function(t,n){return t?D.some(n):D.none()},vl=function(t){return"input"===cr(t)&&"radio"!==Lr(t,"type")||"textarea"===cr(t)},bl=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),yl=[En("find")],xl=Na({fields:yl,name:"composing",apis:bl}),wl=function(t,n,e,o){var r=$c(t.element,"."+n.highlightClass);j(r,(function(e){H(o,(function(t){return t.element===e}))||(Oi(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),Lo(e,No())})))}))},Sl=function(t,n,e,o){wl(t,n,0,[o]),kl(t,n,e,o)||(Ci(o.element,n.highlightClass),n.onHighlight(t,o),Lo(o,zo()))},kl=function(t,n,e,o){return _i(o.element,n.highlightClass)},Cl=function(t,n,e){return Fu(t.element,"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},Ol=function(t,n,e){var o=$c(t.element,"."+n.itemClass);return(o.length>0?D.some(o[o.length-1]):D.none()).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},_l=function(t,n,e,o){var r=$c(t.element,"."+n.itemClass);return q(r,(function(t){return _i(t,n.highlightClass)})).bind((function(n){var e=ic(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()}))},Tl=function(t,n,e){var o=$c(t.element,"."+n.itemClass);return pl(L(o,(function(n){return t.getSystem().getByDom(n).toOptional()})))},El=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return wl(t,n,0,[])},dehighlight:function(t,n,e,o){kl(t,n,e,o)&&(Oi(o.element,n.highlightClass),n.onDehighlight(t,o),Lo(o,No()))},highlight:Sl,highlightFirst:function(t,n,e){Cl(t,n).each((function(o){Sl(t,n,e,o)}))},highlightLast:function(t,n,e){Ol(t,n).each((function(o){Sl(t,n,e,o)}))},highlightAt:function(t,n,e,o){(function(t,n,e,o){var r=$c(t.element,"."+n.itemClass);return D.from(r[o]).fold((function(){return ct.error(new Error("No element found with index "+o))}),t.getSystem().getByDom)})(t,n,0,o).fold((function(t){throw t}),(function(o){Sl(t,n,e,o)}))},highlightBy:function(t,n,e,o){var r=Tl(t,n);Y(r,o).each((function(o){Sl(t,n,e,o)}))},isHighlighted:kl,getHighlighted:function(t,n,e){return Fu(t.element,"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},getFirst:Cl,getLast:Ol,getPrevious:function(t,n,e){return _l(t,n,0,-1)},getNext:function(t,n,e){return _l(t,n,0,1)},getCandidates:Tl}),Bl=[En("highlightClass"),En("itemClass"),Ku("onHighlight"),Ku("onDehighlight")],Al=Na({fields:Bl,name:"highlighting",apis:El}),Ml=[8],Dl=[9],Fl=[13],Il=[27],Rl=[32],Vl=[37],Pl=[38],Hl=[39],zl=[40],Nl=function(t,n,e){var o=Q(t.slice(0,n)),r=Q(t.slice(n+1));return Y(o.concat(r),e)},Ll=function(t,n,e){var o=Q(t.slice(0,n));return Y(o,e)},jl=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return Y(r.concat(o),e)},Ul=function(t,n,e){var o=t.slice(n+1);return Y(o,e)},Wl=function(t){return function(n){var e=n.raw;return P(t,e.which)}},Gl=function(t){return function(n){return $(t,(function(t){return t(n)}))}},Xl=function(t){return!0===t.raw.shiftKey},Yl=function(t){return!0===t.raw.ctrlKey},ql=v(Xl),Kl=function(t,n){return{matches:t,classification:n}},Jl=function(t,n,e){n.exists((function(t){return e.exists((function(n){return Le(n,t)}))}))||jo(t,Ro(),{prevFocus:n,newFocus:e})},$l=function(){var t=function(t){return qa(t.element)};return{get:t,set:function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element);var r=t(n);Jl(n,o,r)}}},Ql=function(){var t=function(t){return Al.getHighlighted(t).map((function(t){return t.element}))};return{get:t,set:function(n,e){var o=t(n);n.getSystem().getByDom(e).fold(d,(function(t){Al.highlight(n,t)}));var r=t(n);Jl(n,o,r)}}};!function(t){t.OnFocusMode="onFocus",t.OnEnterOrSpaceMode="onEnterOrSpace",t.OnApiMode="onApi"}(yc||(yc={}));var Zl=function(t,n,e,o,r){var i=function(t,n,e,o,r){var i,u;return(i=e(t,n,o,r),u=n.event,Y(i,(function(t){return t.matches(u)})).map((function(t){return t.classification}))).bind((function(e){return e(t,n,o,r)}))},u={schema:function(){return t.concat([Un("focusManager",$l()),Wn("focusInside","onFocus",ln((function(t){return P(["onFocus","onEnterOrSpace","onApi"],t)?ct.value(t):ct.error("Invalid value for focusInside")}))),Zu("handler",u),Zu("state",n),Zu("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==yc.OnFocusMode?D.none():r(t).map((function(e){return Jo(ho(),(function(o,r){e(o,t,n),r.stop()}))})),a=[Jo(uo(),(function(o,u){i(o,u,e,t,n).fold((function(){!function(e,o){var i=Wl(Rl.concat(Fl))(o.event);t.focusInside===yc.OnEnterOrSpaceMode&&i&&Xe(e,o)&&r(t).each((function(r){r(e,t,n),o.stop()}))}(o,u)}),(function(t){u.stop()}))})),Jo(ao(),(function(e,r){i(e,r,o,t,n).each((function(t){r.stop()}))}))];return Yo(u.toArray().concat(a))}};return u},td=function(t){var n=[Pn("onEscape"),Pn("onEnter"),Un("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Un("firstTabstop",0),Un("useTabstopAt",x),Pn("visibilitySelector")].concat([t]),e=function(t,n){var e=t.visibilitySelector.bind((function(t){return Iu(n,t)})).getOr(n);return ou(e)>0},o=function(t,n,o){(function(t,n){var o=$c(t.element,n.selector),r=W(o,(function(t){return e(n,t)}));return D.from(r[n.firstTabstop])})(t,n).each((function(e){n.focusManager.set(t,e)}))},r=function(t,n,o,r){var i=$c(t.element,o.selector);return function(t,n){return n.focusManager.get(t).bind((function(t){return Iu(t,n.selector)}))}(t,o).bind((function(n){return q(i,h(Le,n)).bind((function(n){return function(t,n,o,r,i){return i(n,o,(function(t){return function(t,n){return e(t,n)&&t.useTabstopAt(n)}(r,t)})).fold((function(){return r.cyclic?D.some(!0):D.none()}),(function(n){return r.focusManager.set(t,n),D.some(!0)}))}(t,i,n,o,r)}))}))},i=g([Kl(Gl([Xl,Wl(Dl)]),(function(t,n,e){var o=e.cyclic?Nl:Ll;return r(t,0,e,o)})),Kl(Wl(Dl),(function(t,n,e){var o=e.cyclic?jl:Ul;return r(t,0,e,o)})),Kl(Wl(Il),(function(t,n,e){return e.onEscape.bind((function(e){return e(t,n)}))})),Kl(Gl([ql,Wl(Fl)]),(function(t,n,e){return e.onEnter.bind((function(e){return e(t,n)}))}))]),u=g([]);return Zl(n,di.init,i,u,(function(){return D.some(o)}))},nd=td(Qn("cyclic",y)),ed=td(Qn("cyclic",x)),od=function(t,n,e){return vl(e)&&Wl(Rl)(n.event)?D.none():function(t,n,e){return Wo(t,e,xo()),D.some(!0)}(t,0,e)},rd=function(t,n){return D.some(!0)},id=[Un("execute",od),Un("useSpace",!1),Un("useEnter",!0),Un("useControlEnter",!1),Un("useDown",!1)],ud=function(t,n,e){return e.execute(t,n,t.element)},ad=Zl(id,di.init,(function(t,n,e,o){var r=e.useSpace&&!vl(t.element)?Rl:[],i=e.useEnter?Fl:[],u=e.useDown?zl:[],a=r.concat(i).concat(u);return[Kl(Wl(a),ud)].concat(e.useControlEnter?[Kl(Gl([Yl,Wl(Fl)]),ud)]:[])}),(function(t,n,e,o){return e.useSpace&&!vl(t.element)?[Kl(Wl(Rl),rd)]:[]}),(function(){return D.none()})),cd=function(){var t=Zn(D.none());return mi({readState:function(){return t.get().map((function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set(D.some({numRows:n,numColumns:e}))},getNumRows:function(){return t.get().map((function(t){return t.numRows}))},getNumColumns:function(){return t.get().map((function(t){return t.numColumns}))}})},sd=Object.freeze({__proto__:null,flatgrid:cd,init:function(t){return t.state(t)}}),fd=function(t){return function(n,e,o,r){var i=t(n.element);return gd(i,n,e,o,r)}},ld=function(t,n){var e=vc(t,n);return fd(e)},dd=function(t,n){var e=vc(n,t);return fd(e)},md=function(t){return function(n,e,o,r){return gd(t,n,e,o,r)}},gd=function(t,n,e,o,r){return o.focusManager.get(n).bind((function(e){return t(n.element,e,o,r)})).map((function(t){return o.focusManager.set(n,t),!0}))},pd=md,hd=md,vd=md,bd=function(t){return!function(t){return t.offsetWidth<=0&&t.offsetHeight<=0}(t.dom)},yd=function(t,n,e){var o=$c(t,e);return function(t,e){return q(t,(function(t){return Le(t,n)})).map((function(n){return{index:n,candidates:t}}))}(W(o,bd))},xd=function(t,n){return q(t,(function(t){return Le(n,t)}))},wd=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind((function(n){var o=n.row*e+n.column;return o>=0&&o<t.length?D.some(t[o]):D.none()}))},Sd=function(t,n,e,o,r){return wd(t,n,o,(function(n,i){var u=n===e-1?t.length-n*o:o,a=ic(i,r,0,u-1);return D.some({row:n,column:a})}))},kd=function(t,n,e,o,r){return wd(t,n,o,(function(n,i){var u=ic(n,r,0,e-1),a=u===e-1?t.length-u*o:o,c=uc(i,0,a-1);return D.some({row:u,column:c})}))},Cd=[En("selector"),Un("execute",od),Ju("onEscape"),Un("captureTab",!1),na()],Od=function(t,n,e){Fu(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},_d=function(t){return function(n,e,o,r){return yd(n,e,o.selector).bind((function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},Td=function(t,n,e){return e.captureTab?D.some(!0):D.none()},Ed=_d((function(t,n,e,o){return Sd(t,n,e,o,-1)})),Bd=_d((function(t,n,e,o){return Sd(t,n,e,o,1)})),Ad=_d((function(t,n,e,o){return kd(t,n,e,o,-1)})),Md=_d((function(t,n,e,o){return kd(t,n,e,o,1)})),Dd=g([Kl(Wl(Vl),ld(Ed,Bd)),Kl(Wl(Hl),dd(Ed,Bd)),Kl(Wl(Pl),pd(Ad)),Kl(Wl(zl),hd(Md)),Kl(Gl([Xl,Wl(Dl)]),Td),Kl(Gl([ql,Wl(Dl)]),Td),Kl(Wl(Il),(function(t,n,e){return e.onEscape(t,n)})),Kl(Wl(Rl.concat(Fl)),(function(t,n,e,o){return function(t,n){return n.focusManager.get(t).bind((function(t){return Iu(t,n.selector)}))}(t,e).bind((function(o){return e.execute(t,n,o)}))}))]),Fd=g([Kl(Wl(Rl),rd)]),Id=Zl(Cd,cd,Dd,Fd,(function(){return D.some(Od)})),Rd=function(t,n,e,o){var r=function(t,n,e){var i,u=ic(n,o,0,e.length-1);return u===t?D.none():(i=e[u],"button"===cr(i)&&"disabled"===Lr(i,"disabled")?r(t,u,e):D.from(e[u]))};return yd(t,e,n).bind((function(t){var n=t.index,e=t.candidates;return r(n,n,e)}))},Vd=[En("selector"),Un("getInitial",D.none),Un("execute",od),Ju("onEscape"),Un("executeOnMove",!1),Un("allowVertical",!0)],Pd=function(t,n,e){return function(t,n){return n.focusManager.get(t).bind((function(t){return Iu(t,n.selector)}))}(t,e).bind((function(o){return e.execute(t,n,o)}))},Hd=function(t,n,e){n.getInitial(t).orThunk((function(){return Fu(t.element,n.selector)})).each((function(e){n.focusManager.set(t,e)}))},zd=function(t,n,e){return Rd(t,e.selector,n,-1)},Nd=function(t,n,e){return Rd(t,e.selector,n,1)},Ld=function(t){return function(n,e,o,r){return t(n,e,o,r).bind((function(){return o.executeOnMove?Pd(n,e,o):D.some(!0)}))}},jd=function(t,n,e){return e.onEscape(t,n)},Ud=g([Kl(Wl(Rl),rd)]),Wd=Zl(Vd,di.init,(function(t,n,e,o){var r=Vl.concat(e.allowVertical?Pl:[]),i=Hl.concat(e.allowVertical?zl:[]);return[Kl(Wl(r),Ld(ld(zd,Nd))),Kl(Wl(i),Ld(dd(zd,Nd))),Kl(Wl(Fl),Pd),Kl(Wl(Rl),Pd),Kl(Wl(Il),jd)]}),Ud,(function(){return D.some(Hd)})),Gd=function(t,n,e){return D.from(t[n]).bind((function(t){return D.from(t[e]).map((function(t){return{rowIndex:n,columnIndex:e,cell:t}}))}))},Xd=function(t,n,e,o){var r=t[n].length,i=ic(e,o,0,r-1);return Gd(t,n,i)},Yd=function(t,n,e,o){var r=ic(e,o,0,t.length-1),i=t[r].length,u=uc(n,0,i-1);return Gd(t,r,u)},qd=function(t,n,e,o){var r=t[n].length,i=uc(e+o,0,r-1);return Gd(t,n,i)},Kd=function(t,n,e,o){var r=uc(e+o,0,t.length-1),i=t[r].length,u=uc(n,0,i-1);return Gd(t,r,u)},Jd=[In("selectors",[En("row"),En("cell")]),Un("cycles",!0),Un("previousSelector",D.none),Un("execute",od)],$d=function(t,n,e){n.previousSelector(t).orThunk((function(){var e=n.selectors;return Fu(t.element,e.cell)})).each((function(e){n.focusManager.set(t,e)}))},Qd=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return Iu(o,r.selectors.row).bind((function(t){var n=$c(t,r.selectors.cell);return xd(n,o).bind((function(n){var o=$c(e,r.selectors.row);return xd(o,t).bind((function(t){var e=function(t,n){return L(t,(function(t){return $c(t,n.selectors.cell)}))}(o,r);return i(e,t,n).map((function(t){return t.cell}))}))}))}))}},Zd=Qd((function(t,n,e){return Xd(t,n,e,-1)}),(function(t,n,e){return qd(t,n,e,-1)})),tm=Qd((function(t,n,e){return Xd(t,n,e,1)}),(function(t,n,e){return qd(t,n,e,1)})),nm=Qd((function(t,n,e){return Yd(t,e,n,-1)}),(function(t,n,e){return Kd(t,e,n,-1)})),em=Qd((function(t,n,e){return Yd(t,e,n,1)}),(function(t,n,e){return Kd(t,e,n,1)})),om=g([Kl(Wl(Vl),ld(Zd,tm)),Kl(Wl(Hl),dd(Zd,tm)),Kl(Wl(Pl),pd(nm)),Kl(Wl(zl),hd(em)),Kl(Wl(Rl.concat(Fl)),(function(t,n,e){return qa(t.element).bind((function(o){return e.execute(t,n,o)}))}))]),rm=g([Kl(Wl(Rl),rd)]),im=Zl(Jd,di.init,om,rm,(function(){return D.some($d)})),um=[En("selector"),Un("execute",od),Un("moveOnTab",!1)],am=function(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))},cm=function(t,n,e){Fu(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},sm=function(t,n,e){return Rd(t,e.selector,n,-1)},fm=function(t,n,e){return Rd(t,e.selector,n,1)},lm=g([Kl(Wl(Pl),vd(sm)),Kl(Wl(zl),vd(fm)),Kl(Gl([Xl,Wl(Dl)]),(function(t,n,e,o){return e.moveOnTab?vd(sm)(t,n,e,o):D.none()})),Kl(Gl([ql,Wl(Dl)]),(function(t,n,e,o){return e.moveOnTab?vd(fm)(t,n,e,o):D.none()})),Kl(Wl(Fl),am),Kl(Wl(Rl),am)]),dm=g([Kl(Wl(Rl),rd)]),mm=Zl(um,di.init,lm,dm,(function(){return D.some(cm)})),gm=[Ju("onSpace"),Ju("onEnter"),Ju("onShiftEnter"),Ju("onLeft"),Ju("onRight"),Ju("onTab"),Ju("onShiftTab"),Ju("onUp"),Ju("onDown"),Ju("onEscape"),Un("stopSpaceKeyup",!1),Pn("focusIn")],pm=Zl(gm,di.init,(function(t,n,e){return[Kl(Wl(Rl),e.onSpace),Kl(Gl([ql,Wl(Fl)]),e.onEnter),Kl(Gl([Xl,Wl(Fl)]),e.onShiftEnter),Kl(Gl([Xl,Wl(Dl)]),e.onShiftTab),Kl(Gl([ql,Wl(Dl)]),e.onTab),Kl(Wl(Pl),e.onUp),Kl(Wl(zl),e.onDown),Kl(Wl(Vl),e.onLeft),Kl(Wl(Hl),e.onRight),Kl(Wl(Rl),e.onSpace),Kl(Wl(Il),e.onEscape)]}),(function(t,n,e){return e.stopSpaceKeyup?[Kl(Wl(Rl),rd)]:[]}),(function(t){return t.focusIn})),hm=nd.schema(),vm=ed.schema(),bm=Wd.schema(),ym=Id.schema(),xm=im.schema(),wm=ad.schema(),Sm=mm.schema(),km=pm.schema(),Cm=ja({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:hm,cyclic:vm,flow:bm,flatgrid:ym,matrix:xm,execution:wm,menu:Sm,special:km}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element,t.element)}),(function(o){o(t,n,e)}))},setGridSize:function(t,n,e,o,r){!function(t){return Tt(t,"setGridSize")}(e)?console.error("Layout does not support setGridSize"):e.setGridSize(o,r)}},state:sd}),Om=function(t,n,e,o){var r=t.getSystem().build(o);Es(t,r,e)},_m=function(t,n,e,o){var r=Tm(t);Y(r,(function(t){return Le(o.element,t.element)})).each(As)},Tm=function(t,n){return t.components()},Em=function(t,n,e,o,r){var i=Tm(t);return D.from(i[o]).map((function(n){return _m(t,0,0,n),r.each((function(n){Om(t,0,(function(t,n){!function(t,n,e){wr(t,e).fold((function(){Dr(t,n)}),(function(t){Br(t,n)}))}(t,n,o)}),n)})),n}))},Bm=Na({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){Om(t,0,Dr,o)},prepend:function(t,n,e,o){Om(t,0,Mr,o)},remove:_m,replaceAt:Em,replaceBy:function(t,n,e,o,r){var i=Tm(t);return q(i,o).bind((function(n){return Em(t,0,0,n,r)}))},set:function(t,n,e,o){Ka((function(){var n=L(o,t.getSystem().build);_s(t,n)}),t.element)},contents:Tm})}),Am=function(t,n){return{key:t,value:{config:{},me:function(t,n){var e=Yo(n);return Na({fields:[En("enabled")],name:t,active:{events:g(e)}})}(t,n),configAsRaw:g({}),initialConfig:{},state:di}}},Mm=function(t,n){n.ignore||(Xa(t.element),n.onFocus(t))},Dm=Object.freeze({__proto__:null,focus:Mm,blur:function(t,n){n.ignore||function(t){t.dom.blur()}(t.element)},isFocused:function(t){return function(t){var n=Or(t).dom;return t.dom===n.activeElement}(t.element)}}),Fm=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return pi(e)},events:function(t){return Yo([Jo(ho(),(function(n,e){Mm(n,t),e.stop()}))].concat(t.stopMousedown?[Jo(Ze(),(function(t,n){n.event.prevent()}))]:[]))}}),Im=[Ku("onFocus"),Un("stopMousedown",!1),Un("ignore",!1)],Rm=Na({fields:Im,name:"focusing",active:Fm,apis:Dm}),Vm=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},Pm=function(t,n,e){n.toggleClass.each((function(n){e.get()?Ci(t.element,n):Oi(t.element,n)}))},Hm=function(t,n,e){Lm(t,n,e,!e.get())},zm=function(t,n,e){e.set(!0),Pm(t,n,e),Vm(t,n,e)},Nm=function(t,n,e){e.set(!1),Pm(t,n,e),Vm(t,n,e)},Lm=function(t,n,e,o){(o?zm:Nm)(t,n,e)},jm=function(t,n,e){Lm(t,n,e,n.selected)},Um=Object.freeze({__proto__:null,onLoad:jm,toggle:Hm,isOn:function(t,n,e){return e.get()},on:zm,off:Nm,set:Lm}),Wm=Object.freeze({__proto__:null,exhibit:function(){return pi({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=Hm,ar((function(t){r(t,e,o)}))),u=Ra(t,n,jm);return Yo(K([t.toggleOnExecute?[i]:[],[u]]))}}),Gm=function(t,n,e){Nr(t.element,"aria-expanded",e)},Xm=[Un("selected",!1),Pn("toggleClass"),Un("toggleOnExecute",!0),Wn("aria",{mode:"none"},bn("mode",{pressed:[Un("syncWithExpanded",!1),Zu("update",(function(t,n,e){Nr(t.element,"aria-pressed",e),n.syncWithExpanded&&Gm(t,0,e)}))],checked:[Zu("update",(function(t,n,e){Nr(t.element,"aria-checked",e)}))],expanded:[Zu("update",Gm)],selected:[Zu("update",(function(t,n,e){Nr(t.element,"aria-selected",e)}))],none:[Zu("update",d)]}))],Ym=Na({fields:Xm,name:"toggling",active:Wm,apis:Um,state:(!1,{init:function(){var t=Zn(false);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(false)},readState:function(){return t.get()}}}})}),qm=function(){var t=function(t,n){n.stop(),Uo(t)};return[Jo(fo(),t),Jo(So(),t),nr(Ke()),nr(Ze())]},Km=function(t){return Yo(K([t.map((function(t){return ar((function(n,e){t(n),e.stop()}))})).toArray(),qm()]))},Jm="alloy.item-hover",$m="alloy.item-focus",Qm=function(t){(qa(t.element).isNone()||Rm.isFocused(t))&&(Rm.isFocused(t)||Rm.focus(t),jo(t,Jm,{item:t}))},Zm=function(t){jo(t,$m,{item:t})},tg=g(Jm),ng=g($m),eg=[En("data"),En("components"),En("dom"),Un("hasSubmenu",!1),Pn("toggling"),pf("itemBehaviours",[Ym,Rm,Cm,lf]),Un("ignoreFocus",!1),Un("domModification",{}),Zu("builder",(function(t){return{dom:t.dom,domModification:S(S({},t.domModification),{attributes:S(S(S({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:hf(t.itemBehaviours,[t.toggling.fold(Ym.revoke,(function(t){return Ym.config(S({aria:{mode:"checked"}},t))})),Rm.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Zm(t)}}),Cm.config({mode:"execution"}),lf.config({store:{mode:"memory",initialValue:t.data}}),Am("item-type-events",C(qm(),[Jo(oo(),Qm),Jo(wo(),Rm.focus)]))]),components:t.components,eventOrder:t.eventOrder}})),Un("eventOrder",{})],og=[En("dom"),En("components"),Zu("builder",(function(t){return{dom:t.dom,components:t.components,events:Yo([er(wo())])}}))],rg=g("item-widget"),ig=g([zf({name:"widget",overrides:function(t){return{behaviours:Ha([lf.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:d}})])}}})]),ug=[En("uid"),En("data"),En("components"),En("dom"),Un("autofocus",!1),Un("ignoreFocus",!1),pf("widgetBehaviours",[lf,Rm,Cm]),Un("domModification",{}),ul(ig()),Zu("builder",(function(t){var n=$f(rg(),t,ig()),e=Qf(rg(),t,n.internals()),o=function(n){return Zf(n,t,"widget").map((function(t){return Cm.focusIn(t),t}))},r=function(n,e){return vl(e.event.target)?D.none():t.autofocus?(e.setSource(n.element),D.none()):D.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:Yo([ar((function(t,n){o(t).each((function(t){n.stop()}))})),Jo(oo(),Qm),Jo(wo(),(function(n,e){t.autofocus?o(n):Rm.focus(n)}))]),behaviours:hf(t.widgetBehaviours,[lf.config({store:{mode:"memory",initialValue:t.data}}),Rm.config({ignore:t.ignoreFocus,onFocus:function(t){Zm(t)}}),Cm.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:Ua(),onLeft:r,onRight:r,onEscape:function(n,e){return Rm.isFocused(n)||t.autofocus?t.autofocus?(e.setSource(n.element),D.none()):D.none():(Rm.focus(n),D.some(!0))}})])}}))],ag=bn("type",{widget:ug,item:eg,separator:og}),cg=g([jf({factory:{sketch:function(t){var n=pn("menu.spec item",ag,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:S(S({},n),{uid:oi("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),sg=g([En("value"),En("items"),En("dom"),En("components"),Un("eventOrder",{}),df("menuBehaviours",[Al,lf,xl,Cm]),Wn("movement",{mode:"menu",moveOnTab:!0},bn("mode",{grid:[na(),Zu("config",(function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}}))],matrix:[Zu("config",(function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}})),En("rowSelector")],menu:[Un("moveOnTab",!0),Zu("config",(function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}}))]})),Bn("markers",Wu()),Un("fakeFocus",!1),Un("focusManager",$l()),Ku("onHighlight")]),fg=g("alloy.menu-focus"),lg=gl({name:"Menu",configFields:sg(),partFields:cg(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:gf(t.menuBehaviours,[Al.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),lf.config({store:{mode:"memory",initialValue:t.value}}),xl.config({find:D.some}),Cm.config(t.movement.config(t,t.movement))]),events:Yo([Jo(ng(),(function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each((function(e){Al.highlight(t,e),n.stop(),jo(t,fg(),{menu:t,item:e})}))})),Jo(tg(),(function(t,n){var e=n.event.item;Al.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),dg=function(t,n,e,o){return Ot(e,o).bind((function(o){return Ot(t,o).bind((function(o){var r=dg(t,n,e,o);return D.some([o].concat(r))}))})).getOr([])},mg=function(t){return"prepared"===t.type?D.some(t.menu):D.none()},gg=function(){var t=Zn({}),n=Zn({}),e=Zn({}),o=Zn(D.none()),r=Zn({}),i=function(t){return u(t).bind(mg)},u=function(t){return Ot(n.get(),t)},a=function(n){return Ot(t.get(),n)};return{setMenuBuilt:function(t,e){var o;n.set(S(S({},n.get()),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(D.some(i)),t.set(a),n.set(u),r.set(c);var s=function(t,n){var e={};yt(t,(function(t,n){j(t,(function(t){e[t]=n}))}));var o=n,r=wt(n,(function(t,n){return{k:t,v:n}})),i=xt(r,(function(t,n){return[n].concat(dg(e,o,r,n))}));return xt(e,(function(t){return Ot(i,t).getOr([t])}))}(c,a);e.set(s)},expand:function(n){return Ot(t.get(),n).map((function(t){var o=Ot(e.get(),n).getOr([]);return[t].concat(o)}))},refresh:function(t){return Ot(e.get(),t)},collapse:function(t){return Ot(e.get(),t).bind((function(t){return t.length>1?D.some(t.slice(1)):D.none()}))},lookupMenu:u,lookupItem:a,otherMenus:function(t){var n=r.get();return Z(vt(n),t)},getPrimary:function(){return o.get().bind(i)},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.set(D.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(n,r){var u=W(a(n).toArray(),(function(t){return i(t).isSome()}));return Ot(e.get(),n).bind((function(n){var e=Q(u.concat(n));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return D.none();n.push(o.getOrDie())}return D.some(n)}(J(e,(function(n,u){return function(n,e,o){return i(n).bind((function(r){return function(n){return kt(t.get(),(function(t,e){return t===n}))}(n).bind((function(t){return e(t).map((function(t){return{triggeredMenu:r,triggeringItem:t,triggeringPath:o}}))}))}))}(n,r,e.slice(0,u+1)).fold((function(){return o.get().is(n)?[]:[D.none()]}),(function(t){return[D.some(t)]}))})))}))}}},pg=mg,hg=g("collapse-item"),vg=ml({name:"TieredMenu",configFields:[Qu("onExecute"),Qu("onEscape"),$u("onOpenMenu"),$u("onOpenSubmenu"),Ku("onRepositionMenu"),Ku("onCollapseMenu"),Un("highlightImmediately",!0),In("data",[En("primary"),En("menus"),En("expansions")]),Un("fakeFocus",!1),Ku("onHighlight"),Ku("onHover"),Xu(),En("dom"),Un("navigateOnHover",!0),Un("stayInDom",!1),df("tmenuBehaviours",[Cm,Al,xl,Bm]),Un("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(t,n){var e,o=Zn(D.none()),r=gg(),i=function(t){return lf.getValue(t).value},u=function(n){return xt(t.data.menus,(function(t,n){return J(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},a=function(t,n){Al.highlight(t,n),Al.getHighlighted(n).orThunk((function(){return Al.getFirst(n)})).each((function(n){Wo(t,n.element,wo())}))},c=function(t,n){return pl(L(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?D.some(t.menu):D.none()}))})))},s=function(n,e,o){var r=c(e,e.otherMenus(o));j(r,(function(e){Ei(e.element,[t.markers.backgroundMenu]),t.stayInDom||Bm.remove(n,e)}))},f=function(n,e){var r=function(n){return o.get().getOrThunk((function(){var e={},r=$c(n.element,"."+t.markers.item),u=W(r,(function(t){return"true"===Lr(t,"aria-haspopup")}));return j(u,(function(t){n.getSystem().getByDom(t).each((function(t){var n=i(t);e[n]=t}))})),o.set(D.some(e)),e}))}(n);yt(r,(function(t,n){var o=P(e,n);Nr(t.element,"aria-expanded",o)}))},l=function(n,e,o){return D.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return D.none();var i=r.menu,u=c(e,o.slice(1));return j(u,(function(n){Ci(n.element,t.markers.backgroundMenu)})),Ai(i.element)||Bm.append(n,tu(i)),Ei(i.element,[t.markers.backgroundMenu]),a(n,i),s(n,e,o),D.some(i)}))}))};!function(t){t[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent"}(e||(e={}));var m=function(n,o,u){void 0===u&&(u=e.HighlightSubmenu);var a=i(o);return r.expand(a).bind((function(i){return f(n,i),D.from(i[0]).bind((function(a){return r.lookupMenu(a).bind((function(c){var s=function(t,n,e){if("notbuilt"===e.type){var o=t.getSystem().build(e.nbMenu());return r.setMenuBuilt(n,o),o}return e.menu}(n,a,c);return Ai(s.element)||Bm.append(n,tu(s)),t.onOpenSubmenu(n,o,s,Q(i)),u===e.HighlightSubmenu?(Al.highlightFirst(s),l(n,r,i)):(Al.dehighlightAll(s),D.some(o))}))}))}))},g=function(n,e){var o=i(e);return r.collapse(o).bind((function(o){return f(n,o),l(n,r,o).map((function(o){return t.onCollapseMenu(n,e,o),o}))}))},p=function(n){return function(e,o){return Iu(o.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOptional().bind((function(t){return n(e,t).map(x)}))}))}},h=Yo([Jo(fg(),(function(t,n){var e=n.event.item;r.lookupItem(i(e)).each((function(){var e=n.event.menu;Al.highlight(t,e);var o=i(n.event.item);r.refresh(o).each((function(n){return s(t,r,n)}))}))})),ar((function(n,o){var r=o.event.target;n.getSystem().getByDom(r).each((function(o){0===i(o).indexOf("collapse-item")&&g(n,o),m(n,o,e.HighlightSubmenu).fold((function(){t.onExecute(n,o)}),d)}))})),rr((function(n,e){(function(n){var e=function(n,e,o){return xt(o,(function(o,r){var i=function(){return lg.sketch(S(S({},o),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?Ql():$l()}))};return r===e?{type:"prepared",menu:n.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))}(n,t.data.primary,t.data.menus),o=u();return r.setContents(t.data.primary,e,t.data.expansions,o),r.getPrimary()})(n).each((function(e){Bm.append(n,tu(e)),t.onOpenMenu(n,e),t.highlightImmediately&&a(n,e)}))}))].concat(t.navigateOnHover?[Jo(tg(),(function(n,o){var u=o.event.item;!function(t,n){var e=i(n);r.refresh(e).bind((function(n){return f(t,n),l(t,r,n)}))}(n,u),m(n,u,e.HighlightParent),t.onHover(n,u)}))]:[])),v=function(t){return Al.getHighlighted(t).bind(Al.getHighlighted)},b={collapseMenu:function(t){v(t).each((function(n){g(t,n)}))},highlightPrimary:function(t){r.getPrimary().each((function(n){a(t,n)}))},repositionMenus:function(n){r.getPrimary().bind((function(t){return v(n).bind((function(t){var n=i(t),e=Ct(r.getMenus()),o=pl(L(e,pg));return r.getTriggeringPath(n,(function(t){return function(t,n,e){return it(n,(function(t){if(!t.getSystem().isConnected())return D.none();var n=Al.getCandidates(t);return Y(n,(function(t){return i(t)===e}))}))}(0,o,t)}))})).map((function(n){return{primary:t,triggeringPath:n}}))})).fold((function(){(function(t){return D.from(t.components()[0]).filter((function(t){return"menu"===Lr(t.element,"role")}))})(n).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;t.onRepositionMenu(n,o,r)}))}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:gf(t.tmenuBehaviours,[Cm.config({mode:"special",onRight:p((function(t,n){return vl(n.element)?D.none():m(t,n,e.HighlightSubmenu)})),onLeft:p((function(t,n){return vl(n.element)?D.none():g(t,n)})),onEscape:p((function(n,e){return g(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))})),focusIn:function(t,n){r.getPrimary().each((function(n){Wo(t,n.element,wo())}))}}),Al.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),xl.config({find:function(t){return Al.getHighlighted(t)}}),Bm.config({})]),eventOrder:t.eventOrder,apis:b,events:h}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:Lt(t,n),expansions:{}}},collapseItem:function(t){return{value:Jr(hg()),meta:{text:t}}}}}),bg=ml({name:"InlineView",configFields:[En("lazySink"),Ku("onShow"),Ku("onHide"),Ln("onEscape"),df("inlineBehaviours",[Ws,lf,Wa]),jn("fireDismissalEventInstead",[Un("event",Fo())]),jn("fireRepositionEventInstead",[Un("event",Io())]),Un("getRelated",D.none),Un("isExtraPart",y),Un("eventOrder",D.none)],factory:function(t,n){var e=function(t,n,e,r){o(t,n,e,(function(){return r.map((function(t){return Cu(t)}))}))},o=function(n,e,o,r){var i=t.lazySink(n).getOrDie();Ws.openWhileCloaked(n,o,(function(){return Ss.positionWithinBounds(i,e,n,r())})),lf.setValue(n,D.some({mode:"position",anchor:e,getBounds:r}))},r=function(n,e,o,r){var i=function(t,n,e,o,r){var i=function(){return t.lazySink(n)},u="horizontal"===o.type?{layouts:{onLtr:function(){return Ma()},onRtl:function(){return Da()}}}:{},a=function(t){return function(t){return 2===t.length}(t)?u:{}};return vg.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return Ws.close(n),t.onEscape.map((function(t){return t(n)})),D.some(!0)},onExecute:function(){return D.some(!0)},onOpenMenu:function(t,n){Ss.positionWithinBounds(i().getOrDie(),e,n,r())},onOpenSubmenu:function(t,n,e,o){var r=i().getOrDie();Ss.position(r,S({anchor:"submenu",item:n},a(o)),e)},onRepositionMenu:function(t,n,o){var u=i().getOrDie();Ss.positionWithinBounds(u,e,n,r()),j(o,(function(t){var n=a(t.triggeringPath);Ss.position(u,S({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)}))}})}(t,n,e,o,r);Ws.open(n,i),lf.setValue(n,D.some({mode:"menu",menu:i}))},i=function(n){Ws.isOpen(n)&&lf.getValue(n).each((function(e){switch(e.mode){case"menu":Ws.getState(n).each((function(t){vg.repositionMenus(t)}));break;case"position":var o=t.lazySink(n).getOrDie();Ss.positionWithinBounds(o,e.anchor,n,e.getBounds())}}))},u={setContent:function(t,n){Ws.setContent(t,n)},showAt:function(t,n,o){e(t,n,o,D.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(t,n,e){r(t,n,e,(function(){return D.none()}))},showMenuWithinBounds:r,hide:function(t){Ws.isOpen(t)&&(lf.setValue(t,D.none()),Ws.close(t))},getContent:function(t){return Ws.getState(t)},reposition:i,isOpen:Ws.isOpen};return{uid:t.uid,dom:t.dom,behaviours:gf(t.inlineBehaviours,[Ws.config({isPartOf:function(n,e,o){return Vu(e,o)||function(n,e){return t.getRelated(n).exists((function(t){return Vu(t,e)}))}(n,o)},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),lf.config({store:{mode:"memory",initialValue:D.none()}}),Wa.config({channels:S(S({},Ks(S({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),$s(S(S({},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:i})))})]),eventOrder:t.eventOrder,apis:u}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),yg=function(t){return t.x},xg=function(t,n){return t.x+t.width/2-n.width/2},wg=function(t,n){return t.x+t.width-n.width},Sg=function(t){return t.y},kg=function(t,n){return t.y+t.height-n.height},Cg=function(t,n,e){return ea(wg(t,n),kg(t,n),e.innerSoutheast(),aa(),da(t,{right:0,bottom:3}),"layout-inner-se")},Og=function(t,n,e){return ea(yg(t),kg(t,n),e.innerSouthwest(),ua(),da(t,{left:1,bottom:3}),"layout-inner-sw")},_g=function(t,n,e){return ea(wg(t,n),Sg(t),e.innerNortheast(),ia(),da(t,{right:0,top:2}),"layout-inner-ne")},Tg=function(t,n,e){return ea(yg(t),Sg(t),e.innerNorthwest(),ra(),da(t,{left:1,top:2}),"layout-inner-nw")},Eg=function(t,n,e){return ea(xg(t,n),Sg(t),e.innerNorth(),ca(),da(t,{top:2}),"layout-inner-n")},Bg=function(t,n,e){return ea(xg(t,n),kg(t,n),e.innerSouth(),sa(),da(t,{bottom:3}),"layout-inner-s")},Ag=tinymce.util.Tools.resolve("tinymce.util.Delay"),Mg=ml({name:"Button",factory:function(t){var n=Km(t.action),e=t.dom.tag,o=function(n){return Ot(t.dom,"attributes").bind((function(t){return Ot(t,n)}))};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:hf(t.buttonBehaviours,[Rm.config({}),Cm.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"===e){var t=o("type").getOr("button"),n=o("role").map((function(t){return{role:t}})).getOr({});return S({type:t},n)}return{role:o("role").getOr("button")}}()},eventOrder:t.eventOrder}},configFields:[Un("uid",void 0),En("dom"),Un("components",[]),pf("buttonBehaviours",[Rm,Cm]),Pn("action"),Pn("role"),Un("eventOrder",{})]}),Dg=function(t){var n=function(t){return void 0!==t.uid}(t)&&Tt(t,"uid")?t.uid:oi("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return S(S({},t),{uid:n})}}},Fg=function(t){return D.from(t()["temporary-placeholder"]).getOr("!not found!")},Ig=function(t,n){return D.from(n()[t.toLowerCase()]).getOrThunk((function(){return Fg(n)}))},Rg=function(t,n){return it(t,(function(t){return D.from(n()[t.toLowerCase()])})).getOrThunk((function(){return Fg(n)}))},Vg={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Pg=ml({name:"Notification",factory:function(t){var n=Dg({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:Ha([Bm.config({})])}),e=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},o=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},r=Dg({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:Ha([Bm.config({})])}),i={updateProgress:function(t,n){t.getSystem().isConnected()&&r.getOpt(t).each((function(t){Bm.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(n)]},o(n)])}))},updateText:function(t,e){if(t.getSystem().isConnected()){var o=n.get(t);Bm.set(o,[Ji(e)])}}},u=K([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return D.from(Vg[t])})).toArray()]),a=Dg(Mg.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Ig("close",t.iconProvider),attributes:{"aria-label":t.translationProvider("Close")}}}],action:function(n){t.onAction(n)}})),c=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:Rg(u,t.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[n.asSpec()],behaviours:Ha([Bm.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},behaviours:Ha([Rm.config({}),Am("notification-events",[Jo(ro(),(function(t){a.getOpt(t).each(Rm.focus)}))])]),components:c.concat(t.progress?[r.asSpec()]:[]).concat(t.closeButton?[a.asSpec()]:[]),apis:i}},configFields:[Pn("level"),En("progress"),En("icon"),En("onAction"),En("text"),En("iconProvider"),En("translationProvider"),qn("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}});var Hg,zg=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},throttle:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null!==e&&clearTimeout(e),e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},Ng=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Lg=function(t,n,e,o,r){var i=Ng(t,(function(n){return function(t,n){return t.isBlock(n)||P(["BR","IMG","HR","INPUT"],n.nodeName)||"false"===t.getContentEditable(n)}(t,n)}));return D.from(i.backwards(n,e,o,r))},jg=function(t,n){return Ug(re(t.selection.getNode())).getOrThunk((function(){var e=ne('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return Dr(e,re(n.extractContents())),n.insertNode(e.dom),br(e).each((function(t){return t.dom.normalize()})),function(t){return n=Jc,(e=function(t){for(var o=xr(t),r=o.length-1;r>=0;r--){var i=o[r];if(n(i))return D.some(i);var u=e(i);if(u.isSome())return u}return D.none()})(t);var n,e}(e).map((function(n){t.selection.setCursorLocation(n.dom,function(t){return"img"===cr(t)?1:qc(t).fold((function(){return xr(t).length}),(function(t){return t.length}))}(n))})),e}))},Ug=function(t){return Iu(t,"[data-mce-autocompleter]")},Wg=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Gg=function(t){return""!==t&&-1!==" \f\n\r\t\v".indexOf(t)},Xg=function(t,n){return t.substring(n.length)},Yg=function(t,n,e,o){return void 0===o&&(o=0),Ug(re(n.startContainer)).fold((function(){return function(t,n,e,o){if(void 0===o&&(o=0),!(r=n).collapsed||3!==r.startContainer.nodeType)return D.none();var r,i=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return Lg(t,n.startContainer,n.startOffset,(function(t,n,o){return function(t,n,e){var o;for(o=n-1;o>=0;o--){var r=t.charAt(o);if(Gg(r))return D.none();if(r===e)break}return D.some(o)}(o,n,e).getOr(n)}),i).bind((function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return D.none();var i=Wg(r);return 0!==i.lastIndexOf(e)||Xg(i,e).length<o?D.none():D.some({text:Xg(i,e),range:r,triggerChar:e})}))}(t,n,e,o)}),(function(n){var o=t.createRng();o.selectNode(n.dom);var r=Wg(o);return D.some({range:o,text:Xg(r,e),triggerChar:e})}))},qg=tinymce.util.Tools.resolve("tinymce.util.Promise"),Kg=function(t,n){return{container:t,offset:n}},Jg=function(t){if(function(t){return 3===t.nodeType}(t))return Kg(t,t.data.length);var n=t.childNodes;return n.length>0?Jg(n[n.length-1]):Kg(t,n.length)},$g=function(t,n){var e=t.childNodes;return e.length>0&&n<e.length?$g(e[n],0):e.length>0&&function(t){return 1===t.nodeType}(t)&&e.length===n?Jg(e[e.length-1]):Kg(t,n)},Qg=function(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=W(r.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return function(t){return function(n){var e=$g(n.startContainer,n.startOffset);return!function(t,n){return Lg(t,n.container,n.offset,(function(t,n){return 0===n?-1:n}),t.getRoot()).filter((function(t){var n=t.container.data.charAt(t.offset-1);return!Gg(n)})).isSome()}(t,e)}}(t.dom)}))(e.range,i,e.text)}));if(0===u.length)return D.none();var a=qg.all(L(u,(function(t){return t.fetch(e.text,t.maxResults,o).then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}}))})));return D.some({lookupData:a,context:e})},Zg=Zt([Mn("type"),Nn("text")]),tp=Zt([Un("type","autocompleteitem"),Un("active",!1),Un("disabled",!1),Un("meta",{}),Mn("value"),Nn("text"),Nn("icon")]),np=Zt([Mn("type"),Mn("ch"),Gn("minChars",1),Un("columns",1),Gn("maxResults",10),Ln("matches"),Fn("fetch"),Fn("onAction"),Jn("highlightOn",[],Sn)]),ep=[qn("disabled",!1),Nn("tooltip"),Nn("icon"),Nn("text"),Kn("onSetup",(function(){return d}))],op=Zt([Mn("type"),Fn("onAction")].concat(ep)),rp=function(t){return mn("toolbarbutton",op,t)},ip=[qn("active",!1)].concat(ep),up=Zt(ip.concat([Mn("type"),Fn("onAction")])),ap=function(t){return mn("ToggleButton",up,t)},cp=[Kn("predicate",y),Yn("scope","node",["node","editor"]),Yn("position","selection",["node","selection","line"])],sp=ep.concat([Un("type","contextformbutton"),Un("primary",!1),Fn("onAction"),Qn("original",p)]),fp=ip.concat([Un("type","contextformbutton"),Un("primary",!1),Fn("onAction"),Qn("original",p)]),lp=ep.concat([Un("type","contextformbutton")]),dp=ip.concat([Un("type","contextformtogglebutton")]),mp=bn("type",{contextformbutton:sp,contextformtogglebutton:fp}),gp=Zt([Un("type","contextform"),Kn("initValue",(function(){return""})),Nn("label"),Vn("commands",mp),Hn("launch",bn("type",{contextformbutton:lp,contextformtogglebutton:dp}))].concat(cp)),pp=Zt([Un("type","contexttoolbar"),Mn("items")].concat(cp));!function(t){t[t.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",t[t.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"}(Hg||(Hg={}));var hp,vp=Hg,bp="tox-menu-nav__js",yp="tox-collection__item",xp={normal:bp,color:"tox-swatch"},wp="tox-collection__item--enabled",Sp="tox-collection__item-label",kp="tox-collection__item-caret",Cp="tox-collection__item--active",Op="tox-collection__item-container",_p="tox-collection__item-container--row",Tp=function(t){return Ot(xp,t).getOr(bp)},Ep=function(t){return"color"===t?"tox-swatches":"tox-menu"},Bp=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Ep(t),tieredMenu:"tox-tiered-menu"}},Ap=function(t){var n=Bp(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:Tp(t)}},Mp=function(t,n,e){var o=Bp(e);return{tag:"div",classes:K([[o.menu,"tox-menu-"+n+"-column"],t?[o.hasIcons]:[]])}},Dp=[lg.parts.items({})],Fp=function(t,n,e){var o=Bp(e);return{dom:{tag:"div",classes:K([[o.tieredMenu]])},markers:Ap(e)}},Ip=function(t,n){return function(e){var o=N(e,n);return L(o,(function(n){return{dom:t,components:n}}))}},Rp=function(t,n){var e=[],o=[];return j(t,(function(t,r){n(t,r)?(o.length>0&&e.push(o),o=[],_t(t.dom,"innerHtml")&&o.push(t)):o.push(t)})),o.length>0&&e.push(o),L(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},Vp=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[lg.parts.items({preprocess:function(e){return"auto"!==t&&t>1?Ip({tag:"div",classes:["tox-collection__group"]},t)(e):Rp(e,(function(t,e){return"separator"===n[e].type}))}})]}},Pp=function(t){return H(t,(function(t){return"icon"in t&&void 0!==t.icon}))},Hp=function(t){return console.error(hn(t)),console.log(t),D.none()},zp=function(t,n,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[lg.parts.items({preprocess:function(t){return Rp(t,(function(t,n){return"separator"===i[n].type}))}})]});return{value:t,dom:u.dom,components:u.components,items:e}},Np=function(t,n,e,o,r){var i;return"color"===r?{value:t,dom:(i=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[lg.parts.items({preprocess:"auto"!==t?Ip({tag:"div",classes:["tox-swatches__row"]},t):p})]}]}}(o)).dom,components:i.components,items:e}:"normal"===r&&"auto"===o?{value:t,dom:(i=Vp(o,e)).dom,components:i.components,items:e}:"normal"===r&&1===o?{value:t,dom:(i=Vp(1,e)).dom,components:i.components,items:e}:"normal"===r?{value:t,dom:(i=Vp(o,e)).dom,components:i.components,items:e}:"listpreview"===r&&"auto"!==o?{value:t,dom:(i=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[lg.parts.items({preprocess:Ip({tag:"div",classes:["tox-collection__group"]},t)})]}}(o)).dom,components:i.components,items:e}:{value:t,dom:Mp(n,o,r),components:Dp,items:e}},Lp=[Mn("type"),Mn("src"),Nn("alt"),Jn("classes",[],Sn)],jp=Zt(Lp),Up=[Mn("type"),Mn("text"),Nn("name"),Jn("classes",["tox-collection__item-label"],Sn)],Wp=Zt(Up),Gp=fn((function(){return vn("type",{cardimage:jp,cardtext:Wp,cardcontainer:Xp})})),Xp=Zt([Mn("type"),Xn("direction","horizontal"),Xn("align","left"),Xn("valign","middle"),Vn("items",Gp)]),Yp=[qn("disabled",!1),Nn("text"),Nn("shortcut"),un("value","value",Ht((function(){return Jr("menuitem-value")})),yn()),Un("meta",{})],qp=Zt([Mn("type"),Nn("label"),Vn("items",Gp),Kn("onSetup",(function(){return d})),Kn("onAction",d)].concat(Yp)),Kp=Zt([Mn("type"),qn("active",!1),Nn("icon")].concat(Yp)),Jp=Zt([Mn("type"),Dn("fancytype",["inserttable","colorswatch"]),Kn("onAction",d)]),$p=Zt([Mn("type"),Kn("onSetup",(function(){return d})),Kn("onAction",d),Nn("icon")].concat(Yp)),Qp=Zt([Mn("type"),Fn("getSubmenuItems"),Kn("onSetup",(function(){return d})),Nn("icon")].concat(Yp)),Zp=Zt([Mn("type"),Nn("icon"),qn("active",!1),Kn("onSetup",(function(){return d})),Fn("onAction")].concat(Yp)),th=function(t,n,e){var o=$c(t.element,"."+e);if(o.length>0){var r=q(o,(function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>n})).getOr(o.length);return D.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return D.none()},nh=function(t){return function(t,n){return Ha([Am(t,n)])}(Jr("unnamed-events"),t)},eh=Jr("tooltip.exclusive"),oh=Jr("tooltip.show"),rh=Jr("tooltip.hide"),ih=function(t,n,e){t.getSystem().broadcastOn([eh],{})},uh=Object.freeze({__proto__:null,hideAllExclusive:ih,setComponents:function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&Bm.set(t,o)}))}}),ah=Object.freeze({__proto__:null,events:function(t,n){var e=function(e){n.getTooltip().each((function(o){As(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()};return Yo(K([[Jo(oh,(function(e){n.resetTimer((function(){!function(e){if(!n.isShowing()){ih(e);var o=t.lazySink(e).getOrDie(),r=e.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:Yo("normal"===t.mode?[Jo(oo(),(function(t){Lo(e,oh)})),Jo(no(),(function(t){Lo(e,rh)}))]:[]),behaviours:Ha([Bm.config({})])});n.setTooltip(r),Ts(o,r),t.onShow(e,r),Ss.position(o,t.anchor(e),r)}}(e)}),t.delay)})),Jo(rh,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),Jo(yo(),(function(t,n){var o=n;o.universal||P(o.channels,eh)&&e(t)})),ir((function(t){e(t)}))],"normal"===t.mode?[Jo(ro(),(function(t){Lo(t,oh)})),Jo(vo(),(function(t){Lo(t,rh)})),Jo(oo(),(function(t){Lo(t,oh)})),Jo(no(),(function(t){Lo(t,rh)}))]:[Jo(zo(),(function(t,n){Lo(t,oh)})),Jo(No(),(function(t){Lo(t,rh)}))]]))}}),ch=[En("lazySink"),En("tooltipDom"),Un("exclusive",!0),Un("tooltipComponents",[]),Un("delay",300),Yn("mode","normal",["normal","follow-highlight"]),Un("anchor",(function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:g([Ca,ka,ya,wa,xa,Sa]),onRtl:g([Ca,ka,ya,wa,xa,Sa])}}})),Ku("onHide"),Ku("onShow")],sh=Na({fields:ch,name:"tooltipping",active:ah,state:Object.freeze({__proto__:null,init:function(){var t=Zn(D.none()),n=Zn(D.none()),e=function(){t.get().each((function(t){clearTimeout(t)}))},o=g("not-implemented");return mi({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set(D.some(t))},clearTooltip:function(){n.set(D.none())},clearTimer:e,resetTimer:function(n,o){e(),t.set(D.some(setTimeout((function(){n()}),o)))},readState:o})}}),apis:uh}),fh=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),lh=tinymce.util.Tools.resolve("tinymce.util.I18n"),dh=["input","button","textarea","select"],mh=function(t,n,e){(n.disabled()?yh:xh)(t,n)},gh=function(t,n){return!0===n.useNative&&P(dh,cr(t.element))},ph=function(t){Nr(t.element,"disabled","disabled")},hh=function(t){Wr(t.element,"disabled")},vh=function(t){Nr(t.element,"aria-disabled","true")},bh=function(t){Nr(t.element,"aria-disabled","false")},yh=function(t,n,e){n.disableClass.each((function(n){Ci(t.element,n)})),(gh(t,n)?ph:vh)(t),n.onDisabled(t)},xh=function(t,n,e){n.disableClass.each((function(n){Oi(t.element,n)})),(gh(t,n)?hh:bh)(t),n.onEnabled(t)},wh=function(t,n){return gh(t,n)?function(t){return Ur(t.element,"disabled")}(t):function(t){return"true"===Lr(t.element,"aria-disabled")}(t)},Sh=Object.freeze({__proto__:null,enable:xh,disable:yh,isDisabled:wh,onLoad:mh,set:function(t,n,e,o){(o?yh:xh)(t,n)}}),kh=Object.freeze({__proto__:null,exhibit:function(t,n){return pi({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return Yo([qo(xo(),(function(n,e){return wh(n,t)})),Ra(t,n,mh)])}}),Ch=[Kn("disabled",y),Un("useNative",!0),Pn("disableClass"),Ku("onDisabled"),Ku("onEnabled")],Oh=Na({fields:Ch,name:"disabling",active:kh,apis:Sh}),_h=tinymce.util.Tools.resolve("tinymce.EditorManager"),Th=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},Eh=function(t){return t.getParam("width",fh.DOM.getStyle(t.getElement(),"width"))},Bh=function(t){return D.from(t.getParam("min_width")).filter(f)},Ah=function(t){return D.from(t.getParam("min_height")).filter(f)},Mh=function(t){return D.from(t.getParam("max_width")).filter(f)},Dh=function(t){return D.from(t.getParam("max_height")).filter(f)},Fh=function(t){return!1!==t.getParam("menubar",!0,"boolean")},Ih=function(t){var n=t.getParam("toolbar",!0),e=!0===n,r=o(n),u=i(n)&&n.length>0;return!Vh(t)&&(u||r||e)},Rh=function(t){var n=z(9,(function(n){return t.getParam("toolbar"+(n+1),!1,"string")})),e=W(n,(function(t){return"string"==typeof t}));return e.length>0?D.some(e):D.none()},Vh=function(t){return Rh(t).fold((function(){return t.getParam("toolbar",[],"string[]").length>0}),x)};!function(t){t.default="wrap",t.floating="floating",t.sliding="sliding",t.scrolling="scrolling"}(hp||(hp={}));var Ph,Hh=function(t){return t.getParam("toolbar_mode","","string")};!function(t){t.auto="auto",t.top="top",t.bottom="bottom"}(Ph||(Ph={}));var zh,Nh,Lh=function(t){return t.getParam("toolbar_location",Ph.auto,"string")},jh=function(t){return Lh(t)===Ph.bottom},Uh=function(t){if(!t.inline)return D.none();var n=function(t){return t.getParam("fixed_toolbar_container","","string")}(t);if(n.length>0)return Fu(Mi(),n);var e=function(t){return t.getParam("fixed_toolbar_container_target")}(t);return c(e)?D.some(re(e)):D.none()},Wh=function(t){return t.inline&&Uh(t).isSome()},Gh=function(t){return Uh(t).getOrThunk((function(){return _r(Or(re(t.getElement())))}))},Xh=function(t){return t.inline&&!Fh(t)&&!Ih(t)&&!Vh(t)},Yh=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!Wh(t)&&!Xh(t)},qh=function(t){var n=t.getParam("menu");return n?xt(n,(function(t){return S(S({},t),{items:t.items})})):{}},Kh=function(t){return t.getParam("menubar")},Jh=function(t){return t.getParam("anchor_top","#top")},$h=function(t){return t.getParam("anchor_bottom","#bottom")},Qh="silver.readonly",Zh=Zt([("readonly",Bn("readonly",kn))]),tv=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([Gs()],{target:e}),t.uiMothership.broadcastOn([Gs()],{target:e})),t.mothership.broadcastOn([Qh],{readonly:n}),t.uiMothership.broadcastOn([Qh],{readonly:n})},nv=function(t,n){t.on("init",(function(){t.mode.isReadOnly()&&tv(n,!0)})),t.on("SwitchMode",(function(){return tv(n,t.mode.isReadOnly())})),function(t){return t.getParam("readonly",!1,"boolean")}(t)&&t.setMode("readonly")},ev=function(){var t;return Wa.config({channels:(t={},t[Qh]={schema:Zh,onReceive:function(t,n){Oh.set(t,n.readonly)}},t)})},ov=function(t){return Oh.config({disabled:t})},rv=function(t){return Oh.config({disabled:t,disableClass:"tox-tbtn--disabled"})},iv=function(t){return Oh.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},uv=function(t,n){var e=t.getApi(n);return function(t){t(e)}},av=function(t,n){return rr((function(e){uv(t,e)((function(e){var o=t.onSetup(e);s(o)&&n.set(o)}))}))},cv=function(t,n){return ir((function(e){return uv(t,e)(n.get())}))},sv=function(t,n){return ar((function(e,o){uv(t,e)(t.onAction),t.triggersSubmenu||n!==vp.CLOSE_ON_EXECUTE||(e.getSystem().isConnected()&&Lo(e,Co()),o.stop())}))},fv=((zh={})[xo()]=["disabling","alloy.base.behaviour","toggling","item-events"],zh),lv=function(t){return J(t,(function(t){return t.toArray()}))},dv=function(t,n,e,o){var r,i=Zn(d);return{type:"item",dom:n.dom,components:lv(n.optComponents),data:t.data,eventOrder:fv,hasSubmenu:t.triggersSubmenu,itemBehaviours:Ha([Am("item-events",[sv(t,e),av(t,i),cv(t,i)]),(r=function(){return t.disabled||o.isDisabled()},Oh.config({disabled:r,disableClass:"tox-collection__item--state-disabled"})),ev(),Bm.config({})].concat(t.itemBehaviours))}},mv=function(t){return{value:t.value,meta:S({text:t.text.getOr("")},t.meta)}},gv=tinymce.util.Tools.resolve("tinymce.Env"),pv=function(t){var n=gv.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=t.split("+"),o=L(e,(function(t){var e=t.toLowerCase().trim();return _t(n,e)?n[e]:t}));return gv.mac?o.join(""):o.join("+")},hv=function(t){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:t}}},vv=function(t){return{dom:{tag:"div",classes:[Sp]},components:[Ji(lh.translate(t))]}},bv=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},yv=function(t,n){return{dom:{tag:"div",classes:[Sp]},components:[{dom:{tag:t.tag,styles:t.styles},components:[Ji(lh.translate(n))]}]}},xv=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:pv(t)}}},wv=function(t){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:Ig("checkmark",t)}}},Sv=function(t,n){var e=n.map((function(t){return{attributes:{title:lh.translate(t)}}})).getOr({});return S({tag:"div",classes:[bp,yp].concat(t?["tox-collection__item-icon-rtl"]:[])},e)},kv=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],Cv=["list-bull-circle","list-bull-default","list-bull-square"],Ov=function(t,n,e,o){void 0===o&&(o=D.none());var r,i=lh.isRtl()&&t.iconContent.exists((function(t){return P(Cv,t)})),u=(r=t.iconContent,r.map((function(t){return lh.isRtl()&&P(kv,t)?t+"-rtl":t}))).map((function(t){return function(t,n,e){return D.from(n()[t.toLowerCase()]).or(e).getOrThunk((function(){return Fg(n)}))}(t,n.icons,o)})),a=D.from(t.meta).fold((function(){return vv}),(function(t){return _t(t,"style")?h(yv,t.style):vv}));return"color"===t.presets?function(t,n,e,o){var r,i;return{dom:(r=e.getOr(""),i={tag:"div",attributes:t.map((function(t){return{title:o.translate(t)}})).getOr({}),classes:["tox-swatch"]},S(S({},i),"custom"===n?{tag:"button",classes:C(i.classes,["tox-swatches__picker-btn"]),innerHtml:r}:"remove"===n?{classes:C(i.classes,["tox-swatch--remove"]),innerHtml:r}:{attributes:S(S({},i.attributes),{"data-mce-color":n}),styles:{"background-color":n}})),optComponents:[]}}(t.ariaLabel,t.value,u,n):function(t,n,e,o,r){var i=e?n.or(D.some("")).map(hv):D.none(),u=t.checkMark,a=t.htmlContent.fold((function(){return t.textContent.map(o)}),(function(t){return D.some(bv(t,[Sp]))}));return{dom:Sv(r,t.ariaLabel),optComponents:[i,a,t.shortcutContent.map(xv),u,t.caret]}}(t,u,e,a,i)},_v=function(t,n){return Ot(t,"tooltipWorker").map((function(t){return[sh.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:lc}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){sh.setComponents(n,[$i({element:re(t)})])}))}})]})).getOr([])},Tv=function(t,n){var e=function(t){return fh.DOM.encode(t)}(lh.translate(t));if(n.length>0){var o=new RegExp(function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(n),"gi");return e.replace(o,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return e},Ev=function(t,n){return L(t,(function(t){switch(t.type){case"cardcontainer":return function(t,n){var e="vertical"===t.direction?"tox-collection__item-container--column":_p,o="left"===t.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right";return{dom:{tag:"div",classes:[Op,e,o,function(){switch(t.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:n}}(t,Ev(t.items,n));case"cardimage":return function(t,n,e){return{dom:{tag:"img",classes:n,attributes:{src:t,alt:e.getOr("")}}}}(t.src,t.classes,t.alt);case"cardtext":var e=t.name.exists((function(t){return P(n.cardText.highlightOn,t)}))?D.from(n.cardText.matchText).getOr(""):"";return bv(Tv(t.text,e),t.classes)}}))},Bv=Xf(rg(),ig()),Av=function(t){return{value:t}},Mv=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Dv=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Fv=function(t){return Mv.test(t)||Dv.test(t)},Iv=function(t){var n=t.toString(16);return(1===n.length?"0"+n:n).toUpperCase()},Rv=function(t){var n=Iv(t.red)+Iv(t.green)+Iv(t.blue);return Av(n)},Vv=Math.min,Pv=Math.max,Hv=Math.round,zv=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Nv=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Lv=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},jv=function(t){var n=parseInt(t,10);return n.toString()===t&&n>=0&&n<=255},Uv=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;if(i=Pv(0,Vv(i,1)),u=Pv(0,Vv(u,1)),0===i)return n=e=o=Hv(255*u),Lv(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=Hv(255*(n+f)),e=Hv(255*(e+f)),o=Hv(255*(o+f)),Lv(n,e,o,1)},Wv=function(t){var n,e,o=(n=function(t){return{value:t.value.replace(Mv,(function(t,n,e,o){return n+n+e+e+o+o}))}}(t),null===(e=Dv.exec(n.value))?["FFFFFF","FF","FF","FF"]:e),r=parseInt(o[1],16),i=parseInt(o[2],16),u=parseInt(o[3],16);return Lv(r,i,u,1)},Gv=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return Lv(r,i,u,a)},Xv=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},Yv=Lv(255,0,0,1),qv=function(t,n){return t.fire("ResizeContent",n)},Kv=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Jv="tinymce-custom-colors",$v="choiceitem",Qv=[{type:$v,text:"Light Green",value:"#BFEDD2"},{type:$v,text:"Light Yellow",value:"#FBEEB8"},{type:$v,text:"Light Red",value:"#F8CAC6"},{type:$v,text:"Light Purple",value:"#ECCAFA"},{type:$v,text:"Light Blue",value:"#C2E0F4"},{type:$v,text:"Green",value:"#2DC26B"},{type:$v,text:"Yellow",value:"#F1C40F"},{type:$v,text:"Red",value:"#E03E2D"},{type:$v,text:"Purple",value:"#B96AD9"},{type:$v,text:"Blue",value:"#3598DB"},{type:$v,text:"Dark Turquoise",value:"#169179"},{type:$v,text:"Orange",value:"#E67E23"},{type:$v,text:"Dark Red",value:"#BA372A"},{type:$v,text:"Dark Purple",value:"#843FA1"},{type:$v,text:"Dark Blue",value:"#236FA1"},{type:$v,text:"Light Gray",value:"#ECF0F1"},{type:$v,text:"Medium Gray",value:"#CED4D9"},{type:$v,text:"Gray",value:"#95A5A6"},{type:$v,text:"Dark Gray",value:"#7E8C8D"},{type:$v,text:"Navy Blue",value:"#34495E"},{type:$v,text:"Black",value:"#000000"},{type:$v,text:"White",value:"#ffffff"}],Zv=function(t){void 0===t&&(t=10);var n,e=Kv.getItem(Jv),r=o(e)?JSON.parse(e):[],i=t-(n=r).length<0?n.slice(0,t):n,u=function(t){i.splice(t,1)};return{add:function(n){(function(t,n){var e=V(t,n);return-1===e?D.none():D.some(e)})(i,n).each(u),i.unshift(n),i.length>t&&i.pop(),Kv.setItem(Jv,JSON.stringify(i))},state:function(){return i.slice(0)}}}(10),tb=function(t){return!1!==t.getParam("custom_colors")},nb=function(t){var n=function(t){return t.getParam("color_map")}(t);return void 0!==n?function(t){var n=[],e=document.createElement("canvas");e.height=1,e.width=1;for(var o=e.getContext("2d"),r=function(t,n){var e=n/255;return("0"+Math.round(t*e+255*(1-e)).toString(16)).slice(-2).toUpperCase()},i=function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();o.clearRect(0,0,e.width,e.height),o.fillStyle="#FFFFFF",o.fillStyle=t,o.fillRect(0,0,1,1);var n=o.getImageData(0,0,1,1).data,i=n[0],u=n[1],a=n[2],c=n[3];return"#"+r(i,c)+r(u,c)+r(a,c)},u=0;u<t.length;u+=2)n.push({text:t[u+1],value:i(t[u]),type:"choiceitem"});return n}(n):Qv},eb=function(t){Zv.add(t)},ob=function(t){return function(t,n){return t.getParam("color_cols",n,"number")}(t,(n=nb(t).length,Math.max(5,Math.ceil(Math.sqrt(n)))));var n},rb=function(t,n,e,o){"custom"===e?fb(t)((function(e){e.each((function(e){eb(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),"#000000"):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},ib=function(t,n){return t.concat(L(Zv.state(),(function(t){return{type:$v,text:t,value:t}})).concat(function(t){var n="choiceitem",e={type:n,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return t?[e,{type:n,text:"Custom color",icon:"color-picker",value:"custom"}]:[e]}(n)))},ub=function(t,n){return function(e){e(ib(t,n))}},ab=function(t,n,e){var o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";t.setIconFill(o,e)},cb=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){return D.from(function(t,n){var e;return t.dom.getParents(t.selection.getStart(),(function(t){var o;(o=t.style["forecolor"===n?"color":"background-color"])&&(e=e||o)})),e}(t,e)).bind((function(t){return function(t){if("transparent"===t)return D.some(Lv(0,0,0,0));var n=zv.exec(t);if(null!==n)return D.some(Gv(n[1],n[2],n[3],"1"));var e=Nv.exec(t);return null!==e?D.some(Gv(e[1],e[2],e[3],e[4])):D.none()}(t).map((function(t){var e=Rv(t).value;return fe(n.toLowerCase(),e)}))})).getOr(!1)},columns:ob(t),fetch:ub(nb(t),tb(t)),onAction:function(n){null!==r.get()&&rb(t,e,r.get(),d)},onItemAction:function(o,i){rb(t,e,i,(function(e){r.set(e),function(t,n){t.fire("TextColorChange",n)}(t,{name:n,color:e})}))},onSetup:function(e){null!==r.get()&&ab(e,n,r.get());var o=function(t){t.name===n&&ab(e,t.name,t.color)};return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},sb=function(t,n,e,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){rb(t,e,n.value,d)}}]}})},fb=function(t){return function(n,e){var o=!1,r={colorpicker:e};t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:function(t,n){"hex-valid"===n.name&&(o=n.value)},onSubmit:function(e){var r=e.getData().colorpicker;o?(n(D.from(r)),e.close()):t.windowManager.alert(t.translate(["Invalid hex color code: {0}",r]))},onClose:d,onCancel:function(){n(D.none())}})}},lb=function(t,n,e,o,r,i,u,a){var c=Pp(n),s=db(n,e,o,"color"!==r?"normal":"color",i,u,a);return Np(t,c,s,o,r)},db=function(t,n,e,o,r,i,u){return pl(L(t,(function(a){return"choiceitem"===a.type?(c=a,mn("choicemenuitem",Kp,c)).fold(Hp,(function(c){return D.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=Ov({presets:e,textContent:n?t.text:D.none(),htmlContent:D.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:D.none(),checkMark:n?D.some(wv(u.icons)):D.none(),caret:D.none(),value:t.value},u,a);return Mt(dv({data:mv(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Ym.set(t,n)},isActive:function(){return Ym.isOn(t)},isDisabled:function(){return Oh.isDisabled(t)},setDisabled:function(n){return Oh.set(t,n)}}},onAction:function(n){return o(t.value)},onSetup:function(t){return t.setActive(r),d},triggersSubmenu:!1,itemBehaviours:[]},c,i,u),{toggling:{toggleClass:wp,toggleOnExecute:!1,selected:t.active}})}(c,1===e,o,n,i(a.value),r,u,Pp(t)))})):D.none();var c})))},mb=function(t,n){var e=Ap(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},gb=Jr("cell-over"),pb=Jr("cell-execute"),hb=function(t,n,e){var o,r=function(e){return jo(e,pb,{row:t,col:n})},i=function(t,n){n.stop(),r(t)};return Zi({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:Ha([Am("insert-table-picker-cell",[Jo(oo(),Rm.focus),Jo(xo(),r),Jo(fo(),i),Jo(So(),i)]),Ym.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Rm.config({onFocus:function(e){return jo(e,gb,{row:t,col:n})}})])})},vb=function(t){return J(t,(function(t){return L(t,tu)}))},bb=function(t,n){return Ji(n+1+"x"+(t+1))},yb={inserttable:function(t){var n=Jr("size-label"),e=function(t,n,e){for(var o=[],r=0;r<10;r++){for(var i=[],u=0;u<10;u++)i.push(hb(r,u,t));o.push(i)}return o}(n),o=Dg({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[Ji("0x0")],behaviours:Ha([Bm.config({})])});return{type:"widget",data:{value:Jr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Bv.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:vb(e).concat(o.asSpec()),behaviours:Ha([Am("insert-table-picker",[tr(gb,(function(t,n,r){var i=r.event.row,u=r.event.col;!function(t,n,e,o,r){for(var i=0;i<10;i++)for(var u=0;u<10;u++)Ym.set(t[i][u],i<=n&&u<=e)}(e,i,u),Bm.set(o.get(t),[bb(i,u)])})),tr(pb,(function(n,e,o){t.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),Lo(n,Co())}))]),Cm.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=ib(n.colorinput.getColors(),n.colorinput.hasCustomColors()),o=n.colorinput.getColorCols(),r="color",i=lb(Jr("menu-value"),e,(function(n){t.onAction({value:n})}),o,r,vp.CLOSE_ON_EXECUTE,y,n.shared.providers),u=S(S({},i),{markers:Ap(r),movement:mb(o,r)});return{type:"widget",data:{value:Jr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Bv.widget(lg.sketch(u))]}}},xb=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:S({tag:"div",classes:[yp,"tox-collection__group-heading"]},n),components:[]}};!function(t){t[t.ContentFocus=0]="ContentFocus",t[t.UiFocus=1]="UiFocus"}(Nh||(Nh={}));var wb=function(t,n,e,o,r){var i,u=e.shared.providers,a=function(t){return r?S(S({},t),{shortcut:D.none(),icon:t.text.isSome()?D.none():t.icon}):t};switch(t.type){case"menuitem":return(i=t,mn("menuitem",$p,i)).fold(Hp,(function(t){return D.some(function(t,n,e,o){void 0===o&&(o=!0);var r=Ov({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:D.none(),ariaLabel:t.text,caret:D.none(),checkMark:D.none(),shortcutContent:t.shortcut},e,o);return dv({data:mv(t),getApi:function(t){return{isDisabled:function(){return Oh.isDisabled(t)},setDisabled:function(n){return Oh.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)}(a(t),n,u,o))}));case"nestedmenuitem":return function(t){return mn("nestedmenuitem",Qp,t)}(t).fold(Hp,(function(t){return D.some(function(t,n,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1);var i,u=r?(i=e.icons,{dom:{tag:"div",classes:[kp],innerHtml:Ig("chevron-down",i)}}):function(t){return{dom:{tag:"div",classes:[kp],innerHtml:Ig("chevron-right",t)}}}(e.icons),a=Ov({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:D.none(),ariaLabel:t.text,caret:D.some(u),checkMark:D.none(),shortcutContent:t.shortcut},e,o);return dv({data:mv(t),getApi:function(t){return{isDisabled:function(){return Oh.isDisabled(t)},setDisabled:function(n){return Oh.set(t,n)}}},disabled:t.disabled,onAction:d,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,n,e)}(a(t),n,u,o,r))}));case"togglemenuitem":return function(t){return mn("togglemenuitem",Zp,t)}(t).fold(Hp,(function(t){return D.some(function(t,n,e,o){void 0===o&&(o=!0);var r=Ov({iconContent:t.icon,textContent:t.text,htmlContent:D.none(),ariaLabel:t.text,checkMark:D.some(wv(e.icons)),caret:D.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return Mt(dv({data:mv(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Ym.set(t,n)},isActive:function(){return Ym.isOn(t)},isDisabled:function(){return Oh.isDisabled(t)},setDisabled:function(n){return Oh.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:wp,toggleOnExecute:!1,selected:t.active}})}(a(t),n,u,o))}));case"separator":return function(t){return mn("separatormenuitem",Zg,t)}(t).fold(Hp,(function(t){return D.some(xb(t))}));case"fancymenuitem":return function(t){return mn("fancymenuitem",Jp,t)}(t).fold(Hp,(function(t){return function(t,n){return function(t,n){return Object.prototype.hasOwnProperty.call(t,n)?D.some(t[n]):D.none()}(yb,t.fancytype).map((function(e){return e(t,n)}))}(a(t),e)}));default:return console.error("Unknown item in general menu",t),D.none()}},Sb=function(t,n,e,o,r,i,u){var a=1===o,c=!a||Pp(t);return pl(L(t,(function(t){switch(t.type){case"separator":return(o=t,mn("Autocompleter.Separator",Zg,o)).fold(Hp,(function(t){return D.some(xb(t))}));case"cardmenuitem":return function(t){return mn("cardmenuitem",qp,t)}(t).fold(Hp,(function(t){return D.some(function(t,n,e,o){var r={dom:Sv(!1,t.label),optComponents:[D.some({dom:{tag:"div",classes:[Op,_p]},components:Ev(t.items,o)})]};return dv({data:mv(S({text:D.none()},t)),disabled:t.disabled,getApi:function(t){return{isDisabled:function(){return Oh.isDisabled(t)},setDisabled:function(n){Oh.set(t,n),j($c(t.element,"*"),(function(e){t.getSystem().getByDom(e).each((function(t){t.hasConfigured(Oh)&&Oh.set(t,n)}))}))}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:D.from(o.itemBehaviours).getOr([])},r,n,e.providers)}(S(S({},t),{onAction:function(n){t.onAction(n),e(t.value,t.meta)}}),r,i,{itemBehaviours:_v(t.meta,i),cardText:{matchText:n,highlightOn:u}}))}));case"autocompleteitem":default:return function(t){return mn("Autocompleter.Item",tp,t)}(t).fold(Hp,(function(t){return D.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=Ov({presets:o,textContent:D.none(),htmlContent:e?t.text.map((function(t){return Tv(t,n)})):D.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:D.none(),checkMark:D.none(),caret:D.none(),value:t.value},u.providers,a,t.icon);return dv({data:mv(t),disabled:t.disabled,getApi:g({}),onAction:function(n){return r(t.value,t.meta)},onSetup:g(d),triggersSubmenu:!1,itemBehaviours:_v(t.meta,u)},c,i,u.providers)}(t,n,a,"normal",e,r,i,c))}))}var o})))},kb=function(t,n,e,o,r){var i=Pp(n),u=pl(L(n,(function(t){var n=function(t){return wb(t,e,o,function(t){return r?!t.hasOwnProperty("text"):i}(t),r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(S(S({},t),{disabled:!0})):n(t)})));return(r?zp:Np)(t,i,u,1,"normal")},Cb=function(t){return vg.singleData(t.value,t)},Ob=function(t,n){var e=Zn(D.none()),o=Zn(!1),r=Zi(bg.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:Ha([Am("dismissAutocompleter",[Jo(Fo(),(function(){return a()}))])]),lazySink:n.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&bg.hide(r)},a=function(){if(i()){var n=e.get().map((function(t){return t.element}));Ug(n.getOr(re(t.selection.getNode()))).each(Vr),u(),e.set(D.none()),o.set(!1)}},c=Ft((function(){return function(t){var n,e,o=t.ui.registry.getAll().popups,r=xt(o,(function(t){return(n=t,mn("Autocompleter",np,n)).fold((function(t){throw new Error(hn(t))}),(function(t){return t}));var n})),i=(n=St(r,(function(t){return t.ch})),e={},j(n,(function(t){e[t]={}})),vt(e)),u=Ct(r);return{dataset:r,triggerChars:i,lookupByChar:function(t){return W(u,(function(n){return n.ch===t}))}}}(t)})),s=function(f){(function(n){return e.get().map((function(e){return Yg(t.dom,t.selection.getRng(),e.triggerChar).bind((function(e){return Qg(t,c,e,n)}))})).getOrThunk((function(){return function(t,n){var e=n(),o=t.selection.getRng();return function(t,n,e){return it(e.triggerChars,(function(e){return Yg(t,n,e)}))}(t.dom,o,e).bind((function(e){return Qg(t,n,e)}))}(t,c)}))})(f).fold(a,(function(c){!function(n){if(!i()){var r=jg(t,n.range);e.set(D.some({triggerChar:n.triggerChar,element:r,matchLength:n.text.length})),o.set(!1)}}(c.context),c.lookupData.then((function(i){e.get().map((function(e){var f,l,d,m=c.context;if(e.triggerChar===m.triggerChar){var g=(f=m.triggerChar,d=it(l=i,(function(t){return D.from(t.columns)})).getOr(1),J(l,(function(e){var r=e.items;return Sb(r,e.matchText,(function(n,r){var i=t.selection.getRng();Yg(t.dom,i,f).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(t){var i=t.range,c={hide:function(){a()},reload:function(t){u(),s(t)}};o.set(!0),e.onAction(c,i,n,r),o.set(!1)}))}),d,vp.BUBBLE_TO_SANDBOX,n,e.highlightOn)})));g.length>0?function(n,e,o,i){n.matchLength=e.text.length;var u=it(o,(function(t){return D.from(t.columns)})).getOr(1);bg.showAt(r,{anchor:"node",root:re(t.getBody()),node:D.from(n.element)},lg.sketch(function(t,n,e,o){var r=e===Nh.ContentFocus?Ql():$l(),i=mb(n,o),u=Ap(o);return{dom:t.dom,components:t.components,items:t.items,value:t.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===Nh.ContentFocus,focusManager:r,menuBehaviours:nh("auto"!==n?[]:[rr((function(t,n){th(t,4,u.item).each((function(n){var e=n.numColumns,o=n.numRows;Cm.setGridSize(t,o,e)}))}))])}}(Np("autocompleter-value",!0,i,u,"normal"),u,Nh.ContentFocus,"normal"))),bg.getContent(r).each(Al.highlightFirst)}(e,m,i,g):m.text.length-e.matchLength>=10?a():u()}}))}))}))},f={onKeypress:zg((function(t){27!==t.which&&s()}),50),cancelIfNecessary:a,isMenuOpen:function(){return bg.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return bg.getContent(r)}};!1===t.hasPlugin("rtc")&&function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){jo(t,uo(),{raw:n})};n.on("keydown",(function(n){var o=function(){return t.getView().bind(Al.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(Uo),n.preventDefault()):40===n.which?(o().fold((function(){t.getView().each(Al.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&!t.isProcessingAction()&&Ug(re(n.element)).isNone()&&t.cancelIfNecessary()}))}(f,t)},_b=x,Tb=function(t,n,e){return function(t,n,e,o){return gu(t,n,e,o,!1)}(t,n,_b,e)},Eb=function(t,n,e){return function(t,n,e,o){return gu(t,n,e,o,!0)}(t,n,_b,e)},Bb=mu,Ab=function(t,n,e){return Iu(t,n,e).isSome()},Mb=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},Db=function(t){var n=t.raw;return void 0===n.touches||1!==n.touches.length?D.none():D.some(n.touches[0])},Fb=function(){return He().browser.isFirefox()},Ib=Qt([Fn("triggerEvent"),Un("stopBackspace",!0)]),Rb=function(t,n){var e=pn("Getting GUI events settings",Ib,n),o=function(t){var n=Zn(D.none()),e=Zn(!1),o=Mb((function(n){t.triggerEvent(ko(),n),e.set(!0)}),400),r=jt([{key:Ke(),value:function(t){return Db(t).each((function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:t.target};o.schedule(t),e.set(!1),n.set(D.some(i))})),D.none()}},{key:Je(),value:function(t){return o.cancel(),Db(t).each((function(t){n.get().each((function(e){(function(t,n){var e=Math.abs(t.clientX-n.x),o=Math.abs(t.clientY-n.y);return e>5||o>5})(t,e)&&n.set(D.none())}))})),D.none()}},{key:$e(),value:function(r){return o.cancel(),n.get().filter((function(t){return Le(t.target,r.target)})).map((function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(So(),r)}))}}]);return{fireIfReady:function(t,n){return Ot(r,n).bind((function(n){return n(t)}))}}}(e),r=L(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return Tb(t,n,(function(t){o.fireIfReady(t,n).each((function(n){n&&t.kill()})),e.triggerEvent(n,t)&&t.kill()}))})),i=Zn(D.none()),u=Tb(t,"paste",(function(t){o.fireIfReady(t,"paste").each((function(n){n&&t.kill()})),e.triggerEvent("paste",t)&&t.kill(),i.set(D.some(setTimeout((function(){e.triggerEvent(bo(),t)}),0)))})),a=Tb(t,"keydown",(function(t){e.triggerEvent("keydown",t)?t.kill():!0===e.stopBackspace&&function(t){return t.raw.which===Ml[0]&&!P(["input","textarea"],cr(t.target))&&!Ab(t.target,'[contenteditable="true"]')}(t)&&t.prevent()})),c=function(t,n){return Fb()?Eb(t,"focus",n):Tb(t,"focusin",n)}(t,(function(t){e.triggerEvent("focusin",t)&&t.kill()})),s=Zn(D.none()),f=function(t,n){return Fb()?Eb(t,"blur",n):Tb(t,"focusout",n)}(t,(function(t){e.triggerEvent("focusout",t)&&t.kill(),s.set(D.some(setTimeout((function(){e.triggerEvent(vo(),t)}),0)))}));return{unbind:function(){j(r,(function(t){t.unbind()})),a.unbind(),c.unbind(),f.unbind(),u.unbind(),i.get().each(clearTimeout),s.get().each(clearTimeout)}}},Vb=function(t,n){var e=Ot(t,"target").getOr(n);return Zn(e)},Pb=Et([{stopped:[]},{resume:["element"]},{complete:[]}]),Hb=function(t,n,e,o,r,i){var u=t(n,o),a=function(t,n){var e=Zn(!1),o=Zn(!1);return{stop:function(){e.set(!0)},cut:function(){o.set(!0)},isStopped:e.get,isCut:o.get,event:t,setSource:n.set,getSource:n.get}}(e,r);return u.fold((function(){return i.logEventNoHandlers(n,o),Pb.complete()}),(function(t){var e=t.descHandler;return hi(e)(a),a.isStopped()?(i.logEventStopped(n,t.element,e.purpose),Pb.stopped()):a.isCut()?(i.logEventCut(n,t.element,e.purpose),Pb.complete()):br(t.element).fold((function(){return i.logNoParent(n,t.element,e.purpose),Pb.complete()}),(function(o){return i.logEventResponse(n,t.element,e.purpose),Pb.resume(o)}))}))},zb=function(t,n,e,o,r,i){return Hb(t,n,e,o,r,i).fold(x,(function(o){return zb(t,n,e,o,r,i)}),y)},Nb=function(t,n,e,o,r){var i=Vb(e,o);return zb(t,n,e,o,i,r)},Lb=function(){var t,n=(t={},{registerId:function(n,e,o){yt(o,(function(o,r){var i=void 0!==t[r]?t[r]:{};i[e]=function(t,n){return{cHandler:h.apply(void 0,[t.handler].concat(n)),purpose:t.purpose}}(o,n),t[r]=i}))},unregisterId:function(n){yt(t,(function(t,e){t.hasOwnProperty(n)&&delete t[n]}))},filterByType:function(n){return Ot(t,n).map((function(t){return St(t,(function(t,n){return function(t,n){return{id:t,descHandler:n}}(n,t)}))})).getOr([])},find:function(n,e,o){var r=Ot(t,e);return Ge(o,(function(t){return function(t,n){return ei(n).fold((function(){return D.none()}),(function(e){return t.bind((function(t){return Ot(t,e)})).map((function(t){return function(t,n){return{element:t,descHandler:n}}(n,t)}))}))}(r,t)}),n)}}),e={},o=function(t){ei(t.element).each((function(t){delete e[t],n.unregisterId(t)}))};return{find:function(t,e,o){return n.find(t,e,o)},filter:function(t){return n.filterByType(t)},register:function(t){var r=function(t){var n=t.element;return ei(n).fold((function(){return function(t,n){var e=Jr(Zr+"uid-");return ni(n,e),e}(0,t.element)}),(function(t){return t}))}(t);Tt(e,r)&&function(t,n){var r=e[n];if(r!==t)throw new Error('The tagId "'+n+'" is already used by: '+Xr(r.element)+"\nCannot use it for: "+Xr(t.element)+"\nThe conflicting element is"+(Ai(r.element)?" ":" not ")+"already in the DOM");o(t)}(t,r);var i=[t];n.registerId(i,r,t.events),e[r]=t},unregister:o,getById:function(t){return Ot(e,t)}}},jb=ml({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=k(n,["attributes"]);return{uid:t.uid,dom:S({tag:"div",attributes:S({role:"presentation"},e)},o),components:t.components,behaviours:mf(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[Un("components",[]),df("containerBehaviours",[]),Un("events",{}),Un("domModification",{}),Un("eventOrder",{})]}),Ub=function(t){var n=function(n){return br(t.element).fold(x,(function(t){return Le(n,t)}))},e=Lb(),o=function(t,o){return e.find(n,t,o)},r=Rb(t.element,{triggerEvent:function(t,n){return Nu(t,n.target,(function(e){return function(t,n,e,o){return Nb(t,n,e,e.target,o)}(o,t,n,e)}))}}),i={debugInfo:g("real"),triggerEvent:function(t,n,e){Nu(t,n,(function(r){return Nb(o,t,e,n,r)}))},triggerFocus:function(t,n){ei(t).fold((function(){Xa(t)}),(function(e){Nu(ho(),t,(function(e){return function(t,n,e,o,r){var i=Vb(e,o);Hb(t,n,e,o,i,r)}(o,ho(),{originator:n,kill:d,prevent:d,target:t},t,e),!1}))}))},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return h(t)},getByDom:function(t){return v(t)},build:Zi,addToGui:function(t){c(t)},removeFromGui:function(t){s(t)},addToWorld:function(t){u(t)},removeFromWorld:function(t){a(t)},broadcast:function(t){l(t)},broadcastOn:function(t,n){m(t,n)},broadcastEvent:function(t,n){p(t,n)},isConnected:x},u=function(t){t.connect(i),lr(t.element)||(e.register(t),j(t.components(),u),i.triggerEvent(_o(),t.element,{target:t.element}))},a=function(t){lr(t.element)||(j(t.components(),a),e.unregister(t)),t.disconnect()},c=function(n){Ts(t,n)},s=function(t){As(t)},f=function(t){var n=e.filter(yo());j(n,(function(n){var e=n.descHandler;hi(e)(t)}))},l=function(t){f({universal:!0,data:t})},m=function(t,n){f({universal:!1,channels:t,data:n})},p=function(t,n){return function(t,n,e){var o=function(t){var n=Zn(!1);return{stop:function(){n.set(!0)},cut:d,isStopped:n.get,isCut:y,event:t,setSource:b("Cannot set source of a broadcasted event"),getSource:b("Cannot get source of a broadcasted event")}}(n);return j(t,(function(t){var n=t.descHandler;hi(n)(o)})),o.isStopped()}(e.filter(t),n)},h=function(t){return e.getById(t).fold((function(){return ct.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),ct.value)},v=function(t){var n=ei(t).getOr("not found");return h(n)};return u(t),{root:t,element:t.element,destroy:function(){r.unbind(),Rr(t.element)},add:c,remove:s,getByUid:h,getByDom:v,addToWorld:u,removeFromWorld:a,broadcast:l,broadcastOn:m,broadcastEvent:p}},Wb=g([Un("prefix","form-field"),df("fieldBehaviours",[xl,lf])]),Gb=g([Lf({schema:[En("dom")],name:"label"}),Lf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[En("text")],name:"aria-descriptor"}),zf({factory:{sketch:function(t){var n=function(t,n){var e={};return yt(t,(function(t,o){P(n,o)||(e[o]=t)})),e}(t,["factory"]);return t.factory.sketch(n)}},schema:[En("factory")],name:"field"})]),Xb=gl({name:"FormField",configFields:Wb(),partFields:Gb(),factory:function(t,n,e,o){var r=gf(t.fieldBehaviours,[xl.config({find:function(n){return Zf(n,t,"field")}}),lf.config({store:{mode:"manual",getValue:function(t){return xl.getCurrent(t).bind(lf.getValue)},setValue:function(t,n){xl.getCurrent(t).each((function(t){lf.setValue(t,n)}))}}})]),i=Yo([rr((function(n,e){var o=nl(n,t,["label","field","aria-descriptor"]);o.field().each((function(n){var e=Jr(t.prefix);o.label().each((function(t){Nr(t.element,"for",e),Nr(n.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=Jr(t.prefix);Nr(e.element,"id",o),Nr(n.element,"aria-describedby",o)}))}))}))]),u={getField:function(n){return Zf(n,t,"field")},getLabel:function(n){return Zf(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),Yb=Object.freeze({__proto__:null,exhibit:function(t,n){return pi({attributes:jt([{key:n.tabAttr,value:"true"}])})}}),qb=[Un("tabAttr","data-alloy-tabstop")],Kb=Na({fields:qb,name:"tabstopping",active:Yb}),Jb=tinymce.util.Tools.resolve("tinymce.html.Entities"),$b=function(t,n,e,o){var r=Qb(t,n,e,o);return Xb.sketch(r)},Qb=function(t,n,e,o){return{dom:Zb(e),components:t.toArray().concat([n]),fieldBehaviours:Ha(o)}},Zb=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},ty=function(t,n){return Xb.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},ny=Jr("form-component-change"),ey=Jr("form-close"),oy=Jr("form-cancel"),ry=Jr("form-action"),iy=Jr("form-submit"),uy=Jr("form-block"),ay=Jr("form-unblock"),cy=Jr("form-tabchange"),sy=Jr("form-resize"),fy=g([Pn("data"),Un("inputAttributes",{}),Un("inputStyles",{}),Un("tag","input"),Un("inputClasses",[]),Ku("onSetValue"),Un("styles",{}),Un("eventOrder",{}),df("inputBehaviours",[lf,Rm]),Un("selectOnFocus",!0)]),ly=function(t){return Ha([Rm.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=Gi(n);n.dom.setSelectionRange(0,e.length)}:d})])},dy=function(t){return S(S({},ly(t)),gf(t.inputBehaviours,[lf.config({store:S(S({mode:"manual"},t.data.map((function(t){return{initialValue:t}})).getOr({})),{getValue:function(t){return Gi(t.element)},setValue:function(t,n){Gi(t.element)!==n&&Xi(t.element,n)}}),onSetValue:t.onSetValue})]))},my=function(t){return{tag:t.tag,attributes:S({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},gy=ml({name:"Input",configFields:fy(),factory:function(t,n){return{uid:t.uid,dom:my(t),components:[],behaviours:dy(t),eventOrder:t.eventOrder}}}),py={},hy={exports:py};!function(t,n,o,r){!function(t){"object"==typeof n&&void 0!==o?o.exports=t():("undefined"!=typeof window?window:void 0!==e.g?e.g:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}((function(){return function t(n,e,o){function r(u,a){if(!e[u]){if(!n[u]){var c=!1;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var f=e[u]={exports:{}};n[u][0].call(f.exports,(function(t){return r(n[u][1][t]||t)}),f,f.exports,t,n,e,o)}return e[u].exports}for(var i=!1,u=0;u<o.length;u++)r(o[u]);return r}({1:[function(t,n,e){var o,r,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(o===setTimeout)return setTimeout(t,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(n){try{return o.call(null,t,0)}catch(n){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(t){o=u}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var s,f=[],l=!1,d=-1;function m(){l&&s&&(l=!1,s.length?f=s.concat(f):d=-1,f.length&&g())}function g(){if(!l){var t=c(m);l=!0;for(var n=f.length;n;){for(s=f,f=[];++d<n;)s&&s[d].run();d=-1,n=f.length}s=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(n){try{return r.call(null,t)}catch(n){return r.call(this,t)}}}(t)}}function p(t,n){this.fun=t,this.array=n}function h(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];f.push(new p(t,n)),1!==f.length||l||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,n,e){(function(t){!function(e){var o=setTimeout;function r(){}function i(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function u(t,n){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn((function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(t){return void c(n.promise,t)}a(n.promise,o)}else(1===t._state?a:c)(n.promise,t._value)}))):t._deferreds.push(n)}function a(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof i)return t._state=3,t._value=n,void s(t);if("function"==typeof e)return void l((o=e,r=n,function(){o.apply(r,arguments)}),t)}t._state=1,t._value=n,s(t)}catch(n){c(t,n)}var o,r}function c(t,n){t._state=2,t._value=n,s(t)}function s(t){2===t._state&&0===t._deferreds.length&&i._immediateFn((function(){t._handled||i._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)u(t,t._deferreds[n]);t._deferreds=null}function f(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function l(t,n){var e=!1;try{t((function(t){e||(e=!0,a(n,t))}),(function(t){e||(e=!0,c(n,t))}))}catch(t){if(e)return;e=!0,c(n,t)}}i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,n){var e=new this.constructor(r);return u(this,new f(t,n,e)),e},i.all=function(t){var n=Array.prototype.slice.call(t);return new i((function(t,e){if(0===n.length)return t([]);var o=n.length;function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),e)}n[i]=u,0==--o&&t(n)}catch(t){e(t)}}for(var i=0;i<n.length;i++)r(i,n[i])}))},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i((function(n){n(t)}))},i.reject=function(t){return new i((function(n,e){e(t)}))},i.race=function(t){return new i((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},i._immediateFn="function"==typeof t?function(n){t(n)}:function(t){o(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},void 0!==n&&n.exports?n.exports=i:e.Promise||(e.Promise=i)}(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,o){var r=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;n>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),n))},e.setImmediate="function"==typeof n?n:function(t){var n=c++,o=!(arguments.length<2)&&u.call(arguments,1);return a[n]=!0,r((function(){a[n]&&(o?t.apply(null,o):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"==typeof o?o:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var o=t("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}))}(0,py,hy);var vy,by=hy.exports.boltExport,yy=function(t){var n=D.none(),e=[],o=function(t){r()?i(t):e.push(t)},r=function(){return n.isSome()},i=function(t){n.each((function(n){setTimeout((function(){t(n)}),0)}))};return t((function(t){r()||(n=D.some(t),j(e,i),e=[])})),{get:o,map:function(t){return yy((function(n){o((function(e){n(t(e))}))}))},isReady:r}},xy={nu:yy,pure:function(t){return yy((function(n){n(t)}))}},wy=function(t){setTimeout((function(){throw t}),0)},Sy=function(t){var n=function(n){t().then(n,wy)};return{map:function(n){return Sy((function(){return t().then(n)}))},bind:function(n){return Sy((function(){return t().then((function(t){return n(t).toPromise()}))}))},anonBind:function(n){return Sy((function(){return t().then((function(){return n.toPromise()}))}))},toLazy:function(){return xy.nu(n)},toCached:function(){var n=null;return Sy((function(){return null===n&&(n=t()),n}))},toPromise:t,get:n}},ky=function(t){return Sy((function(){return new by(t)}))},Cy=function(t){return Sy((function(){return by.resolve(t)}))},Oy=["input","textarea"],_y=function(t){var n=cr(t);return P(Oy,n)},Ty=function(t,n){var e=n.getRoot(t).getOr(t.element);Oi(e,n.invalidClass),n.notify.each((function(n){_y(t.element)&&Nr(t.element,"aria-invalid",!1),n.getContainer(t).each((function(t){Hr(t,n.validHtml)})),n.onValid(t)}))},Ey=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element);Ci(r,n.invalidClass),n.notify.each((function(n){_y(t.element)&&Nr(t.element,"aria-invalid",!0),n.getContainer(t).each((function(t){Hr(t,o)})),n.onInvalid(t,o)}))},By=function(t,n,e){return n.validator.fold((function(){return Cy(ct.value(!0))}),(function(n){return n.validate(t)}))},Ay=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),By(t,n).map((function(e){return t.getSystem().isConnected()?e.fold((function(e){return Ey(t,n,0,e),ct.error(e)}),(function(e){return Ty(t,n),ct.value(e)})):ct.error("No longer in system")}))},My=Object.freeze({__proto__:null,markValid:Ty,markInvalid:Ey,query:By,run:Ay,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element);return _i(e,n.invalidClass)}}),Dy=Object.freeze({__proto__:null,events:function(t,n){return t.validator.map((function(n){return Yo([Jo(n.onEvent,(function(n){Ay(n,t).get(p)}))].concat(n.validateOnLoad?[rr((function(n){Ay(n,t).get(d)}))]:[]))})).getOr({})}}),Fy=[En("invalidClass"),Un("getRoot",D.none),jn("notify",[Un("aria","alert"),Un("getContainer",D.none),Un("validHtml",""),Ku("onValid"),Ku("onInvalid"),Ku("onValidate")]),jn("validator",[En("validate"),Un("onEvent","input"),Un("validateOnLoad",!0)])],Iy=Na({fields:Fy,name:"invalidating",active:Dy,apis:My,extra:{validation:function(t){return function(n){var e=lf.getValue(n);return Cy(t(e))}}}}),Ry=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),Vy=[Bn("others",dn(ct.value,yn()))],Py=Na({fields:Vy,name:"coupling",apis:Ry,state:Object.freeze({__proto__:null,init:function(){var t={},n=g({});return mi({readState:n,getOrCreate:function(n,e,o){var r=vt(e.others);if(r)return Ot(t,o).getOrThunk((function(){var r=Ot(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r);return t[o]=i,i}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),Hy=g("sink"),zy=g(Lf({name:Hy(),overrides:g({dom:{tag:"div"},behaviours:Ha([Ss.config({useFixed:x})]),events:Yo([nr(uo()),nr(Ze()),nr(fo())])})}));!function(t){t[t.HighlightFirst=0]="HighlightFirst",t[t.HighlightNone=1]="HighlightNone"}(vy||(vy={}));var Ny,Ly,jy,Uy=function(t,n){var e=t.getHotspot(n).getOr(n),o="hotspot",r=t.getAnchorOverrides();return t.layouts.fold((function(){return{anchor:o,hotspot:e,overrides:r}}),(function(t){return{anchor:o,hotspot:e,overrides:r,layouts:t}}))},Wy=function(t,n,e,o,r,i,u){return function(t,n,e,o,r,i,u){var a=function(t,n,e){return(0,t.fetch)(e).map(n)}(t,n,o),c=Yy(o,t);return a.map((function(t){return t.bind((function(t){return D.from(vg.sketch(S(S({},i.menu()),{uid:oi(""),data:t,highlightImmediately:u===vy.HighlightFirst,onOpenMenu:function(t,n){var o=c().getOrDie();Ss.position(o,e,n),Ws.decloak(r)},onOpenSubmenu:function(t,n,e){var o=c().getOrDie();Ss.position(o,{anchor:"submenu",item:n},e),Ws.decloak(r)},onRepositionMenu:function(t,n,o){var r=c().getOrDie();Ss.position(r,e,n),j(o,(function(t){Ss.position(r,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)}))},onEscape:function(){return Rm.focus(o),Ws.close(r),D.some(!0)}})))}))}))}(t,n,Uy(t,e),e,o,r,u).map((function(t){return t.fold((function(){Ws.isOpen(o)&&Ws.close(o)}),(function(t){Ws.cloak(o),Ws.open(o,t),i(o)})),o}))},Gy=function(t,n,e,o,r,i,u){return Ws.close(o),Cy(o)},Xy=function(t,n,e,o,r,i){var u=Py.getCoupled(e,"sandbox");return(Ws.isOpen(u)?Gy:Wy)(t,n,e,u,o,r,i)},Yy=function(t,n){return t.getSystem().getByUid(n.uid+"-"+Hy()).map((function(t){return function(){return ct.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return ct.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},qy=function(t){Ws.getState(t).each((function(t){vg.repositionMenus(t)}))},Ky=function(t,n,e){var o=Ru(),r=Yy(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:hf(t.sandboxBehaviours,[lf.config({store:{mode:"memory",initialValue:n}}),Ws.config({onOpen:function(r,i){var u=Uy(t,n);o.link(n.element),t.matchWidth&&function(t,n,e){var o=xl.getCurrent(n).getOr(n),r=lu(t.element);e?Ri(o.element,"min-width",r+"px"):function(t,n){fu.set(t,n)}(o.element,r)}(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,o){return Vu(e,o)||Vu(n,o)},getAttachPoint:function(){return r().getOrDie()}}),xl.config({find:function(t){return Ws.getState(t).bind((function(t){return xl.getCurrent(t)}))}}),Wa.config({channels:S(S({},Ks({isExtraPart:y})),$s({doReposition:qy}))})])}},Jy=function(t){var n=Py.getCoupled(t,"sandbox");qy(n)},$y=function(){return[Un("sandboxClasses",[]),pf("sandboxBehaviours",[xl,Wa,Ws,lf])]},Qy=g([En("dom"),En("fetch"),Ku("onOpen"),Ju("onExecute"),Un("getHotspot",D.some),Un("getAnchorOverrides",g({})),Sc(),df("dropdownBehaviours",[Ym,Py,Cm,Rm]),En("toggleClass"),Un("eventOrder",{}),Pn("lazySink"),Un("matchWidth",!1),Un("useMinWidth",!1),Pn("role")].concat($y())),Zy=g([Nf({schema:[Xu()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),zy()]),tx=gl({name:"Dropdown",configFields:Qy(),partFields:Zy(),factory:function(t,n,e,o){var r,i=function(t){Ws.getState(t).each((function(t){vg.highlightPrimary(t)}))},u={expand:function(n){Ym.isOn(n)||Xy(t,(function(t){return t}),n,o,d,vy.HighlightNone).get(d)},open:function(n){Ym.isOn(n)||Xy(t,(function(t){return t}),n,o,d,vy.HighlightFirst).get(d)},isOpen:Ym.isOn,close:function(n){Ym.isOn(n)&&Xy(t,(function(t){return t}),n,o,d,vy.HighlightFirst).get(d)},repositionMenus:function(t){Ym.isOn(t)&&Jy(t)}},a=function(t,n){return Uo(t),D.some(!0)};return{uid:t.uid,dom:t.dom,components:n,behaviours:gf(t.dropdownBehaviours,[Ym.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),Py.config({others:{sandbox:function(n){return Ky(t,n,{onOpen:function(){return Ym.on(n)},onClose:function(){return Ym.off(n)}})}}}),Cm.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t,n){if(tx.isOpen(t)){var e=Py.getCoupled(t,"sandbox");i(e)}else tx.open(t);return D.some(!0)},onEscape:function(t,n){return tx.isOpen(t)?(tx.close(t),D.some(!0)):D.none()}}),Rm.config({})]),events:Km(D.some((function(n){Xy(t,(function(t){return t}),n,o,i,vy.HighlightFirst).get(d)}))),eventOrder:S(S({},t.eventOrder),(r={},r[xo()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:u,domModification:{attributes:S(S({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===t.dom.tag?{type:("type",Ot(t.dom,"attributes").bind((function(t){return Ot(t,"type")}))).getOr("button")}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),nx=Object.freeze({__proto__:null,events:function(){return Yo([qo(mo(),x)])},exhibit:function(){return pi({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}}),ex=Na({fields:[],name:"unselecting",active:nx}),ox=Jr("color-input-change"),rx=Jr("color-swatch-change"),ix=Jr("color-picker-cancel"),ux=Lf({schema:[En("dom")],name:"label"}),ax=function(t){return Lf({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold((function(){return{}}),(function(t){return{events:Yo([$o(Ke(),(function(n,e,o){return t(n,o)}),[n]),$o(Ze(),(function(n,e,o){return t(n,o)}),[n]),$o(to(),(function(n,e,o){o.mouseIsDown.get()&&t(n,o)}),[n])])}}))}})},cx=ax("top-left"),sx=ax("top"),fx=ax("top-right"),lx=ax("right"),dx=ax("bottom-right"),mx=ax("bottom"),gx=ax("bottom-left"),px=ax("left"),hx=zf({name:"thumb",defaults:g({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Yo([Zo(Ke(),t,"spectrum"),Zo(Je(),t,"spectrum"),Zo($e(),t,"spectrum"),Zo(Ze(),t,"spectrum"),Zo(to(),t,"spectrum"),Zo(eo(),t,"spectrum")])}}}),vx=zf({schema:[Qn("mouseIsDown",(function(){return Zn(!1)}))],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map((function(o){return n.setValueFrom(e,t,o)}))};return{behaviours:Ha([Cm.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),Rm.config({})]),events:Yo([Jo(Ke(),e),Jo(Je(),e),Jo(Ze(),e),Jo(to(),(function(n,o){t.mouseIsDown.get()&&e(n,o)}))])}}}),bx=[ux,px,lx,sx,mx,cx,fx,gx,dx,hx,vx],yx=g("slider.change.value"),xx=function(t){var n=t.event.raw;if(function(t){return-1!==t.type.indexOf("touch")}(n)){var e=n;return void 0!==e.touches&&1===e.touches.length?D.some(e.touches[0]).map((function(t){return uu(t.clientX,t.clientY)})):D.none()}var o=n;return void 0!==o.clientX?D.some(o).map((function(t){return uu(t.clientX,t.clientY)})):D.none()},wx=function(t){return t.model.minX},Sx=function(t){return t.model.minY},kx=function(t){return t.model.minX-1},Cx=function(t){return t.model.minY-1},Ox=function(t){return t.model.maxX},_x=function(t){return t.model.maxY},Tx=function(t){return t.model.maxX+1},Ex=function(t){return t.model.maxY+1},Bx=function(t,n,e){return n(t)-e(t)},Ax=function(t){return Bx(t,Ox,wx)},Mx=function(t){return Bx(t,_x,Sx)},Dx=function(t){return Ax(t)/2},Fx=function(t){return Mx(t)/2},Ix=function(t){return t.stepSize},Rx=function(t){return t.snapToGrid},Vx=function(t){return t.snapStart},Px=function(t){return t.rounded},Hx=function(t,n){return void 0!==t[n+"-edge"]},zx=function(t){return Hx(t,"left")},Nx=function(t){return Hx(t,"right")},Lx=function(t){return Hx(t,"top")},jx=function(t){return Hx(t,"bottom")},Ux=function(t){return t.model.value.get()},Wx=function(t){return{x:t}},Gx=function(t){return{y:t}},Xx=function(t,n){return{x:t,y:n}},Yx=function(t,n){jo(t,yx(),{value:n})},qx=function(t,n,e,o){return t<n?t:t>e?e:t===n?n-1:Math.max(n,t-o)},Kx=function(t,n,e,o){return t>e?t:t<n?n:t===e?e+1:Math.min(e,t+o)},Jx=function(t,n,e){return Math.max(n,Math.min(e,t))},$x=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,f=t.hasMaxEdge,l=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=f?e+1:e;if(r<l)return g;if(r>d)return p;var h=function(t,n,e){return Math.min(e,Math.max(t,n))-n}(r,l,d),v=Jx(h/m*o+n,g,p);return u&&v>=n&&v<=e?function(t,n,e,o,r){return r.fold((function(){var r=t-n,i=Math.round(r/o)*o;return Jx(n+i,n-1,e+1)}),(function(n){var r=(t-n)%o,i=Math.round(r/o),u=Math.floor((t-n)/o),a=Math.floor((e-n)/o),c=n+Math.min(a,u+i)*o;return Math.max(n,c)}))}(v,n,e,i,a):c?Math.round(v):v},Qx=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,f=t.centerMaxEdge;return r<n?i?0:s:r>e?u?a:f:(r-n)/o*c},Zx="top",tw="right",nw="bottom",ew="left",ow=function(t){return t.element.dom.getBoundingClientRect()},rw=function(t,n){return t[n]},iw=function(t){var n=ow(t);return rw(n,ew)},uw=function(t){var n=ow(t);return rw(n,tw)},aw=function(t){var n=ow(t);return rw(n,Zx)},cw=function(t){var n=ow(t);return rw(n,nw)},sw=function(t){var n=ow(t);return rw(n,"width")},fw=function(t){var n=ow(t);return rw(n,"height")},lw=function(t,n,e){return(t+n)/2-e},dw=function(t,n){var e=ow(t),o=ow(n),r=rw(e,ew),i=rw(e,tw),u=rw(o,ew);return lw(r,i,u)},mw=function(t,n){var e=ow(t),o=ow(n),r=rw(e,Zx),i=rw(e,nw),u=rw(o,Zx);return lw(r,i,u)},gw=function(t,n){jo(t,yx(),{value:n})},pw=function(t){return{x:t}},hw=function(t,n,e){var o={min:wx(n),max:Ox(n),range:Ax(n),value:e,step:Ix(n),snap:Rx(n),snapStart:Vx(n),rounded:Px(n),hasMinEdge:zx(n),hasMaxEdge:Nx(n),minBound:iw(t),maxBound:uw(t),screenRange:sw(t)};return $x(o)},vw=function(t){return function(n,e){return function(t,n,e){var o=(t>0?Kx:qx)(Ux(e).x,wx(e),Ox(e),Ix(e));return gw(n,pw(o)),D.some(o)}(t,n,e).map(x)}},bw=function(t,n,e,o,r,i){var u=function(t,n,e,o,r){var i=sw(t),u=o.bind((function(n){return D.some(dw(n,t))})).getOr(0),a=r.bind((function(n){return D.some(dw(n,t))})).getOr(i),c={min:wx(n),max:Ox(n),range:Ax(n),value:e,hasMinEdge:zx(n),hasMaxEdge:Nx(n),minBound:iw(t),minOffset:0,maxBound:uw(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return Qx(c)}(n,i,e,o,r);return iw(n)-iw(t)+u},yw=vw(-1),xw=vw(1),ww=D.none,Sw=D.none,kw={"top-left":D.none(),top:D.none(),"top-right":D.none(),right:D.some((function(t,n){Yx(t,Wx(Tx(n)))})),"bottom-right":D.none(),bottom:D.none(),"bottom-left":D.none(),left:D.some((function(t,n){Yx(t,Wx(kx(n)))}))},Cw=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=hw(t,n,e),r=pw(o);return gw(t,r),o},setToMin:function(t,n){var e=wx(n);gw(t,pw(e))},setToMax:function(t,n){var e=Ox(n);gw(t,pw(e))},findValueOfOffset:hw,getValueFromEvent:function(t){return xx(t).map((function(t){return t.left}))},findPositionOfValue:bw,setPositionFromValue:function(t,n,e,o){var r=Ux(e),i=bw(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=lu(n.element)/2;Ri(n.element,"left",i-u+"px")},onLeft:yw,onRight:xw,onUp:ww,onDown:Sw,edgeActions:kw}),Ow=function(t,n){jo(t,yx(),{value:n})},_w=function(t){return{y:t}},Tw=function(t,n,e){var o={min:Sx(n),max:_x(n),range:Mx(n),value:e,step:Ix(n),snap:Rx(n),snapStart:Vx(n),rounded:Px(n),hasMinEdge:Lx(n),hasMaxEdge:jx(n),minBound:aw(t),maxBound:cw(t),screenRange:fw(t)};return $x(o)},Ew=function(t){return function(n,e){return function(t,n,e){var o=(t>0?Kx:qx)(Ux(e).y,Sx(e),_x(e),Ix(e));return Ow(n,_w(o)),D.some(o)}(t,n,e).map(x)}},Bw=function(t,n,e,o,r,i){var u=function(t,n,e,o,r){var i=fw(t),u=o.bind((function(n){return D.some(mw(n,t))})).getOr(0),a=r.bind((function(n){return D.some(mw(n,t))})).getOr(i),c={min:Sx(n),max:_x(n),range:Mx(n),value:e,hasMinEdge:Lx(n),hasMaxEdge:jx(n),minBound:aw(t),minOffset:0,maxBound:cw(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return Qx(c)}(n,i,e,o,r);return aw(n)-aw(t)+u},Aw=D.none,Mw=D.none,Dw=Ew(-1),Fw=Ew(1),Iw={"top-left":D.none(),top:D.some((function(t,n){Yx(t,Gx(Cx(n)))})),"top-right":D.none(),right:D.none(),"bottom-right":D.none(),bottom:D.some((function(t,n){Yx(t,Gx(Ex(n)))})),"bottom-left":D.none(),left:D.none()},Rw=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=Tw(t,n,e),r=_w(o);return Ow(t,r),o},setToMin:function(t,n){var e=Sx(n);Ow(t,_w(e))},setToMax:function(t,n){var e=_x(n);Ow(t,_w(e))},findValueOfOffset:Tw,getValueFromEvent:function(t){return xx(t).map((function(t){return t.top}))},findPositionOfValue:Bw,setPositionFromValue:function(t,n,e,o){var r=Ux(e),i=Bw(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=ou(n.element)/2;Ri(n.element,"top",i-u+"px")},onLeft:Aw,onRight:Mw,onUp:Dw,onDown:Fw,edgeActions:Iw}),Vw=function(t,n){jo(t,yx(),{value:n})},Pw=function(t,n){return{x:t,y:n}},Hw=function(t,n){return function(e,o){return function(t,n,e,o){var r=t>0?Kx:qx,i=n?Ux(o).x:r(Ux(o).x,wx(o),Ox(o),Ix(o)),u=n?r(Ux(o).y,Sx(o),_x(o),Ix(o)):Ux(o).y;return Vw(e,Pw(i,u)),D.some(i)}(t,n,e,o).map(x)}},zw=Hw(-1,!1),Nw=Hw(1,!1),Lw=Hw(-1,!0),jw=Hw(1,!0),Uw={"top-left":D.some((function(t,n){Yx(t,Xx(kx(n),Cx(n)))})),top:D.some((function(t,n){Yx(t,Xx(Dx(n),Cx(n)))})),"top-right":D.some((function(t,n){Yx(t,Xx(Tx(n),Cx(n)))})),right:D.some((function(t,n){Yx(t,Xx(Tx(n),Fx(n)))})),"bottom-right":D.some((function(t,n){Yx(t,Xx(Tx(n),Ex(n)))})),bottom:D.some((function(t,n){Yx(t,Xx(Dx(n),Ex(n)))})),"bottom-left":D.some((function(t,n){Yx(t,Xx(kx(n),Ex(n)))})),left:D.some((function(t,n){Yx(t,Xx(kx(n),Fx(n)))}))},Ww=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=hw(t,n,e.left),r=Tw(t,n,e.top),i=Pw(o,r);return Vw(t,i),i},setToMin:function(t,n){var e=wx(n),o=Sx(n);Vw(t,Pw(e,o))},setToMax:function(t,n){var e=Ox(n),o=_x(n);Vw(t,Pw(e,o))},getValueFromEvent:function(t){return xx(t)},setPositionFromValue:function(t,n,e,o){var r=Ux(e),i=bw(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Bw(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=lu(n.element)/2,c=ou(n.element)/2;Ri(n.element,"left",i-a+"px"),Ri(n.element,"top",u-c+"px")},onLeft:zw,onRight:Nw,onUp:Lw,onDown:jw,edgeActions:Uw}),Gw=gl({name:"Slider",configFields:[Un("stepSize",1),Un("onChange",d),Un("onChoose",d),Un("onInit",d),Un("onDragStart",d),Un("onDragEnd",d),Un("snapToGrid",!1),Un("rounded",!0),Pn("snapStart"),Bn("model",bn("mode",{x:[Un("minX",0),Un("maxX",100),Qn("value",(function(t){return Zn(t.mode.minX)})),En("getInitialValue"),Zu("manager",Cw)],y:[Un("minY",0),Un("maxY",100),Qn("value",(function(t){return Zn(t.mode.minY)})),En("getInitialValue"),Zu("manager",Rw)],xy:[Un("minX",0),Un("maxX",100),Un("minY",0),Un("maxY",100),Qn("value",(function(t){return Zn({x:t.mode.minX,y:t.mode.minY})})),En("getInitialValue"),Zu("manager",Ww)]})),df("sliderBehaviours",[Cm,lf]),Qn("mouseIsDown",(function(){return Zn(!1)}))],partFields:bx,factory:function(t,n,e,o){var r,i=function(n){return tl(n,t,"thumb")},u=function(n){return tl(n,t,"spectrum")},a=function(n){return Zf(n,t,"left-edge")},c=function(n){return Zf(n,t,"right-edge")},s=function(n){return Zf(n,t,"top-edge")},f=function(n){return Zf(n,t,"bottom-edge")},l=t.model,d=l.manager,m=function(n,e){d.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:f,getSpectrum:u})},g=function(t,n){l.value.set(n);var e=i(t);m(t,e)},p=function(n){var e=t.mouseIsDown.get();t.mouseIsDown.set(!1),e&&Zf(n,t,"thumb").each((function(e){var o=l.value.get();t.onChoose(n,e,o)}))},h=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},v=function(n,e){e.stop(),t.onDragEnd(n,i(n)),p(n)};return{uid:t.uid,dom:t.dom,components:n,behaviours:gf(t.sliderBehaviours,[Cm.config({mode:"special",focusIn:function(n){return Zf(n,t,"spectrum").map(Cm.focusIn).map(x)}}),lf.config({store:{mode:"manual",getValue:function(t){return l.value.get()}}}),Wa.config({channels:(r={},r[Ys()]={onReceive:p},r)})]),events:Yo([Jo(yx(),(function(n,e){!function(n,e){g(n,e);var o=i(n);t.onChange(n,o,e),D.some(!0)}(n,e.event.value)})),rr((function(n,e){var o=l.getInitialValue();l.value.set(o);var r=i(n);m(n,r);var a=u(n);t.onInit(n,r,a,l.value.get())})),Jo(Ke(),h),Jo($e(),v),Jo(Ze(),h),Jo(eo(),v)]),apis:{resetToMin:function(n){d.setToMin(n,t)},resetToMax:function(n){d.setToMax(n,t)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),Xw=function(t,n,e){return{hue:t,saturation:n,value:e}},Yw=function(t){var n,e=0,o=0,r=t.red/255,i=t.green/255,u=t.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u));return a===c?Xw(0,0,100*(o=a)):(e=60*((e=r===a?3:u===a?1:5)-(r===a?i-u:u===a?r-i:u-r)/(c-a)),n=(c-a)/c,o=c,Xw(Math.round(e),Math.round(100*n),Math.round(100*o)))},qw=function(t){return Rv(Uv(t))},Kw=Jr("rgb-hex-update"),Jw=Jr("slider-update"),$w=Jr("palette-update"),Qw="form",Zw=[df("formBehaviours",[lf])],tS=function(t){return"<alloy.field."+t+">"},nS=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:gf(t.formBehaviours,[lf.config({store:{mode:"manual",getValue:function(n){var e=el(n,t);return xt(e,(function(t,n){return t().bind((function(t){var e,o;return e=xl.getCurrent(t),o=new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+Xr(t.element)),e.fold((function(){return ct.error(o)}),ct.value)})).map(lf.getValue)}))},setValue:function(n,e){yt(e,(function(e,o){Zf(n,t,o).each((function(t){xl.getCurrent(t).each((function(t){lf.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return Zf(n,t,e).bind(xl.getCurrent)}}}},eS={getField:li((function(t,n,e){return t.getField(n,e)})),sketch:function(t){var n=function(){var t=[];return{field:function(n,e){return t.push(n),qf(Qw,tS(n),e)},record:function(){return t}}}(),e=t(n),o=n.record(),r=L(o,(function(t){return zf({name:t,pname:tS(t)})}));return sl(Qw,Zw,r,nS,e)}},oS=Jr("valid-input"),rS=Jr("invalid-input"),iS=Jr("validating-input"),uS="colorcustom.rgb.",aS=function(t,n,e,o){var r=function(e,o){return Iy.config({invalidClass:n("invalid"),notify:{onValidate:function(t){jo(t,iS,{type:e})},onValid:function(t){jo(t,oS,{type:e,value:lf.getValue(t)})},onInvalid:function(t){jo(t,rS,{type:e,value:lf.getValue(t)})}},validator:{validate:function(n){var e=lf.getValue(n),r=o(e)?ct.value(!0):ct.error(t("aria.input.invalid"));return Cy(r)},validateOnLoad:!1}})},i=function(e,o,i,u,a){var c=t("colorcustom.rgb.range"),s=[Xb.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),Xb.parts.field({data:a,factory:gy,inputAttributes:S({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:Ha([r(o,e),Kb.config({})]),onSetValue:function(t){Iy.isInvalid(t)&&Iy.run(t).get(d)}})],f="hex"!==o?[Xb.parts["aria-descriptor"]({text:c})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:s.concat(f)}},u=function(t,n){var e=n.red,o=n.green,r=n.blue;lf.setValue(t,{red:e,green:o,blue:r})},a=Dg({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(t,n){a.getOpt(t).each((function(t){Ri(t.element,"background-color","#"+n.value)}))};return ml({factory:function(){var r={red:Zn(D.some(255)),green:Zn(D.some(255)),blue:Zn(D.some(255)),hex:Zn(D.some("ffffff"))},s=function(t){return r[t].get()},f=function(t,n){r[t].set(n)},l=function(t){var n=t.red,e=t.green,o=t.blue;f("red",D.some(n)),f("green",D.some(e)),f("blue",D.some(o))},d=function(t,n){var e=n.event;"hex"!==e.type?f(e.type,D.none()):o(t)},m=function(t,n){var o=n.event;!function(t){return"hex"===t.type}(o)?function(t,n,e){var o=parseInt(e,10);f(n,D.some(o)),s("red").bind((function(t){return s("green").bind((function(n){return s("blue").map((function(e){return Lv(t,n,e,1)}))}))})).each((function(n){var e=function(t,n){var e=Rv(n);return eS.getField(t,"hex").each((function(n){Rm.isFocused(n)||lf.setValue(t,{hex:e.value})})),e}(t,n);jo(t,Kw,{hex:e}),c(t,e)}))}(t,o.type,o.value):function(t,n){e(t);var o=Av(n);f("hex",D.some(n));var r=Wv(o);u(t,r),l(r),jo(t,Kw,{hex:o}),c(t,o)}(t,o.value)},g=function(n){return{label:t(uS+n+".label"),description:t(uS+n+".description")}},p=g("red"),h=g("green"),v=g("blue"),b=g("hex");return Mt(eS.sketch((function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",Xb.sketch(i(jv,"red",p.label,p.description,255))),e.field("green",Xb.sketch(i(jv,"green",h.label,h.description,255))),e.field("blue",Xb.sketch(i(jv,"blue",v.label,v.description,255))),e.field("hex",Xb.sketch(i(Fv,"hex",b.label,b.description,"ffffff"))),a.asSpec()],formBehaviours:Ha([Iy.config({invalidClass:n("form-invalid")}),Am("rgb-form-events",[Jo(oS,m),Jo(rS,d),Jo(iS,d)])])}})),{apis:{updateHex:function(t,n){lf.setValue(t,{hex:n.value}),function(t,n){var e=Wv(n);u(t,e),l(e)}(t,n),c(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},cS=function(t,n){return ml({name:"ColourPicker",configFields:[En("dom"),Un("onValidHex",d),Un("onInvalidHex",d)],factory:function(e){var o,r=aS(t,n,e.onValidHex,e.onInvalidHex),i=function(t,n){var e=Gw.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),o=Gw.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(t,n){var e=t.width,o=t.height,r=t.getContext("2d");if(null!==r){r.fillStyle=n,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}};return ml({factory:function(t){var i=g({x:0,y:0}),u=Ha([xl.config({find:D.some}),Rm.config({})]);return Gw.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:i},rounded:!1,components:[e,o],onChange:function(t,n,e){jo(t,$w,{value:e})},onInit:function(t,n,e,o){r(e.element.dom,Xv(Yv))},sliderBehaviours:u})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){!function(t,n){var e=t.components()[0].element.dom,o=Xw(n,100,100),i=Uv(o);r(e,Xv(i))}(n,e)},setThumb:function(t,n,e){!function(t,n){var e=Yw(Wv(n));Gw.setValue(t,{x:e.saturation,y:100-e.value})}(n,e)}},extraApis:{}})}(0,n),u=function(t){return 100-t/360*100},a={paletteRgba:Zn(Yv),paletteHue:Zn(0)},c=Dg(function(t,n){var e=Gw.parts.spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=Gw.parts.thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return Gw.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:g({y:0})},components:[e,o],sliderBehaviours:Ha([Rm.config({})]),onChange:function(t,n,e){jo(t,Jw,{value:e})}})}(0,n)),s=Dg(i.sketch({})),f=Dg(r.sketch({})),l=function(t,n,e){s.getOpt(t).each((function(t){i.setHue(t,e)}))},d=function(t,n){f.getOpt(t).each((function(t){r.updateHex(t,n)}))},m=function(t,n,e,o){!function(t,n){var e=Wv(t);a.paletteRgba.set(e),a.paletteHue.set(n)}(n,e),j(o,(function(o){o(t,n,e)}))};return{uid:e.uid,dom:e.dom,components:[s.asSpec(),c.asSpec(),f.asSpec()],behaviours:Ha([Am("colour-picker-events",[Jo(Kw,(o=[l,function(t,n,e){c.getOpt(t).each((function(t){Gw.setValue(t,{y:u(e)})}))},function(t,n){s.getOpt(t).each((function(t){i.setThumb(t,n)}))}],function(t,n){var e=n.event.hex,r=function(t){return Yw(Wv(t))}(e);m(t,e,r.hue,o)})),Jo($w,function(){var t=[d];return function(n,e){var o=e.event.value,r=a.paletteHue.get(),i=Xw(r,o.x,100-o.y),u=qw(i);m(n,u,r,t)}}()),Jo(Jw,function(){var t=[l,d];return function(n,e){var o=function(t){return(100-t)/100*360}(e.event.value.y),r=a.paletteRgba.get(),i=Yw(r),u=Xw(o,i.saturation,i.value),c=qw(u);m(n,c,o,t)}}())]),xl.config({find:function(t){return f.getOpt(t)}}),Cm.config({mode:"acyclic"})])}}})},sS=function(){return xl.config({find:D.some})},fS=function(t){return xl.config({find:function(n){return wr(n.element,t).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}})},lS={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},dS=function(t){return function(t){return lS[t]}(t)},mS=tinymce.util.Tools.resolve("tinymce.Resource"),gS=tinymce.util.Tools.resolve("tinymce.util.Tools"),pS=Zt([Un("preprocess",p),Un("postprocess",p)]),hS=function(t,n,e){return lf.config(Mt({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},vS=function(t,n){var e=pn("RepresentingConfigs.memento processors",pS,n);return lf.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=lf.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);lf.setValue(i,r)}}})},bS=hS,yS=function(t){return n=Pr,e=Hr,hS(t,(function(t){return n(t.element)}),(function(t,n){return e(t.element,n)}));var n,e},xS=function(t){return lf.config({store:{mode:"memory",initialValue:t}})},wS=Jr("alloy-fake-before-tabstop"),SS=Jr("alloy-fake-after-tabstop"),kS=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:Ha([Rm.config({ignore:!0}),Kb.config({})])}},CS=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[kS([wS]),t,kS([SS])],behaviours:Ha([fS(1)])}},OS=function(t,n){jo(t,uo(),{raw:{which:9,shiftKey:n}})},_S=function(t,n){var e=n.element;_i(e,wS)?OS(t,!0):_i(e,SS)&&OS(t,!1)},TS=function(t){return Ab(t,["."+wS,"."+SS].join(","),y)},ES=!(He().browser.isIE()||He().browser.isEdge()),BS=function(t,n){return DS(document.createElement("canvas"),t,n)},AS=function(t){var n=BS(t.width,t.height);return MS(n).drawImage(t,0,0),n},MS=function(t){return t.getContext("2d")},DS=function(t,n,e){return t.width=n,t.height=e,t},FS=function(t){return t.naturalWidth||t.width},IS=function(t){return t.naturalHeight||t.height},RS=window.Promise?window.Promise:function(){var t=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],f(t,o(u,this),o(a,this))},n=window,e=t.immediateFn||"function"==typeof n.setImmediate&&n.setImmediate||function(t){return setTimeout(t,1)},o=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.apply(n,e)}},r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(t){var n=this;null!==this._state?e((function(){var e=n._state?t.onFulfilled:t.onRejected;if(null!==e){var o;try{o=e(n._value)}catch(n){return void t.reject(n)}t.resolve(o)}else(n._state?t.resolve:t.reject)(n._value)})):this._deferreds.push(t)}function u(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void f(o(n,t),o(u,this),o(a,this))}this._state=!0,this._value=t,c.call(this)}catch(t){a.call(this,t)}}function a(t){this._state=!1,this._value=t,c.call(this)}function c(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];i.call(this,e)}this._deferreds=[]}function s(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}var f=function(t,n,e){var o=!1;try{t((function(t){o||(o=!0,n(t))}),(function(t){o||(o=!0,e(t))}))}catch(t){if(o)return;o=!0,e(t)}};return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.then=function(n,e){var o=this;return new t((function(t,r){i.call(o,new s(n,e,t,r))}))},t.all=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var o=Array.prototype.slice.call(1===n.length&&r(n[0])?n[0]:n);return new t((function(t,n){if(0===o.length)return t([]);for(var e=o.length,r=function(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),n)}o[i]=u,0==--e&&t(o)}catch(t){n(t)}},i=0;i<o.length;i++)r(i,o[i])}))},t.resolve=function(n){return n&&"object"==typeof n&&n.constructor===t?n:new t((function(t){t(n)}))},t.reject=function(n){return new t((function(t,e){e(n)}))},t.race=function(n){return new t((function(t,e){for(var o=0,r=n;o<r.length;o++)r[o].then(t,e)}))},t}(),VS=function(t,n,e){return n=n||"image/png",s(HTMLCanvasElement.prototype.toBlob)?new RS((function(o,r){t.toBlob((function(t){t?o(t):r()}),n,e)})):(o=t.toDataURL(n,e),new RS((function(t,n){(function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return D.none();for(var o=e[1],r=n[1],i=1024,u=atob(r),a=u.length,c=Math.ceil(a/i),s=new Array(c),f=0;f<c;++f){for(var l=f*i,d=Math.min(l+i,a),m=new Array(d-l),g=l,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0);s[f]=new Uint8Array(m)}return D.some(new Blob(s,{type:o}))})(o).fold((function(){n("uri is not base64: "+o)}),t)})));var o},PS=function(t){URL.revokeObjectURL(t.src)},HS=function(t,n,e){var o=n.type,r=g(o),i=g(e),u=function(n,e){return t.then((function(t){return function(t,n,e){return n=n||"image/png",t.toDataURL(n,e)}(t,n,e)}))};return{getType:r,toBlob:function(){return RS.resolve(n)},toDataURL:i,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then((function(t){return VS(t,n,e)}))},toAdjustedDataURL:u,toAdjustedBase64:function(t,n){return u(t,n).then((function(t){return t.split(",")[1]}))},toCanvas:function(){return t.then(AS)}}},zS=function(t){return function(t){return new RS((function(n){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(t)}))}(t).then((function(n){return HS(function(t){return function(t){return new RS((function(n,e){var o=URL.createObjectURL(t),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),n(r)},a=function(){i(),e("Unable to load data of type "+t.type+": "+o)};r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)}))}(t).then((function(t){PS(t);var n=BS(FS(t),IS(t));return MS(n).drawImage(t,0,0),n}))}(t),t,n)}))},NS=function(t,n){return VS(t,n).then((function(n){return HS(RS.resolve(t),n,t.toDataURL())}))},LS=function(t,n,e){var o="string"==typeof t?parseFloat(t):t;return o>e?o=e:o<n&&(o=n),o},jS=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],US=function(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r},WS=function(t,n){return t.toCanvas().then((function(e){return GS(e,t.getType(),n)}))},GS=function(t,n,e){var o=MS(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],f=n[3],l=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),NS(t,n)},XS=function(t){return function(n,e){return WS(n,t([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e))}},YS=function(t){return function(n){return WS(n,t)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),qS=XS((function(t,n){return n=LS(255*n,-255,255),US(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),KS=XS((function(t,n){var e;return n=LS(n,-1,1),e=(n*=100)<0?127+n/100*127:127*(e=0==(e=n%1)?jS[n]:jS[Math.floor(n)]*(1-e)+jS[Math.floor(n)+1]*e)+127,US(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),JS=(Ny=[0,-1,0,-1,5,-1,0,-1,0],function(t){return function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=MS(t),r=o.getImageData(0,0,t.width,t.height),i=o.getImageData(0,0,t.width,t.height);return i=function(t,n,e){for(var o=function(t,n,e){return t>e?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(l+h-i,0,c-1),b=4*(o(f+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[b+1]*y,g+=u[b+2]*y}var x=4*(f*c+l);a[x]=o(d,0,255),a[x+1]=o(m,0,255),a[x+2]=o(g,0,255)}return n}(r,i,e),o.putImageData(i,0,0),NS(t,n)}(e,t.getType(),n)}))}(t,Ny)}),$S=(Ly=function(t,n){return 255*Math.pow(t/255,1-n)},function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){for(var o=MS(t),r=new Array(256),i=0;i<r.length;i++)r[i]=Ly(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),NS(t,n)}(e,t.getType(),n)}))}),QS=function(t,n,e){var o=FS(t),r=IS(t),i=n/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=ZS(t,i,u);return a?c.then((function(t){return QS(t,n,e)})):c},ZS=function(t,n,e){return new RS((function(o){var r=FS(t),i=IS(t),u=Math.floor(r*n),a=Math.floor(i*e),c=BS(u,a);MS(c).drawImage(t,0,0,r,i,0,0,u,a),o(c)}))},tk=function(t,n){void 0===n&&(n=2);var e=Math.pow(10,n),o=Math.round(t*e);return Math.ceil(o/e)},nk=function(t){return YS(t)},ek=function(t){return JS(t)},ok=function(t,n){return $S(t,n)},rk=function(t,n){return qS(t,n)},ik=function(t,n){return KS(t,n)},uk=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=BS(t.width,t.height),r=MS(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),NS(o,n)}(e,t.getType(),n)}))}(t,n)},ak=function(t,n,e,o,r){return function(t,n,e,o,r){return t.toCanvas().then((function(i){return function(t,n,e,o,r,i){var u=BS(r,i);return MS(u).drawImage(t,-e,-o),NS(u,n)}(i,t.getType(),n,e,o,r)}))}(t,n,e,o,r)},ck=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=(e<0?360+e:e)*Math.PI/180,r=t.width,i=t.height,u=Math.sin(o),a=Math.cos(o),c=tk(Math.abs(r*a)+Math.abs(i*u)),s=tk(Math.abs(r*u)+Math.abs(i*a)),f=BS(c,s),l=MS(f);return l.translate(c/2,s/2),l.rotate(o),l.drawImage(t,-r/2,-i/2),NS(f,n)}(e,t.getType(),n)}))}(t,n)},sk=function(t,n){return S({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},fk=function(t,n){return sk(Ig(t,n),{})},lk=function(t,n){return sk(Ig(t,n),{behaviours:Ha([Bm.config({})])})},dk=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:Ha([Bm.config({})])}},mk=Jr("toolbar.button.execute"),gk=((jy={})[xo()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],jy),pk=Jr("update-menu-text"),hk=Jr("update-menu-icon"),vk=function(t,n,e){var o=Zn(d),r=t.text.map((function(t){return Dg(dk(t,n,e.providers))})),i=t.icon.map((function(t){return Dg(lk(t,e.providers.icons))})),u=function(t,n){var e=lf.getValue(t);return Rm.focus(e),jo(e,"keydown",{raw:n.event.raw}),tx.close(e),D.some(!0)},a=t.role.fold((function(){return{}}),(function(t){return{role:t}})),c=t.tooltip.fold((function(){return{}}),(function(t){var n=e.providers.translate(t);return{title:n,"aria-label":n}}));return Dg(tx.sketch(S(S(S({},t.uid?{uid:t.uid}:{}),a),{dom:{tag:"button",classes:[n,n+"--select"].concat(L(t.classes,(function(t){return n+"--"+t}))),attributes:S({},c)},components:lv([i.map((function(t){return t.asSpec()})),r.map((function(t){return t.asSpec()})),D.some({dom:{tag:"div",classes:[n+"__select-chevron"],innerHtml:Ig("chevron-down",e.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Ha(C(t.dropdownBehaviours,[ov((function(){return t.disabled||e.providers.isDisabled()})),ev(),ex.config({}),Bm.config({}),Am("dropdown-events",[av(t,o),cv(t,o)]),Am("menubutton-update-display-text",[Jo(pk,(function(t,n){r.bind((function(n){return n.getOpt(t)})).each((function(t){Bm.set(t,[Ji(e.providers.translate(n.event.text))])}))})),Jo(hk,(function(t,n){i.bind((function(n){return n.getOpt(t)})).each((function(t){Bm.set(t,[lk(n.event.icon,e.providers.icons)])}))}))])])),eventOrder:Mt(gk,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Ha([Cm.config({mode:"special",onLeft:u,onRight:u})]),lazySink:e.getSink,toggleClass:n+"--active",parts:{menu:Fp(0,t.columns,t.presets)},fetch:function(n){return ky(h(t.fetch,n))}}))).asSpec()},bk=function(t){return"separator"===t.type},yk={type:"separator"},xk=function(t,n){var e=function(t,n){var e=X(t,(function(t,e){return function(t){return o(t)}(e)?""===e?t:"|"===e?t.length>0&&!bk(t[t.length-1])?t.concat([yk]):t:_t(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[]);return e.length>0&&bk(e[e.length-1])&&e.pop(),e}(o(t)?t.split(" "):t,n);return G(e,(function(t,e){var o=function(t,n){return function(t){return _t(t,"getSubmenuItems")}(t)?function(t,n){var e=t.getSubmenuItems(),o=xk(e,n);return{item:t,menus:Mt(o.menus,Lt(t.value,o.items)),expansions:Mt(o.expansions,Lt(t.value,t.value))}}(t,n):{item:t,menus:{},expansions:{}}}(function(t){if(bk(t))return t;var n=Ot(t,"value").getOrThunk((function(){return Jr("generated-menu-item")}));return Mt({value:n},t)}(e),n);return{menus:Mt(t.menus,o.menus),items:[o.item].concat(t.items),expansions:Mt(t.expansions,o.expansions)}}),{menus:{},expansions:{},items:[]})},wk=function(t,n,e,o){var r=Jr("primary-menu"),i=xk(t,e.shared.providers.menuItems());if(0===i.items.length)return D.none();var u=kb(r,i.items,n,e,o),a=xt(i.menus,(function(t,o){return kb(o,t,n,e,!1)})),c=Mt(a,Lt(r,u));return D.from(vg.tieredData(r,c,i.expansions))},Sk=function(t){return{isDisabled:function(){return Oh.isDisabled(t)},setDisabled:function(n){return Oh.set(t,n)},setActive:function(n){var e=t.element;n?(Ci(e,"tox-tbtn--enabled"),Nr(e,"aria-pressed",!0)):(Oi(e,"tox-tbtn--enabled"),Wr(e,"aria-pressed"))},isActive:function(){return _i(t.element,"tox-tbtn--enabled")}}},kk=function(t,n,e,o){return vk({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch((function(t){o(wk(t,vp.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:Sk,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Kb.config({})]},n,e.shared)},Ck=function(t,n,e){var o=function(t){return function(o){var r=!o.isActive();o.setActive(r),t.storage.set(r),e.shared.getSink().each((function(e){n().getOpt(e).each((function(n){Xa(n.element),jo(n,ry,{name:t.name,value:t.storage.get()})}))}))}},r=function(t){return function(n){n.setActive(t.storage.get())}};return function(n){n(L(t,(function(t){var n=t.text.fold((function(){return{}}),(function(t){return{text:t}}));return S(S({type:t.type,active:!1},n),{onAction:o(t),onSetup:r(t)})})))}},Ok=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold((function(){return{}}),(function(t){return{action:t}})),a=S({buttonBehaviours:Ha([ov((function(){return t.disabled||i.isDisabled()})),ev(),Kb.config({}),Am("button press",[Ko("click"),Ko("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Mt(a,{dom:o});return Mt(c,{components:r})},_k=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},i=t.icon.map((function(t){return fk(t,e.icons)})),u=lv([i]);return Ok(t,n,o,r,u,e)},Tk=function(t,n,e,o){void 0===o&&(o=[]);var r=_k(t,D.some(n),e,o);return Mg.sketch(r)},Ek=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return fk(t,e.icons)})):D.none(),a=u.isSome()?lv([u]):[],c=u.isSome()?{}:{innerHtml:i},s=C(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],r),f=S(S({tag:"button",classes:s},c),{attributes:{title:i}});return Ok(t,n,o,f,a,e)},Bk=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=Ek(t,D.some(n),e,o,r);return Mg.sketch(i)},Ak=function(t,n){return function(e){"custom"===n?jo(e,ry,{name:t,value:{}}):"submit"===n?Lo(e,iy):"cancel"===n?Lo(e,oy):console.error("Unknown button type: ",n)}},Mk=function(t,n,e){if(function(t,n){return"menu"===n}(0,n)){var o=t,r=S(S({},t),{onSetup:function(n){return n.setDisabled(t.disabled),d},fetch:Ck(o.items,(function(){return i}),e)}),i=Dg(kk(r,"tox-tbtn",e,D.none()));return i.asSpec()}if(function(t,n){return"custom"===n||"cancel"===n||"submit"===n}(0,n)){var u=Ak(t.name,n),a=S(S({},t),{borderless:!1});return Bk(a,u,e.shared.providers,[])}console.error("Unknown footer button type: ",n)},Dk=g([Un("field1Name","field1"),Un("field2Name","field2"),$u("onLockedChange"),Yu(["lockClass"]),Un("locked",!1),pf("coupledFieldBehaviours",[xl,lf])]),Fk=function(t,n){return zf({factory:Xb,name:t,overrides:function(t){return{fieldBehaviours:Ha([Am("coupled-input-behaviour",[Jo(co(),(function(e){(function(t,n,e){return Zf(t,n,e).bind(xl.getCurrent)})(e,t,n).each((function(n){Zf(e,t,"lock").each((function(o){Ym.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})},Ik=g([Fk("field1","field2"),Fk("field2","field1"),zf({factory:Mg,schema:[En("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:Ha([Ym.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),Rk=gl({name:"FormCoupledInputs",configFields:Dk(),partFields:Ik(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:hf(t.coupledFieldBehaviours,[xl.config({find:D.some}),lf.config({store:{mode:"manual",getValue:function(n){var e,o=rl(n,t,["field1","field2"]);return(e={})[t.field1Name]=lf.getValue(o.field1()),e[t.field2Name]=lf.getValue(o.field2()),e},setValue:function(n,e){var o=rl(n,t,["field1","field2"]);Tt(e,t.field1Name)&&lf.setValue(o.field1(),e[t.field1Name]),Tt(e,t.field2Name)&&lf.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return Zf(n,t,"field1")},getField2:function(n){return Zf(n,t,"field2")},getLock:function(n){return Zf(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),Vk=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null!==n){var e=parseFloat(n[1]),o=n[2];return ct.value({value:e,unit:o})}return ct.error(t)},Pk=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return Object.prototype.hasOwnProperty.call(e,t)};return t.unit===n?D.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?D.some(t.value):D.some(t.value/e[t.unit]*e[n]):D.none()},Hk=function(t){return D.none()},zk=function(t,n){var e=Hk,o=Jr("ratio-event"),r=Rk.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:Ig("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:Ig("unlock",n.icons)}}],buttonBehaviours:Ha([Oh.config({disabled:function(){return t.disabled||n.isDisabled()}}),ev(),Kb.config({})])}),i=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(e){return Xb.parts.field({factory:gy,inputClasses:["tox-textfield"],inputBehaviours:Ha([Oh.config({disabled:function(){return t.disabled||n.isDisabled()}}),ev(),Kb.config({}),Am("size-input-events",[Jo(ro(),(function(t,n){jo(t,o,{isField1:e})})),Jo(so(),(function(n,e){jo(n,ny,{name:t.name})}))])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=Rk.parts.field1(i([Xb.parts.label(a("Width")),u(!0)])),s=Rk.parts.field2(i([Xb.parts.label(a("Height")),u(!1)]));return Rk.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){Vk(lf.getValue(t)).each((function(t){e(t).each((function(t){lf.setValue(n,function(t){var n,e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},o=t.value.toFixed((n=t.unit)in e?e[n]:1);return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+t.unit}(t))}))}))},coupledFieldBehaviours:Ha([Oh.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){Rk.getField1(t).bind(Xb.getField).each(Oh.disable),Rk.getField2(t).bind(Xb.getField).each(Oh.disable),Rk.getLock(t).each(Oh.disable)},onEnabled:function(t){Rk.getField1(t).bind(Xb.getField).each(Oh.enable),Rk.getField2(t).bind(Xb.getField).each(Oh.enable),Rk.getLock(t).each(Oh.enable)}}),ev(),Am("size-input-events2",[Jo(o,(function(t,n){var o,r,i,u,a=n.event.isField1,c=a?Rk.getField1(t):Rk.getField2(t),s=a?Rk.getField2(t):Rk.getField1(t),f=c.map(lf.getValue).getOr(""),l=s.map(lf.getValue).getOr("");o=l,e=(r=Vk(f).toOptional(),i=Vk(o).toOptional(),u=function(t,n){return Pk(t,n.unit).map((function(t){return n.value/t})).map((function(t){return function(t,n){return function(e){return Pk(e,n).map((function(e){return{value:e*t,unit:n}}))}}(t,n.unit)})).getOr(Hk)},r.isSome()&&i.isSome()?D.some(u(r.getOrDie(),i.getOrDie())):D.none()).getOr(Hk)}))])])})},Nk={undo:g(Jr("undo")),redo:g(Jr("redo")),zoom:g(Jr("zoom")),back:g(Jr("back")),apply:g(Jr("apply")),swap:g(Jr("swap")),transform:g(Jr("transform")),tempTransform:g(Jr("temp-transform")),transformApply:g(Jr("transform-apply"))},Lk=g("save-state"),jk=g("disable"),Uk=g("enable"),Wk={formActionEvent:ry,saveState:Lk,disable:jk,enable:Uk},Gk=function(t,n){var e=function(t,e,o,r){return Dg(Bk({name:t,text:t,disabled:o,primary:r,icon:D.none(),borderless:!1},e,n))},o=function(t,e,o,r){return Dg(Tk({name:t,icon:D.some(t),tooltip:D.some(e),disabled:r,primary:!1,borderless:!1},o,n))},r=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Oh)&&Oh.disable(e)}))},i=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Oh)&&Oh.enable(e)}))},u={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},a=d,c=function(t,n,e){jo(t,n,e)},s=function(t){return Lo(t,Wk.disable())},f=function(t){return Lo(t,Wk.enable())},l=function(t,n){s(t),c(t,Nk.transform(),{transform:n}),f(t)},m=function(t){return function(){tt.getOpt(t).each((function(t){Bm.set(t,[Q])}))}},p=function(t,n){s(t),c(t,Nk.transformApply(),{transform:n,swap:m(t)}),f(t)},h=function(){return e("Back",(function(t){return c(t,Nk.back(),{swap:m(t)})}),!1,!1)},v=function(){return Dg({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Ha([Oh.config({})])})},b=function(){return e("Apply",(function(t){return c(t,Nk.apply(),{swap:m(t)})}),!0,!0)},y=[h(),v(),e("Apply",(function(n){p(n,(function(n){var e=t.getRect();return ak(n,e.x,e.y,e.w,e.h)})),t.hideCrop()}),!1,!0)],x=jb.sketch({dom:u,components:y.map((function(t){return t.asSpec()})),containerBehaviours:Ha([Am("image-tools-crop-buttons-events",[Jo(Wk.disable(),(function(t,n){r(y,t)})),Jo(Wk.enable(),(function(t,n){i(y,t)}))])])}),w=Dg(zk({name:"size",label:D.none(),constrain:!0,disabled:!1},n)),S=[h(),v(),w,v(),e("Apply",(function(t){w.getOpt(t).each((function(n){var e,o,r=lf.getValue(n),i=(e=parseInt(r.width,10),o=parseInt(r.height,10),function(t){return function(t,n,e){return function(t,n,e){return t.toCanvas().then((function(o){return QS(o,n,e).then((function(n){return NS(n,t.getType())}))}))}(t,n,e)}(t,e,o)});p(t,i)}))}),!1,!0)],k=jb.sketch({dom:u,components:S.map((function(t){return t.asSpec()})),containerBehaviours:Ha([Am("image-tools-resize-buttons-events",[Jo(Wk.disable(),(function(t,n){r(S,t)})),Jo(Wk.enable(),(function(t,n){i(S,t)}))])])}),C=function(t,n){return function(e){return t(e,n)}},O=C(uk,"h"),_=C(uk,"v"),T=C(ck,-90),E=C(ck,90),B=function(t,n){!function(t,n){s(t),c(t,Nk.tempTransform(),{transform:n}),f(t)}(t,n)},A=[h(),v(),o("flip-horizontally","Flip horizontally",(function(t){B(t,O)}),!1),o("flip-vertically","Flip vertically",(function(t){B(t,_)}),!1),o("rotate-left","Rotate counterclockwise",(function(t){B(t,T)}),!1),o("rotate-right","Rotate clockwise",(function(t){B(t,E)}),!1),v(),b()],M=jb.sketch({dom:u,components:A.map((function(t){return t.asSpec()})),containerBehaviours:Ha([Am("image-tools-fliprotate-buttons-events",[Jo(Wk.disable(),(function(t,n){r(A,t)})),Jo(Wk.enable(),(function(t,n){i(A,t)}))])])}),F=function(t,e,o,r,i){var u=Gw.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),a=Gw.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),c=Gw.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Dg(Gw.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:i,getInitialValue:g({x:r})},components:[u,a,c],sliderBehaviours:Ha([Rm.config({})]),onChoose:e}))},I=function(t,n,e,o,r){return F(t,(function(t,e,o){var r=C(n,o.x/100);l(t,r)}),e,o,r)},R=function(t,n,e,o,a){var c=function(t,n,e,o,r){return[h(),I(t,n,e,o,r),b()]}(t,n,e,o,a);return jb.sketch({dom:u,components:c.map((function(t){return t.asSpec()})),containerBehaviours:Ha([Am("image-tools-filter-panel-buttons-events",[Jo(Wk.disable(),(function(t,n){r(c,t)})),Jo(Wk.enable(),(function(t,n){i(c,t)}))])])})},V=[h(),v(),b()],P=jb.sketch({dom:u,components:V.map((function(t){return t.asSpec()}))}),H=R("Brightness",rk,-100,0,100),z=R("Contrast",ik,-100,0,100),N=R("Gamma",ok,-100,0,100),L=function(t,n,e){return function(o){return function(t,n,e,o){return function(t,n,e,o){return WS(t,function(t,n,e,o){return n=LS(n,0,2),e=LS(e,0,2),o=LS(o,0,2),US([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],[n,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])}(0,n,e,o))}(t,n,e,o)}(o,t,n,e)}},j=function(t){return F(t,(function(t,n,e){var o=U.getOpt(t),r=G.getOpt(t),i=W.getOpt(t);o.each((function(n){r.each((function(e){i.each((function(o){var r=lf.getValue(n).x/100,i=lf.getValue(o).x/100,u=lf.getValue(e).x/100,a=L(r,i,u);l(t,a)}))}))}))}),0,100,200)},U=j("R"),W=j("G"),G=j("B"),X=[h(),U,W,G,b()],Y=jb.sketch({dom:u,components:X.map((function(t){return t.asSpec()}))}),q=function(t,n,e){return function(o){c(o,Nk.swap(),{transform:n,swap:function(){tt.getOpt(o).each((function(n){Bm.set(n,[t]),e(n)}))}})}},K=D.some(ek),J=D.some(nk),$=[o("crop","Crop",q(x,D.none(),(function(n){t.showCrop()})),!1),o("resize","Resize",q(k,D.none(),(function(n){w.getOpt(n).each((function(n){var e=t.getMeasurements(),o=e.width,r=e.height;lf.setValue(n,{width:o,height:r})}))})),!1),o("orientation","Orientation",q(M,D.none(),a),!1),o("brightness","Brightness",q(H,D.none(),a),!1),o("sharpen","Sharpen",q(P,K,a),!1),o("contrast","Contrast",q(z,D.none(),a),!1),o("color-levels","Color levels",q(Y,D.none(),a),!1),o("gamma","Gamma",q(N,D.none(),a),!1),o("invert","Invert",q(P,J,a),!1)],Q=jb.sketch({dom:u,components:$.map((function(t){return t.asSpec()}))}),Z=jb.sketch({dom:{tag:"div"},components:[Q],containerBehaviours:Ha([Bm.config({})])}),tt=Dg(Z);return{memContainer:tt,getApplyButton:function(t){return tt.getOpt(t).map((function(t){var n=t.components()[0];return n.components()[n.components().length-1]}))}}},Xk=tinymce.util.Tools.resolve("tinymce.geom.Rect"),Yk=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),qk=tinymce.util.Tools.resolve("tinymce.util.Observable"),Kk=tinymce.util.Tools.resolve("tinymce.util.VK"),Jk=function(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]};var $k,Qk=0,Zk=function(t,n,e,o,r){var i,u="tox-crid-"+Qk++,a=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],c=["top","right","bottom","left"],s=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},f=function(n,o,r,i){var u,a,c,f,l;u=o.x,a=o.y,c=o.w,f=o.h,u+=r*n.deltaX,a+=i*n.deltaY,(c+=r*n.deltaW)<20&&(c=20),(f+=i*n.deltaH)<20&&(f=20),l=t=Xk.clamp({x:u,y:a,w:c,h:f},e,"move"===n.name),l=s(e,l),g.fire("updateRect",{rect:l}),m(l)},l=function(t){var e=function(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),Yk("#"+u+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})};gS.each(a,(function(n){Yk("#"+u+"-"+n.name,o).css({left:t.w*n.xMul+t.x,top:t.h*n.yMul+t.y})})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)},d=function(n){l(t=n)},m=function(t){var n,o;d((n=e,{x:(o=t).x+n.x,y:o.y+n.y,w:o.w,h:o.h}))};Yk('<div id="'+u+'" class="tox-croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),gS.each(c,(function(t){Yk("#"+u,o).append('<div id="'+u+"-"+t+'"class="tox-croprect-block" style="display: none" data-mce-bogus="all">')})),gS.each(a,(function(t){Yk("#"+u,o).append('<div id="'+u+"-"+t.name+'" class="tox-croprect-handle tox-croprect-handle-'+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')})),i=gS.map(a,(function(n){var e;return function(t,n){var e,o,r,i,u=n.document||document,a=u.getElementById(n.handle||t),c=function(t){if(Jk(t),t.button!==o)return s(t);t.deltaX=t.screenX-r,t.deltaY=t.screenY-i,t.preventDefault(),n.drag(t)},s=function(t){Jk(t),Yk(u).off("mousemove touchmove",c).off("mouseup touchend",s),e.remove(),n.stop&&n.stop(t)};return Yk(a).on("mousedown touchstart",(function(t){var f,l=function(t){var n=Math.max,e=t.documentElement,o=t.body,r=n(e.scrollWidth,o.scrollWidth),i=n(e.clientWidth,o.clientWidth),u=n(e.offsetWidth,o.offsetWidth),a=n(e.scrollHeight,o.scrollHeight),c=n(e.clientHeight,o.clientHeight);return{width:r<u?i:r,height:a<n(e.offsetHeight,o.offsetHeight)?c:a}}(u);Jk(t),t.preventDefault(),o=t.button;var d=a;r=t.screenX,i=t.screenY,f=window.getComputedStyle?window.getComputedStyle(d,null).getPropertyValue("cursor"):d.runtimeStyle.cursor,e=Yk("<div></div>").css({position:"absolute",top:0,left:0,width:l.width,height:l.height,zIndex:2147483647,opacity:1e-4,cursor:f}).appendTo(u.body),Yk(u).on("mousemove touchmove",c).on("mouseup touchend",s),n.start(t)})),{destroy:function(){Yk(a).off()}}}(u,{document:o.ownerDocument,handle:u+"-"+n.name,start:function(){e=t},drag:function(t){f(n,e,t.deltaX,t.deltaY)}})})),l(t),Yk(o).on("focusin focusout",(function(t){Yk(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")})),Yk(o).on("keydown",(function(n){var e;gS.each(a,(function(t){if(n.target.id===u+"-"+t.name)return e=t,!1}));var o=function(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),f(e,o,r,i)};switch(n.keyCode){case Kk.LEFT:o(n,0,t,-10,0);break;case Kk.RIGHT:o(n,0,t,10,0);break;case Kk.UP:o(n,0,t,0,-10);break;case Kk.DOWN:o(n,0,t,0,10);break;case Kk.ENTER:case Kk.SPACEBAR:n.preventDefault(),r()}}));var g=gS.extend({toggleVisibility:function(t){var n=gS.map(a,(function(t){return"#"+u+"-"+t.name})).concat(gS.map(c,(function(t){return"#"+u+"-"+t}))).join(",");t?Yk(n,o).show():Yk(n,o).hide()},setClampRect:function(n){e=n,l(t)},setRect:d,getInnerRect:function(){return s(e,t)},setInnerRect:m,setViewPortRect:function(e){n=e,l(t)},destroy:function(){gS.each(i,(function(t){t.destroy()})),i=[]}},qk);return g},tC=function(t,n,e,o,r){return Tk({name:t,icon:D.some(n),disabled:e,tooltip:D.some(t),primary:!1,borderless:!1},o,r)},nC=function(t,n){n?Oh.enable(t):Oh.disable(t)},eC=function(t,n){var e=function(t){var n,e,o,r,i=Zn(t),u=Zn(D.none()),a=(e=-1,{data:n=[],add:function(t){var o=n.splice(++e);return n.push(t),{state:t,removed:o}},undo:function(){if(o())return n[--e]},redo:function(){if(r())return n[++e]},canUndo:o=function(){return e>0},canRedo:r=function(){return-1!==e&&e<n.length-1}});a.add(t);var c=function(t){i.set(t)},s=function(t){return{blob:t,url:URL.createObjectURL(t)}},f=function(t){URL.revokeObjectURL(t.url)},l=function(){u.get().each(f),u.set(D.none())},m=function(t){var n,e=s(t);return c(e),n=a.add(e).removed,gS.each(n,f),e.url};return{getBlobState:function(){return i.get()},setBlobState:c,addBlobState:m,getTempState:function(){return u.get().fold((function(){return i.get()}),(function(t){return t}))},updateTempState:function(t){var n=s(t);return l(),u.set(D.some(n)),n.url},addTempState:function(t){var n=s(t);return u.set(D.some(n)),n.url},applyTempState:function(t){return u.get().fold(d,(function(n){m(n.blob),t()}))},destroyTempState:l,undo:function(){var t=a.undo();return c(t),t.url},redo:function(){var t=a.redo();return c(t),t.url},getHistoryStates:function(){return{undoEnabled:a.canUndo(),redoEnabled:a.canRedo()}}}}(t.currentState),o=function(t){var n=e.getHistoryStates();m.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),jo(t,Wk.formActionEvent,{name:Wk.saveState(),value:n.undoEnabled})},r=function(t){return t.toBlob()},i=function(t){jo(t,Wk.formActionEvent,{name:Wk.disable(),value:{}})},u=function(t){g.getApplyButton(t).each((function(t){Oh.enable(t)})),jo(t,Wk.formActionEvent,{name:Wk.enable(),value:{}})},a=function(t,n){return i(t),l.updateSrc(t,n)},c=function(t,n,e,c,s){return i(t),function(t){return zS(t)}(n).then(e).then(r).then(c).then((function(n){return a(t,n).then((function(n){return o(t),s(),u(t),n}))})).catch((function(n){return console.log(n),u(t),n}))},s=function(t,n,o){var r=e.getBlobState().blob;c(t,r,n,(function(t){return e.updateTempState(t)}),o)},f=function(t){var n=e.getBlobState().url;return e.destroyTempState(),o(t),n},l=function(t){var n=Dg({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=Zn(1),o=Zn(D.none()),r=Zn({x:0,y:0,w:1,h:1}),i=Zn({x:0,y:0,w:1,h:1}),u=function(t,i){s.getOpt(t).each((function(t){var u=e.get(),a=lu(t.element),c=ou(t.element),s=i.dom.naturalWidth*u,f=i.dom.naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"};Vi(i,m),n.getOpt(t).each((function(t){Vi(t.element,m)})),o.get().each((function(t){var n=r.get();t.setRect({x:n.x*u+l,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:l,y:d,w:s,h:f}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(t,n){var o,a=ee("img");return Nr(a,"src",n),(o=a.dom,new qg((function(t){var n=function(){o.removeEventListener("load",n),t(o)};o.complete?t(o):o.addEventListener("load",n)}))).then((function(){return s.getOpt(t).map((function(t){var n=$i({element:a});Bm.replaceAt(t,1,D.some(n));var o=i.get(),c={x:0,y:0,w:a.dom.naturalWidth,h:a.dom.naturalHeight};i.set(c);var f=Xk.inflate(c,-20,-20);return r.set(f),o.w===c.w&&o.h===c.h||function(t,n){s.getOpt(t).each((function(t){var o=lu(t.element),r=ou(t.element),i=n.dom.naturalWidth,u=n.dom.naturalHeight,a=Math.min(o/i,r/u);a>=1?e.set(1):e.set(a)}))}(t,a),u(t,a),a}))}))},c=jb.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:Ha([Am("image-panel-crop-events",[rr((function(t){s.getOpt(t).each((function(t){var n=t.element.dom,i=Zk({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,d);i.toggleVisibility(!1),i.on("updateRect",(function(t){var n=t.rect,o=e.get(),i={x:Math.round(n.x/o),y:Math.round(n.y/o),w:Math.round(n.w/o),h:Math.round(n.h/o)};r.set(i)})),o.set(D.some(i))}))}))])])}],containerBehaviours:Ha([Bm.config({}),Am("image-panel-events",[rr((function(n){a(n,t)}))])])}),s=Dg(c);return{memContainer:s,updateSrc:a,zoom:function(t,n){var o=e.get(),r=n>0?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),s.getOpt(t).each((function(t){var n=t.components()[1].element;u(t,n)}))},showCrop:function(){o.get().each((function(t){t.toggleVisibility(!0)}))},hideCrop:function(){o.get().each((function(t){t.toggleVisibility(!1)}))},getRect:function(){return r.get()},getMeasurements:function(){var t=i.get();return{width:t.w,height:t.h}}}}(t.currentState.url),m=function(t){var n=Dg(tC("Undo","undo",!0,(function(t){jo(t,Nk.undo(),{direction:1})}),t)),e=Dg(tC("Redo","redo",!0,(function(t){jo(t,Nk.redo(),{direction:1})}),t));return{container:jb.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[n.asSpec(),e.asSpec(),tC("Zoom in","zoom-in",!1,(function(t){jo(t,Nk.zoom(),{direction:1})}),t),tC("Zoom out","zoom-out",!1,(function(t){jo(t,Nk.zoom(),{direction:-1})}),t)]}),updateButtonUndoStates:function(t,o,r){n.getOpt(t).each((function(t){nC(t,o)})),e.getOpt(t).each((function(t){nC(t,r)}))}}}(n),g=Gk(l,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[g.memContainer.asSpec(),l.memContainer.asSpec(),m.container],behaviours:Ha([lf.config({store:{mode:"manual",getValue:function(){return e.getBlobState()}}}),Am("image-tools-events",[Jo(Nk.undo(),(function(t,n){var r=e.undo();a(t,r).then((function(n){u(t),o(t)}))})),Jo(Nk.redo(),(function(t,n){var r=e.redo();a(t,r).then((function(n){u(t),o(t)}))})),Jo(Nk.zoom(),(function(t,n){var e=n.event.direction;l.zoom(t,e)})),Jo(Nk.back(),(function(t,n){!function(t){var n=f(t);a(t,n).then((function(n){u(t)}))}(t),(0,n.event.swap)(),l.hideCrop()})),Jo(Nk.apply(),(function(t,n){e.applyTempState((function(){f(t),(0,n.event.swap)()}))})),Jo(Nk.transform(),(function(t,n){return s(t,n.event.transform,d)})),Jo(Nk.tempTransform(),(function(t,n){return function(t,n){var o=e.getTempState().blob;c(t,o,n,(function(t){return e.addTempState(t)}),d)}(t,n.event.transform)})),Jo(Nk.transformApply(),(function(t,n){return function(t,n,o){var r=e.getBlobState().blob;c(t,r,n,(function(n){var o=e.addBlobState(n);return f(t),o}),o)}(t,n.event.transform,n.event.swap)})),Jo(Nk.swap(),(function(t,n){!function(t){m.updateButtonUndoStates(t,!1,!1)}(t);var e=n.event.transform,o=n.event.swap;e.fold((function(){o()}),(function(n){s(t,n,o)}))}))]),sS()])}},oC=function(t){return!_t(t,"items")},rC="data-value",iC=function(t,n,e,o){return L(e,(function(e){return oC(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){lf.setValue(t,e.value),jo(t,ny,{name:n}),Rm.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return iC(t,n,e.items,o)}}}))},uC=function(t,n){return it(t,(function(t){return oC(t)?hl(t.value===n,t):uC(t.items,n)}))},aC=ml({name:"HtmlSelect",configFields:[En("options"),df("selectBehaviours",[Rm,lf]),Un("selectClasses",[]),Un("selectAttributes",{}),Pn("data")],factory:function(t,n){var e=L(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),o=t.data.map((function(t){return Lt("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:gf(t.selectBehaviours,[Rm.config({}),lf.config({store:S({mode:"manual",getValue:function(t){return Gi(t.element)},setValue:function(n,e){Y(t.options,(function(t){return t.value===e})).isSome()&&Xi(n.element,e)}},o)})])}}}),cC=function(t,n){var e=t.label.map((function(t){return ty(t,n)})),o=[Oh.config({disabled:function(){return t.disabled||n.isDisabled()}}),ev(),Cm.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Lo(t,iy),D.some(!0)}}),Am("textfield-change",[Jo(co(),(function(n,e){jo(n,ny,{name:t.name})})),Jo(bo(),(function(n,e){jo(n,ny,{name:t.name})}))]),Kb.config({})],r=t.validation.map((function(t){return Iy.config({getRoot:function(t){return br(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=lf.getValue(n),o=t.validator(e);return Cy(!0===o?ct.value(e):ct.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),i=t.placeholder.fold(g({}),(function(t){return{placeholder:n.translate(t)}})),u=t.inputMode.fold(g({}),(function(t){return{inputmode:t}})),a=S(S({},i),u),c=Xb.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:a,inputClasses:[t.classname],inputBehaviours:Ha(K([o,r])),selectOnFocus:!1,factory:gy}),s=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),f=[Oh.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){Xb.getField(t).each(Oh.disable)},onEnabled:function(t){Xb.getField(t).each(Oh.enable)}}),ev()];return $b(e,c,s,f)},sC=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return Yo([Jo(t.event,e),ir((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[Jo(t,(function(){return n.cancel()}))]})).getOr([])))}}),fC=function(t){var n=Zn(null);return mi({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},lC=Object.freeze({__proto__:null,throttle:fC,init:function(t){return t.stream.streams.state(t)}}),dC=[Bn("stream",bn("mode",{throttle:[En("delay"),Un("stopEvent",!0),Zu("streams",{setup:function(t,n){var e=t.stream,o=zg(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:fC})]})),Un("event","input"),Pn("cancelEvent"),$u("onStream")],mC=Na({fields:dC,name:"streaming",active:sC,state:lC}),gC=function(t,n,e){var o=lf.getValue(e);lf.setValue(n,o),hC(n)},pC=function(t,n){var e=t.element,o=Gi(e),r=e.dom;"number"!==Lr(e,"type")&&n(r,o)},hC=function(t){pC(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},vC=g("alloy.typeahead.itemexecute"),bC=g([Pn("lazySink"),En("fetch"),Un("minChars",5),Un("responseTime",1e3),Ku("onOpen"),Un("getHotspot",D.some),Un("getAnchorOverrides",g({})),Un("layouts",D.none()),Un("eventOrder",{}),$n("model",{},[Un("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),Un("selectsOver",!0),Un("populateFromBrowse",!0)]),Ku("onSetValue"),Ju("onExecute"),Ku("onItemExecute"),Un("inputClasses",[]),Un("inputAttributes",{}),Un("inputStyles",{}),Un("matchWidth",!0),Un("useMinWidth",!1),Un("dismissOnBlur",!0),Yu(["openClass"]),Pn("initialData"),df("typeaheadBehaviours",[Rm,lf,mC,Cm,Ym,Py]),Qn("previewing",(function(){return Zn(!0)}))].concat(fy()).concat($y())),yC=g([Nf({schema:[Xu()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){(function(t,n,e){if(t.selectsOver){var o=lf.getValue(n),r=t.getDisplayText(o),i=lf.getValue(e);return 0===t.getDisplayText(i).indexOf(r)?D.some((function(){gC(0,n,e),function(t,n){pC(t,(function(t,e){return t.setSelectionRange(n,e.length)}))}(n,r.length)})):D.none()}return D.none()})(t.model,o,e).fold((function(){return Al.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&gC(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map((function(t){return jo(t,vC(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&gC(t.model,n,e)}))}}}})]),xC=gl({name:"Typeahead",configFields:bC(),partFields:yC(),factory:function(t,n,e,o){var r=function(n,e,r){t.previewing.set(!1);var i=Py.getCoupled(n,"sandbox");Ws.isOpen(i)?xl.getCurrent(i).each((function(t){Al.getHighlighted(t).fold((function(){r(t)}),(function(){Xo(i,t.element,"keydown",e)}))})):Wy(t,u(n),n,i,o,(function(t){xl.getCurrent(t).each(r)}),vy.HighlightFirst).get(d)},i=ly(t),u=function(t){return function(n){return n.map((function(n){var e=Ct(n.menus),o=J(e,(function(t){return W(t.items,(function(t){return"item"===t.type}))}));return lf.getState(t).update(L(o,(function(t){return t.data}))),n}))}},a=[Rm.config({}),lf.config({onSetValue:t.onSetValue,store:S({mode:"dataset",getDataKey:function(t){return Gi(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){Xi(n.element,t.model.getDisplayText(e))}},t.initialData.map((function(t){return Lt("initialValue",t)})).getOr({}))}),mC.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n,e){var r=Py.getCoupled(n,"sandbox");if(Rm.isFocused(n)&&Gi(n.element).length>=t.minChars){var i=xl.getCurrent(r).bind((function(t){return Al.getHighlighted(t).map(lf.getValue)}));t.previewing.set(!0),Wy(t,u(n),n,r,o,(function(n){xl.getCurrent(r).each((function(n){i.fold((function(){t.model.selectsOver&&Al.highlightFirst(n)}),(function(t){Al.highlightBy(n,(function(n){return lf.getValue(n).value===t.value})),Al.getHighlighted(n).orThunk((function(){return Al.highlightFirst(n),D.none()}))}))}))}),vy.HighlightFirst).get(d)}},cancelEvent:Oo()}),Cm.config({mode:"special",onDown:function(t,n){return r(t,n,Al.highlightFirst),D.some(!0)},onEscape:function(t){var n=Py.getCoupled(t,"sandbox");return Ws.isOpen(n)?(Ws.close(n),D.some(!0)):D.none()},onUp:function(t,n){return r(t,n,Al.highlightLast),D.some(!0)},onEnter:function(n){var e=Py.getCoupled(n,"sandbox"),o=Ws.isOpen(e);if(o&&!t.previewing.get())return xl.getCurrent(e).bind((function(t){return Al.getHighlighted(t)})).map((function(t){return jo(n,vC(),{item:t}),!0}));var r=lf.getValue(n);return Lo(n,Oo()),t.onExecute(e,n,r),o&&Ws.close(e),D.some(!0)}}),Ym.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),Py.config({others:{sandbox:function(n){return Ky(t,n,{onOpen:function(){return Ym.on(n)},onClose:function(){return Ym.off(n)}})}}}),Am("typeaheadevents",[ar((function(n){var e=d;Xy(t,u(n),n,o,e,vy.HighlightFirst).get(d)})),Jo(vC(),(function(n,e){var o=Py.getCoupled(n,"sandbox");gC(t.model,n,e.event.item),Lo(n,Oo()),t.onItemExecute(n,o,e.event.item,lf.getValue(n)),Ws.close(o),hC(n)}))].concat(t.dismissOnBlur?[Jo(vo(),(function(t){var n=Py.getCoupled(t,"sandbox");qa(n.element).isNone()&&Ws.close(n)}))]:[]))];return{uid:t.uid,dom:my(Mt(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:S(S({},i),gf(t.typeaheadBehaviours,a)),eventOrder:t.eventOrder}}}),wC=function(t){return S(S({},t),{toCached:function(){return wC(t.toCached())},bindFuture:function(n){return wC(t.bind((function(t){return t.fold((function(t){return Cy(ct.error(t))}),(function(t){return n(t)}))})))},bindResult:function(n){return wC(t.map((function(t){return t.bind(n)})))},mapResult:function(n){return wC(t.map((function(t){return t.map(n)})))},mapError:function(n){return wC(t.map((function(t){return t.mapError(n)})))},foldResult:function(n,e){return t.map((function(t){return t.fold(n,e)}))},withTimeout:function(n,e){return wC(ky((function(o){var r=!1,i=setTimeout((function(){r=!0,o(ct.error(e()))}),n);t.get((function(t){r||(clearTimeout(i),o(t))}))})))}})},SC=function(t){return wC(ky(t))},kC={type:"separator"},CC=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:d}},OC=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:d}},_C=function(t,n){return function(t){return L(t,CC)}(function(t,n){return W(n,(function(n){return n.type===t}))}(t,n))},TC=function(t){return _C("header",t.targets)},EC=function(t){return _C("anchor",t.targets)},BC=function(t){return D.from(t.anchorTop).map((function(t){return OC("<top>",t)})).toArray()},AC=function(t){return D.from(t.anchorBottom).map((function(t){return OC("<bottom>",t)})).toArray()},MC=function(t,n){var e=t.toLowerCase();return W(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return fe(n.toLowerCase(),e)||fe(t.value.toLowerCase(),e)}))},DC=Jr("aria-invalid"),FC=function(t){return function(n,e,o){return Ot(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}},IC={bar:FC((function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:L(t.items,n.interpreter)}}(t,n.shared)})),collection:FC((function(t,n){return function(t,n){var e,o,r=t.label.map((function(t){return ty(t,n)})),i=function(t){return function(n,e){Iu(e.event.target,"[data-collection-item-value]").each((function(o){t(n,e,o,Lr(o,"data-collection-item-value"))}))}},u=i((function(e,o,r,i){o.stop(),n.isDisabled()||jo(e,ry,{name:t.name,value:i})})),a=[Jo(oo(),i((function(t,n,e){Xa(e)}))),Jo(fo(),u),Jo(So(),u),Jo(ro(),i((function(t,n,e){Fu(t.element,"."+Cp).each((function(t){Oi(t,Cp)})),Ci(e,Cp)}))),Jo(io(),i((function(t){Fu(t.element,"."+Cp).each((function(t){Oi(t,Cp)}))}))),ar(i((function(n,e,o,r){jo(n,ry,{name:t.name,value:r})})))],c=function(t,n){return L($c(t.element,".tox-collection__item"),n)},s=Xb.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:p},behaviours:Ha([Oh.config({disabled:n.isDisabled,onDisabled:function(t){c(t,(function(t){Ci(t,"tox-collection__item--state-disabled"),Nr(t,"aria-disabled",!0)}))},onEnabled:function(t){c(t,(function(t){Oi(t,"tox-collection__item--state-disabled"),Wr(t,"aria-disabled")}))}}),ev(),Bm.config({}),lf.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,o){!function(e,o){var r=L(o,(function(e){var o=lh.translate(e.text),r=1===t.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,(function(t){return u[t]}));return'<div class="tox-collection__item'+(n.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+Jb.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),i="auto"!==t.columns&&t.columns>1?N(r,t.columns):[r],u=L(i,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}));Hr(e.element,u.join(""))}(e,o),"auto"===t.columns&&th(e,5,"tox-collection__item").each((function(t){var n=t.numRows,o=t.numColumns;Cm.setGridSize(e,n,o)})),Lo(e,sy)}}),Kb.config({}),Cm.config((o=t.columns,1===o?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===o?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+yp}})),Am("collection-events",a)]),eventOrder:(e={},e[xo()]=["disabling","alloy.base.behaviour","collection-events"],e)});return $b(r,s,["tox-form__group--collection"],[])}(t,n.shared.providers)})),alertbanner:FC((function(t,n){return function(t,n){return jb.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+t.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Mg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Ig(t.icon,n.icons),attributes:{title:n.translate(t.iconTooltip)}},action:function(n){jo(n,ry,{name:"alert-banner",value:t.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(t.text)}}]})}(t,n.shared.providers)})),input:FC((function(t,n){return function(t,n){return cC({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:D.none(),maximized:t.maximized},n)}(t,n.shared.providers)})),textarea:FC((function(t,n){return function(t,n){return cC({name:t.name,multiline:!0,label:t.label,inputMode:D.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:D.none(),maximized:t.maximized},n)}(t,n.shared.providers)})),label:FC((function(t,n){return function(t,n){var e={dom:{tag:"label",innerHtml:n.providers.translate(t.label),classes:["tox-label"]}},o=L(t.items,n.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:Ha([sS(),Bm.config({}),yS(D.none()),Cm.config({mode:"acyclic"})])}}(t,n.shared)})),iframe:function(t){return function(n,e,o){var r=Mt(e,{source:"dynamic"});return FC(t)(n,r,o)}}((function(t,n){return function(t,n){var e=ES&&t.sandboxed,o=S(S({},t.label.map((function(t){return{title:t}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=function(t){var n=Zn("");return{getValue:function(t){return n.get()},setValue:function(e,o){if(t)Nr(e.element,"srcdoc",o);else{Nr(e.element,"src","javascript:''");var r=e.element.dom.contentWindow.document;r.open(),r.write(o),r.close()}n.set(o)}}}(e),i=t.label.map((function(t){return ty(t,n)})),u=Xb.parts.field({factory:{sketch:function(t){return CS({uid:t.uid,dom:{tag:"iframe",attributes:o},behaviours:Ha([Kb.config({}),Rm.config({}),bS(D.none(),r.getValue,r.setValue)])})}}});return $b(i,u,["tox-form__group--stretched"],[])}(t,n.shared.providers)})),button:FC((function(t,n){return function(t,n){var e,o,r=Ak(t.name,"custom");return e=D.none(),o=Xb.parts.field(S({factory:Mg},Ek(t,D.some(r),n,[xS(""),sS()]))),$b(e,o,[],[])}(t,n.shared.providers)})),checkbox:FC((function(t,n){return function(t,n){var e=lf.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),o=function(t){return t.element.dom.click(),D.some(!0)},r=Xb.parts.field({factory:{sketch:p},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Ha([sS(),Oh.config({disabled:function(){return t.disabled||n.isDisabled()}}),Kb.config({}),Rm.config({}),e,Cm.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),Am("checkbox-events",[Jo(so(),(function(n,e){jo(n,ny,{name:t.name})}))])])}),i=Xb.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:n.translate(t.label)},behaviours:Ha([ex.config({})])}),u=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:Ig("checked"===t?"selected":"unselected",n.icons)}}},a=Dg({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[u("checked"),u("unchecked")]});return Xb.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,a.asSpec(),i],fieldBehaviours:Ha([Oh.config({disabled:function(){return t.disabled||n.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){Xb.getField(t).each(Oh.disable)},onEnabled:function(t){Xb.getField(t).each(Oh.enable)}}),ev()])})}(t,n.shared.providers)})),colorinput:FC((function(t,n){return function(t,n,e){var o=Xb.parts.field({factory:gy,inputClasses:["tox-textfield"],onSetValue:function(t){return Iy.run(t).get(d)},inputBehaviours:Ha([Oh.config({disabled:n.providers.isDisabled}),ev(),Kb.config({}),Iy.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return br(t.element)},notify:{onValid:function(t){var n=lf.getValue(t);jo(t,ox,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=lf.getValue(t);if(0===n.length)return Cy(ct.value(!0));var e=ee("span");Ri(e,"background-color",n);var o=Ni(e,"background-color").fold((function(){return ct.error("blah")}),(function(t){return ct.value(n)}));return Cy(o)}}})]),selectOnFocus:!1}),r=t.label.map((function(t){return ty(t,n.providers)})),i=function(t,n){jo(t,rx,{value:n})},u=Dg(function(t,n){return tx.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:Ha([ov(n.providers.isDisabled),ev(),ex.config({}),Kb.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:function(e){return ky((function(n){return t.fetch(n)})).map((function(o){return D.from(Cb(Mt(lb(Jr("menu-value"),o,(function(n){t.onItemAction(e,n)}),t.columns,t.presets,vp.CLOSE_ON_EXECUTE,y,n.providers),{movement:mb(t.columns,t.presets)})))}))},parts:{menu:Fp(0,0,t.presets)}})}({dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[xa,ya,Ca]},onLtr:function(){return[ya,xa,Ca]}},components:[],fetch:ub(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(t,n){u.getOpt(t).each((function(t){"custom"===n?e.colorPicker((function(n){n.fold((function(){return Lo(t,ix)}),(function(n){i(t,n),eb(n)}))}),"#ffffff"):i(t,"remove"===n?"":n)}))}},n));return Xb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,u.asSpec()]}]),fieldBehaviours:Ha([Am("form-field-events",[Jo(ox,(function(n,e){u.getOpt(n).each((function(t){Ri(t.element,"background-color",e.event.color)})),jo(n,ny,{name:t.name})})),Jo(rx,(function(t,n){Xb.getField(t).each((function(e){lf.setValue(e,n.event.value),xl.getCurrent(t).each(Rm.focus)}))})),Jo(ix,(function(t,n){Xb.getField(t).each((function(n){xl.getCurrent(t).each(Rm.focus)}))}))])])})}(t,n.shared,n.colorinput)})),colorpicker:FC((function(t){var n=function(t){return"tox-"+t},e=cS(dS,n),o=Dg(e.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(t){jo(t,ry,{name:"hex-valid",value:!0})},onInvalidHex:function(t){jo(t,ry,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:Ha([lf.config({store:{mode:"manual",getValue:function(t){var n=o.get(t);return xl.getCurrent(n).bind((function(t){return lf.getValue(t).hex})).map((function(t){return"#"+t})).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),r=o.get(t);xl.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(t){lf.setValue(t,{hex:D.from(e[1]).getOr("")}),eS.getField(t,"hex").each((function(t){Lo(t,co())}))}))}}}),sS()])}})),dropzone:FC((function(t,n){return function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){j(t,(function(t){t(n,e)}))}},r=function(t,n){if(!Oh.isDisabled(t)){var e=n.event.raw;u(t,e.dataTransfer.files)}},i=function(t,n){var e=n.event.raw.target;u(t,e.files)},u=function(e,o){lf.setValue(e,function(t,n){var e=gS.explode(n.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"));return W(rt(t),(function(t){return H(e,(function(n){return le(t.name.toLowerCase(),"."+n.toLowerCase())}))}))}(o,n)),jo(e,ny,{name:t.name})},a=Dg({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Ha([Am("input-file-events",[nr(fo()),nr(So())])])}),c=t.label.map((function(t){return ty(t,n)})),s=Xb.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Ha([xS([]),sS(),Oh.config({}),Ym.config({toggleClass:"dragenter",toggleOnExecute:!1}),Am("dropzone-events",[Jo("dragenter",o([e,Ym.toggle])),Jo("dragleave",o([e,Ym.toggle])),Jo("dragover",e),Jo("drop",o([e,r])),Jo(so(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},Mg.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:Ha([Kb.config({}),ov(n.isDisabled),ev()])})]}]}}}});return $b(c,s,["tox-form__group--stretched"],[])}(t,n.shared.providers)})),grid:FC((function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:L(t.items,n.interpreter)}}(t,n.shared)})),listbox:FC((function(t,n){return function(t,n){var e=n.shared.providers,o=et(t.items).filter(oC),r=t.label.map((function(t){return ty(t,e)})),i={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Xb.parts.field({dom:{},factory:{sketch:function(e){return vk({uid:e.uid,text:o.map((function(t){return t.text})),icon:D.none(),tooltip:t.label,role:D.none(),fetch:function(e,o){var r=iC(e,t.name,t.items,lf.getValue(e));o(wk(r,vp.CLOSE_ON_EXECUTE,n,!1))},onSetup:g(d),getApi:g({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Kb.config({}),lf.config({store:{mode:"manual",initialValue:o.map((function(t){return t.value})).getOr(""),getValue:function(t){return Lr(t.element,rC)},setValue:function(n,e){uC(t.items,e).each((function(t){Nr(n.element,rC,t.value),jo(n,pk,{text:t.text})}))}}})]},"tox-listbox",n.shared)}}})]};return Xb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:K([r.toArray(),[i]]),fieldBehaviours:Ha([Oh.config({disabled:g(t.disabled),onDisabled:function(t){Xb.getField(t).each(Oh.disable)},onEnabled:function(t){Xb.getField(t).each(Oh.enable)}})])})}(t,n)})),selectbox:FC((function(t,n){return function(t,n){var e=L(t.items,(function(t){return{text:n.translate(t.text),value:t.value}})),o=t.label.map((function(t){return ty(t,n)})),r=Xb.parts.field({dom:{},selectAttributes:{size:t.size},options:e,factory:aC,selectBehaviours:Ha([Oh.config({disabled:function(){return t.disabled||n.isDisabled()}}),Kb.config({}),Am("selectbox-change",[Jo(so(),(function(n,e){jo(n,ny,{name:t.name})}))])])}),i=t.size>1?D.none():D.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:Ig("chevron-down",n.icons)}}),u={dom:{tag:"div",classes:["tox-selectfield"]},components:K([[r],i.toArray()])};return Xb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:K([o.toArray(),[u]]),fieldBehaviours:Ha([Oh.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){Xb.getField(t).each(Oh.disable)},onEnabled:function(t){Xb.getField(t).each(Oh.enable)}}),ev()])})}(t,n.shared.providers)})),sizeinput:FC((function(t,n){return zk(t,n.shared.providers)})),urlinput:FC((function(t,n){return function(t,n,e){var o,r=n.shared.providers,i=function(n){var o=lf.getValue(n);e.addToHistory(o.value,t.filetype)},u=Xb.parts.field({factory:xC,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":DC,type:"url"},minChars:0,responseTime:0,fetch:function(o){var r=function(t,n,e){var o=lf.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value;return e.getLinkInformation().fold((function(){return[]}),(function(n){var o,i=MC(r,function(t){return L(t,(function(t){return OC(t,t)}))}(e.getHistory(t)));return"file"===t?(o=[i,MC(r,TC(n)),MC(r,K([BC(n),EC(n),AC(n)]))],X(o,(function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(kC,n)}),[])):i}))}(t.filetype,o,e),i=wk(r,vp.BUBBLE_TO_SANDBOX,n,!1);return Cy(i)},getHotspot:function(t){return m.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(Iy)&&Iy.run(t).get(d)},typeaheadBehaviours:Ha(K([e.getValidationHandler().map((function(n){return Iy.config({getRoot:function(t){return br(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){c.getOpt(t).each((function(t){Nr(t.element,"title",r.translate(n))}))}},validator:{validate:function(e){var o=lf.getValue(e);return SC((function(e){n({type:t.filetype,url:o.value},(function(t){if("invalid"===t.status){var n=ct.error(t.message);e(n)}else{var o=ct.value(t.message);e(o)}}))}))},validateOnLoad:!1}})})).toArray(),[Oh.config({disabled:function(){return t.disabled||r.isDisabled()}}),Kb.config({}),Am("urlinput-events",K(["file"===t.filetype?[Jo(co(),(function(n){jo(n,ny,{name:t.name})}))]:[],[Jo(so(),(function(n){jo(n,ny,{name:t.name}),i(n)})),Jo(bo(),(function(n){jo(n,ny,{name:t.name}),i(n)}))]]))]])),eventOrder:(o={},o[co()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Fp(0,0,"normal")},onExecute:function(t,n,e){jo(n,iy,{})},onItemExecute:function(n,e,o,r){i(n),jo(n,ny,{name:t.name})}}),a=t.label.map((function(t){return ty(t,r)})),c=Dg(function(t,n,e,o){return void 0===e&&(e=t),void 0===o&&(o=t),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],innerHtml:Ig(e,r.icons),attributes:S({title:r.translate(o),"aria-live":"polite"},n.fold((function(){return{}}),(function(t){return{id:t}})))}}}("invalid",D.some(DC),"warning")),s=Dg({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[c.asSpec()]}),f=e.getUrlPicker(t.filetype),l=Jr("browser.url.event"),m=Dg({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,s.asSpec()],behaviours:Ha([Oh.config({disabled:function(){return t.disabled||r.isDisabled()}})])}),g=Dg(Bk({name:t.name,icon:D.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(t){return Lo(t,l)}),r,[],["tox-browse-url"]));return Xb.sketch({dom:Zb([]),components:a.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:K([[m.asSpec()],f.map((function(){return g.asSpec()})).toArray()])}]),fieldBehaviours:Ha([Oh.config({disabled:function(){return t.disabled||r.isDisabled()},onDisabled:function(t){Xb.getField(t).each(Oh.disable),g.getOpt(t).each(Oh.disable)},onEnabled:function(t){Xb.getField(t).each(Oh.enable),g.getOpt(t).each(Oh.enable)}}),ev(),Am("url-input-events",[Jo(l,(function(n){xl.getCurrent(n).each((function(e){var o=lf.getValue(e),r=S({fieldname:t.name},o);f.each((function(o){o(r).get((function(o){lf.setValue(e,o),jo(n,ny,{name:t.name})}))}))}))}))])])})}(t,n,n.urlinput)})),customeditor:FC((function(t){var n=Zn(D.none()),e=Dg({dom:{tag:t.tag}}),o=Zn(D.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Ha([Am("custom-editor-events",[rr((function(r){e.getOpt(r).each((function(e){(!function(t){return Object.prototype.hasOwnProperty.call(t,"init")}(t)?mS.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element.dom,t.settings)})):t.init(e.element.dom)).then((function(t){o.get().each((function(n){t.setValue(n)})),o.set(D.none()),n.set(D.some(t))}))}))}))]),lf.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(D.some(e))}),(function(t){return t.setValue(e)}))}}}),sS()]),components:[e.asSpec()]}})),htmlpanel:FC((function(t){return"presentation"===t.presets?jb.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):jb.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:Ha([Kb.config({}),Rm.config({})])})})),imagetools:FC((function(t,n){return eC(t,n.shared.providers)})),table:FC((function(t,n){return function(t,n){var e,o,r=function(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(o=t.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:L(o,(function(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}}))}]}),(e=t.cells,{dom:{tag:"tbody"},components:L(e,(function(t){return{dom:{tag:"tr"},components:L(t,r)}}))})],behaviours:Ha([Kb.config({}),Rm.config({})])}}(t,n.shared.providers)})),panel:FC((function(t,n){return function(t,n){return{dom:{tag:"div",classes:t.classes},components:L(t.items,n.shared.interpreter)}}(t,n)}))},RC={field:function(t,n){return n}},VC=function(t,n,e){var o=Mt(e,{shared:{interpreter:function(n){return PC(t,n,o)}}});return PC(t,n,o)},PC=function(t,n,e){return Ot(IC,n.type).fold((function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(o){return o(t,n,e)}))},HC={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},zC=function(t,n,e){var o=pc(-12,12,HC),r={maxHeightFunction:lc()};return function(){return e()?{anchor:"node",root:_r(t()),node:D.from(t()),bubble:o,layouts:{onRtl:function(){return[Tg]},onLtr:function(){return[_g]}},overrides:r}:{anchor:"hotspot",hotspot:n(),bubble:o,layouts:{onRtl:function(){return[ya]},onLtr:function(){return[xa]}},overrides:r}}},NC=function(t,n,e){return function(){return e()?{anchor:"node",root:_r(t()),node:D.from(t()),layouts:{onRtl:function(){return[Eg]},onLtr:function(){return[Eg]}}}:{anchor:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[Ca]},onLtr:function(){return[Ca]}}}}},LC=function(t,n){return function(){return{anchor:"selection",root:n(),getSelection:function(){var n=t.selection.getRng();return D.some(Lc.range(re(n.startContainer),n.startOffset,re(n.endContainer),n.endOffset))}}}},jC=function(t){return function(n){return{anchor:"node",root:t(),node:n}}},UC=function(t,n,e){var o=Wh(t),r=function(){return re(t.getBody())},i=function(){return re(t.getContentAreaContainer())},u=function(){return o||!e()};return{inlineDialog:zC(i,n,u),banner:NC(i,n,u),cursor:LC(t,r),node:jC(r)}},WC=function(t){return function(n,e){fb(t)(n,e)}},GC=function(t){return function(){return tb(t)}},XC=function(t){return function(){return nb(t)}},YC=function(t){return function(){return ob(t)}},qC=function(t){return{colorPicker:WC(t),hasCustomColors:GC(t),getColors:XC(t),getColorCols:YC(t)}},KC=function(t){return function(){return function(t){return t.getParam("draggable_modal",!1,"boolean")}(t)}},JC=function(t){return{isDraggableModal:KC(t)}},$C=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],QC=function(t){return X(t,(function(t,n){if(_t(n,"items")){var e=QC(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(_t(n,"inline")||function(t){return _t(t,"block")}(n)||function(t){return _t(t,"selector")}(n)){var r="custom-"+(o(n.name)?n.name:n.title.toLowerCase());return{customFormats:t.customFormats.concat([{name:r,format:n}]),formats:t.formats.concat([{title:n.title,format:r,icon:n.icon}])}}return S(S({},t),{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},ZC=function(t){return function(t){return D.from(t.getParam("style_formats")).filter(i)}(t).map((function(n){var e=function(t,n){var e=QC(n),o=function(n){j(n,(function(n){t.formatter.has(n.name)||t.formatter.register(n.name,n.format)}))};return t.formatter?o(e.customFormats):t.on("init",(function(){o(e.customFormats)})),e.formats}(t,n);return function(t){return t.getParam("style_formats_merge",!1,"boolean")}(t)?$C.concat(e):e})).getOr($C)},tO=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return Mt(t,o)},nO=function(t,n,e,r){var i=function(n){return L(n,(function(n){var u=vt(n);if(Tt(n,"items")){var a=i(n.items);return Mt(function(t){return Mt(t,{type:"submenu"})}(n),{getStyleItems:function(){return a}})}return Tt(n,"format")?function(t){return tO(t,e,r)}(n):1===u.length&&P(u,"title")?Mt(n,{type:"separator"}):function(n){var i=o(n.name)?n.name:Jr(n.title),u="custom-"+i,a={type:"formatter",format:u,isSelected:e(u),getStylePreview:r(u)},c=Mt(n,a);return t.formatter.register(i,c),c}(n)}))};return i(n)},eO=function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?D.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):D.none()}},o=function(t){var n=t.items;return void 0!==n&&n.length>0?J(n,o):[t.format]},r=Zn([]),i=Zn([]),u=Zn([]),a=Zn([]),c=Zn(!1);return t.on("PreInit",(function(u){var a=ZC(t),c=nO(t,a,n,e);r.set(c),i.set(J(c,o))})),t.on("addStyleModifications",(function(r){var i=nO(t,r.items,n,e);u.set(i),c.set(r.replace),a.set(J(i,o))})),{getData:function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)}}},oO=gS.trim,rO=function(t){return function(n){if(function(t){return c(t)&&1===t.nodeType}(n)){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},iO=rO("true"),uO=rO("false"),aO=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},cO=function(t){return t.innerText||t.textContent},sO=function(t){return function(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)}(t)&&lO(t)},fO=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},lO=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return iO(t)}return!1}(t)&&!uO(t)},dO=function(t){return fO(t)&&lO(t)},mO=function(t){var n=function(t){return t.id?t.id:Jr("h")}(t);return aO("header",cO(t),"#"+n,function(t){return fO(t)?parseInt(t.nodeName.substr(1),10):0}(t),(function(){t.id=n}))},gO=function(t){var n=t.id||t.name,e=cO(t);return aO("anchor",e||"#"+n,"#"+n,0,d)},pO=function(t){return oO(t.title).length>0},hO=function(t){var n=function(t){return L($c(re(t),"h1,h2,h3,h4,h5,h6,a:not([href])"),(function(t){return t.dom}))}(t);return W(function(t){return L(W(t,dO),mO)}(n).concat(function(t){return L(W(t,sO),gO)}(n)),pO)},vO="tinymce-url-history",bO=function(t){return o(t)&&/^https?/.test(t)},yO=function(t){return r(t)&&kt(t,(function(t){return!(i(n=t)&&n.length<=5&&$(n,bO));var n})).isNone()},xO=function(){var t,n=Kv.getItem(vO);if(null===n)return{};try{t=JSON.parse(n)}catch(t){if(t instanceof SyntaxError)return console.log("Local storage "+vO+" was not valid JSON",t),{};throw t}return yO(t)?t:(console.log("Local storage "+vO+" was not valid format",t),{})},wO=function(t){var n=xO();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},SO=function(t,n){if(bO(t)){var e=xO(),o=Object.prototype.hasOwnProperty.call(e,n)?e[n]:[],r=W(o,(function(n){return n!==t}));e[n]=[t].concat(r).slice(0,5),function(t){if(!yO(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));Kv.setItem(vO,JSON.stringify(t))}(e)}},kO=function(t){return!!t},CO=function(t){return xt(gS.makeMap(t,/[, ]/),kO)},OO=function(t){return D.from(function(t){return t.getParam("file_picker_callback")}(t)).filter(s)},_O=function(t){return D.from(t).filter(o).getOrUndefined()},TO=function(t){return{getHistory:wO,addToHistory:SO,getLinkInformation:function(){return function(t){return function(t){return!1===t.getParam("typeahead_urls")}(t)?D.none():D.some({targets:hO(t.getBody()),anchorTop:_O(Jh(t)),anchorBottom:_O($h(t))})}(t)},getValidationHandler:function(){return function(t){return D.from(function(t){var n=t.getParam("file_picker_validator_handler",void 0,"function");return void 0===n?t.getParam("filepicker_validator_handler",void 0,"function"):n}(t))}(t)},getUrlPicker:function(n){return function(t,n){return function(t,n){var e=function(t){var n=D.some(function(t){return t.getParam("file_picker_types")}(t)).filter(kO),e=D.some(function(t){return t.getParam("file_browser_callback_types")}(t)).filter(kO),o=n.or(e).map(CO);return OO(t).fold(y,(function(t){return o.fold(x,(function(t){return vt(t).length>0&&t}))}))}(t);return u(e)?e?OO(t):D.none():e[n]?OO(t):D.none()}(t,n).map((function(e){return function(i){return ky((function(u){var a=S({filetype:n,fieldname:i.fieldname},D.from(i.meta).getOr({}));e.call(t,(function(t,n){if(!o(t))throw new Error("Expected value to be string");if(void 0!==n&&!r(n))throw new Error("Expected meta to be a object");u({value:t,meta:n})}),i.value,a)}))}}))}(t,n)}}},EO=g((function(t,n){!function(t,n){var e=fu.max(t,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);Ri(t,"max-width",e+"px")}(t,Math.floor(n))})),BO="contexttoolbar-hide",AO=g([En("dom"),Un("shell",!0),df("toolbarBehaviours",[Bm])]),MO=g([Lf({name:"groups",overrides:function(){return{behaviours:Ha([Bm.config({})])}}})]),DO=gl({name:"Toolbar",configFields:AO(),partFields:MO(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[Bm.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:gf(t.toolbarBehaviours,r.behaviours),apis:{setGroups:function(n,e){var o;(o=n,t.shell?D.some(o):Zf(o,t,"groups")).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){Bm.set(t,e)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),FO=function(t,n,e){return{within:t,extra:n,withinWidth:e}},IO=function(t,n,e){var o,r=(o=function(t,n){var o=e(t);return D.some({element:t,start:n,finish:n+o,width:o})},X(t,(function(t,n){return o(n,t.len).fold(g(t),(function(n){return{len:n.finish,list:t.list.concat([n])}}))}),{len:0,list:[]}).list),i=W(r,(function(t){return t.finish<=n})),u=G(i,(function(t,n){return t+n.width}),0);return{within:i,extra:r.slice(i.length),withinWidth:u}},RO=function(t){return L(t,(function(t){return t.element}))},VO=function(t,n){var e=L(n,(function(t){return tu(t)}));DO.setGroups(t,e)},PO=function(t,n,e){var o=tl(t,n,"primary"),r=Py.getCoupled(t,"overflowGroup");Ri(o.element,"visibility","hidden");var i=n.builtGroups.get().concat([r]),u=it(i,(function(t){return qa(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}));e([]),VO(o,i);var a=function(t,n,e,o){var r=function(t,n,e){var o=IO(n,t,e);return 0===o.extra.length?D.some(o):D.none()}(t,n,e).getOrThunk((function(){return IO(n,t-e(o),e)})),i=r.within,u=r.extra,a=r.withinWidth;return 1===u.length&&u[0].width<=e(o)?function(t,n,e){var o=RO(t.concat(n));return FO(o,[],e)}(i,u,a):u.length>=1?function(t,n,e,o){var r=RO(t).concat([e]);return FO(r,RO(n),o)}(i,u,o,a):function(t,n,e){return FO(RO(t),[],e)}(i,0,a)}(lu(o.element),n.builtGroups.get(),(function(t){return lu(t.element)}),r);0===a.extra.length?(Bm.remove(o,r),e([])):(VO(o,a.within),e(a.extra)),Ui(o.element,"visibility"),Wi(o.element),u.each(Rm.focus)},HO=g([df("splitToolbarBehaviours",[Py]),Qn("builtGroups",(function(){return Zn([])}))]),zO=g([Yu(["overflowToggledClass"]),Ln("getOverflowBounds"),En("lazySink"),Qn("overflowGroups",(function(){return Zn([])}))].concat(HO())),NO=g([zf({factory:DO,schema:AO(),name:"primary"}),Nf({schema:AO(),name:"overflow"}),Nf({name:"overflow-button"}),Nf({name:"overflow-group"})]),LO=g([Yu(["toggledClass"]),En("lazySink"),Fn("fetch"),Ln("getBounds"),jn("fireDismissalEventInstead",[Un("event",Fo())]),Sc()]),jO=g([Nf({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Ha([Ym.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Nf({factory:DO,schema:AO(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:Ha([Cm.config({mode:"cyclic",onEscape:function(n){return Zf(n,t,"button").each(Rm.focus),D.none()}})])}}})]),UO=function(t,n){var e=Py.getCoupled(t,"toolbarSandbox");Ws.isOpen(e)?Ws.close(e):Ws.open(e,n.toolbar())},WO=function(t,n,e,o){var r=e.getBounds.map((function(t){return t()})),i=e.lazySink(t).getOrDie();Ss.positionWithinBounds(i,{anchor:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:EO()}},n,r)},GO=function(t,n,e,o,r){DO.setGroups(n,r),WO(t,n,e,o),Ym.on(t)},XO=gl({name:"FloatingToolbarButton",factory:function(t,n,e,o){return S(S({},Mg.sketch(S(S({},o.button()),{action:function(t){UO(t,o)},buttonBehaviours:hf({dump:o.button().buttonBehaviours},[Py.config({others:{toolbarSandbox:function(n){return function(t,n,e){var o=Ru();return{dom:{tag:"div",attributes:{id:o.id}},behaviours:Ha([Cm.config({mode:"special",onEscape:function(t){return Ws.close(t),D.some(!0)}}),Ws.config({onOpen:function(r,i){e.fetch().get((function(r){GO(t,i,e,n.layouts,r),o.link(t.element),Cm.focusIn(i)}))},onClose:function(){Ym.off(t),Rm.focus(t),o.unlink(t.element)},isPartOf:function(n,e,o){return Vu(e,o)||Vu(t,o)},getAttachPoint:function(){return e.lazySink(t).getOrDie()}}),Wa.config({channels:S(S({},Ks(S({isExtraPart:y},e.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),$s({doReposition:function(){Ws.getState(Py.getCoupled(t,"toolbarSandbox")).each((function(o){WO(t,o,e,n.layouts)}))}}))})])}}(n,e,t)}}})])}))),{apis:{setGroups:function(n,o){Ws.getState(Py.getCoupled(n,"toolbarSandbox")).each((function(r){GO(n,r,t,e.layouts,o)}))},reposition:function(n){Ws.getState(Py.getCoupled(n,"toolbarSandbox")).each((function(o){WO(n,o,t,e.layouts)}))},toggle:function(t){UO(t,o)},getToolbar:function(t){return Ws.getState(Py.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return Ws.isOpen(Py.getCoupled(t,"toolbarSandbox"))}}})},configFields:LO(),partFields:jO(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),YO=g([En("items"),Yu(["itemSelector"]),df("tgroupBehaviours",[Cm])]),qO=g([jf({name:"items",unit:"item"})]),KO=gl({name:"ToolbarGroup",configFields:YO(),partFields:qO(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:gf(t.tgroupBehaviours,[Cm.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),JO=function(t){return L(t,(function(t){return tu(t)}))},$O=function(t,n,e){PO(t,e,(function(o){e.overflowGroups.set(o),n.getOpt(t).each((function(t){XO.setGroups(t,JO(o))}))}))},QO=gl({name:"SplitFloatingToolbar",configFields:zO(),partFields:NO(),factory:function(t,n,e,o){var r=Dg(XO.sketch({fetch:function(){return ky((function(n){n(JO(t.overflowGroups.get()))}))},layouts:{onLtr:function(){return[xa,ya]},onRtl:function(){return[ya,xa]},onBottomLtr:function(){return[Sa,wa]},onBottomRtl:function(){return[wa,Sa]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:gf(t.splitToolbarBehaviours,[Py.config({others:{overflowGroup:function(){return KO.sketch(S(S({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(L(e,n.getSystem().build)),$O(n,r,t)},refresh:function(n){return $O(n,r,t)},toggle:function(t){r.getOpt(t).each((function(t){XO.toggle(t)}))},isOpen:function(t){return r.getOpt(t).map(XO.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each((function(t){XO.reposition(t)}))},getOverflow:function(t){return r.getOpt(t).bind(XO.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),ZO=function(t,n){return n.getAnimationRoot.fold((function(){return t.element}),(function(n){return n(t)}))},t_=function(t){return t.dimension.property},n_=function(t,n){return t.dimension.getDimension(n)},e_=function(t,n){var e=ZO(t,n);Ei(e,[n.shrinkingClass,n.growingClass])},o_=function(t,n){Oi(t.element,n.openClass),Ci(t.element,n.closedClass),Ri(t.element,t_(n),"0px"),Wi(t.element)},r_=function(t,n){Oi(t.element,n.closedClass),Ci(t.element,n.openClass),Ui(t.element,t_(n))},i_=function(t,n,e,o){e.setCollapsed(),Ri(t.element,t_(n),n_(n,t.element)),Wi(t.element),e_(t,n),o_(t,n),n.onStartShrink(t),n.onShrunk(t)},u_=function(t,n,e,o){var r=o.getOrThunk((function(){return n_(n,t.element)}));e.setCollapsed(),Ri(t.element,t_(n),r),Wi(t.element);var i=ZO(t,n);Oi(i,n.growingClass),Ci(i,n.shrinkingClass),o_(t,n),n.onStartShrink(t)},a_=function(t,n,e){var o=n_(n,t.element);("0px"===o?i_:u_)(t,n,e,D.some(o))},c_=function(t,n,e){var o=ZO(t,n),r=_i(o,n.shrinkingClass),i=n_(n,t.element);r_(t,n);var u=n_(n,t.element);(r?function(){Ri(t.element,t_(n),i),Wi(t.element)}:function(){o_(t,n)})(),Oi(o,n.shrinkingClass),Ci(o,n.growingClass),r_(t,n),Ri(t.element,t_(n),u),e.setExpanded(),n.onStartGrow(t)},s_=function(t,n,e){var o=ZO(t,n);return!0===_i(o,n.growingClass)},f_=function(t,n,e){var o=ZO(t,n);return!0===_i(o,n.shrinkingClass)},l_=Object.freeze({__proto__:null,refresh:function(t,n,e){if(e.isExpanded()){Ui(t.element,t_(n));var o=n_(n,t.element);Ri(t.element,t_(n),o)}},grow:function(t,n,e){e.isExpanded()||c_(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&a_(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&i_(t,n,e,D.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:s_,isShrinking:f_,isTransitioning:function(t,n,e){return s_(t,n)||f_(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?a_:c_)(t,n,e)},disableTransitions:e_}),d_=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded;return pi(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:Lt(n.dimension.property,"0px")})},events:function(t,n){return Yo([or(lo(),(function(e,o){o.event.raw.propertyName===t.dimension.property&&(e_(e,t),n.isExpanded()&&Ui(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))}))])}}),m_=[En("closedClass"),En("openClass"),En("shrinkingClass"),En("growingClass"),Pn("getAnimationRoot"),Ku("onShrunk"),Ku("onStartShrink"),Ku("onGrown"),Ku("onStartGrow"),Un("expanded",!1),Bn("dimension",bn("property",{width:[Zu("property","width"),Zu("getDimension",(function(t){return lu(t)+"px"}))],height:[Zu("property","height"),Zu("getDimension",(function(t){return ou(t)+"px"}))]}))],g_=Na({fields:m_,name:"sliding",active:d_,apis:l_,state:Object.freeze({__proto__:null,init:function(t){var n=Zn(t.expanded);return mi({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:h(n.set,!1),setExpanded:h(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),p_=g([Yu(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Ku("onOpened"),Ku("onClosed")].concat(HO())),h_=g([zf({factory:DO,schema:AO(),name:"primary"}),zf({factory:DO,schema:AO(),name:"overflow",overrides:function(t){return{toolbarBehaviours:Ha([g_.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){Zf(n,t,"overflow-button").each((function(t){Ym.off(t),Rm.focus(t)})),t.onClosed(n)},onGrown:function(n){Cm.focusIn(n),t.onOpened(n)},onStartGrow:function(n){Zf(n,t,"overflow-button").each(Ym.on)}}),Cm.config({mode:"acyclic",onEscape:function(n){return Zf(n,t,"overflow-button").each(Rm.focus),D.some(!0)}})])}}}),Nf({name:"overflow-button",overrides:function(t){return{buttonBehaviours:Ha([Ym.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Nf({name:"overflow-group"})]),v_=function(t,n){Zf(t,n,"overflow-button").bind((function(){return Zf(t,n,"overflow")})).each((function(e){b_(t,n),g_.toggleGrow(e)}))},b_=function(t,n){Zf(t,n,"overflow").each((function(e){PO(t,n,(function(t){var n=L(t,(function(t){return tu(t)}));DO.setGroups(e,n)})),Zf(t,n,"overflow-button").each((function(t){g_.hasGrown(e)&&Ym.on(t)})),g_.refresh(e)}))},y_=gl({name:"SplitSlidingToolbar",configFields:p_(),partFields:h_(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle";return{uid:t.uid,dom:t.dom,components:n,behaviours:gf(t.splitToolbarBehaviours,[Py.config({others:{overflowGroup:function(t){return KO.sketch(S(S({},o["overflow-group"]()),{items:[Mg.sketch(S(S({},o["overflow-button"]()),{action:function(n){Lo(t,r)}}))]}))}}}),Am("toolbar-toggle-events",[Jo(r,(function(n){v_(n,t)}))])]),apis:{setGroups:function(n,e){!function(n,e){var o=L(e,n.getSystem().build);t.builtGroups.set(o)}(n,e),b_(n,t)},refresh:function(n){return b_(n,t)},toggle:function(n){return v_(n,t)},isOpen:function(n){return function(t,n){return Zf(t,n,"overflow").map(g_.hasGrown).getOr(!1)}(n,t)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),x_=g(Jr("toolbar-height-change")),w_=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:S({tag:"div",classes:["tox-toolbar__group"]},n),components:[KO.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Ha([Kb.config({}),Rm.config({})])}},S_=function(t){return KO.sketch(w_(t))},k_=function(t,n){var e=rr((function(n){var e=L(t.initGroups,S_);DO.setGroups(n,e)}));return Ha([iv(t.providers.isDisabled),ev(),Cm.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),Am("toolbar-events",[e])])},C_=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":w_({title:D.none(),items:[]}),"overflow-button":_k({name:"more",icon:D.some("more-drawer"),disabled:!1,tooltip:D.some("More..."),primary:!1,borderless:!1},D.none(),t.providers)},splitToolbarBehaviours:k_(t,n)}},O_=function(t){var n=C_(t),e=QO.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return QO.sketch(S(S({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=Ou(n),o=hr(n),r=Ou(o),i=Math.max(o.dom.scrollHeight,r.height);return ku(e.x+4,r.y,e.width-8,i)},parts:S(S({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},__=function(t){var n=y_.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=y_.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=C_(t);return y_.sketch(S(S({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([x_()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([x_()],{type:"closed"})}}))},T_=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return DO.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===hp.scrolling?["tox-toolbar--scrolling"]:[])},components:[DO.parts.groups({})],toolbarBehaviours:k_(t,n)})},E_=Zt([Mn("type"),Bn("items",nn([sn([Mn("name"),Vn("items",Sn)]),Sn]))].concat(ep)),B_=[Nn("text"),Nn("tooltip"),Nn("icon"),Fn("fetch"),Kn("onSetup",(function(){return d}))],A_=Zt(C([Mn("type")],B_)),M_=function(t){return mn("menubutton",A_,t)},D_=Zt([Mn("type"),Nn("tooltip"),Nn("icon"),Nn("text"),Ln("select"),Fn("fetch"),Kn("onSetup",(function(){return d})),Yn("presets","normal",["normal","color","listpreview"]),Un("columns",1),Fn("onAction"),Fn("onItemAction")]),F_=Object.freeze({__proto__:null,events:function(t,n){var e=function(e,o){t.updateState.each((function(t){var r=t(e,o);n.set(r)})),t.renderComponents.each((function(t){var r=t(o,n.get()),i=L(r,e.getSystem().build);_s(e,i)}))};return Yo([Jo(yo(),(function(n,o){var r=o;if(!r.universal){var i=t.channel;P(r.channels,i)&&e(n,r.data)}})),rr((function(n,o){t.initialData.each((function(t){e(n,t)}))}))])}}),I_=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),R_=[En("channel"),Pn("renderComponents"),Pn("updateState"),Pn("initialData")],V_=Na({fields:R_,name:"reflecting",active:F_,apis:I_,state:Object.freeze({__proto__:null,init:function(){var t=Zn(D.none());return{readState:function(){return t.get().fold((function(){return"none"}),(function(t){return t}))},get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(D.none())}}}})}),P_=g([En("toggleClass"),En("fetch"),$u("onExecute"),Un("getHotspot",D.some),Un("getAnchorOverrides",g({})),Sc(),$u("onItemExecute"),Pn("lazySink"),En("dom"),Ku("onOpen"),df("splitDropdownBehaviours",[Py,Cm,Rm]),Un("matchWidth",!1),Un("useMinWidth",!1),Un("eventOrder",{}),Pn("role")].concat($y())),H_=zf({factory:Mg,schema:[En("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:Ha([Rm.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(Uo)},buttonBehaviours:Ha([Ym.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),z_=zf({factory:Mg,schema:[En("dom")],name:"button",defaults:function(){return{buttonBehaviours:Ha([Rm.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),N_=g([H_,z_,Lf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[En("text")],name:"aria-descriptor"}),Nf({schema:[Xu()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),zy()]),L_=gl({name:"SplitDropdown",configFields:P_(),partFields:N_(),factory:function(t,n,e,o){var r,i=function(t){xl.getCurrent(t).each((function(t){Al.highlightFirst(t),Cm.focusIn(t)}))},u=function(n){Xy(t,(function(t){return t}),n,o,i,vy.HighlightFirst).get(d)},a=function(n){var e=tl(n,t,"button");return Uo(e),D.some(!0)},c=S(S({},Yo([rr((function(n,e){Zf(n,t,"aria-descriptor").each((function(t){var e=Jr("aria");Nr(t.element,"id",e),Nr(n.element,"aria-describedby",e)}))}))])),Km(D.some(u))),s={repositionMenus:function(t){Ym.isOn(t)&&Jy(t)}};return{uid:t.uid,dom:t.dom,components:n,apis:s,eventOrder:S(S({},t.eventOrder),(r={},r[xo()]=["disabling","toggling","alloy.base.behaviour"],r)),events:c,behaviours:gf(t.splitDropdownBehaviours,[Py.config({others:{sandbox:function(n){var e=tl(n,t,"arrow");return Ky(t,n,{onOpen:function(){Ym.on(e),Ym.on(n)},onClose:function(){Ym.off(e),Ym.off(n)}})}}}),Cm.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t){return u(t),D.some(!0)}}),Rm.config({}),Ym.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),j_=function(t){return{isDisabled:function(){return Oh.isDisabled(t)},setDisabled:function(n){return Oh.set(t,n)}}},U_=function(t){return{setActive:function(n){Ym.set(t,n)},isActive:function(){return Ym.isOn(t)},isDisabled:function(){return Oh.isDisabled(t)},setDisabled:function(n){return Oh.set(t,n)}}},W_=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},G_=Jr("focus-button"),X_=["checklist","ordered-list"],Y_=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],q_=function(t,n,e,o,r,i){var u,a=function(t){return lh.isRtl()&&P(X_,t)?t+"-rtl":t},c=lh.isRtl()&&t.exists((function(t){return P(Y_,t)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:W_(e,i)},components:lv([t.map((function(t){return fk(a(t),i.icons)})),n.map((function(t){return dk(t,"tox-tbtn",i)}))]),eventOrder:(u={},u[Ze()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:Ha([iv(i.isDisabled),ev(),Am("common-button-display-events",[Jo(Ze(),(function(t,n){n.event.prevent(),Lo(t,G_)}))])].concat(o.map((function(e){return V_.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return lv([t.icon.map((function(t){return fk(a(t),i.icons)})),t.text.map((function(t){return dk(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},K_=function(t,n,e){var o,r=Zn(d),i=q_(t.icon,t.text,t.tooltip,D.none(),D.none(),e);return Mg.sketch({dom:i.dom,components:i.components,eventOrder:gk,buttonBehaviours:Ha([Am("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},ar((function(t,n){uv(o,t)((function(n){jo(t,mk,{buttonApi:n}),o.onAction(n)}))}))),av(n,r),cv(n,r)]),iv((function(){return t.disabled||e.isDisabled()})),ev()].concat(n.toolbarButtonBehaviours))})},J_=function(t,n,e){return K_(t,{toolbarButtonBehaviours:[].concat(e.length>0?[Am("toolbarButtonWith",e)]:[]),getApi:j_,onSetup:t.onSetup},n)},$_=function(t,n,e){return Mt(K_(t,{toolbarButtonBehaviours:[Bm.config({}),Ym.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[Am("toolbarToggleButtonWith",e)]:[]),getApi:U_,onSetup:t.onSetup},n))},Q_=function(t,n,e){return function(o){return ky((function(t){return n.fetch(t)})).map((function(r){return D.from(Cb(Mt(lb(Jr("menu-value"),r,(function(e){n.onItemAction(t(o),e)}),n.columns,n.presets,vp.CLOSE_ON_EXECUTE,n.select.getOr(y),e),{movement:mb(n.columns,n.presets),menuBehaviours:nh("auto"!==n.columns?[]:[rr((function(t,e){th(t,4,Tp(n.presets)).each((function(n){var e=n.numRows,o=n.numColumns;Cm.setGridSize(t,e,o)}))}))])})))}))}},Z_=function(t,n){return Jo(mk,(function(e,o){var r=function(t){return{hide:function(){return Lo(t,Co())},getValue:function(){return lf.getValue(t)}}}(t.get(e));n.onAction(r,o.event.buttonApi)}))},tT=function(t,n){var e=t.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),o=Dg(gy.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:Ha([Cm.config({mode:"special",onEnter:function(t){return r.findPrimary(t).map((function(t){return Uo(t),!0}))},onLeft:function(t,n){return n.cut(),D.none()},onRight:function(t,n){return n.cut(),D.none()}})])})),r=function(t,n,e){var o=L(n,(function(n){return Dg(function(t,n,e){var o={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?function(t,n,e){var o=n.original,r=(o.primary,k(o,["primary"])),i=gn(ap(S(S({},r),{type:"togglebutton",onAction:d})));return $_(i,e.backstage.shared.providers,[Z_(t,n)])}(t,n,o):function(t,n,e){var o=n.original,r=(o.primary,k(o,["primary"])),i=gn(rp(S(S({},r),{type:"button",onAction:d})));return J_(i,e.backstage.shared.providers,[Z_(t,n)])}(t,n,o)}(t,n,e))}));return{asSpecs:function(){return L(o,(function(t){return t.asSpec()}))},findPrimary:function(t){return it(n,(function(n,e){return n.primary?D.from(o[e]).bind((function(n){return n.getOpt(t)})).filter(v(Oh.isDisabled)):D.none()}))}}}(o,t.commands,n);return[{title:D.none(),items:[o.asSpec()]},{title:D.none(),items:r.asSpecs()}]},nT=function(t,n){var e=yu(window),o=Cu(re(t.getContentAreaContainer())),r=Fh(t)||Ih(t)||Vh(t),i=function(t,n){var e=Math.max(n.x,t.x),o=t.right-e,r=n.width-(e-n.x);return{x:e,width:Math.min(o,r)}}(o,e),u=i.x,a=i.width;if(t.inline&&!r)return ku(u,e.y,a,e.height);var c=function(t,n,e,o){var r=re(t.getContainer()),i=Fu(r,".tox-editor-header").getOr(r),u=Cu(i),a=u.y>=n.bottom,c=o&&!a;if(t.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom};if(t.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)};var s=Cu(r);return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}}(t,o,e,n.header.isPositionedAtTop()),s=c.y,f=c.bottom;return ku(u,s,a,f-s)},eT=function(t,n){var e=W(n,(function(n){return n.predicate(t.dom)})),o=U(e,(function(t){return"contexttoolbar"===t.type}));return{contextToolbars:o.pass,contextForms:o.fail}},oT=function(t,n){var e={},o=[],r=[],i={},u={},a=vt(t);return j(a,(function(a){var c=t[a];"contextform"===c.type?function(t,a){var c=gn(mn("ContextForm",gp,a));e[t]=c,c.launch.map((function(e){i["form:"+t]=S(S({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[t]=c}(a,c):"contexttoolbar"===c.type&&function(t,n){var e;(e=n,mn("ContextToolbar",pp,e)).each((function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e}))}(a,c)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},rT=Jr("forward-slide"),iT=Jr("backward-slide"),uT=Jr("change-slide-event"),aT="tox-pop--resizing",cT=function(t,n,e){var o=function(t,o,i,u){var a=n.shared.providers.translate(t.title);if("separator"===t.type)return D.some({type:"separator",text:a});if("submenu"===t.type){var c=J(t.getStyleItems(),(function(t){return r(t,o,u)}));return 0===o&&c.length<=0?D.none():D.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return J(t.getStyleItems(),(function(t){return r(t,o,u)}))}})}return D.some(S({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(u),disabled:i,onAction:e.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))))},r=function(t,n,r){var i="formatter"===t.type&&e.isInvalid(t);return 0===n?i?[]:o(t,n,!1,r).toArray():o(t,n,i,r).toArray()},i=function(t){var n=e.getCurrentValue(),o=e.shouldHide?0:1;return J(t,(function(t){return r(t,o,n)}))};return{validateItems:i,getFetch:function(t,n){return function(e,o){var r=n(),u=i(r);o(wk(u,vp.CLOSE_ON_EXECUTE,t,!1))}}}},sT=function(t,n,e){var o=e.dataset,r="basic"===o.type?function(){return L(o.data,(function(t){return tO(t,e.isSelectedFor,e.getPreviewFor)}))}:o.getData;return{items:cT(0,n,e),getStyleItems:r}},fT=function(t,n,e){var o=sT(0,n,e),r=o.items,i=o.getStyleItems;return vk({text:e.icon.isSome()?D.none():D.some(""),icon:e.icon,tooltip:D.from(e.tooltip),role:D.none(),fetch:r.getFetch(n,i),onSetup:function(n){var o=function(){var t=n.getComponent();t.getSystem().isConnected()&&e.updateText(t)};return o(),t.on("NodeChange",o),function(){t.off("NodeChange",o)}},getApi:function(t){return{getComponent:g(t)}},columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)};!function(t){t[t.SemiColon=0]="SemiColon",t[t.Space=1]="Space"}($k||($k={}));var lT,dT,mT,gT,pT=function(t,n,e,o){return{type:"basic",data:(r=function(t,n){return n===$k.SemiColon?t.replace(/;$/,"").split(";"):t.split(" ")}(t.getParam(n,e,"string"),o),L(r,(function(t){var n=t,e=t,o=t.split("=");return o.length>1&&(n=o[0],e=o[1]),{title:n,format:e}})))};var r},hT=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],vT=function(t){var n={type:"basic",data:hT};return{tooltip:"Align",icon:D.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:D.none,getPreviewFor:function(t){return function(){return D.none()}},onAction:function(n){return function(){return Y(hT,(function(t){return t.format===n.format})).each((function(n){return t.execCommand(n.command)}))}},updateText:function(n){var e=Y(hT,(function(n){return t.formatter.match(n.format)})).fold((function(){return"left"}),(function(t){return t.title.toLowerCase()}));jo(n,hk,{icon:"align-"+e})},dataset:n,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},bT=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],yT=function(t){var n=t.split(/\s*,\s*/);return L(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},xT=function(t){var n=function(){var n=function(t){return t?yT(t)[0]:""},o=t.queryCommandValue("FontName"),r=e.data,i=o?o.toLowerCase():"";return{matchOpt:Y(r,(function(t){var e=t.format;return e.toLowerCase()===i||n(e).toLowerCase()===n(i).toLowerCase()})).orThunk((function(){return function(t){var n;return 0===t.indexOf("-apple-system")&&(n=yT(t.toLowerCase()),$(bT,(function(t){return n.indexOf(t.toLowerCase())>-1})))}(i)?D.from({title:"System Font",format:i}):D.none()})),font:o}},e=pT(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",$k.SemiColon);return{tooltip:"Fonts",icon:D.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getCurrentValue:function(){return n().matchOpt},getPreviewFor:function(t){return function(){return D.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},updateText:function(t){var e=n(),o=e.matchOpt,r=e.font,i=o.fold((function(){return r}),(function(t){return t.title}));jo(t,pk,{text:i})},dataset:e,shouldHide:!1,isInvalid:y}},wT={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},ST={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},kT=function(t){var n=function(){var n=D.none(),e=o.data,r=t.queryCommandValue("FontSize");if(r)for(var i=function(t){var o=function(t,n){return/[0-9.]+px$/.test(t)?function(t,n){var e=Math.pow(10,n);return Math.round(t*e)/e}(72*parseInt(t,10)/96,n||0)+"pt":Ot(ST,t).getOr(t)}(r,t),i=function(t){return Ot(wT,t).getOr("")}(o);n=Y(e,(function(t){return t.format===r||t.format===o||t.format===i}))},u=3;n.isNone()&&u>=0;u--)i(u);return{matchOpt:n,size:r}},e=g(D.none),o=pT(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",$k.Space);return{tooltip:"Font sizes",icon:D.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getPreviewFor:e,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},updateText:function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold((function(){return r}),(function(t){return t.title}));jo(t,pk,{text:i})},dataset:o,shouldHide:!1,isInvalid:y}},CT=function(t,n){var e=n(),o=L(e,(function(t){return t.format}));return D.from(t.formatter.closest(o)).bind((function(t){return Y(e,(function(n){return n.format===t}))})).orThunk((function(){return hl(t.formatter.match("p"),{title:"Paragraph",format:"p"})}))},OT=function(t){var n=Zn(D.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(D.none())},isSet:function(){return n.get().isSome()},set:function(t){e(),n.set(D.some(t))}}},_T=function(){return OT((function(t){return t.destroy()}))},TT=function(){return OT((function(t){return t.unbind()}))},ET=function(t,n){return function(e){var o=TT(),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive);o.set(r)};return t.initialized?r():t.on("init",r),o.clear}},BT=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},AT=function(t){var n=pT(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",$k.SemiColon);return{tooltip:"Blocks",icon:D.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:D.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return D.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:BT(t),updateText:function(e){var o=CT(t,(function(){return n.data})).fold((function(){return"Paragraph"}),(function(t){return t.title}));jo(e,pk,{text:o})},dataset:n,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},MT=function(t,n){return{tooltip:"Formats",icon:D.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:D.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return void 0!==e?D.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):D.none()}},onAction:BT(t),updateText:function(n){var e=function(t){var n=t.items;return void 0!==n&&n.length>0?J(n,e):[{title:t.title,format:t.format}]},o=J(ZC(t),e),r=CT(t,(function(){return o})).fold((function(){return"Paragraph"}),(function(t){return t.title}));jo(n,pk,{text:r})},shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},DT=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],FT=function(t,n){return function(e,o,r){var i=t(e).mapError((function(t){return hn(t)})).getOrDie();return n(i,o,r)}},IT={button:FT(rp,(function(t,n){return e=t,o=n.backstage.shared.providers,J_(e,o,[]);var e,o})),togglebutton:FT(ap,(function(t,n){return e=t,o=n.backstage.shared.providers,$_(e,o,[]);var e,o})),menubutton:FT(M_,(function(t,n){return kk(t,"tox-tbtn",n.backstage,D.none())})),splitbutton:FT((function(t){return mn("SplitButton",D_,t)}),(function(t,n){return function(t,n){var e,o=Jr("channel-update-split-dropdown-display"),r=function(t){return{isDisabled:function(){return Oh.isDisabled(t)},setDisabled:function(n){return Oh.set(t,n)},setIconFill:function(n,e){Fu(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Nr(t,"fill",e)}))},setIconStroke:function(n,e){Fu(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Nr(t,"stroke",e)}))},setActive:function(n){t.getSystem().isConnected()&&(Nr(t.element,"aria-pressed",n),Fu(t.element,"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return Ym.set(t,n)}))})))},isActive:function(){return Fu(t.element,"span").exists((function(n){return!!t.getSystem().isConnected()&&t.getSystem().getByDom(n).exists(Ym.isOn)}))}}},i=Zn(d),u={getApi:r,onSetup:t.onSetup};return L_.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:S({"aria-pressed":!1},W_(t.tooltip,n.providers))},onExecute:function(n){t.onAction(r(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:Ha([rv(n.providers.isDisabled),ev(),Am("split-dropdown-events",[Jo(G_,Rm.focus),av(u,i),cv(u,i)]),ex.config({})]),eventOrder:(e={},e[Mo()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:Q_(r,t,n.providers),parts:{menu:Fp(0,t.columns,t.presets)},components:[L_.parts.button(q_(t.icon,t.text,D.none(),D.some(o),D.some([Ym.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),L_.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Ig("chevron-down",n.providers.icons)},buttonBehaviours:Ha([rv(n.providers.isDisabled),ev()])}),L_.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})}(t,n.backstage.shared)})),grouptoolbarbutton:FT((function(t){return mn("GroupToolbarButton",E_,t)}),(function(t,n,e){var o,r=e.ui.registry.getAll().buttons,i=((o={})[xc]=n.backstage.shared.header.isPositionedAtTop()?Pu.TopToBottom:Pu.BottomToTop,o);switch(Hh(e)){case hp.floating:return function(t,n,e,o){var r=n.shared;return XO.sketch({lazySink:r.getSink,fetch:function(){return ky((function(n){n(L(e(t.items),S_))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:q_(t.icon,t.text,t.tooltip,D.none(),D.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})}(t,n.backstage,(function(t){return VT(e,{buttons:r,toolbar:t,allowToolbarGroups:!1},n,D.none())}),i);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(t,n){return function(t,n){var e=S({type:"advanced"},n.styleselect);return fT(t,n,MT(t,e))}(t,n.backstage)},fontsizeSelectButton:function(t,n){return function(t,n){return fT(t,n,kT(t))}(t,n.backstage)},fontSelectButton:function(t,n){return function(t,n){return fT(t,n,xT(t))}(t,n.backstage)},formatButton:function(t,n){return function(t,n){return fT(t,n,AT(t))}(t,n.backstage)},alignMenuButton:function(t,n){return function(t,n){return fT(t,n,vT(t))}(t,n.backstage)}},RT={styleselect:IT.styleSelectButton,fontsizeselect:IT.fontsizeSelectButton,fontselect:IT.fontSelectButton,formatselect:IT.formatButton,align:IT.alignMenuButton},VT=function(t,n,e,r){var i=function(t){var n,e=t.toolbar,r=t.buttons;return!1===e?[]:void 0===e||!0===e?function(t){var n=L(DT,(function(n){var e=W(n.items,(function(n){return _t(t,n)||_t(RT,n)}));return{name:n.name,items:e}}));return W(n,(function(t){return t.items.length>0}))}(r):o(e)?(n=e.split("|"),L(n,(function(t){return{items:t.trim().split(" ")}}))):function(t){return l(t,(function(t){return _t(t,"name")&&_t(t,"items")}))}(e)?e:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])}(n),u=L(i,(function(o){var i=J(o.items,(function(o){return 0===o.trim().length?[]:function(t,n,e,o,r,i){return Ot(n,e.toLowerCase()).orThunk((function(){return i.bind((function(t){return it(t,(function(t){return Ot(n,t+e.toLowerCase())}))}))})).fold((function(){return Ot(RT,e.toLowerCase()).map((function(n){return n(t,r)})).orThunk((function(){return D.none()}))}),(function(n){return"grouptoolbarbutton"!==n.type||o?function(t,n,e){return Ot(IT,t.type).fold((function(){return console.error("skipping button defined by",t),D.none()}),(function(o){return D.some(o(t,n,e))}))}(n,r,t):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),D.none())}))}(t,n.buttons,o,n.allowToolbarGroups,e,r).toArray()}));return{title:D.from(t.translate(o.name)),items:i}}));return W(u,(function(t){return t.items.length>0}))},PT={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},HT={maxHeightFunction:lc(),maxWidthFunction:EO()},zT={onLtr:function(){return[ka,Ca,wa,ya,Sa,xa,Eg,Bg,_g,Cg,Tg,Og]},onRtl:function(){return[ka,Ca,Sa,xa,wa,ya,Eg,Bg,Tg,Og,_g,Cg]}},NT={onLtr:function(){return[Ca,ya,xa,wa,Sa,ka,Eg,Bg,_g,Cg,Tg,Og]},onRtl:function(){return[Ca,xa,ya,Sa,wa,ka,Eg,Bg,Tg,Og,_g,Cg]}},LT=function(t,n,e,o){var r,i,u=He().deviceType.isTouch,a=Zi((r={sink:e,onEscape:function(){return t.focus(),D.some(!0)}},i=Zn([]),bg.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){i.set([]),bg.getContent(t).each((function(t){Ui(t.element,"visibility")})),Oi(t.element,aT),Ui(t.element,"width")},inlineBehaviours:Ha([Am("context-toolbar-events",[or(lo(),(function(t,n){Oi(t.element,aT),Ui(t.element,"width")})),Jo(uT,(function(t,n){var e=t.element;Ui(e,"width");var o=lu(e);bg.setContent(t,n.event.contents),Ci(e,aT);var r=lu(e);Ri(e,"width",o+"px"),bg.getContent(t).each((function(t){n.event.focus.bind((function(t){return Xa(t),qa(e)})).orThunk((function(){return Cm.focusIn(t),Ya(Or(e))}))})),Ag.setTimeout((function(){Ri(t.element,"width",r+"px")}),0)})),Jo(rT,(function(t,n){bg.getContent(t).each((function(n){i.set(i.get().concat([{bar:n,focus:Ya(Or(t.element))}]))})),jo(t,uT,{contents:n.event.forwardContents,focus:D.none()})})),Jo(iT,(function(t,n){ot(i.get()).each((function(n){i.set(i.get().slice(0,i.get().length-1)),jo(t,uT,{contents:tu(n.bar),focus:n.focus})}))}))]),Cm.config({mode:"special",onEscape:function(t){return ot(i.get()).fold((function(){return r.onEscape()}),(function(n){return Lo(t,iT),D.some(!0)}))}})]),lazySink:function(){return ct.value(r.sink)}}))),c=function(){return nT(t,o.backstage.shared)},s=function(){if(u()&&o.backstage.isContextMenuOpen())return!0;var n,e,r,i,a,s,f=(n=p.get().filter((function(t){return Ai(re(t))})).map((function(t){return t.getBoundingClientRect()})).getOrThunk((function(){return t.selection.getRng().getBoundingClientRect()})),e=t.inline?hu().top:Ou(re(t.getBody())).y,{y:n.top+e,bottom:n.bottom+e}),l=c();return r=f.y,i=f.bottom,a=l.y,s=l.bottom,!(Math.max(r,a)<=Math.min(i,s))},f=function(){g.set(D.none()),bg.hide(a)},l=function(){bg.hide(a)},m=function(){g.get().each((function(t){var n=a.element;Ui(n,"display"),s()?Ri(n,"display","none"):Ss.positionWithinBounds(e,t,a,D.some(c()))}))},g=Zn(D.none()),p=Zn(D.none()),h=Zn(null),v=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:Ha([Cm.config({mode:"acyclic"}),Am("pop-dialog-wrap-events",[rr((function(n){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return Cm.focusIn(n)}))})),ir((function(n){t.shortcuts.remove("ctrl+F9")}))])])}},b=Ft((function(){return oT(n,(function(t){var n=y([t]);jo(a,rT,{forwardContents:v(n)})}))})),y=function(n){var e=t.ui.registry.getAll().buttons,r=b(),i=S(S({},e),r.formNavigators),u=Hh(t)===hp.scrolling?hp.scrolling:hp.default,a=K(L(n,(function(n){return"contexttoolbar"===n.type?function(n,e){return VT(t,{buttons:n,toolbar:e.items,allowToolbarGroups:!1},o,D.some(["form:"]))}(i,n):function(t,n){return tT(t,n)}(n,o.backstage.shared.providers)})));return T_({type:u,uid:Jr("context-toolbar"),initGroups:a,onEscape:D.none,cyclicKeying:!0,providers:o.backstage.shared.providers})};t.on("contexttoolbar-show",(function(n){var e=b();Ot(e.lookupTable,n.toolbarKey).each((function(e){x([e],n.target===t?D.none():D.some(n)),bg.getContent(a).each(Cm.focusIn)}))}));var x=function(t,n){if(k(),!u()||!o.backstage.isContextMenuOpen()){var e=y(t),r=n.map(re),i=function(t,n){var e="node"===t?o.backstage.shared.anchors.node(n):o.backstage.shared.anchors.cursor();return Mt(e,function(t,n){return"line"===t?{bubble:pc(12,0,PT),layouts:{onLtr:function(){return[Oa]},onRtl:function(){return[_a]}},overrides:HT}:{bubble:pc(0,12,PT),layouts:n?NT:zT,overrides:HT}}(t,u()))}(t[0].position,r);g.set(D.some(i)),p.set(n);var f=a.element;Ui(f,"display"),bg.showWithinBounds(a,i,v(e),(function(){return D.some(c())})),s()&&Ri(f,"display","none")}},w=function(){t.hasFocus()&&function(t,n){var e=re(n.getBody()),o=function(t){return Le(t,e)},r=re(n.selection.getNode());return function(t){return!o(t)&&!je(e,t)}(r)?D.none():function(t,n,e){var o=eT(t,n);if(o.contextForms.length>0)return D.some({elem:t,toolbars:[o.contextForms[0]]});var r=eT(t,e);if(r.contextForms.length>0)return D.some({elem:t,toolbars:[r.contextForms[0]]});if(o.contextToolbars.length>0||r.contextToolbars.length>0){var i=function(t){if(t.length<=1)return t;var n=function(n){return H(t,(function(t){return t.position===n}))},e=function(n){return W(t,(function(t){return t.position===n}))},o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=L(e("selection"),(function(t){return S(S({},t),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return D.some({elem:t,toolbars:i})}return D.none()}(r,t.inNodeScope,t.inEditorScope).orThunk((function(){return function(t,n,e){return t(n)?D.none():We(n,(function(t){var n=eT(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=r.length>0?r:function(t){if(t.length<=1)return t;var n=function(n){return Y(t,(function(t){return t.position===n}))};return n("selection").orThunk((function(){return n("node")})).orThunk((function(){return n("line")})).map((function(t){return t.position})).fold((function(){return[]}),(function(n){return W(t,(function(t){return t.position===n}))}))}(o);return i.length>0?D.some({elem:t,toolbars:i}):D.none()}),t)}(o,r,t)}))}(b(),t).fold(f,(function(t){x(t.toolbars,D.some(t.elem.dom))}))},k=function(){var t=h.get();null!==t&&(Ag.clearTimeout(t),h.set(null))},C=function(){k(),h.set(Ag.setEditorTimeout(t,w,0))};t.on("init",(function(){t.on(BO,l),t.on("ScrollContent ScrollWindow longpress",m),t.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){C()})),t.on("focusout",(function(n){Ag.setEditorTimeout(t,(function(){qa(e.element).isNone()&&qa(a.element).isNone()&&f()}),0)})),t.on("SwitchMode",(function(){t.mode.isReadOnly()&&f()})),t.on("AfterProgressState",(function(n){n.state?f():t.hasFocus()&&C()})),t.on("NodeChange",(function(t){qa(a.element).fold(C,d)}))}))},jT=al,UT=Wf,WT=g([Un("shell",!1),En("makeItem"),Un("setupItem",d),pf("listBehaviours",[Bm])]),GT=Lf({name:"items",overrides:function(){return{behaviours:Ha([Bm.config({})])}}}),XT=g([GT]),YT=gl({name:g("CustomList")(),configFields:WT(),partFields:XT(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[Bm.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:gf(t.listBehaviours,r.behaviours),apis:{setItems:function(n,e){var o;(o=n,t.shell?D.some(o):Zf(o,t,"items")).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=Bm.contents(o),i=e.length,u=i-r.length,a=u>0?z(u,(function(){return t.makeItem()})):[],c=r.slice(i);j(c,(function(t){return Bm.remove(o,t)})),j(a,(function(t){return Bm.append(o,t)}));var s=Bm.contents(o);j(s,(function(o,r){t.setupItem(n,o,e[r],r)}))}))}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),qT=d,KT=y,JT=g([]),$T=Object.freeze({__proto__:null,setup:qT,isDocked:KT,getBehaviours:JT}),QT=function(t){return(Ni(t,"position").is("fixed")?D.none():yr(t)).orThunk((function(){var n=ee("span");return br(t).bind((function(t){Dr(t,n);var e=yr(n);return Rr(n),e}))}))},ZT=function(t){return QT(t).map(cu).getOrThunk((function(){return uu(0,0)}))},tE=Et([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),nE=function(t,n){var e=t.element;Ci(e,n.transitionClass),Oi(e,n.fadeOutClass),Ci(e,n.fadeInClass),n.onShow(t)},eE=function(t,n){var e=t.element;Ci(e,n.transitionClass),Oi(e,n.fadeInClass),Ci(e,n.fadeOutClass),n.onHide(t)},oE=function(t,n,e){return $(t,(function(t){switch(t){case"bottom":return function(t,n){return t.bottom<=n.bottom}(n,e);case"top":return function(t,n){return t.y>=n.y}(n,e)}}))},rE=function(t,n){return n.getInitialPosition().map((function(n){return ku(n.bounds.x,n.bounds.y,lu(t),ou(t))}))},iE=function(t,n,e){return e.getInitialPosition().bind((function(o){switch(e.setInitialPosition(D.none()),o.position){case"static":return D.some(tE.static());case"absolute":var r=QT(t).map(Cu).getOrThunk((function(){return Cu(Mi())}));return D.some(tE.absolute(Ja("absolute",Ot(o.style,"left").map((function(t){return n.x-r.x})),Ot(o.style,"top").map((function(t){return n.y-r.y})),Ot(o.style,"right").map((function(t){return r.right-n.right})),Ot(o.style,"bottom").map((function(t){return r.bottom-n.bottom})))));default:return D.none()}}))},uE=function(t,n,e){var o=t.element;return Ni(o,"position").is("fixed")?function(t,n,e){return rE(t,e).filter((function(t){return oE(e.getModes(),t,n)})).bind((function(n){return iE(t,n,e)}))}(o,n,e):function(t,n,e){var o=Cu(t);if(oE(e.getModes(),o,n))return D.none();!function(t,n,e){e.setInitialPosition(D.some({style:Li(t),position:Hi(t,"position")||"static",bounds:n}))}(t,o,e);var r=_u(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return D.some(tE.fixed(Ja("fixed",D.some(i),c?D.some(u):D.none(),D.none(),c?D.none():D.some(a))))}(o,n,e)},aE=function(t,n){j(["left","right","top","bottom","position"],(function(n){return Ui(t.element,n)})),n.onUndocked(t)},cE=function(t,n,e){$a(t.element,e),("fixed"===e.position?n.onDocked:n.onUndocked)(t)},sE=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u=function(t,n){return t.y<n.bottom&&t.bottom>n.y}(i,o);u!==e.isVisible()&&(e.setVisible(u),r&&!u?(Ti(t.element,[n.fadeOutClass]),n.onHide(t)):(u?nE:eE)(t,n))}))}))},fE=function(t,n,e){t.getSystem().isConnected()&&function(t,n,e){var o=n.lazyViewport(t),r=e.isDocked();r&&sE(t,n,e,o),uE(t,o,e).each((function(i){e.setDocked(!r),i.fold((function(){return aE(t,n)}),(function(e){return cE(t,n,e)}),(function(r){sE(t,n,e,o,!0),cE(t,n,r)}))}))}(t,n,e)},lE=function(t,n,e){e.isDocked()&&function(t,n,e){var o=t.element;e.setDocked(!1),function(t,n){var e=t.element;return rE(e,n).bind((function(t){return iE(e,t,n)}))}(t,e).each((function(e){e.fold((function(){return aE(t,n)}),(function(e){return cE(t,n,e)}),d)})),e.setVisible(!0),n.contextual.each((function(n){Ei(o,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)})),fE(t,n,e)}(t,n,e)},dE=Object.freeze({__proto__:null,refresh:fE,reset:lE,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),mE=Object.freeze({__proto__:null,events:function(t,n){return Yo([or(lo(),(function(e,o){t.contextual.each((function(t){_i(e.element,t.transitionClass)&&(Ei(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e)),o.stop()}))})),Jo(Bo(),(function(e,o){fE(e,t,n)})),Jo(Ao(),(function(e,o){lE(e,t,n)}))])}}),gE=[jn("contextual",[Mn("fadeInClass"),Mn("fadeOutClass"),Mn("transitionClass"),Fn("lazyContext"),Ku("onShow"),Ku("onShown"),Ku("onHide"),Ku("onHidden")]),Kn("lazyViewport",_u),Jn("modes",["top","bottom"],Sn),Ku("onDocked"),Ku("onUndocked")],pE=Na({fields:gE,name:"docking",active:mE,apis:dE,state:Object.freeze({__proto__:null,init:function(t){var n=Zn(!1),e=Zn(!0),o=Zn(D.none()),r=Zn(t.modes);return mi({isDocked:n.get,setDocked:n.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),hE={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},vE="tox-tinymce--toolbar-sticky-on",bE="tox-tinymce--toolbar-sticky-off",yE=function(t){var n=t.element;br(n).each((function(e){var o="padding-"+pE.getModes(t)[0];if(pE.isDocked(t)){var r=lu(e);Ri(n,"width",r+"px"),Ri(e,o,function(t){return ru(t)+(parseInt(Hi(t,"margin-top"),10)||0)+(parseInt(Hi(t,"margin-bottom"),10)||0)}(n)+"px")}else Ui(n,"width"),Ui(e,o)}))},xE=function(t,n){n?(Oi(t,hE.fadeOutClass),Ti(t,[hE.transitionClass,hE.fadeInClass])):(Oi(t,hE.fadeInClass),Ti(t,[hE.fadeOutClass,hE.transitionClass]))},wE=function(t,n){var e=re(t.getContainer());n?(Ci(e,vE),Oi(e,bE)):(Ci(e,bE),Oi(e,vE))},SE=function(t,n){var e=Zn(D.none()),o=n.getSink,r=function(t){o().each((function(n){return t(n.element)}))},i=function(n){t.inline||yE(n),wE(t,pE.isDocked(n)),n.getSystem().broadcastOn([Xs()],{}),o().each((function(t){return t.getSystem().broadcastOn([Xs()],{})}))},u=t.inline?[]:function(){var t;return[Wa.config({channels:(t={},t[x_()]={onReceive:yE},t)})]}();return C([Rm.config({}),pE.config({contextual:S({lazyContext:function(n){var e,o=ru(n.element),r=t.inline?t.getContentAreaContainer():t.getContainer(),i=Cu(re(r)),u=i.height-o,a=i.y+(e=n,"top",P(pE.getModes(e),"top")?0:o);return D.some(ku(i.x,a,i.width,u))},onShow:function(){r((function(t){return xE(t,!0)}))},onShown:function(t){r((function(t){return Ei(t,[hE.transitionClass,hE.fadeInClass])})),e.get().each((function(n){var o,r,i;o=t.element,i=gr(r=n),Ya(i).filter((function(t){return!Le(r,t)})).filter((function(t){return Le(t,re(i.dom.body))||je(o,t)})).each((function(){return Xa(r)})),e.set(D.none())}))},onHide:function(t){e.set(function(t,n){return qa(t).orThunk((function(){return n().toOptional().bind((function(t){return qa(t.element)}))}))}(t.element,o)),r((function(t){return xE(t,!1)}))},onHidden:function(){r((function(t){return Ei(t,[hE.transitionClass])}))}},hE),modes:[n.header.getDockingMode()],onDocked:i,onUndocked:i})],u)},kE=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",(function(){e().each(pE.reset)})),t.on("ResizeWindow ResizeEditor",(function(){e().each(yE)})),t.on("SkinLoaded",(function(){e().each((function(t){pE.isDocked(t)?pE.reset(t):pE.refresh(t)}))})),t.on("FullscreenStateChanged",(function(){e().each(pE.reset)}))),t.on("AfterScrollIntoView",(function(t){e().each((function(n){pE.refresh(n);var e=n.element;bd(e)&&function(t,n){var e=gr(n),o=e.dom.defaultView.innerHeight,r=hu(e),i=re(t.elm),u=Ou(i),a=ou(i),c=u.y,s=c+a,f=cu(n),l=ou(n),d=f.top,m=d+l,g=Math.abs(d-r.top)<2,p=Math.abs(m-(r.top+o))<2;if(g&&c<m)vu(r.left,c-l,e);else if(p&&s>d){var h=c-o+a+l;vu(r.left,h,e)}}(t,e)}))})),t.on("PostRender",(function(){wE(t,!1)}))},isDocked:function(t){return t().map(pE.isDocked).getOr(!1)},getBehaviours:SE}),CE=ml({factory:function(t,n){var e={focus:Cm.focusIn,setMenus:function(t,e){var o=L(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=M_(e).mapError((function(t){return hn(t)})).getOrDie();return kk(o,"tox-mbtn",n.backstage,D.some("menuitem"))}));Bm.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:Ha([Bm.config({}),Am("menubar-events",[rr((function(n){t.onSetup(n)})),Jo(oo(),(function(t,n){Fu(t.element,".tox-mbtn--active").each((function(e){Iu(n.event.target,".tox-mbtn").each((function(n){Le(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){tx.expand(t),tx.close(e),Rm.focus(t)}))}))}))}))})),Jo(Ro(),(function(t,n){n.event.prevFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(e){n.event.newFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(t){tx.isOpen(e)&&(tx.expand(t),tx.close(e))}))}))}))]),Cm.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),D.some(!0)}}),Kb.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[En("dom"),En("uid"),En("onEscape"),En("backstage"),Un("onSetup",d)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),OE="container",_E=[df("slotBehaviours",[])],TE=function(t){return"<alloy.field."+t+">"},EE=function(t,n){var e,o=function(n){return ol(t)},r=function(n,e){return function(o,r){return Zf(o,t,r).map((function(t){return n(t,r)})).getOr(e)}},i=function(t,n){return"true"!==Lr(t.element,"aria-hidden")},u=r(i,!1),a=r((function(t,n){if(i(t)){var e=t.element;Ri(e,"display","none"),Nr(e,"aria-hidden","true"),jo(t,Vo(),{name:n,visible:!1})}})),c=(e=a,function(t,n){j(n,(function(n){return e(t,n)}))}),s=r((function(t,n){if(!i(t)){var e=t.element;Ui(e,"display"),Wr(e,"aria-hidden"),jo(t,Vo(),{name:n,visible:!0})}})),f={getSlotNames:o,getSlot:function(n,e){return Zf(n,t,e)},isShowing:u,hideSlot:a,hideAllSlots:function(t){return c(t,o())},showSlot:s};return{uid:t.uid,dom:t.dom,components:n,behaviours:mf(t.slotBehaviours),apis:f}},BE=xt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},(function(t){return li(t)})),AE=S(S({},BE),{sketch:function(t){var n=function(){var t=[];return{slot:function(n,e){return t.push(n),qf(OE,TE(n),e)},record:function(){return t}}}(),e=t(n),o=n.record(),r=L(o,(function(t){return zf({name:t,pname:TE(t)})}));return sl(OE,_E,r,EE,e)}}),ME=Zt([Nn("icon"),Nn("tooltip"),Kn("onShow",d),Kn("onHide",d),Kn("onSetup",(function(){return d}))]),DE=function(t){return{element:function(){return t.element.dom}}},FE=function(t,n){var e=L(vt(n),(function(t){var e=n[t],o=gn(function(t){return mn("sidebar",ME,t)}(e));return{name:t,getApi:DE,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return L(e,(function(n){var o=Zn(d);return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:nh([av(n,o),cv(n,o),Jo(Vo(),(function(t,n){var o=n.event;Y(e,(function(t){return t.name===o.name})).each((function(n){(o.visible?n.onShow:n.onHide)(n.getApi(t))}))}))])})}))},IE=function(t){return AE.sketch((function(n){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:FE(n,t),slotBehaviours:nh([rr((function(t){return AE.hideAllSlots(t)}))])}}))},RE=function(t){return xl.getCurrent(t).bind((function(t){return g_.isGrowing(t)||g_.hasGrown(t)?xl.getCurrent(t).bind((function(t){return Y(AE.getSlotNames(t),(function(n){return AE.isShowing(t,n)}))})):D.none()}))},VE=Jr("FixSizeEvent"),PE=Jr("AutoSizeEvent"),HE=function(t){var n=ne(t),e=xr(n),o=function(t){var n=void 0!==t.dom.attributes?t.dom.attributes:[];return X(n,(function(t,n){var e;return"class"===n.name?t:S(S({},t),((e={})[n.name]=n.value,e))}),{})}(n),r=function(t){return Array.prototype.slice.call(t.dom.classList,0)}(n),i=0===e.length?{}:{innerHtml:Pr(n)};return S({tag:cr(n),classes:r,attributes:o},i)},zE=function(t){return{dom:{tag:"div",attributes:{"aria-label":t.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:HE('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:Ha([Cm.config({mode:"special",onTab:function(){return D.some(!0)},onShiftTab:function(){return D.some(!0)}}),Rm.config({})])}},NE=UT.optional({factory:CE,name:"menubar",schema:[En("backstage")]}),LE=UT.optional({factory:{sketch:function(t){return YT.sketch({uid:t.uid,dom:t.dom,listBehaviours:Ha([Cm.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return T_({type:t.type,uid:Jr("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),D.some(!0)}})},setupItem:function(t,n,e,o){DO.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[En("dom"),En("onEscape")]}),jE=UT.optional({factory:{sketch:function(t){return function(t){return t.type===hp.sliding?__:t.type===hp.floating?O_:T_}(t)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),D.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[En("dom"),En("onEscape"),En("getSink")]}),UE=UT.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?SE:JT;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:Ha(e(n,t.sharedBackstage))}}},name:"header",schema:[En("dom")]}),WE=UT.optional({name:"socket",schema:[En("dom")]}),GE=UT.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Ha([Kb.config({}),Rm.config({}),g_.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){xl.getCurrent(t).each(AE.hideAllSlots),Lo(t,PE)},onGrown:function(t){Lo(t,PE)},onStartGrow:function(t){jo(t,VE,{width:Ni(t.element,"width").getOr("")})},onStartShrink:function(t){jo(t,VE,{width:lu(t.element)+"px"})}}),Bm.config({}),xl.config({find:function(t){var n=Bm.contents(t);return et(n)}})])}],behaviours:Ha([fS(0),Am("sidebar-sliding-events",[Jo(VE,(function(t,n){Ri(t.element,"width",n.event.width)})),Jo(PE,(function(t,n){Ui(t.element,"width")}))])])}}},name:"sidebar",schema:[En("dom")]}),XE=UT.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Ha([Bm.config({})]),components:[]}}},name:"throbber",schema:[En("dom")]}),YE=gl({name:"OuterContainer",factory:function(t,n,e){var o={getSocket:function(n){return jT.getPart(n,t,"socket")},setSidebar:function(n,e){jT.getPart(n,t,"sidebar").each((function(t){return function(t,n){xl.getCurrent(t).each((function(t){return Bm.set(t,[IE(n)])}))}(t,e)}))},toggleSidebar:function(n,e){jT.getPart(n,t,"sidebar").each((function(t){return function(t,n){xl.getCurrent(t).each((function(t){xl.getCurrent(t).each((function(e){g_.hasGrown(t)?AE.isShowing(e,n)?g_.shrink(t):(AE.hideAllSlots(e),AE.showSlot(e,n)):(AE.hideAllSlots(e),AE.showSlot(e,n),g_.grow(t))}))}))}(t,e)}))},whichSidebar:function(n){return jT.getPart(n,t,"sidebar").bind(RE).getOrNull()},getHeader:function(n){return jT.getPart(n,t,"header")},getToolbar:function(n){return jT.getPart(n,t,"toolbar")},setToolbar:function(n,e){jT.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){jT.getPart(n,t,"multiple-toolbar").each((function(t){YT.setItems(t,e)}))},refreshToolbar:function(n){jT.getPart(n,t,"toolbar").each((function(t){return t.getApis().refresh(t)}))},toggleToolbarDrawer:function(n){jT.getPart(n,t,"toolbar").each((function(t){var n,e;e=function(n){return n(t)},null!=(n=t.getApis().toggle)?D.some(e(n)):D.none()}))},isToolbarDrawerToggled:function(n){return jT.getPart(n,t,"toolbar").bind((function(t){return D.from(t.getApis().isOpen).map((function(n){return n(t)}))})).getOr(!1)},getThrobber:function(n){return jT.getPart(n,t,"throbber")},focusToolbar:function(n){jT.getPart(n,t,"toolbar").orThunk((function(){return jT.getPart(n,t,"multiple-toolbar")})).each((function(t){Cm.focusIn(t)}))},setMenubar:function(n,e){jT.getPart(n,t,"menubar").each((function(t){CE.setMenus(t,e)}))},focusMenubar:function(n){jT.getPart(n,t,"menubar").each((function(t){CE.focus(t)}))}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},configFields:[En("dom"),En("behaviours")],partFields:[UE,NE,jE,LE,WE,GE,XE],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=L(e,(function(t){return S_(t)}));t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=L(e,(function(t){return L(t,S_)}));t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),qE={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},KE=function(t){return"string"==typeof t?t.split(" "):t},JE=function(t,n){var e=S(S({},qE),n.menus),o=vt(n.menus).length>0,r=void 0===n.menubar||!0===n.menubar?KE("file edit view insert format tools table help"):KE(!1===n.menubar?"":n.menubar),i=W(r,(function(t){return o&&n.menus.hasOwnProperty(t)&&n.menus[t].hasOwnProperty("items")||qE.hasOwnProperty(t)})),u=L(i,(function(o){var r=e[o];return function(t,n,e){var o=function(t){return t.getParam("removed_menuitems","")}(e).split(/[ ,]/);return{text:t.title,getItems:function(){return J(t.items,(function(t){var e=t.toLowerCase();return 0===e.trim().length||H(o,(function(t){return t===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:n.menuItems[e]?[n.menuItems[e]]:[]}))}}}({title:r.title,items:KE(r.items)},n,t)}));return W(u,(function(t){return t.getItems().length>0&&H(t.getItems(),(function(t){return"separator"!==t.type}))}))},$E=function(t){var n=function(){t._skinLoaded=!0,function(t){t.fire("SkinLoaded")}(t)};return function(){t.initialized?n():t.on("init",n)}},QE=function(t,n,e){return new qg((function(o,r){e.load(n,o,r),t.on("remove",(function(){return e.unload(n)}))}))},ZE=function(t,n){return QE(t,n+"/skin.min.css",t.ui.styleSheetLoader)},tB=function(t,n){var e;return e=re(t.getElement()),Tr(e).isSome()?QE(t,n+"/skin.shadowdom.min.css",fh.DOM.styleSheetLoader):qg.resolve()},nB=function(t,n){var e=function(t){var n=t.getParam("skin"),e=t.getParam("skin_url");if(!1!==n){var o=n||"oxide";e=e?t.documentBaseURI.toAbsolute(e):_h.baseURL+"/skins/ui/"+o}return e}(n);e&&n.contentCSS.push(e+(t?"/content.inline":"/content")+".min.css"),!1===function(t){return!1===t.getParam("skin")}(n)&&o(e)?qg.all([ZE(n,e),tB(n,e)]).then($E(n),function(t,n){return function(){return function(t,n){return t.fire("SkinLoadError",n)}(t,{message:"Skin could not be loaded"})}}(n)):$E(n)()},eB=h(nB,!1),oB=h(nB,!0),rB=function(t,n,e,r){var i=n.outerContainer,u=e.toolbar,a=e.buttons;if(l(u,o)){var c=u.map((function(n){var o={toolbar:n,buttons:a,allowToolbarGroups:e.allowToolbarGroups};return VT(t,o,{backstage:r},D.none())}));YE.setToolbars(i,c)}else YE.setToolbar(i,VT(t,e,{backstage:r},D.none()))},iB=He(),uB=iB.os.isiOS()&&iB.os.version.major<=12,aB=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=Zn(0),u=n.outerContainer;eB(t);var a=re(r.targetNode),c=_r(Or(a));!function(t,n){Fs(t,n,Ar)}(a,n.mothership),Ds(c,n.uiMothership),t.on("PostRender",(function(){rB(t,n,e,o),i.set(t.getWin().innerWidth),YE.setMenubar(u,JE(t,e)),YE.setSidebar(u,e.sidebar),function(t,n){var e=t.dom,o=t.getWin(),r=t.getDoc().documentElement,i=Zn(uu(o.innerWidth,o.innerHeight)),u=Zn(uu(r.offsetWidth,r.offsetHeight)),a=function(){var n=i.get();n.left===o.innerWidth&&n.top===o.innerHeight||(i.set(uu(o.innerWidth,o.innerHeight)),qv(t))},c=function(){var n=t.getDoc().documentElement,e=u.get();e.left===n.offsetWidth&&e.top===n.offsetHeight||(u.set(uu(n.offsetWidth,n.offsetHeight)),qv(t))},s=function(n){return function(t,n){return t.fire("ScrollContent",n)}(t,n)};e.bind(o,"resize",a),e.bind(o,"scroll",s);var f=Eb(re(t.getBody()),"load",c),l=n.uiMothership.element;t.on("hide",(function(){Ri(l,"display","none")})),t.on("show",(function(){Ui(l,"display")})),t.on("NodeChange",c),t.on("remove",(function(){f.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null}))}(t,n)}));var s,f,l=YE.getSocket(u).getOrDie("Could not find expected socket element");if(uB){Vi(l.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var d=(s=function(){t.fire("ScrollContent")},20,f=null,{cancel:function(){null!==f&&(clearTimeout(f),f=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null===f&&(f=setTimeout((function(){s.apply(null,t),f=null}),20))}}),m=Tb(l.element,"scroll",d.throttle);t.on("remove",m.unbind)}nv(t,n),t.addCommand("ToggleSidebar",(function(n,e){YE.toggleSidebar(u,e),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return YE.whichSidebar(u)}));var g=Hh(t);g!==hp.sliding&&g!==hp.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=t.getWin().innerWidth;e!==i.get()&&(YE.refreshToolbar(n.outerContainer),i.set(e))}));var p={enable:function(){tv(n,!1)},disable:function(){tv(n,!0)},isDisabled:function(){return Oh.isDisabled(u)}};return{iframeContainer:l.element.dom,editorContainer:u.element.dom,api:p}}}),cB=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?D.some(parseInt(""+t,10)):D.none()},sB=function(t){return f(t)?t+"px":t},fB=function(t,n,e){var o=n.filter((function(n){return t<n})),r=e.filter((function(n){return t>n}));return o.or(r).getOr(t)},lB=function(t){var n=Eh(t),e=Bh(t),o=Mh(t);return cB(n).map((function(t){return fB(t,e,o)}))},dB=function(t,n){var e=Cu(t);return{pos:n?e.y:e.bottom,bounds:e}},mB=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=Zn(null),s=re(r.targetNode),f=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=fh.DOM,c=Wh(t),s=Yh(t),f=Mh(t).or(lB(t)),l=o.shared.header,d=l.isPositionedAtTop,m=Hh(t),g=m===hp.sliding||m===hp.floating,p=Zn(!1),h=function(){return p.get()&&!t.removed},v=function(t){return g?t.fold((function(){return 0}),(function(t){return t.components().length>1?ou(t.components()[1].element):0})):0},b=function(){i.broadcastOn([Xs()],{})},y=function(t){if(void 0===t&&(t=!1),h()){var e;if(c||(e=f.getOrThunk((function(){var t=cB(Hi(Mi(),"margin-left")).getOr(0);return lu(Mi())-cu(n).left+t})),Ri(r.get().element,"max-width",e+"px")),g&&YE.refreshToolbar(u),c||function(){var t=YE.getToolbar(u),e=v(t),o=Cu(n),i=d()?Math.max(o.y-ou(r.get().element)+e,0):o.bottom;Vi(u.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(o.x)+"px"})}(),s){var o=r.get();t?pE.reset(o):pE.refresh(o)}b()}},x=function(e){if(void 0===e&&(e=!0),!c&&s&&h()){var o=l.getDockingMode(),i=function(e){switch(Lh(t)){case Ph.auto:var o=YE.getToolbar(u),r=v(o),i=ou(e.element)-r,a=Cu(n);if(a.y>i)return"top";var c=hr(n),s=Math.max(c.dom.scrollHeight,ou(c));return a.bottom<s-i||_u().bottom<a.bottom-i?"bottom":"top";case Ph.bottom:return"bottom";case Ph.top:default:return"top"}}(r.get());i!==o&&(function(t){var n=r.get();pE.setModes(n,[t]),l.setDockingMode(t);var e=d()?Pu.TopToBottom:Pu.BottomToTop;Nr(n.element,xc,e)}(i),e&&y(!0))}};return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),Ri(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),Ui(i.element,"display"),x(!1),y()},hide:function(){p.set(!1),e.outerContainer&&(Ri(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),Ri(i.element,"display","none")},update:y,updateMode:x,repositionPopups:b}}(t,s,n,o,c),l=function(t){return t.getParam("toolbar_persist",!1,"boolean")}(t);oB(t);var d=function(){if(c.get())f.show();else{c.set(YE.getHeader(a).getOrDie());var r=Gh(t);Ds(r,i),Ds(r,u),rB(t,n,e,o),YE.setMenubar(a,JE(t,e)),f.show(),function(t,n,e,o){var r=Zn(dB(n,e.isPositionedAtTop())),i=function(o){var i=dB(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,f=c.bounds,l=a.height!==f.height||a.width!==f.width;r.set({pos:u,bounds:a}),l&&qv(t,o),e.isVisible()&&(s!==u?e.update(!0):l&&(e.updateMode(),e.repositionPopups()))};o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),t.on("NodeChange keydown",(function(t){Ag.requestAnimationFrame((function(){return i(t)}))})),t.on("ScrollWindow",(function(){return e.updateMode()}));var u=TT();u.set(Eb(re(t.getBody()),"load",i)),t.on("remove",(function(){u.clear()}))}(t,s,f,l),t.nodeChanged()}};t.on("show",d),t.on("hide",f.hide),l||(t.on("focus",d),t.on("blur",f.hide)),t.on("init",(function(){(t.hasFocus()||l)&&d()})),nv(t,n);var m={show:function(){f.show()},hide:function(){f.hide()},enable:function(){tv(n,!1)},disable:function(){tv(n,!0)},isDisabled:function(){return Oh.isDisabled(a)}};return{editorContainer:a.element.dom,api:m}}}),gB={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},pB=(lT="[eE][+-]?[0-9]+",mT=["Infinity","[0-9]+\\."+(dT=function(t){return"(?:"+t+")?"})("[0-9]+")+dT(lT),"\\.[0-9]+"+dT(lT),"[0-9]+"+dT(lT)].join("|"),new RegExp("^([+-]?(?:"+mT+"))(.*)$")),hB=function(t){return function(t,n){return function(t,n){return D.from(pB.exec(t)).bind((function(t){var e=Number(t[1]),o=t[2];return function(t,n){return H(n,(function(n){return H(gB[n],(function(n){return t===n}))}))}(o,n)?D.some({value:e,unit:o}):D.none()}))}(t,["fixed","relative","empty"]).map((function(t){return t.value+t.unit}))}(t).getOr(t)},vB=function(t){var n=function(t){return t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")}(t),e=new Map,o=_T(),r=function(){var n=hB(t.queryCommandValue("LineHeight"));D.from(e.get(n)).fold((function(){return o.clear()}),(function(t){o.set({destroy:function(){t.setActive(!1)}}),t.setActive(!0)}))};return t.on("nodeChange",r),L(n,(function(i,u){return{type:"togglemenuitem",text:i,onSetup:function(a){return e.set(hB(i),a),u+1===n.length&&r(),function(){0===u&&(t.off("nodeChange",r),o.clear())}},onAction:function(){return t.execCommand("LineHeight",!1,i)}}}))},bB=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},yB=function(t){(function(t){!function(t){gS.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:ET(t,n.name),onAction:bB(t,n.name)})}));for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:ET(t,e),onAction:bB(t,e)})}}(t),function(t){gS.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(n){t.ui.registry.addButton(n.name,{tooltip:n.text,icon:n.icon,onAction:function(){return t.execCommand(n.action)}})}))}(t),function(t){gS.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:function(){return t.execCommand(n.action)},onSetup:ET(t,n.name)})}))}(t)})(t),function(t){gS.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(n){t.ui.registry.addMenuItem(n.name,{text:n.text,icon:n.icon,shortcut:n.shortcut,onAction:function(){return t.execCommand(n.action)}})})),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:bB(t,"code")})}(t)},xB=function(t,n,e){var o=function(){return!!n.undoManager&&n.undoManager[e]()},r=function(){t.setDisabled(n.mode.isReadOnly()||!o())};return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},wB=function(t,n){!function(t){gS.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,onAction:function(){return t.execCommand(n.cmd)},icon:n.icon,onSetup:ET(t,n.name)})}));t.ui.registry.addButton("alignnone",{tooltip:"No alignment",onAction:function(){return t.execCommand("JustifyNone")},icon:"align-none"})}(t),yB(t),function(t,n){!function(t,n){var e=sT(0,n,vT(t));t.ui.registry.addNestedMenuItem("align",{text:n.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=sT(0,n,xT(t));t.ui.registry.addNestedMenuItem("fontformats",{text:n.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=S({type:"advanced"},n.styleselect),o=sT(0,n,MT(t,e));t.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})}(t,n),function(t,n){var e=sT(0,n,AT(t));t.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=sT(0,n,kT(t));t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n)}(t,n),function(t){!function(t){t.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(n){return xB(n,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(n){return xB(n,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}})}(t),function(t){t.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(n){return xB(n,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(n){return xB(n,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}})}(t)}(t),function(t){!function(t){t.addCommand("mceApplyTextcolor",(function(n,e){!function(t,n,e){t.undoManager.transact((function(){t.focus(),t.formatter.apply(n,{value:e}),t.nodeChanged()}))}(t,n,e)})),t.addCommand("mceRemoveTextcolor",(function(n){!function(t,n){t.undoManager.transact((function(){t.focus(),t.formatter.remove(n,{value:null},null,!0),t.nodeChanged()}))}(t,n)}))}(t);var n=Zn(null),e=Zn(null);cb(t,"forecolor","forecolor","Text color",n),cb(t,"backcolor","hilitecolor","Background color",e),sb(t,"forecolor","forecolor","Text color"),sb(t,"backcolor","hilitecolor","Background color")}(t),function(t){!function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return t.execCommand("mceToggleVisualAid")}})}(t),function(t){t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(n){return function(t,n){t.setActive(n.hasVisual);var e=function(n){t.setActive(n.hasVisual)};return n.on("VisualAid",e),function(){return n.off("VisualAid",e)}}(n,t)},onAction:function(){t.execCommand("mceToggleVisualAid")}})}(t)}(t),function(t){!function(t){t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(n){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"));var e=function(){t.setDisabled(!n.queryCommandState("outdent"))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(n,t)},onAction:function(){return t.execCommand("outdent")}}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return t.execCommand("indent")}})}(t)}(t),function(t){!function(t){t.ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return vB(t)}})}(t),function(t){t.ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(n){return n(vB(t))}})}(t)}(t)},SB=function(t,n){return{anchor:"makeshift",x:t,y:n}},kB=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},CB=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(kB(t)){var n=t.touches[0];return SB(n.pageX,n.pageY)}return SB(t.pageX,t.pageY)}(n):function(t,n){var e=fh.DOM.getPos(t);return function(t,n,e){return SB(t.x+n,t.y+e)}(n,e.x,e.y)}(t.getContentAreaContainer(),function(t){if(kB(t)){var n=t.touches[0];return SB(n.clientX,n.clientY)}return SB(t.clientX,t.clientY)}(n)):OB(t)},OB=function(t){return{anchor:"selection",root:re(t.selection.getNode())}},_B=function(t){return{anchor:"node",node:D.some(re(t.selection.getNode())),root:re(t.getBody())}},TB=function(t,n,e,o,r,i){var u=e(),a=i?_B(t):CB(t,n);wk(u,vp.CLOSE_ON_EXECUTE,o,!1).map((function(t){n.preventDefault(),bg.showMenuAt(r,a,{menu:{markers:Ap("normal")},data:t})}))},EB={onLtr:function(){return[Ca,ya,xa,wa,Sa,ka,Eg,Bg,_g,Cg,Tg,Og]},onRtl:function(){return[Ca,xa,ya,Sa,wa,ka,Eg,Bg,Tg,Og,_g,Cg]}},BB={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},AB=function(t,n,e,o,r,i){var u=He(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){var u=e();!function(t,n,e,o,r,i,u){var a=i?_B(t):function(t,n){return S({bubble:pc(0,12,BB),layouts:EB,overrides:{maxWidthFunction:EO(),maxHeightFunction:lc()}},CB(t,n))}(t,n);wk(e,vp.CLOSE_ON_EXECUTE,o,!0).map((function(e){n.preventDefault(),bg.showMenuWithinBounds(r,a,{menu:{markers:Ap("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return D.some(nT(t,o.shared))})),t.fire(BO)}))}(t,n,u,o,r,i,!(s||a||c&&f))};if(!c&&!a||i)s&&!i&&t.selection.setCursorLocation(n.target,0),l();else{var d=function(){!function(t){var n=t.selection.getRng(),e=function(){Ag.setEditorTimeout(t,(function(){t.selection.setRng(n)}),10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}}(t),l()};!function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng();return ts(t.getWin(),Lc.domRange(r)).exists((function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY}))}(t,n)?(t.once("selectionchange",d),t.once("touchend",(function(){return t.off("selectionchange",d)}))):d()}},MB=function(t){return"string"==typeof t?t.split(/[ ,]/):t},DB=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},FB=function(t){return o(t)?"|"===t:"separator"===t.type},IB={type:"separator"},RB=function(t){var n,e=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}};if(o(t))return t;switch(t.type){case"separator":return IB;case"submenu":return S(S({type:"nestedmenuitem"},e(t)),{getSubmenuItems:function(){var n=t.getSubmenuItems();return o(n)?n:L(n,RB)}});default:return S(S({type:"menuitem"},e(t)),{onAction:(n=t.onAction,function(){return n()})})}},VB=function(t,n){if(0===n.length)return t;var e=ot(t).filter((function(t){return!FB(t)})).fold((function(){return[]}),(function(t){return[IB]}));return t.concat(e).concat(n).concat([IB])},PB=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},HB=function(t,n){return PB(t,n)?t.selection.getStart(!0):n.target},zB=function(t,n,e){var r=He().deviceType.isTouch,i=Zi(bg.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:Ha([Am("dismissContextMenu",[Jo(Fo(),(function(n,e){Ws.close(n),t.focus()}))])])})),u=function(t){return bg.hide(i)},a=function(n){if(DB(t)&&n.preventDefault(),!function(t,n){return n.ctrlKey&&!DB(t)}(t,n)&&!function(t){return!1===t.getParam("contextmenu")}(t)){var u=function(t,n){var e=function(t){return t.getParam("contextmenu_avoid_overlap","","string")}(t);if(PB(t,n))return!0;if(e){var o=HB(t,n);return Ab(re(o),e)}return!1}(t,n);(r()?AB:TB)(t,n,(function(){var e=HB(t,n),r=t.ui.registry.getAll(),i=function(t){return function(t,n,e){var o=t.ui.registry.getAll().contextMenus;return D.from(t.getParam("contextmenu")).map(MB).getOrThunk((function(){return W(MB("link linkchecker image imagetools table spellchecker configurepermanentpen"),(function(t){return _t(o,t)}))}))}(t)}(t);return function(t,n,e){var r=X(n,(function(n,r){return Ot(t,r.toLowerCase()).map((function(t){var r=t.update(e);if(o(r))return VB(n,r.split(" "));if(r.length>0){var i=L(r,RB);return VB(n,i)}return n})).getOrThunk((function(){return n.concat([r])}))}),[]);return r.length>0&&FB(r[r.length-1])&&r.pop(),r}(r.contextMenus,i,e)}),e,i,u)}};t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");t.on(n,u),t.on("longpress contextmenu",a)}))},NB=Et([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),LB=function(t){return function(n){return n.translate(-t.left,-t.top)}},jB=function(t){return function(n){return n.translate(t.left,t.top)}},UB=function(t){return function(n,e){return X(t,(function(t,n){return n(t)}),uu(n,e))}},WB=function(t,n,e){return t.fold(UB([jB(e),LB(n)]),UB([LB(n)]),UB([]))},GB=function(t,n,e){return t.fold(UB([jB(e)]),UB([]),UB([jB(n)]))},XB=function(t,n,e){return t.fold(UB([]),UB([LB(e)]),UB([jB(n),LB(e)]))},YB=function(t,n,e){var o=t.fold((function(t,n){return{position:D.some("absolute"),left:D.some(t+"px"),top:D.some(n+"px")}}),(function(t,n){return{position:D.some("absolute"),left:D.some(t-e.left+"px"),top:D.some(n-e.top+"px")}}),(function(t,n){return{position:D.some("fixed"),left:D.some(t+"px"),top:D.some(n+"px")}}));return S({right:D.none(),bottom:D.none()},o)},qB=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return t.fold(r(XB,KB),r(GB,JB),r(WB,$B))},KB=NB.offset,JB=NB.absolute,$B=NB.fixed,QB=function(t,n){var e=Lr(t,n);return a(e)?NaN:parseInt(e,10)},ZB=function(t,n,e,o,r,i){var u=function(t,n,e,o){return function(t,n){var e=t.element,o=QB(e,n.leftAttr),r=QB(e,n.topAttr);return isNaN(o)||isNaN(r)?D.none():D.some(uu(o,r))}(t,n).fold((function(){return e}),(function(t){return $B(t.left+o.left,t.top+o.top)}))}(t,n,e,o),a=n.mustSnap?nA(t,n,u,r,i):eA(t,n,u,r,i),c=WB(u,r,i);return function(t,n,e){var o=t.element;Nr(o,n.leftAttr,e.left+"px"),Nr(o,n.topAttr,e.top+"px")}(t,n,c),a.fold((function(){return{coord:$B(c.left,c.top),extra:D.none()}}),(function(t){return{coord:t.output,extra:t.extra}}))},tA=function(t,n,e,o){return it(t,(function(t){var r=t.sensor;return function(t,n,e,o,r,i){var u=GB(t,r,i),a=GB(n,r,i);return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=o}(n,r,t.range.left,t.range.top,e,o)?D.some({output:qB(t.output,n,e,o),extra:t.extra}):D.none()}))},nA=function(t,n,e,o,r){var i=n.getSnapPoints(t);return tA(i,e,o,r).orThunk((function(){return X(i,(function(t,n){var i=n.sensor,u=function(t,n,e,o,r,i){var u=GB(t,r,i),a=GB(n,r,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top);return uu(c,s)}(e,i,n.range.left,n.range.top,o,r);return t.deltas.fold((function(){return{deltas:D.some(u),snap:D.some(n)}}),(function(e){return(u.left+u.top)/2<=(e.left+e.top)/2?{deltas:D.some(u),snap:D.some(n)}:t}))}),{deltas:D.none(),snap:D.none()}).snap.map((function(t){return{output:qB(t.output,e,o,r),extra:t.extra}}))}))},eA=function(t,n,e,o,r){var i=n.getSnapPoints(t);return tA(i,e,o,r)},oA=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=gr(t.element),u=hu(i),a=ZT(r),c=function(t,n,e){return{coord:qB(t.output,t.output,n,e),extra:t.extra}}(o,u,a),s=YB(c.coord,0,a);Pi(r,s)}}}),rA="data-initial-z-index",iA=function(t,n){t.getSystem().addToGui(n),function(t){br(t.element).filter(fr).each((function(n){Ni(n,"z-index").each((function(t){Nr(n,rA,t)})),Ri(n,"z-index",Hi(t.element,"z-index"))}))}(n)},uA=function(t){!function(t){br(t.element).filter(fr).each((function(t){jr(t,rA).fold((function(){return Ui(t,"z-index")}),(function(n){return Ri(t,"z-index",n)})),Wr(t,rA)}))}(t),t.getSystem().removeFromGui(t)},aA=function(t,n,e){return t.getSystem().build(jb.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},cA=jn("snaps",[En("getSnapPoints"),Ku("onSensor"),En("leftAttr"),En("topAttr"),Un("lazyViewport",_u),Un("mustSnap",!1)]),sA=[Un("useFixed",y),En("blockerClass"),Un("getTarget",p),Un("onDrag",d),Un("repositionTarget",!0),Un("onDrop",d),Kn("getBounds",_u),cA],fA=function(t,n){return{bounds:t.getBounds(),height:ru(n.element),width:du(n.element)}},lA=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return fA(n,t)}));i.each((function(e){!function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=gr(t.element),u=hu(i),a=ZT(r),c=function(t){return(n=Ni(t,"left"),e=Ni(t,"top"),o=Ni(t,"position"),r=function(t,n,e){return("fixed"===e?$B:KB)(parseInt(t,10),parseInt(n,10))},n.isSome()&&e.isSome()&&o.isSome()?D.some(r(n.getOrDie(),e.getOrDie(),o.getOrDie())):D.none()).getOrThunk((function(){var n=cu(t);return JB(n.left,n.top)}));var n,e,o,r}(r),s=function(t,n,e,o,r,i,u){return function(t,n,e,o,r){var i=r.bounds,u=GB(n,e,o),a=uc(u.left,i.x,i.x+i.width-r.width),c=uc(u.top,i.y,i.y+i.height-r.height),s=JB(a,c);return n.fold((function(){var t=XB(s,e,o);return KB(t.left,t.top)}),(function(){return s}),(function(){var t=WB(s,e,o);return $B(t.left,t.top)}))}(0,n.fold((function(){var t,n,u,a=(t=e,n=i.left,u=i.top,t.fold((function(t,e){return KB(t+n,e+u)}),(function(t,e){return JB(t+n,e+u)}),(function(t,e){return $B(t+n,e+u)}))),c=WB(a,o,r);return $B(c.left,c.top)}),(function(n){var u=ZB(t,n,e,i,o,r);return u.extra.each((function(e){n.onSensor(t,e)})),u.coord})),o,r,u)}(t,n.snaps,c,u,a,o,e),f=YB(s,0,a);Pi(r,f)}n.onDrag(t,r,o)}(t,n,u,e)}))},dA=function(t,n,e,o){n.each(uA),e.snaps.each((function(n){!function(t,n){!function(t,n){var e=t.element;Wr(e,n.leftAttr),Wr(e,n.topAttr)}(t,n)}(t,n)}));var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)},mA=function(t){return function(n,e){var o=function(t){e.setStartData(fA(n,t))};return Yo(C([Jo(Bo(),(function(t){e.getStartData().each((function(){return o(t)}))}))],t(n,e,o)))}},gA=Object.freeze({__proto__:null,getData:function(t){return D.from(uu(t.x,t.y))},getDelta:function(t,n){return uu(n.left-t.left,n.top-t.top)}}),pA=function(t,n,e){return[Jo(Ze(),(function(o,r){if(0===r.event.raw.button){r.stop();var i=function(){return dA(o,D.some(c),t,n)},u=Mb(i,200),a={drop:i,delayDrop:u.schedule,forceDrop:i,move:function(e){u.cancel(),lA(o,t,n,gA,e)}},c=aA(o,t.blockerClass,function(t){return Yo([Jo(Ze(),t.forceDrop),Jo(eo(),t.drop),Jo(to(),(function(n,e){t.move(e.event)})),Jo(no(),t.delayDrop)])}(a));e(o),iA(o,c)}}))]},hA=C(sA,[Zu("dragger",{handlers:mA(pA)})]),vA=Object.freeze({__proto__:null,getData:function(t){var n=t.raw.touches;return 1===n.length?function(t){var n=t[0];return D.some(uu(n.clientX,n.clientY))}(n):D.none()},getDelta:function(t,n){return uu(n.left-t.left,n.top-t.top)}}),bA=function(t,n,e){var o=Zn(D.none());return[Jo(Ke(),(function(r,i){i.stop();var u=function(){dA(r,o.get(),t,n),o.set(D.none())},a={drop:u,delayDrop:d,forceDrop:u,move:function(e){lA(r,t,n,vA,e)}},c=aA(r,t.blockerClass,function(t){return Yo([Jo(Ke(),t.forceDrop),Jo($e(),t.drop),Jo(Qe(),t.drop),Jo(Je(),(function(n,e){t.move(e.event)}))])}(a));o.set(D.some(c)),e(r),iA(r,c)})),Jo(Je(),(function(e,o){o.stop(),lA(e,t,n,vA,o.event)})),Jo($e(),(function(e,r){r.stop(),dA(e,o.get(),t,n),o.set(D.none())})),Jo(Qe(),(function(e){dA(e,o.get(),t,n),o.set(D.none())}))]},yA=hA,xA=C(sA,[Zu("dragger",{handlers:mA(bA)})]),wA=C(sA,[Zu("dragger",{handlers:mA((function(t,n,e){return C(pA(t,n,e),bA(t,n,e))}))})]),SA=ja({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:yA,touch:xA,mouseOrTouch:wA}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:D.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var t=D.none(),n=D.none(),e=g({});return mi({readState:e,reset:function(){t=D.none(),n=D.none()},update:function(n,e){return n.getData(e).bind((function(e){return function(n,e){var o=t.map((function(t){return n.getDelta(t,e)}));return t=D.some(e),o}(n,e)}))},getStartData:function(){return n},setStartData:function(t){n=D.some(t)}})}}),apis:oA}),kA=function(t,n,e,o,r,i){return t.fold((function(){return SA.snap({sensor:JB(e-20,o-20),range:uu(r,i),output:JB(D.some(e),D.some(o)),extra:{td:n}})}),(function(t){var r=e-20,i=o-20,u=t.element.dom.getBoundingClientRect();return SA.snap({sensor:JB(r,i),range:uu(40,40),output:JB(D.some(e-u.width/2),D.some(o-u.height/2)),extra:{td:n}})}))},CA=function(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r=o.td;(function(t,n){return t.exists((function(t){return Le(t,n)}))})(n.get(),r)||(n.set(D.some(r)),e(r))},mustSnap:!0}},OA=function(t){return Dg(Mg.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Ha([SA.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),ex.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},_A=function(t,n){var e=Zn([]),o=Zn([]),r=Zn(!1),i=Zn(D.none()),u=Zn(D.none()),a=function(t){var e=Ou(t);return kA(l.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(t){var e=Ou(t);return kA(d.getOpt(n),t,e.right,e.bottom,e.width,e.height)},s=CA((function(){return L(e.get(),(function(t){return a(t)}))}),i,(function(n){u.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),f=CA((function(){return L(o.get(),(function(t){return c(t)}))}),u,(function(n){i.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),l=OA(s),d=OA(f),m=Zi(l.asSpec()),g=Zi(d.asSpec()),p=function(n,e,o,r){var i=o(e);SA.snapTo(n,i),function(n,e,o,i){var u=e.dom.getBoundingClientRect();Ui(n.element,"display");var a=vr(re(t.getBody())).dom.innerHeight,c=u[r]<0,s=function(t,n){return t[r]>n}(u,a);(c||s)&&Ri(n.element,"display","none")}(n,e)},h=function(t){return p(m,t,a,"top")},v=function(t){return p(g,t,c,"bottom")};He().deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){r.get()||(Ts(n,m),Ts(n,g),r.set(!0)),i.set(D.some(t.start)),u.set(D.some(t.finish)),t.otherCells.each((function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),h(t.start),v(t.finish)}))})),t.on("ResizeEditor ResizeWindow ScrollContent",(function(){i.get().each(h),u.get().each(v)})),t.on("TableSelectionClear",(function(){r.get()&&(As(m),As(g),r.set(!1)),i.set(D.none()),u.set(D.none())})))},TA=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1};!function(t){t[t.None=0]="None",t[t.Both=1]="Both",t[t.Vertical=2]="Vertical"}(gT||(gT={}));var EA,BA,AA,MA=function(t,n,e){var o=re(t.getContainer()),r=function(t,n,e,o,r){var i={};return i.height=fB(o+n.top,Ah(t),Dh(t)),e===gT.Both&&(i.width=fB(r+n.left,Bh(t),Mh(t))),i}(t,n,e,ou(o),lu(o));yt(r,(function(t,n){return Ri(o,n,sB(t))})),function(t){t.fire("ResizeEditor")}(t)},DA=function(t,n,e,o){var r=uu(20*e,20*o);return MA(t,r,n),D.some(!0)},FA=function(t,n){var e=function(){var e,o=[];return t.getParam("elementpath",!0,"boolean")&&o.push(function(t,n,e){return n.delimiter||(n.delimiter=""),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Ha([Cm.config({mode:"flow",selector:"div[role=button]"}),Oh.config({disabled:e.isDisabled}),ev(),Kb.config({}),Bm.config({}),Am("elementPathEvents",[rr((function(o,r){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return Cm.focusIn(o)})),t.on("NodeChange",(function(r){var i,u,a=function(n){for(var e=[],o=n.length;o-- >0;){var r=n[o];if(1===r.nodeType&&!TA(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(r.parents);a.length>0?Bm.set(o,(i=L(a||[],(function(n,o){return Mg.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:Ha([ov(e.isDisabled),ev()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}},X(i.slice(1),(function(t,n){var e=t;return e.push(u),e.push(n),e}),[i[0]]))):Bm.set(o,[])}))}))])]),components:[]}}(t,{},n)),t.hasPlugin("wordcount")&&o.push(function(t,n){var e,o=function(t,e,o){return Bm.set(t,[Ji(n.translate(["{0} "+o,e[o]]))])};return Mg.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Ha([ov(n.isDisabled),ev(),Kb.config({}),Bm.config({}),lf.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Am("wordcount-events",[ar((function(t){var n=lf.getValue(t),e="words"===n.mode?"characters":"words";lf.setValue(t,{mode:e,count:n.count}),o(t,n.count,e)})),rr((function(n){t.on("wordCountUpdate",(function(t){var e=lf.getValue(n).mode;lf.setValue(n,{mode:e,count:t.wordCount}),o(n,t.wordCount,e)}))}))])]),eventOrder:(e={},e[xo()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})}(t,n)),t.getParam("branding",!0,"boolean")&&o.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(e=lh.translate(["Powered by {0}","Tiny"]))+'">'+e+"</a>"}}),o.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:o}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:function(){var o=e(),r=function(t,n){var e=function(t){var n=!t.hasPlugin("autoresize"),e=t.getParam("resize",n);return!1===e?gT.None:"both"===e?gT.Both:gT.Vertical}(t);return e===gT.None?D.none():D.some({dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},innerHtml:Ig("resize-handle",n.icons)},behaviours:Ha([SA.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,o,r){return MA(t,r,e)},blockerClass:"tox-blocker"}),Cm.config({mode:"special",onLeft:function(){return DA(t,e,-1,0)},onRight:function(){return DA(t,e,1,0)},onUp:function(){return DA(t,e,0,-1)},onDown:function(){return DA(t,e,0,1)}}),Kb.config({}),Rm.config({})])})}(t,n);return o.concat(r.toArray())}()}},IA=function(t){var n,e,o,r,i=t.inline,u=i?mB:aB,a=Yh(t)?kE:$T,c=D.none(),s=He(),l=s.browser.isIE()?["tox-platform-ie"]:[],m=s.deviceType.isTouch()?["tox-platform-touch"]:[],g=jh(t),p=Gh(t),h=lh.isRtl()?{attributes:{dir:"rtl"}}:{},v={attributes:(n={},n[xc]=g?Pu.BottomToTop:Pu.TopToBottom,n)},b=function(){return c.bind(YE.getHeader)},y=Zi((e=Le(Mi(),p)&&"grid"===Hi(p,"display"),o={dom:S({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(l).concat(m)},h),behaviours:Ha([Ss.config({useFixed:function(){return a.isDocked(b)}})])},r={dom:{styles:{width:document.body.clientWidth+"px"}},events:Yo([Jo(Ao(),(function(){Ri(X.element,"width",document.body.clientWidth+"px")}))])},Mt(o,e?r:{}))),x=function(){return ct.value(y)},w=Dg({dom:{tag:"div",classes:["tox-anchorbar"]}}),k=function(){return c.bind((function(t){return YE.getThrobber(t)})).getOrDie("Could not find throbber element")},C=function(t,n,e){var o=Zn(!1),r=function(t){var n=Zn(jh(t)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===n.get()},getDockingMode:n.get,setDockingMode:n.set}}(n),i={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:lh.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return function(t,n){return PC(RC,t,n)}(t,i)},anchors:UC(n,e,r.isPositionedAtTop),header:r,getSink:function(){return ct.value(t)}},urlinput:TO(n),styleselect:eO(n),colorinput:qC(n),dialog:JC(n),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(t){return o.set(t)}};return i}(y,t,(function(){return c.bind((function(t){return w.getOpt(t)})).getOrDie("Could not find a anchor bar element")})),O=YE.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:C,onEscape:function(){t.focus()}}),_=Hh(t),T=YE.parts.toolbar(S({dom:{tag:"div",classes:["tox-toolbar"]},getSink:x,providers:C.shared.providers,onEscape:function(){t.focus()},type:_,lazyToolbar:function(){return c.bind((function(t){return YE.getToolbar(t)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return b().getOrDie("Could not find header element")}},v)),E=YE.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:C.shared.providers,onEscape:function(){t.focus()},type:_}),B=YE.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),A=YE.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),M=YE.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:C}),F=t.getParam("statusbar",!0,"boolean")&&!i?D.some(FA(t,C.shared.providers)):D.none(),I={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[B,A]},R=Vh(t),V=Ih(t),P=Fh(t),H=YE.parts.header({dom:S({tag:"div",classes:["tox-editor-header"]},v),components:K([P?[O]:[],R?[E]:V?[T]:[],Wh(t)?[]:[w.asSpec()]]),sticky:Yh(t),editor:t,sharedBackstage:C.shared}),z=K([g?[]:[H],i?[]:[I],g?[H]:[]]),N=K([[{dom:{tag:"div",classes:["tox-editor-container"]},components:z}],i?[]:F.toArray(),[M]]),L=Xh(t),U=S(S({role:"application"},lh.isRtl()?{dir:"rtl"}:{}),L?{"aria-hidden":"true"}:{}),W=Zi(YE.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(i?["tox-tinymce-inline"]:[]).concat(g?["tox-tinymce--toolbar-bottom"]:[]).concat(m).concat(l),styles:S({visibility:"hidden"},L?{opacity:"0",border:"0"}:{}),attributes:U},components:N,behaviours:Ha([ev(),Oh.config({disableClass:"tox-tinymce--disabled"}),Cm.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}));c=D.some(W),t.shortcuts.add("alt+F9","focus menubar",(function(){YE.focusMenubar(W)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){YE.focusToolbar(W)})),t.addCommand("ToggleToolbarDrawer",(function(){YE.toggleToolbarDrawer(W)})),t.addQueryStateHandler("ToggleToolbarDrawer",(function(){return YE.isToolbarDrawerToggled(W)}));var G=Ub(W),X=Ub(y);!function(t,n,e){var o=function(t,o){j([n,e],(function(n){n.broadcastEvent(t,o)}))},r=function(t,o){j([n,e],(function(n){n.broadcastOn([t],o)}))},i=function(t){return r(Gs(),{target:t.target})},u=Tb(re(document),"touchstart",i),a=Tb(re(document),"touchmove",(function(t){return o(To(),t)})),c=Tb(re(document),"touchend",(function(t){return o(Eo(),t)})),s=Tb(re(document),"mousedown",i),f=Tb(re(document),"mouseup",(function(t){0===t.raw.button&&r(Ys(),{target:t.target})})),l=function(t){return r(Gs(),{target:re(t.target)})},d=function(t){0===t.button&&r(Ys(),{target:re(t.target)})},m=function(t){return o(Bo(),Bb(t))},g=function(t){r(Xs(),{}),o(Ao(),Bb(t))},p=function(){return r(Xs(),{})},h=function(n){n.state&&r(Gs(),{target:re(t.getContainer())})};t.on("PostRender",(function(){t.on("click",l),t.on("tap",l),t.on("mouseup",d),t.on("ScrollWindow",m),t.on("ResizeWindow",g),t.on("ResizeEditor",p),t.on("AfterProgressState",h)})),t.on("remove",(function(){t.off("click",l),t.off("tap",l),t.off("mouseup",d),t.off("ScrollWindow",m),t.off("ResizeWindow",g),t.off("ResizeEditor",p),t.off("AfterProgressState",h),s.unbind(),u.unbind(),a.unbind(),c.unbind(),f.unbind()})),t.on("detach",(function(){Is(n),Is(e),n.destroy(),e.destroy()}))}(t,G,X);var Y=function(){var n=sB(function(t){return function(t){var n=Th(t),e=Ah(t),o=Dh(t);return cB(n).map((function(t){return fB(t,e,o)}))}(t).getOr(Th(t))}(t)),e=sB(function(t){return lB(t).getOr(Eh(t))}(t));return t.inline||(ji("div","width",e)&&Ri(W.element,"width",e),ji("div","height",n)?Ri(W.element,"height",n):Ri(W.element,"height","200px")),n};return{mothership:G,uiMothership:X,backstage:C,renderUI:function(){a.setup(t,C.shared,b),wB(t,C),zB(t,x,C),function(t){var n=t.ui.registry.getAll().sidebars;j(vt(n),(function(e){var o=n[e],r=function(){return D.from(t.queryCommandValue("ToggleSidebar")).is(e)};t.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(n){t.execCommand("ToggleSidebar",!1,e),n.setActive(r())},onSetup:function(n){var e=function(){return n.setActive(r())};return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})}))}(t),function(t,n,e){var o=Zn(!1),r=Zn(D.none()),i=function(r){r!==o.get()&&(function(t,n,e){var o=t.element;!0===n?(Bm.set(t,[zE(e)]),Ui(o,"display"),Wr(o,"aria-hidden")):(Bm.set(t,[]),Ri(o,"display","none"),Nr(o,"aria-hidden","true"))}(n(),r,e.providers),o.set(r),t.fire("AfterProgressState",{state:r}))};t.on("ProgressState",(function(n){if(r.get().each(Ag.clearTimeout),f(n.time)){var e=Ag.setEditorTimeout(t,(function(){return i(n.state)}),n.time);r.set(D.some(e))}else i(n.state),r.set(D.none())}))}(t,k,C.shared),xt(function(t){return t.getParam("toolbar_groups",{},"object")}(t),(function(n,e){t.ui.registry.addGroupToolbarButton(e,n)}));var n=t.ui.registry.getAll(),e=n.buttons,o=n.menuItems,r=n.contextToolbars,i=n.sidebars,c=Rh(t),s={menuItems:o,menus:qh(t),menubar:Kh(t),toolbar:c.getOrThunk((function(){return function(t){return t.getParam("toolbar",!0)}(t)})),allowToolbarGroups:_===hp.floating,buttons:e,sidebar:i};LT(t,r,y,{backstage:C}),_A(t,y);var l=t.getElement(),d=Y(),m={mothership:G,uiMothership:X,outerContainer:W},g={targetNode:l,height:d};return u.render(t,m,s,C,g)},getUi:function(){return{channels:{broadcastAll:X.broadcast,broadcastOn:X.broadcastOn,register:d}}}}},RA=g([En("lazySink"),Pn("dragBlockClass"),Kn("getBounds",_u),Un("useTabstopAt",x),Un("eventOrder",{}),df("modalBehaviours",[Cm]),Ju("onExecute"),Qu("onEscape")]),VA={sketch:p},PA=g([Lf({name:"draghandle",overrides:function(t,n){return{behaviours:Ha([SA.config({mode:"mouse",getTarget:function(t){return Du(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),zf({schema:[En("dom")],name:"title"}),zf({factory:VA,schema:[En("dom")],name:"close"}),zf({factory:VA,schema:[En("dom")],name:"body"}),Lf({factory:VA,schema:[En("dom")],name:"footer"}),Nf({factory:{sketch:function(t,n){return S(S({},t),{dom:n.dom,components:n.components})}},schema:[Un("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Un("components",[])],name:"blocker"})]),HA=Object.freeze({__proto__:null,block:function(t,n,e,o){Nr(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=Ha([Cm.config({mode:"special",onTab:function(){return D.some(!0)},onShiftTab:function(){return D.some(!0)}}),Rm.config({})]),u=o(r,i),a=r.getSystem().build(u);Bm.append(r,tu(a)),a.hasConfigured(Cm)&&Cm.focusIn(a),e.isBlocked()||n.onBlock(t),e.blockWith((function(){return Bm.remove(r,a)}))},unblock:function(t,n,e){Wr(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),zA=[Kn("getRoot",D.none),Ku("onBlock"),Ku("onUnblock")],NA=Na({fields:zA,name:"blocking",apis:HA,state:Object.freeze({__proto__:null,init:function(){var t=_T();return mi({readState:t.isSet,blockWith:function(n){t.set({destroy:n})},clear:t.clear,isBlocked:t.isSet})}})}),LA=gl({name:"ModalDialog",configFields:RA(),partFields:PA(),factory:function(t,n,e,o){var r,i=Zn(D.none()),u=Jr("modal-events"),a=S(S({},t.eventOrder),((r={})[Mo()]=[u].concat(t.eventOrder["alloy.system.attached"]||[]),r));return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){i.set(D.some(n));var e=t.lazySink(n).getOrDie(),r=o.blocker(),u=e.getSystem().build(S(S({},r),{components:r.components.concat([tu(n)]),behaviours:Ha([Rm.config({}),Am("dialog-blocker-events",[or(ro(),(function(){Cm.focusIn(n)}))])])}));Ts(e,u),Cm.focusIn(n)},hide:function(t){i.set(D.none()),br(t.element).each((function(n){t.getSystem().getByDom(n).each((function(t){As(t)}))}))},getBody:function(n){return tl(n,t,"body")},getFooter:function(n){return tl(n,t,"footer")},setIdle:function(t){NA.unblock(t)},setBusy:function(t,n){NA.block(t,n)}},eventOrder:a,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:gf(t.modalBehaviours,[Bm.config({}),Cm.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),NA.config({getRoot:i.get}),Am(u,[rr((function(n){var e,o,r,i,u,a;e=n.element,o=tl(n,t,"title").element,r=jr(e,"id").fold((function(){var t=Jr("dialog-label");return Nr(o,"id",t),t}),p),Nr(e,"aria-labelledby",r),i=n.element,u=tl(n,t,"body").element,a=D.from(Lr(i,"id")).fold((function(){var t=Jr("dialog-describe");return Nr(u,"id",t),t}),p),Nr(i,"aria-describedby",a)}))])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),jA=Zt([Mn("type"),Mn("name")].concat(Yp)),UA=kn,WA=[un("name","name",Ht((function(){return Jr("button-name")})),Sn),Nn("icon"),Yn("align","end",["start","end"]),qn("primary",!1),qn("disabled",!1)],GA=C(WA,[Mn("text")]),XA=C([Dn("type",["submit","cancel","custom"])],GA),YA=C([Dn("type",["menu"]),Nn("text"),Nn("tooltip"),Nn("icon"),Vn("items",jA)],WA),qA=bn("type",{submit:XA,cancel:XA,custom:XA,menu:YA}),KA=[Mn("type"),Mn("text"),Dn("level",["info","warn","error","success"]),Mn("icon"),Un("url","")],JA=Zt(KA),$A=[Mn("type"),Mn("text"),qn("disabled",!1),qn("primary",!1),un("name","name",Ht((function(){return Jr("button-name")})),Sn),Nn("icon"),qn("borderless",!1)],QA=Zt($A),ZA=[Mn("type"),Mn("name"),Mn("label"),qn("disabled",!1)],tM=Zt(ZA),nM=kn,eM=[Mn("type"),Mn("name")],oM=eM.concat([Nn("label")]),rM=oM.concat([Un("columns","auto")]),iM=Zt(rM),uM=sn([Mn("value"),Mn("text"),Mn("icon")]),aM=Zt(oM),cM=Sn,sM=Zt(oM),fM=Sn,lM=eM.concat([Xn("tag","textarea"),Mn("scriptId"),Mn("scriptUrl"),Wn("settings",void 0,_n)]),dM=eM.concat([Xn("tag","textarea"),Fn("init")]),mM=ln((function(t){return mn("customeditor.old",Qt(dM),t).orThunk((function(){return mn("customeditor.new",Qt(lM),t)}))})),gM=Sn,pM=Zt(oM),hM=tn(cn),vM=function(t){return[Mn("type"),An("columns"),t]},bM=[Mn("type"),Mn("html"),Yn("presets","presentation",["presentation","document"])],yM=Zt(bM),xM=oM.concat([qn("sandboxed",!0)]),wM=Zt(xM),SM=Sn,kM=oM.concat([Bn("currentState",Zt([En("blob"),Mn("url")]))]),CM=Zt(kM),OM=oM.concat([Nn("inputMode"),Nn("placeholder"),qn("maximized",!1),qn("disabled",!1)]),_M=Zt(OM),TM=Sn,EM=function(t){return[Mn("type"),Mn("label"),t]},BM=[Mn("text"),Mn("value")],AM=[Mn("text"),Vn("items",(BA=function(){return MM},AA=Ft((function(){return BA()})),{extract:function(t,n,e){return AA().extract(t,n,e)},toString:function(){return AA().toString()}}))],MM=nn([Zt(BM),Zt(AM)]),DM=oM.concat([Vn("items",MM),qn("disabled",!1)]),FM=Zt(DM),IM=Sn,RM=oM.concat([Rn("items",[Mn("text"),Mn("value")]),Gn("size",1),qn("disabled",!1)]),VM=Zt(RM),PM=Sn,HM=oM.concat([qn("constrain",!0),qn("disabled",!1)]),zM=Zt(HM),NM=Zt([Mn("width"),Mn("height")]),LM=[Mn("type"),Vn("header",Sn),Vn("cells",tn(Sn))],jM=Zt(LM),UM=oM.concat([Nn("placeholder"),qn("maximized",!1),qn("disabled",!1)]),WM=Zt(UM),GM=Sn,XM=oM.concat([Yn("filetype","file",["image","media","file"]),Un("disabled",!1)]),YM=Zt(XM),qM=Zt([Mn("value"),Un("meta",{})]),KM=function(t){return un("items","items",Vt(),tn(ln((function(n){return mn("Checking item of "+t,JM,n).fold((function(t){return ct.error(hn(t))}),(function(t){return ct.value(t)}))}))))},JM=fn((function(){return vn("type",{alertbanner:JA,bar:Zt((t=KM("bar"),[Mn("type"),t])),button:QA,checkbox:tM,colorinput:aM,colorpicker:sM,dropzone:pM,grid:Zt(vM(KM("grid"))),iframe:wM,input:_M,listbox:FM,selectbox:VM,sizeinput:zM,textarea:WM,urlinput:YM,customeditor:mM,htmlpanel:yM,imagetools:CM,collection:iM,label:Zt(EM(KM("label"))),table:jM,panel:QM});var t})),$M=[Mn("type"),Un("classes",[]),Vn("items",JM)],QM=Zt($M),ZM=[un("name","name",Ht((function(){return Jr("tab-name")})),Sn),Mn("title"),Vn("items",JM)],tD=[Mn("type"),Rn("tabs",ZM)],nD=Zt(tD),eD=GA,oD=qA,rD=Zt([Mn("title"),Bn("body",vn("type",{panel:QM,tabpanel:nD})),Xn("size","normal"),Vn("buttons",oD),Un("initialData",{}),Kn("onAction",d),Kn("onChange",d),Kn("onSubmit",d),Kn("onClose",d),Kn("onCancel",d),Un("onTabChange",d)]),iD=Zt(C([Dn("type",["cancel","custom"])],eD)),uD=Zt([Mn("title"),Mn("url"),zn("height"),zn("width"),(EA=iD,Hn("buttons",tn(EA))),Kn("onAction",d),Kn("onCancel",d),Kn("onClose",d),Kn("onMessage",d)]),aD=function(t){return r(t)?[t].concat(J(Ct(t),aD)):i(t)?J(t,aD):[]},cD=function(t){return o(t.type)&&o(t.name)},sD={checkbox:nM,colorinput:cM,colorpicker:fM,dropzone:hM,input:TM,iframe:SM,sizeinput:NM,selectbox:PM,listbox:IM,size:NM,textarea:GM,urlinput:qM,customeditor:gM,collection:uM,togglemenuitem:UA},fD=function(t){var n=function(t){return W(aD(t),cD)}(t),e=J(n,(function(t){return function(t){return D.from(sD[t.type])}(t).fold((function(){return[]}),(function(n){return[Bn(t.name,n)]}))}));return Zt(e)},lD=function(t){return{internalDialog:gn(mn("dialog",rD,t)),dataValidator:fD(t),initialData:t.initialData}},dD={open:function(t,n){var e=lD(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(gn(mn("dialog",uD,n)))},redial:function(t){return lD(t)}},mD=function(t){var n=[],e={};return yt(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),n.length>0?ct.error(n):ct.value(e)},gD=function(t,n){var e,o=Dg(eS.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:L(t.items,(function(t){return VC(e,t,n)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[o.asSpec()]}],behaviours:Ha([Cm.config({mode:"acyclic",useTabstopAt:v(TS)}),(e=o,xl.config({find:e.getOpt})),vS(o,{postprocess:function(t){return mD(t).fold((function(t){return console.error(t),{}}),(function(t){return t}))}})])}},pD=ml({name:"TabButton",configFields:[Un("uid",void 0),En("value"),un("dom","dom",zt((function(){return{attributes:{role:"tab",id:Jr("aria"),"aria-selected":"false"}}})),yn()),Pn("action"),Un("domModification",{}),df("tabButtonBehaviours",[Rm,Cm,lf]),En("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:Km(t.action),behaviours:gf(t.tabButtonBehaviours,[Rm.config({}),Cm.config({mode:"execution",useSpace:!0,useEnter:!0}),lf.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),hD=g([En("tabs"),En("dom"),Un("clickToDismiss",!1),df("tabbarBehaviours",[Al,Cm]),Yu(["tabClass","selectedClass"])]),vD=jf({factory:pD,name:"tabs",unit:"tab",overrides:function(t){var n=function(t,n){Al.dehighlight(t,n),jo(t,Ho(),{tabbar:t,button:n})},e=function(t,n){Al.highlight(t,n),jo(t,Po(),{tabbar:t,button:n})};return{action:function(o){var r=o.getSystem().getByUid(t.uid).getOrDie(),i=Al.isHighlighted(r,o);(i&&t.clickToDismiss?n:i?d:e)(r,o)},domModification:{classes:[t.markers.tabClass]}}}}),bD=g([vD]),yD=gl({name:"Tabbar",configFields:hD(),partFields:bD(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:gf(t.tabbarBehaviours,[Al.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){Nr(n.element,"aria-selected","true")},onDehighlight:function(t,n){Nr(n.element,"aria-selected","false")}}),Cm.config({mode:"flow",getInitial:function(t){return Al.getHighlighted(t).map((function(t){return t.element}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),xD=ml({name:"Tabview",configFields:[df("tabviewBehaviours",[Bm])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:gf(t.tabviewBehaviours,[Bm.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),wD=g([Un("selectFirst",!0),Ku("onChangeTab"),Ku("onDismissTab"),Un("tabs",[]),df("tabSectionBehaviours",[])]),SD=zf({factory:yD,schema:[En("dom"),In("markers",[En("tabClass"),En("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),kD=zf({factory:xD,name:"tabview"}),CD=g([SD,kD]),OD=gl({name:"TabSection",configFields:wD(),partFields:CD(),factory:function(t,n,e,o){var r=function(n,e){Zf(n,t,"tabbar").each((function(t){e(t).each(Uo)}))};return{uid:t.uid,dom:t.dom,components:n,behaviours:mf(t.tabSectionBehaviours),events:Yo(K([t.selectFirst?[rr((function(t,n){r(t,Al.getFirst)}))]:[],[Jo(Po(),(function(n,e){var o,r;o=e.event.button,r=lf.getValue(o),Zf(o,t,"tabview").each((function(n){Y(t.tabs,(function(t){return t.value===r})).each((function(e){var r=e.view();jr(o.element,"id").each((function(t){Nr(n.element,"aria-labelledby",t)})),Bm.set(n,r),t.onChangeTab(n,o,r)}))}))})),Jo(Ho(),(function(n,e){var o=e.event.button;t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return Zf(n,t,"tabview").map((function(t){return Bm.contents(t)})).getOr([])},showTab:function(t,n){r(t,(function(t){var e=Al.getCandidates(t);return Y(e,(function(t){return lf.getValue(t)===n})).filter((function(n){return!Al.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),_D=function(t,n){Ri(t,"height",n+"px"),He().browser.isIE()?Ui(t,"flex-basis"):Ri(t,"flex-basis",n+"px")},TD=function(t,n,e){Du(t,'[role="dialog"]').each((function(t){Fu(t,'[role="tablist"]').each((function(o){e.get().map((function(e){return Ri(n,"height","0"),Ri(n,"flex-basis","0"),Math.min(e,function(t,n,e){var o,r=hr(t).dom,i=Du(t,".tox-dialog-wrap").getOr(t);o="fixed"===Hi(i,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);var u=ou(n),a=n.dom.offsetLeft>=e.dom.offsetLeft+lu(e)?Math.max(ou(e),u):u,c=parseInt(Hi(t,"margin-top"),10)||0,s=parseInt(Hi(t,"margin-bottom"),10)||0;return o-(ou(t)+c+s-a)}(t,n,o))})).each((function(t){_D(n,t)}))}))}))},ED=function(t){return Fu(t,'[role="tabpanel"]')},BD="send-data-to-section",AD="send-data-to-view",MD=function(t,n){var e=Zn({}),o=function(t){var n=lf.getValue(t),o=mD(n).getOr({}),r=e.get(),i=Mt(r,o);e.set(i)},r=function(t){var n=e.get();lf.setValue(t,n)},i=Zn(null),u=L(t.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(t.title)},view:function(){return[eS.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:L(t.items,(function(t){return VC(e,t,n)})),formBehaviours:Ha([Cm.config({mode:"acyclic",useTabstopAt:v(TS)}),Am("TabView.form.events",[rr(r),ir(o)]),Wa.config({channels:jt([{key:BD,value:{onReceive:o}},{key:AD,value:{onReceive:r}}])})])}}))]}}})),a=function(t){var n;return{smartTabHeight:(n=Zn(D.none()),{extraEvents:[rr((function(e){var o=e.element;ED(o).each((function(r){Ri(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){var o,i=(o=function(t,n,e){return L(t,(function(o,r){Bm.set(e,t[r].view());var i=n.dom.getBoundingClientRect();return Bm.set(e,[]),i.height}))}(t,r,e),et(tt(o,(function(t,n){return t>n?-1:t<n?1:0}))));n.set(i)})),TD(o,r,n),Ui(r,"visibility"),function(t,n){et(t).each((function(t){return OD.showTab(n,t.value)}))}(t,e),Ag.requestAnimationFrame((function(){TD(o,r,n)}))}))})),Jo(Ao(),(function(t){var e=t.element;ED(e).each((function(t){TD(e,t,n)}))})),Jo(sy,(function(t,e){var o=t.element;ED(o).each((function(t){var e=Ya(Or(t));Ri(t,"visibility","hidden");var r=Ni(t,"height").map((function(t){return parseInt(t,10)}));Ui(t,"height"),Ui(t,"flex-basis");var i=t.dom.getBoundingClientRect().height;r.forall((function(t){return i>t}))?(n.set(D.from(i)),TD(o,t,n)):r.each((function(n){_D(t,n)})),Ui(t,"visibility"),e.each(Xa)}))}))],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}}(u).smartTabHeight;return OD.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=lf.getValue(n);jo(t,cy,{name:o,oldName:i.get()}),i.set(o)},tabs:u,components:[OD.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[yD.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Ha([Kb.config({})])}),OD.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:Ha([Am("tabpanel",a.extraEvents),Cm.config({mode:"acyclic"}),xl.config({find:function(t){return et(OD.getViewItems(t))}}),lf.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([BD],{}),e.get()},setValue:function(t,n){e.set(n),t.getSystem().broadcastOn([AD],{})}}})])})},DD=Jr("update-dialog"),FD=Jr("update-title"),ID=Jr("update-body"),RD=Jr("update-footer"),VD=Jr("body-send-message"),PD=function(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:S(S({},n.map((function(t){return{id:t}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:Ha([fS(0),V_.config({channel:ID,updateState:function(t,n){return D.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[MD(t.body,e)];default:return[gD(t.body,e)]}},initialData:t})])}},HD=gv.deviceType.isTouch(),zD=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},ND=function(t,n){return LA.parts.close(Mg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:Ha([Kb.config({})])}))},LD=function(){return LA.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},jD=function(t,n){return LA.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:HE("<p>"+n.translate(t)+"</p>")}]}]})},UD=function(t){return LA.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},WD=function(t,n){return[jb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),jb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},GD=function(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return LA.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),D.some(!0)},useTabstopAt:function(t){return!TS(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:S({position:"relative"},t.extraStyles)},components:C([t.header,t.body],t.footer.toArray()),parts:{blocker:{dom:HE('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:HD?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:Ha(C([Rm.config({}),Am("dialog-events",t.dialogEvents.concat([or(ro(),(function(t,n){Cm.focusIn(t)}))])),Am("scroll-lock",[rr((function(){Ci(Mi(),i)})),ir((function(){Oi(Mi(),i)}))])],t.extraBehaviours)),eventOrder:S((n={},n[xo()]=["dialog-events"],n[Mo()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[Do()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},XD=function(t){return Mg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Ig("close",t.icons)}}],action:function(t){Lo(t,oy)}})},YD=function(t,n,e){var o=function(t){return[Ji(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:S({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:Ha([V_.config({channel:FD,renderComponents:o})])}},qD=function(){return{dom:HE('<div class="tox-dialog__draghandle"></div>')}},KD=function(t,n){return function(t,n){var e=LA.parts.title(YD(t,D.none(),n)),o=LA.parts.draghandle(qD()),r=LA.parts.close(XD(n)),i=[e].concat(t.draggable?[o]:[]).concat([r]);return jb.sketch({dom:HE('<div class="tox-dialog__header"></div>'),components:i})}({title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},n.shared.providers)},JD=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:HE('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},$D=function(t,n,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){LA.setBusy(t(),(function(t,o){return JD(e.message,o,n)}))},onUnblock:function(){LA.setIdle(t())}}},QD=function(t,n,e,o){var r;return Zi(GD(S(S({},t),{lazySink:o.shared.getSink,extraBehaviours:C([V_.config({channel:DD,updateState:function(t,n){return D.some(n)},initialData:n}),xS({})],t.extraBehaviours),onEscape:function(t){Lo(t,oy)},dialogEvents:e,eventOrder:(r={},r[yo()]=[V_.name(),Wa.name()],r[Mo()]=["scroll-lock",V_.name(),"messages","dialog-events","alloy.base.behaviour"],r[Do()]=["alloy.base.behaviour","dialog-events","messages",V_.name(),"scroll-lock"],r)})))},ZD=function(t){return L(t,(function(t){return"menu"===t.type?function(t){var n=L(t.items,(function(t){var n=Zn(!1);return S(S({},t),{storage:n})}));return S(S({},t),{items:n})}(t):t}))},tF=function(t){return X(t,(function(t,n){return"menu"===n.type?X(n.items,(function(t,n){return t[n.name]=n.storage,t}),t):t}),{})},nF=function(t,n){return[tr(ro(),_S),t(ey,(function(t,e){n.onClose(),e.onClose()})),t(oy,(function(t,n,e,o){n.onCancel(t),Lo(o,ey)})),Jo(ay,(function(t,e){return n.onUnblock()})),Jo(uy,(function(t,e){return n.onBlock(e.event)}))]},eF=function(t,n,e){var o=function(n,e){return Jo(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event,n)}))}))},r=function(t,n){V_.getState(t).get().each((function(e){n(e.internalDialog,t)}))};return C(nF(o,n),[o(iy,(function(t,n){return n.onSubmit(t)})),o(ny,(function(t,n,e){n.onChange(t,{name:e.name})})),o(ry,(function(t,n,o,r){var i=function(){return Cm.focusIn(r)},u=function(t){return Ur(t,"disabled")||jr(t,"aria-disabled").exists((function(t){return"true"===t}))},a=Or(r.element),c=Ya(a);n.onAction(t,{name:o.name,value:o.value}),Ya(a).fold(i,(function(t){u(t)||c.exists((function(n){return je(t,n)&&u(n)}))?i():e().toOptional().filter((function(n){return!je(n.element,t)})).each(i)}))})),o(cy,(function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})})),ir((function(n){var e=t();lf.setValue(n,e.getData())}))])},oF=function(t,n){var e=n.map((function(t){return t.footerButtons})).getOr([]),o=U(e,(function(t){return"start"===t.align})),r=function(t,n){return jb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:L(n,(function(t){return t.memento.asSpec()}))})};return[r("start",o.pass),r("end",o.fail)]},rF=function(t,n){return{dom:HE('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Ha([V_.config({channel:RD,initialData:t,updateState:function(t,e){var o=L(e.buttons,(function(t){var e=Dg(function(t,n){return Mk(t,t.type,n)}(t,n));return{name:t.name,align:t.align,memento:e}}));return D.some({lookupByName:function(t,n){return function(t,n,e){return Y(n,(function(t){return t.name===e})).bind((function(n){return n.memento.getOpt(t)}))}(t,o,n)},footerButtons:o})},renderComponents:oF})])}},iF=function(t,n){return LA.parts.footer(rF(t,n))},uF=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=xl.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return eS.getField(e,n).fold((function(){var o=t.getFooter();return V_.getState(o).get().bind((function(t){return t.lookupByName(e,n)}))}),(function(t){return D.some(t)}))}return D.none()},aF=function(t,n,e){var r=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},i={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=lf.getValue(o),i=xt(e,(function(t){return t.get()}));return S(S({},r),i)},setData:function(n){r((function(o){var r=i.getData(),u=S(S({},r),n),a=function(t,n){var e=t.getRoot();return V_.getState(e).get().map((function(t){return gn(mn("data",t.dataValidator,n))})).getOr(n)}(t,u),c=t.getFormWrapper();lf.setValue(c,a),yt(e,(function(t,n){_t(u,n)&&t.set(u[n])}))}))},disable:function(n){uF(t,n).each(Oh.disable)},enable:function(n){uF(t,n).each(Oh.enable)},focus:function(n){uF(t,n).each(Rm.focus)},block:function(t){if(!o(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");r((function(n){jo(n,uy,{message:t})}))},unblock:function(){r((function(t){Lo(t,ay)}))},showTab:function(n){r((function(e){var o=t.getBody();V_.getState(o).get().exists((function(t){return t.isTabPanel()}))&&xl.getCurrent(o).each((function(t){OD.showTab(t,n)}))}))},redial:function(t){r((function(e){var o=n(t);e.getSystem().broadcastOn([DD],o),e.getSystem().broadcastOn([FD],o.internalDialog),e.getSystem().broadcastOn([ID],o.internalDialog),e.getSystem().broadcastOn([RD],o.internalDialog),i.setData(o.initialData)}))},close:function(){r((function(t){Lo(t,ey)}))}};return i},cF=tinymce.util.Tools.resolve("tinymce.util.URI"),sF=["insertContent","setContent","execCommand","close","block","unblock"],fF=function(t){return r(t)&&-1!==sF.indexOf(t.mceAction)},lF=function(t,n,e,i){var a,c,s,f,l,d,m,g,p=KD(t.title,i),h=(g={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[CS({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:Ha([Kb.config({}),Rm.config({})])})]}],behaviours:Ha([Cm.config({mode:"acyclic",useTabstopAt:v(TS)})])},LA.parts.body(g)),b=t.buttons.bind((function(t){return 0===t.length?D.none():D.some(iF({buttons:t},i))})),y=(f=function(){return B},l=$D((function(){return E}),i.shared.providers,n),d=function(t,n){return Jo(t,(function(t,e){m(t,(function(o,r){n(f(),o,e.event,t)}))}))},m=function(t,n){V_.getState(t).get().each((function(e){n(e,t)}))},C(nF(d,l),[d(ry,(function(t,n,e){n.onAction(t,{name:e.name})}))])),x=S(S({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),w=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],k=new cF(t.url,{base_uri:new cF(window.location.href)}),O=k.protocol+"://"+k.host+(k.port?":"+k.port:""),_=Zn(D.none()),T=[Am("messages",[rr((function(){var n=Tb(re(window),"message",(function(n){if(k.isSameOrigin(new cF(n.raw.origin))){var o=n.raw.data;fF(o)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!u(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(e,B,o):function(t){return!fF(t)&&r(t)&&_t(t,"mceAction")}(o)&&t.onMessage(B,o)}}));_.set(D.some(n))})),ir((function(){_.get().each((function(t){return t.unbind()}))}))]),Wa.config({channels:(a={},a[VD]={onReceive:function(t,n){Fu(t.element,"iframe").each((function(t){t.dom.contentWindow.postMessage(n,O)}))}},a)})],E=QD({header:p,body:h,footer:b,extraClasses:w,extraBehaviours:T,extraStyles:x},t,y,i),B=(c=E,s=function(t){c.getSystem().isConnected()&&t(c)},{block:function(t){if(!o(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");s((function(n){jo(n,uy,{message:t})}))},unblock:function(){s((function(t){Lo(t,ay)}))},close:function(){s((function(t){Lo(t,ey)}))},sendMessage:function(t){s((function(n){n.getSystem().broadcastOn([VD],t)}))}});return{dialog:E,instanceApi:B}},dF=function(t,n,e){return n&&e?[]:[pE.config({contextual:{lazyContext:function(){return D.some(Cu(re(t.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},mF=function(t){var n=t.backstage,e=t.editor,o=Yh(e),r=function(t){var n=t.backstage.shared;return{open:function(e,o){var r=function(){LA.hide(c),o()},i=Dg(Mk({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:D.none()},"cancel",t.backstage)),u=LD(),a=ND(r,n.providers),c=Zi(GD({lazySink:function(){return n.getSink()},header:zD(u,a),body:jD(e,n.providers),footer:D.some(UD(WD([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Jo(oy,r)],eventOrder:{}}));LA.show(c);var s=i.get(c);Rm.focus(s)}}}(t),i=function(t){var n=t.backstage.shared;return{open:function(e,o){var r=function(t){LA.hide(s),o(t)},i=Dg(Mk({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:D.none()},"submit",t.backstage)),u=Mk({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:D.none()},"cancel",t.backstage),a=LD(),c=ND((function(){return r(!1)}),n.providers),s=Zi(GD({lazySink:function(){return n.getSink()},header:zD(a,c),body:jD(e,n.providers),footer:D.some(UD(WD([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Jo(oy,(function(){return r(!1)})),Jo(iy,(function(){return r(!0)}))],eventOrder:{}}));LA.show(s);var f=i.get(s);Rm.focus(f)}}}(t),u=function(t,e){return dD.open((function(t,o,r){var i=o,u=function(t,n,e){var o=KD(t.internalDialog.title,e),r=function(t,n){var e=PD(t,D.none(),n,!1);return LA.parts.body(e)}({body:t.internalDialog.body},e),i=ZD(t.internalDialog.buttons),u=tF(i),a=iF({buttons:i},e),c=eF((function(){return d}),$D((function(){return l}),e.shared.providers,n),e.shared.getSink),s=function(t){switch(t){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(t.internalDialog.size),f={header:o,body:r,footer:D.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=QD(f,t,c,e),d=aF({getRoot:function(){return l},getBody:function(){return LA.getBody(l)},getFooter:function(){return LA.getFooter(l)},getFormWrapper:function(){var t=LA.getBody(l);return xl.getCurrent(t).getOr(t)}},n.redial,u);return{dialog:l,instanceApi:d}}({dataValidator:r,initialData:i,internalDialog:t},{redial:dD.redial,closeWindow:function(){LA.hide(u.dialog),e(u.instanceApi)}},n);return LA.show(u.dialog),u.instanceApi.setData(i),u.instanceApi}),t)},a=function(t,r,i,u){return dD.open((function(t,a,c){var s,f=gn(mn("data",c,a)),l=(s=Zn(D.none()),{clear:function(){return s.set(D.none())},set:function(t){return s.set(D.some(t))},isSet:function(){return s.get().isSome()},on:function(t){return s.get().each(t)}}),d=n.shared.header.isPositionedAtTop(),m=function(){return l.on((function(t){bg.reposition(t),pE.refresh(t)}))},g=function(t,n,e,o){var r,i,u,a,c,s=Jr("dialog-label"),f=Jr("dialog-content"),l=Dg((u={title:t.internalDialog.title,draggable:!0},a=s,c=e.shared.providers,jb.sketch({dom:HE('<div class="tox-dialog__header"></div>'),components:[YD(u,D.some(a),c),qD(),XD(c)],containerBehaviours:Ha([SA.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return Iu(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),d=Dg(function(t,n,e,o){return PD(t,D.some(n),e,o)}({body:t.internalDialog.body},f,e,o)),m=ZD(t.internalDialog.buttons),g=tF(m),p=Dg(function(t,n){return rF(t,n)}({buttons:m},e)),h=eF((function(){return b}),{onBlock:function(t){NA.block(v,(function(n,o){return JD(t.message,o,e.shared.providers)}))},onUnblock:function(){NA.unblock(v)},onClose:function(){return n.closeWindow()}},e.shared.getSink),v=Zi({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=s,r["aria-describedby"]=""+f,r)},eventOrder:(i={},i[yo()]=[V_.name(),Wa.name()],i[xo()]=["execute-on-form"],i[Mo()]=["reflecting","execute-on-form"],i),behaviours:Ha([Cm.config({mode:"cyclic",onEscape:function(t){return Lo(t,ey),D.some(!0)},useTabstopAt:function(t){return!TS(t)&&("button"!==cr(t)||"disabled"!==Lr(t,"disabled"))}}),V_.config({channel:DD,updateState:function(t,n){return D.some(n)},initialData:t}),Rm.config({}),Am("execute-on-form",h.concat([or(ro(),(function(t,n){Cm.focusIn(t)}))])),NA.config({getRoot:function(){return D.some(v)}}),Bm.config({}),xS({})]),components:[l.asSpec(),d.asSpec(),p.asSpec()]}),b=aF({getRoot:function(){return v},getFooter:function(){return p.get(v)},getBody:function(){return d.get(v)},getFormWrapper:function(){var t=d.get(v);return xl.getCurrent(t).getOr(t)}},n.redial,g);return{dialog:v,instanceApi:b}}({dataValidator:c,initialData:f,internalDialog:t},{redial:dD.redial,closeWindow:function(){l.on(bg.hide),e.off("ResizeEditor",m),l.clear(),i(g.instanceApi)}},n,u),p=Zi(bg.sketch(S(S({lazySink:n.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},d?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:Ha(C([Am("window-manager-inline-events",[Jo(Fo(),(function(t,n){Lo(g.dialog,oy)}))])],dF(e,o,d))),isExtraPart:function(t,n){return function(t){return Ab(t,".tox-alert-dialog")||Ab(t,".tox-confirm-dialog")}(n)}})));return l.set(p),bg.showWithin(p,r,tu(g.dialog),D.some(Mi())),o&&d||(pE.refresh(p),e.on("ResizeEditor",m)),g.instanceApi.setData(f),Cm.focusIn(g.dialog),g.instanceApi}),t)};return{open:function(t,e,o){return void 0!==e&&"toolbar"===e.inline?a(t,n.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?a(t,n.shared.anchors.cursor(),o,e.ariaAttrs):u(t,o)},openUrl:function(t,o){return function(t,o){return dD.openUrl((function(t){var r=lF(t,{closeWindow:function(){LA.hide(r.dialog),o(r.instanceApi)}},e,n);return LA.show(r.dialog),r.instanceApi}),t)}(t,o)},alert:function(t,n){r.open(t,(function(){n()}))},close:function(t){t.close()},confirm:function(t,n){i.open(t,(function(t){n(t)}))}}};w.add("silver",(function(t){var n=IA(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,i=n.getUi;Ob(t,o.shared);var u=mF({editor:t,backstage:o});return{renderUI:r,getWindowManagerImpl:g(u),getNotificationManagerImpl:function(){return function(t,n,e){var o=n.backstage;return{open:function(t,r){var i=!t.closeButton&&t.timeout&&(t.timeout>0||t.timeout<0),u=function(){r(),bg.hide(c)},a=Zi(Pg.sketch({text:t.text,level:P(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:D.from(t.icon),closeButton:!i,onAction:u,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),c=Zi(bg.sketch(S({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return e.add(c),t.timeout>0&&Ag.setTimeout((function(){u()}),t.timeout),{close:u,moveTo:function(t,n){bg.showAt(c,{anchor:"makeshift",x:t,y:n},tu(a))},moveRel:function(t,e){if("banner"!==e){var o=function(t){switch(t){case"bc-bc":return Bg;case"tc-tc":return Eg;case"tc-bc":return ka;case"bc-tc":default:return Ca}}(e),r={anchor:"node",root:Mi(),node:D.some(re(t)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}};bg.showAt(c,r,tu(a))}else bg.showAt(c,n.backstage.shared.anchors.banner(),tu(a))},text:function(t){Pg.updateText(a,t)},settings:t,getEl:function(){return a.element.dom},progressBar:{value:function(t){Pg.updateProgress(a,t)}}}},close:function(t){t.close()},reposition:function(t){!function(t){j(t,(function(t){return t.moveTo(0,0)}))}(t),function(t){t.length>0&&(et(t).each((function(t){return t.moveRel(null,"banner")})),j(t,(function(n,e){e>0&&n.moveRel(t[e-1].getEl(),"bc-tc")})))}(t)},getArgs:function(t){return t.settings}}}(0,{backstage:o},e)},ui:i()}}))}()}}]);
//# sourceMappingURL=860.7bf82e41.chunk.js.map