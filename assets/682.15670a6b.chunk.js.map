{"version":3,"sources":["/Users/liuyang/projects/ringtone_new/node_modules/tinymce/plugins/link/index.js","/Users/liuyang/projects/ringtone_new/node_modules/tinymce/plugins/link/plugin.js"],"names":["eq","call","id","global","tinymce","util","Tools","resolve","global$1","isType","type","value","t","x","Array","prototype","isPrototypeOf","constructor","name","String","isSimpleType","isString","isArray","isNull","a","isBoolean","isFunction","assumeExternalTargets","editor","externalTargets","getParam","getDefaultLinkTarget","getTargetList","getRelList","shouldShowLinkTitle","allowUnsafeLinkTarget","getDefaultLinkProtocol","noop","constant","never","always","none","NONE","o","isNone","fold","n","_s","is","isSome","getOr","getOrThunk","thunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","some","constant_a","self","me","f","s","v","elementEq","b","Optional","from","nativeIndexOf","indexOf","nativePush","push","flatten","xs","r","i","len","length","apply","findMap","arr","cat","someIf","global$2","getValue","item","sanitizeList","list","extractValue","out","text","title","getText","menu","items","sanitizeWith","extracter","ListOptions","label","__assign","Object","assign","arguments","p","hasOwnProperty","this","keys","has","obj","key","global$3","isAnchor","elm","nodeName","toLowerCase","isLink","getHref","collectNodesInRange","rng","predicate","collapsed","contents","cloneContents","walker","firstChild","elements","current","next","hasProtocol","url","test","getAttribute","applyRelTargetRules","rel","isUnsafe","rules","rels","split","removeTargetRules","val","inArray","newRels","concat","addTargetRules","trim","sort","join","getAnchorElement","selectedElm","selection","getNode","isImageFigure","dom","select","getParent","getAnchorText","anchorElm","innerText","textContent","getContent","format","replace","hasLinks","grep","isOnlyTextSelected","inlineTextElements","schema","getTextInlineElements","getRng","nodeType","className","linkDomMutation","attachState","data","linkAttrs","newLinkAttrs","newRel","target","href","handleExternalTargets","applyLinkOverrides","acc","getLinkAttrs","undoManager","transact","attach","focus","setAttribs","updateLink","linkImageFigure","execCommand","insertContent","createHTML","encode","createLink","unwrapOptions","cls","class","pred","onTrue","onFalse","props","k","each$1","internalFilter","_k","link","hasPlugin","unlink","node","unlinkImageFigure","bookmark","getBookmark","cloneRange","startAnchorElm","startContainer","getBody","endAnchorElm","endContainer","setStartBefore","setEndAfter","setRng","moveToBookmark","unlinkSelection","unlinkDomMutation","fig","img","getParents","parentNode","insertBefore","remove","attrs","create","appendChild","findTextByValue","catalog","isListGroup","DialogChanges","initialData","linkCatalog","persistentData","onCatalogChange","change","catalogs","fieldName","anchor","persistentText","hasPersistentText","meta","getDelta","onChange","getData","getTitleFromUrlChange","ts","rawIndexOf","global$4","global$5","tryEmailTransform","message","preprocess","oldData","tryProtocolTransform","defaultLinkProtocol","AnchorListOptions","anchorNodes","anchors","ClassListOptions","getLinkClassList","global$6","RelOptions","initialTarget","isTargetBlank_1","fallbacks","TargetOptions","nonEmptyAttr","elem","getAttrib","DialogInfo","linkNode","extractor","convertURL","linkList","getLinkList","callback","send","success","JSON","parse","err","parseJson","error","_","output","then","optItems","LinkListOptions","links","linkClass","extractFromAnchor","targets","classes","optNode","flags","titleEnabled","open","anchorNode","collectData","info","onSubmit","api","close","getChangedValue","changedData","transform","setEditorTimeout","windowManager","confirm","state","delayedConfirm","DialogConfirms","pData","handleSubmit","settings","displayText","titleText","defaultTarget","original","getInitialData","dialogDelta","size","body","filetype","buttons","primary","_a","newData","setData","makeDialog","spec","getLink","getSelectedLink","getStart","gotoLink","targetEl","$","scrollIntoView","document","createElement","evt","createEvent","initMouseEvent","window","dispatchEvent","removeChild","appendClickRemove","open$1","openDialog","gotoSelectedLink","toggleState","toggler","on","off","toggleActiveState","setActive","mode","isReadOnly","toggleEnabledState","updateState","setDisabled","toggleUnlinkState","hasLinks$1","parents","e","add","ui","registry","addToggleButton","icon","tooltip","onAction","onSetup","addButton","setupButtons","addMenuItem","shortcut","setupMenuItems","addContextMenu","update","element","setupContextMenu","onSetupLink","buttonApi","addContextForm","launch","hasContextToolbar","initValue","commands","formApi","setAttrib","collapse","collapseSelectionToEnd","hide","setupContextToolbars","metaKeyPressed","preventDefault","keyCode","altKey","shiftKey","ctrlKey","metaKey","hasOnlyAltModifier","setupGotoLinks","addCommand","useQuickLink","fire","toolbarKey","register","addShortcut","setup"],"mappings":"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","file":"682.15670a6b.chunk.js","sourcesContent":["// Exports the \"link\" plugin for usage with module loaders\n// Usage:\n//   CommonJS:\n//     require('tinymce/plugins/link')\n//   ES2015:\n//     import 'tinymce/plugins/link'\nrequire('./plugin.js');","/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.8.1 (2021-05-20)\n */\n(function () {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var eq = function (t) {\n      return function (a) {\n        return t === a;\n      };\n    };\n    var isString = isType('string');\n    var isArray = isType('array');\n    var isNull = eq(null);\n    var isBoolean = isSimpleType('boolean');\n    var isFunction = isSimpleType('function');\n\n    var assumeExternalTargets = function (editor) {\n      var externalTargets = editor.getParam('link_assume_external_targets', false);\n      if (isBoolean(externalTargets) && externalTargets) {\n        return 1;\n      } else if (isString(externalTargets) && (externalTargets === 'http' || externalTargets === 'https')) {\n        return externalTargets;\n      }\n      return 0;\n    };\n    var hasContextToolbar = function (editor) {\n      return editor.getParam('link_context_toolbar', false, 'boolean');\n    };\n    var getLinkList = function (editor) {\n      return editor.getParam('link_list');\n    };\n    var getDefaultLinkTarget = function (editor) {\n      return editor.getParam('default_link_target');\n    };\n    var getTargetList = function (editor) {\n      return editor.getParam('target_list', true);\n    };\n    var getRelList = function (editor) {\n      return editor.getParam('rel_list', [], 'array');\n    };\n    var getLinkClassList = function (editor) {\n      return editor.getParam('link_class_list', [], 'array');\n    };\n    var shouldShowLinkTitle = function (editor) {\n      return editor.getParam('link_title', true, 'boolean');\n    };\n    var allowUnsafeLinkTarget = function (editor) {\n      return editor.getParam('allow_unsafe_link_target', false, 'boolean');\n    };\n    var useQuickLink = function (editor) {\n      return editor.getParam('link_quicklink', false, 'boolean');\n    };\n    var getDefaultLinkProtocol = function (editor) {\n      return editor.getParam('link_default_protocol', 'http', 'string');\n    };\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Optional.none();\n    };\n\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var someIf = function (b, a) {\n      return b ? Optional.some(a) : Optional.none();\n    };\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getValue = function (item) {\n      return isString(item.value) ? item.value : '';\n    };\n    var getText = function (item) {\n      if (isString(item.text)) {\n        return item.text;\n      } else if (isString(item.title)) {\n        return item.title;\n      } else {\n        return '';\n      }\n    };\n    var sanitizeList = function (list, extractValue) {\n      var out = [];\n      global$2.each(list, function (item) {\n        var text = getText(item);\n        if (item.menu !== undefined) {\n          var items = sanitizeList(item.menu, extractValue);\n          out.push({\n            text: text,\n            items: items\n          });\n        } else {\n          var value = extractValue(item);\n          out.push({\n            text: text,\n            value: value\n          });\n        }\n      });\n      return out;\n    };\n    var sanitizeWith = function (extracter) {\n      if (extracter === void 0) {\n        extracter = getValue;\n      }\n      return function (list) {\n        return Optional.from(list).map(function (list) {\n          return sanitizeList(list, extracter);\n        });\n      };\n    };\n    var sanitize = function (list) {\n      return sanitizeWith(getValue)(list);\n    };\n    var createUi = function (name, label) {\n      return function (items) {\n        return {\n          name: name,\n          type: 'listbox',\n          label: label,\n          items: items\n        };\n      };\n    };\n    var ListOptions = {\n      sanitize: sanitize,\n      sanitizeWith: sanitizeWith,\n      createUi: createUi,\n      getValue: getValue\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var filter = function (obj, pred) {\n      var t = {};\n      internalFilter(obj, pred, objAcc(t), noop);\n      return t;\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n    var hasNonNullableKey = function (obj, key) {\n      return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.dom.TreeWalker');\n\n    var isAnchor = function (elm) {\n      return elm && elm.nodeName.toLowerCase() === 'a';\n    };\n    var isLink = function (elm) {\n      return isAnchor(elm) && !!getHref(elm);\n    };\n    var collectNodesInRange = function (rng, predicate) {\n      if (rng.collapsed) {\n        return [];\n      } else {\n        var contents = rng.cloneContents();\n        var walker = new global$3(contents.firstChild, contents);\n        var elements = [];\n        var current = contents.firstChild;\n        do {\n          if (predicate(current)) {\n            elements.push(current);\n          }\n        } while (current = walker.next());\n        return elements;\n      }\n    };\n    var hasProtocol = function (url) {\n      return /^\\w+:/i.test(url);\n    };\n    var getHref = function (elm) {\n      var href = elm.getAttribute('data-mce-href');\n      return href ? href : elm.getAttribute('href');\n    };\n    var applyRelTargetRules = function (rel, isUnsafe) {\n      var rules = ['noopener'];\n      var rels = rel ? rel.split(/\\s+/) : [];\n      var toString = function (rels) {\n        return global$2.trim(rels.sort().join(' '));\n      };\n      var addTargetRules = function (rels) {\n        rels = removeTargetRules(rels);\n        return rels.length > 0 ? rels.concat(rules) : rules;\n      };\n      var removeTargetRules = function (rels) {\n        return rels.filter(function (val) {\n          return global$2.inArray(rules, val) === -1;\n        });\n      };\n      var newRels = isUnsafe ? addTargetRules(rels) : removeTargetRules(rels);\n      return newRels.length > 0 ? toString(newRels) : '';\n    };\n    var trimCaretContainers = function (text) {\n      return text.replace(/\\uFEFF/g, '');\n    };\n    var getAnchorElement = function (editor, selectedElm) {\n      selectedElm = selectedElm || editor.selection.getNode();\n      if (isImageFigure(selectedElm)) {\n        return editor.dom.select('a[href]', selectedElm)[0];\n      } else {\n        return editor.dom.getParent(selectedElm, 'a[href]');\n      }\n    };\n    var getAnchorText = function (selection, anchorElm) {\n      var text = anchorElm ? anchorElm.innerText || anchorElm.textContent : selection.getContent({ format: 'text' });\n      return trimCaretContainers(text);\n    };\n    var hasLinks = function (elements) {\n      return global$2.grep(elements, isLink).length > 0;\n    };\n    var hasLinksInSelection = function (rng) {\n      return collectNodesInRange(rng, isLink).length > 0;\n    };\n    var isOnlyTextSelected = function (editor) {\n      var inlineTextElements = editor.schema.getTextInlineElements();\n      var isElement = function (elm) {\n        return elm.nodeType === 1 && !isAnchor(elm) && !has(inlineTextElements, elm.nodeName.toLowerCase());\n      };\n      var elements = collectNodesInRange(editor.selection.getRng(), isElement);\n      return elements.length === 0;\n    };\n    var isImageFigure = function (elm) {\n      return elm && elm.nodeName === 'FIGURE' && /\\bimage\\b/i.test(elm.className);\n    };\n    var getLinkAttrs = function (data) {\n      return foldl([\n        'title',\n        'rel',\n        'class',\n        'target'\n      ], function (acc, key) {\n        data[key].each(function (value) {\n          acc[key] = value.length > 0 ? value : null;\n        });\n        return acc;\n      }, { href: data.href });\n    };\n    var handleExternalTargets = function (href, assumeExternalTargets) {\n      if ((assumeExternalTargets === 'http' || assumeExternalTargets === 'https') && !hasProtocol(href)) {\n        return assumeExternalTargets + '://' + href;\n      }\n      return href;\n    };\n    var applyLinkOverrides = function (editor, linkAttrs) {\n      var newLinkAttrs = __assign({}, linkAttrs);\n      if (!(getRelList(editor).length > 0) && allowUnsafeLinkTarget(editor) === false) {\n        var newRel = applyRelTargetRules(newLinkAttrs.rel, newLinkAttrs.target === '_blank');\n        newLinkAttrs.rel = newRel ? newRel : null;\n      }\n      if (Optional.from(newLinkAttrs.target).isNone() && getTargetList(editor) === false) {\n        newLinkAttrs.target = getDefaultLinkTarget(editor);\n      }\n      newLinkAttrs.href = handleExternalTargets(newLinkAttrs.href, assumeExternalTargets(editor));\n      return newLinkAttrs;\n    };\n    var updateLink = function (editor, anchorElm, text, linkAttrs) {\n      text.each(function (text) {\n        if (anchorElm.hasOwnProperty('innerText')) {\n          anchorElm.innerText = text;\n        } else {\n          anchorElm.textContent = text;\n        }\n      });\n      editor.dom.setAttribs(anchorElm, linkAttrs);\n      editor.selection.select(anchorElm);\n    };\n    var createLink = function (editor, selectedElm, text, linkAttrs) {\n      if (isImageFigure(selectedElm)) {\n        linkImageFigure(editor, selectedElm, linkAttrs);\n      } else {\n        text.fold(function () {\n          editor.execCommand('mceInsertLink', false, linkAttrs);\n        }, function (text) {\n          editor.insertContent(editor.dom.createHTML('a', linkAttrs, editor.dom.encode(text)));\n        });\n      }\n    };\n    var linkDomMutation = function (editor, attachState, data) {\n      var selectedElm = editor.selection.getNode();\n      var anchorElm = getAnchorElement(editor, selectedElm);\n      var linkAttrs = applyLinkOverrides(editor, getLinkAttrs(data));\n      editor.undoManager.transact(function () {\n        if (data.href === attachState.href) {\n          attachState.attach();\n        }\n        if (anchorElm) {\n          editor.focus();\n          updateLink(editor, anchorElm, data.text, linkAttrs);\n        } else {\n          createLink(editor, selectedElm, data.text, linkAttrs);\n        }\n      });\n    };\n    var unlinkSelection = function (editor) {\n      var dom = editor.dom, selection = editor.selection;\n      var bookmark = selection.getBookmark();\n      var rng = selection.getRng().cloneRange();\n      var startAnchorElm = dom.getParent(rng.startContainer, 'a[href]', editor.getBody());\n      var endAnchorElm = dom.getParent(rng.endContainer, 'a[href]', editor.getBody());\n      if (startAnchorElm) {\n        rng.setStartBefore(startAnchorElm);\n      }\n      if (endAnchorElm) {\n        rng.setEndAfter(endAnchorElm);\n      }\n      selection.setRng(rng);\n      editor.execCommand('unlink');\n      selection.moveToBookmark(bookmark);\n    };\n    var unlinkDomMutation = function (editor) {\n      editor.undoManager.transact(function () {\n        var node = editor.selection.getNode();\n        if (isImageFigure(node)) {\n          unlinkImageFigure(editor, node);\n        } else {\n          unlinkSelection(editor);\n        }\n        editor.focus();\n      });\n    };\n    var unwrapOptions = function (data) {\n      var cls = data.class, href = data.href, rel = data.rel, target = data.target, text = data.text, title = data.title;\n      return filter({\n        class: cls.getOrNull(),\n        href: href,\n        rel: rel.getOrNull(),\n        target: target.getOrNull(),\n        text: text.getOrNull(),\n        title: title.getOrNull()\n      }, function (v, _k) {\n        return isNull(v) === false;\n      });\n    };\n    var link = function (editor, attachState, data) {\n      editor.hasPlugin('rtc', true) ? editor.execCommand('createlink', false, unwrapOptions(data)) : linkDomMutation(editor, attachState, data);\n    };\n    var unlink = function (editor) {\n      editor.hasPlugin('rtc', true) ? editor.execCommand('unlink') : unlinkDomMutation(editor);\n    };\n    var unlinkImageFigure = function (editor, fig) {\n      var img = editor.dom.select('img', fig)[0];\n      if (img) {\n        var a = editor.dom.getParents(img, 'a[href]', fig)[0];\n        if (a) {\n          a.parentNode.insertBefore(img, a);\n          editor.dom.remove(a);\n        }\n      }\n    };\n    var linkImageFigure = function (editor, fig, attrs) {\n      var img = editor.dom.select('img', fig)[0];\n      if (img) {\n        var a = editor.dom.create('a', attrs);\n        img.parentNode.insertBefore(a, img);\n        a.appendChild(img);\n      }\n    };\n\n    var isListGroup = function (item) {\n      return hasNonNullableKey(item, 'items');\n    };\n    var findTextByValue = function (value, catalog) {\n      return findMap(catalog, function (item) {\n        if (isListGroup(item)) {\n          return findTextByValue(value, item.items);\n        } else {\n          return someIf(item.value === value, item);\n        }\n      });\n    };\n    var getDelta = function (persistentText, fieldName, catalog, data) {\n      var value = data[fieldName];\n      var hasPersistentText = persistentText.length > 0;\n      return value !== undefined ? findTextByValue(value, catalog).map(function (i) {\n        return {\n          url: {\n            value: i.value,\n            meta: {\n              text: hasPersistentText ? persistentText : i.text,\n              attach: noop\n            }\n          },\n          text: hasPersistentText ? persistentText : i.text\n        };\n      }) : Optional.none();\n    };\n    var findCatalog = function (catalogs, fieldName) {\n      if (fieldName === 'link') {\n        return catalogs.link;\n      } else if (fieldName === 'anchor') {\n        return catalogs.anchor;\n      } else {\n        return Optional.none();\n      }\n    };\n    var init = function (initialData, linkCatalog) {\n      var persistentData = {\n        text: initialData.text,\n        title: initialData.title\n      };\n      var getTitleFromUrlChange = function (url) {\n        return someIf(persistentData.title.length <= 0, Optional.from(url.meta.title).getOr(''));\n      };\n      var getTextFromUrlChange = function (url) {\n        return someIf(persistentData.text.length <= 0, Optional.from(url.meta.text).getOr(url.value));\n      };\n      var onUrlChange = function (data) {\n        var text = getTextFromUrlChange(data.url);\n        var title = getTitleFromUrlChange(data.url);\n        if (text.isSome() || title.isSome()) {\n          return Optional.some(__assign(__assign({}, text.map(function (text) {\n            return { text: text };\n          }).getOr({})), title.map(function (title) {\n            return { title: title };\n          }).getOr({})));\n        } else {\n          return Optional.none();\n        }\n      };\n      var onCatalogChange = function (data, change) {\n        var catalog = findCatalog(linkCatalog, change.name).getOr([]);\n        return getDelta(persistentData.text, change.name, catalog, data);\n      };\n      var onChange = function (getData, change) {\n        var name = change.name;\n        if (name === 'url') {\n          return onUrlChange(getData());\n        } else if (contains([\n            'anchor',\n            'link'\n          ], name)) {\n          return onCatalogChange(getData(), change);\n        } else if (name === 'text' || name === 'title') {\n          persistentData[name] = getData()[name];\n          return Optional.none();\n        } else {\n          return Optional.none();\n        }\n      };\n      return { onChange: onChange };\n    };\n    var DialogChanges = {\n      init: init,\n      getDelta: getDelta\n    };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var delayedConfirm = function (editor, message, callback) {\n      var rng = editor.selection.getRng();\n      global$4.setEditorTimeout(editor, function () {\n        editor.windowManager.confirm(message, function (state) {\n          editor.selection.setRng(rng);\n          callback(state);\n        });\n      });\n    };\n    var tryEmailTransform = function (data) {\n      var url = data.href;\n      var suggestMailTo = url.indexOf('@') > 0 && url.indexOf('/') === -1 && url.indexOf('mailto:') === -1;\n      return suggestMailTo ? Optional.some({\n        message: 'The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?',\n        preprocess: function (oldData) {\n          return __assign(__assign({}, oldData), { href: 'mailto:' + url });\n        }\n      }) : Optional.none();\n    };\n    var tryProtocolTransform = function (assumeExternalTargets, defaultLinkProtocol) {\n      return function (data) {\n        var url = data.href;\n        var suggestProtocol = assumeExternalTargets === 1 && !hasProtocol(url) || assumeExternalTargets === 0 && /^\\s*www(\\.|\\d\\.)/i.test(url);\n        return suggestProtocol ? Optional.some({\n          message: 'The URL you entered seems to be an external link. Do you want to add the required ' + defaultLinkProtocol + ':// prefix?',\n          preprocess: function (oldData) {\n            return __assign(__assign({}, oldData), { href: defaultLinkProtocol + '://' + url });\n          }\n        }) : Optional.none();\n      };\n    };\n    var preprocess = function (editor, data) {\n      return findMap([\n        tryEmailTransform,\n        tryProtocolTransform(assumeExternalTargets(editor), getDefaultLinkProtocol(editor))\n      ], function (f) {\n        return f(data);\n      }).fold(function () {\n        return global$5.resolve(data);\n      }, function (transform) {\n        return new global$5(function (callback) {\n          delayedConfirm(editor, transform.message, function (state) {\n            callback(state ? transform.preprocess(data) : data);\n          });\n        });\n      });\n    };\n    var DialogConfirms = { preprocess: preprocess };\n\n    var getAnchors = function (editor) {\n      var anchorNodes = editor.dom.select('a:not([href])');\n      var anchors = bind(anchorNodes, function (anchor) {\n        var id = anchor.name || anchor.id;\n        return id ? [{\n            text: id,\n            value: '#' + id\n          }] : [];\n      });\n      return anchors.length > 0 ? Optional.some([{\n          text: 'None',\n          value: ''\n        }].concat(anchors)) : Optional.none();\n    };\n    var AnchorListOptions = { getAnchors: getAnchors };\n\n    var getClasses = function (editor) {\n      var list = getLinkClassList(editor);\n      if (list.length > 0) {\n        return ListOptions.sanitize(list);\n      }\n      return Optional.none();\n    };\n    var ClassListOptions = { getClasses: getClasses };\n\n    var global$6 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n    var parseJson = function (text) {\n      try {\n        return Optional.some(JSON.parse(text));\n      } catch (err) {\n        return Optional.none();\n      }\n    };\n    var getLinks = function (editor) {\n      var extractor = function (item) {\n        return editor.convertURL(item.value || item.url, 'href');\n      };\n      var linkList = getLinkList(editor);\n      return new global$5(function (callback) {\n        if (isString(linkList)) {\n          global$6.send({\n            url: linkList,\n            success: function (text) {\n              return callback(parseJson(text));\n            },\n            error: function (_) {\n              return callback(Optional.none());\n            }\n          });\n        } else if (isFunction(linkList)) {\n          linkList(function (output) {\n            return callback(Optional.some(output));\n          });\n        } else {\n          callback(Optional.from(linkList));\n        }\n      }).then(function (optItems) {\n        return optItems.bind(ListOptions.sanitizeWith(extractor)).map(function (items) {\n          if (items.length > 0) {\n            var noneItem = [{\n                text: 'None',\n                value: ''\n              }];\n            return noneItem.concat(items);\n          } else {\n            return items;\n          }\n        });\n      });\n    };\n    var LinkListOptions = { getLinks: getLinks };\n\n    var getRels = function (editor, initialTarget) {\n      var list = getRelList(editor);\n      if (list.length > 0) {\n        var isTargetBlank_1 = initialTarget.is('_blank');\n        var enforceSafe = allowUnsafeLinkTarget(editor) === false;\n        var safeRelExtractor = function (item) {\n          return applyRelTargetRules(ListOptions.getValue(item), isTargetBlank_1);\n        };\n        var sanitizer = enforceSafe ? ListOptions.sanitizeWith(safeRelExtractor) : ListOptions.sanitize;\n        return sanitizer(list);\n      }\n      return Optional.none();\n    };\n    var RelOptions = { getRels: getRels };\n\n    var fallbacks = [\n      {\n        text: 'Current window',\n        value: ''\n      },\n      {\n        text: 'New window',\n        value: '_blank'\n      }\n    ];\n    var getTargets = function (editor) {\n      var list = getTargetList(editor);\n      if (isArray(list)) {\n        return ListOptions.sanitize(list).orThunk(function () {\n          return Optional.some(fallbacks);\n        });\n      } else if (list === false) {\n        return Optional.none();\n      }\n      return Optional.some(fallbacks);\n    };\n    var TargetOptions = { getTargets: getTargets };\n\n    var nonEmptyAttr = function (dom, elem, name) {\n      var val = dom.getAttrib(elem, name);\n      return val !== null && val.length > 0 ? Optional.some(val) : Optional.none();\n    };\n    var extractFromAnchor = function (editor, anchor) {\n      var dom = editor.dom;\n      var onlyText = isOnlyTextSelected(editor);\n      var text = onlyText ? Optional.some(getAnchorText(editor.selection, anchor)) : Optional.none();\n      var url = anchor ? Optional.some(dom.getAttrib(anchor, 'href')) : Optional.none();\n      var target = anchor ? Optional.from(dom.getAttrib(anchor, 'target')) : Optional.none();\n      var rel = nonEmptyAttr(dom, anchor, 'rel');\n      var linkClass = nonEmptyAttr(dom, anchor, 'class');\n      var title = nonEmptyAttr(dom, anchor, 'title');\n      return {\n        url: url,\n        text: text,\n        title: title,\n        target: target,\n        rel: rel,\n        linkClass: linkClass\n      };\n    };\n    var collect = function (editor, linkNode) {\n      return LinkListOptions.getLinks(editor).then(function (links) {\n        var anchor = extractFromAnchor(editor, linkNode);\n        return {\n          anchor: anchor,\n          catalogs: {\n            targets: TargetOptions.getTargets(editor),\n            rels: RelOptions.getRels(editor, anchor.target),\n            classes: ClassListOptions.getClasses(editor),\n            anchor: AnchorListOptions.getAnchors(editor),\n            link: links\n          },\n          optNode: Optional.from(linkNode),\n          flags: { titleEnabled: shouldShowLinkTitle(editor) }\n        };\n      });\n    };\n    var DialogInfo = { collect: collect };\n\n    var handleSubmit = function (editor, info) {\n      return function (api) {\n        var data = api.getData();\n        if (!data.url.value) {\n          unlink(editor);\n          api.close();\n          return;\n        }\n        var getChangedValue = function (key) {\n          return Optional.from(data[key]).filter(function (value) {\n            return !info.anchor[key].is(value);\n          });\n        };\n        var changedData = {\n          href: data.url.value,\n          text: getChangedValue('text'),\n          target: getChangedValue('target'),\n          rel: getChangedValue('rel'),\n          class: getChangedValue('linkClass'),\n          title: getChangedValue('title')\n        };\n        var attachState = {\n          href: data.url.value,\n          attach: data.url.meta !== undefined && data.url.meta.attach ? data.url.meta.attach : noop\n        };\n        DialogConfirms.preprocess(editor, changedData).then(function (pData) {\n          link(editor, attachState, pData);\n        });\n        api.close();\n      };\n    };\n    var collectData = function (editor) {\n      var anchorNode = getAnchorElement(editor);\n      return DialogInfo.collect(editor, anchorNode);\n    };\n    var getInitialData = function (info, defaultTarget) {\n      var anchor = info.anchor;\n      var url = anchor.url.getOr('');\n      return {\n        url: {\n          value: url,\n          meta: { original: { value: url } }\n        },\n        text: anchor.text.getOr(''),\n        title: anchor.title.getOr(''),\n        anchor: url,\n        link: url,\n        rel: anchor.rel.getOr(''),\n        target: anchor.target.or(defaultTarget).getOr(''),\n        linkClass: anchor.linkClass.getOr('')\n      };\n    };\n    var makeDialog = function (settings, onSubmit, editor) {\n      var urlInput = [{\n          name: 'url',\n          type: 'urlinput',\n          filetype: 'file',\n          label: 'URL'\n        }];\n      var displayText = settings.anchor.text.map(function () {\n        return {\n          name: 'text',\n          type: 'input',\n          label: 'Text to display'\n        };\n      }).toArray();\n      var titleText = settings.flags.titleEnabled ? [{\n          name: 'title',\n          type: 'input',\n          label: 'Title'\n        }] : [];\n      var defaultTarget = Optional.from(getDefaultLinkTarget(editor));\n      var initialData = getInitialData(settings, defaultTarget);\n      var catalogs = settings.catalogs;\n      var dialogDelta = DialogChanges.init(initialData, catalogs);\n      var body = {\n        type: 'panel',\n        items: flatten([\n          urlInput,\n          displayText,\n          titleText,\n          cat([\n            catalogs.anchor.map(ListOptions.createUi('anchor', 'Anchors')),\n            catalogs.rels.map(ListOptions.createUi('rel', 'Rel')),\n            catalogs.targets.map(ListOptions.createUi('target', 'Open link in...')),\n            catalogs.link.map(ListOptions.createUi('link', 'Link list')),\n            catalogs.classes.map(ListOptions.createUi('linkClass', 'Class'))\n          ])\n        ])\n      };\n      return {\n        title: 'Insert/Edit Link',\n        size: 'normal',\n        body: body,\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: initialData,\n        onChange: function (api, _a) {\n          var name = _a.name;\n          dialogDelta.onChange(api.getData, { name: name }).each(function (newData) {\n            api.setData(newData);\n          });\n        },\n        onSubmit: onSubmit\n      };\n    };\n    var open = function (editor) {\n      var data = collectData(editor);\n      data.then(function (info) {\n        var onSubmit = handleSubmit(editor, info);\n        return makeDialog(info, onSubmit, editor);\n      }).then(function (spec) {\n        editor.windowManager.open(spec);\n      });\n    };\n\n    var appendClickRemove = function (link, evt) {\n      document.body.appendChild(link);\n      link.dispatchEvent(evt);\n      document.body.removeChild(link);\n    };\n    var open$1 = function (url) {\n      var link = document.createElement('a');\n      link.target = '_blank';\n      link.href = url;\n      link.rel = 'noreferrer noopener';\n      var evt = document.createEvent('MouseEvents');\n      evt.initMouseEvent('click', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n      appendClickRemove(link, evt);\n    };\n\n    var getLink = function (editor, elm) {\n      return editor.dom.getParent(elm, 'a[href]');\n    };\n    var getSelectedLink = function (editor) {\n      return getLink(editor, editor.selection.getStart());\n    };\n    var hasOnlyAltModifier = function (e) {\n      return e.altKey === true && e.shiftKey === false && e.ctrlKey === false && e.metaKey === false;\n    };\n    var gotoLink = function (editor, a) {\n      if (a) {\n        var href = getHref(a);\n        if (/^#/.test(href)) {\n          var targetEl = editor.$(href);\n          if (targetEl.length) {\n            editor.selection.scrollIntoView(targetEl[0], true);\n          }\n        } else {\n          open$1(a.href);\n        }\n      }\n    };\n    var openDialog = function (editor) {\n      return function () {\n        open(editor);\n      };\n    };\n    var gotoSelectedLink = function (editor) {\n      return function () {\n        gotoLink(editor, getSelectedLink(editor));\n      };\n    };\n    var setupGotoLinks = function (editor) {\n      editor.on('click', function (e) {\n        var link = getLink(editor, e.target);\n        if (link && global$1.metaKeyPressed(e)) {\n          e.preventDefault();\n          gotoLink(editor, link);\n        }\n      });\n      editor.on('keydown', function (e) {\n        var link = getSelectedLink(editor);\n        if (link && e.keyCode === 13 && hasOnlyAltModifier(e)) {\n          e.preventDefault();\n          gotoLink(editor, link);\n        }\n      });\n    };\n    var toggleState = function (editor, toggler) {\n      editor.on('NodeChange', toggler);\n      return function () {\n        return editor.off('NodeChange', toggler);\n      };\n    };\n    var toggleActiveState = function (editor) {\n      return function (api) {\n        return toggleState(editor, function () {\n          api.setActive(!editor.mode.isReadOnly() && getAnchorElement(editor, editor.selection.getNode()) !== null);\n        });\n      };\n    };\n    var toggleEnabledState = function (editor) {\n      return function (api) {\n        var updateState = function () {\n          return api.setDisabled(getAnchorElement(editor, editor.selection.getNode()) === null);\n        };\n        updateState();\n        return toggleState(editor, updateState);\n      };\n    };\n    var toggleUnlinkState = function (editor) {\n      return function (api) {\n        var hasLinks$1 = function (parents) {\n          return hasLinks(parents) || hasLinksInSelection(editor.selection.getRng());\n        };\n        var parents = editor.dom.getParents(editor.selection.getStart());\n        api.setDisabled(!hasLinks$1(parents));\n        return toggleState(editor, function (e) {\n          return api.setDisabled(!hasLinks$1(e.parents));\n        });\n      };\n    };\n\n    var register = function (editor) {\n      editor.addCommand('mceLink', function () {\n        if (useQuickLink(editor)) {\n          editor.fire('contexttoolbar-show', { toolbarKey: 'quicklink' });\n        } else {\n          openDialog(editor)();\n        }\n      });\n    };\n\n    var setup = function (editor) {\n      editor.addShortcut('Meta+K', '', function () {\n        editor.execCommand('mceLink');\n      });\n    };\n\n    var setupButtons = function (editor) {\n      editor.ui.registry.addToggleButton('link', {\n        icon: 'link',\n        tooltip: 'Insert/edit link',\n        onAction: openDialog(editor),\n        onSetup: toggleActiveState(editor)\n      });\n      editor.ui.registry.addButton('openlink', {\n        icon: 'new-tab',\n        tooltip: 'Open link',\n        onAction: gotoSelectedLink(editor),\n        onSetup: toggleEnabledState(editor)\n      });\n      editor.ui.registry.addButton('unlink', {\n        icon: 'unlink',\n        tooltip: 'Remove link',\n        onAction: function () {\n          return unlink(editor);\n        },\n        onSetup: toggleUnlinkState(editor)\n      });\n    };\n    var setupMenuItems = function (editor) {\n      editor.ui.registry.addMenuItem('openlink', {\n        text: 'Open link',\n        icon: 'new-tab',\n        onAction: gotoSelectedLink(editor),\n        onSetup: toggleEnabledState(editor)\n      });\n      editor.ui.registry.addMenuItem('link', {\n        icon: 'link',\n        text: 'Link...',\n        shortcut: 'Meta+K',\n        onAction: openDialog(editor)\n      });\n      editor.ui.registry.addMenuItem('unlink', {\n        icon: 'unlink',\n        text: 'Remove link',\n        onAction: function () {\n          return unlink(editor);\n        },\n        onSetup: toggleUnlinkState(editor)\n      });\n    };\n    var setupContextMenu = function (editor) {\n      var inLink = 'link unlink openlink';\n      var noLink = 'link';\n      editor.ui.registry.addContextMenu('link', {\n        update: function (element) {\n          return hasLinks(editor.dom.getParents(element, 'a')) ? inLink : noLink;\n        }\n      });\n    };\n    var setupContextToolbars = function (editor) {\n      var collapseSelectionToEnd = function (editor) {\n        editor.selection.collapse(false);\n      };\n      var onSetupLink = function (buttonApi) {\n        var node = editor.selection.getNode();\n        buttonApi.setDisabled(!getAnchorElement(editor, node));\n        return noop;\n      };\n      editor.ui.registry.addContextForm('quicklink', {\n        launch: {\n          type: 'contextformtogglebutton',\n          icon: 'link',\n          tooltip: 'Link',\n          onSetup: toggleActiveState(editor)\n        },\n        label: 'Link',\n        predicate: function (node) {\n          return !!getAnchorElement(editor, node) && hasContextToolbar(editor);\n        },\n        initValue: function () {\n          var elm = getAnchorElement(editor);\n          return !!elm ? getHref(elm) : '';\n        },\n        commands: [\n          {\n            type: 'contextformtogglebutton',\n            icon: 'link',\n            tooltip: 'Link',\n            primary: true,\n            onSetup: function (buttonApi) {\n              var node = editor.selection.getNode();\n              buttonApi.setActive(!!getAnchorElement(editor, node));\n              return toggleActiveState(editor)(buttonApi);\n            },\n            onAction: function (formApi) {\n              var anchor = getAnchorElement(editor);\n              var value = formApi.getValue();\n              if (!anchor) {\n                var attachState = {\n                  href: value,\n                  attach: noop\n                };\n                var onlyText = isOnlyTextSelected(editor);\n                var text = onlyText ? Optional.some(getAnchorText(editor.selection, anchor)).filter(function (t) {\n                  return t.length > 0;\n                }).or(Optional.from(value)) : Optional.none();\n                link(editor, attachState, {\n                  href: value,\n                  text: text,\n                  title: Optional.none(),\n                  rel: Optional.none(),\n                  target: Optional.none(),\n                  class: Optional.none()\n                });\n                formApi.hide();\n              } else {\n                editor.undoManager.transact(function () {\n                  editor.dom.setAttrib(anchor, 'href', value);\n                  collapseSelectionToEnd(editor);\n                  formApi.hide();\n                });\n              }\n            }\n          },\n          {\n            type: 'contextformbutton',\n            icon: 'unlink',\n            tooltip: 'Remove link',\n            onSetup: onSetupLink,\n            onAction: function (formApi) {\n              unlink(editor);\n              formApi.hide();\n            }\n          },\n          {\n            type: 'contextformbutton',\n            icon: 'new-tab',\n            tooltip: 'Open link',\n            onSetup: onSetupLink,\n            onAction: function (formApi) {\n              gotoSelectedLink(editor)();\n              formApi.hide();\n            }\n          }\n        ]\n      });\n    };\n\n    function Plugin () {\n      global.add('link', function (editor) {\n        setupButtons(editor);\n        setupMenuItems(editor);\n        setupContextMenu(editor);\n        setupContextToolbars(editor);\n        setupGotoLinks(editor);\n        register(editor);\n        setup(editor);\n      });\n    }\n\n    Plugin();\n\n}());\n"],"sourceRoot":""}