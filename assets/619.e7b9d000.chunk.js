(self.webpackChunkringtone=self.webpackChunkringtone||[]).push([[619],{38619:(n,t,e)=>{e(42590)},42590:()=>{!function(){"use strict";var n=function(n){return function(t){return r=typeof(e=t),(null===e?"null":"object"===r&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":r)===n;var e,r}},t=function(n){return function(t){return typeof t===n}},e=n("string"),r=n("object"),o=n("array"),u=t("boolean"),i=(void 0,function(n){return undefined===n}),c=function(n){return!function(n){return null==n}(n)},a=t("function"),l=t("number"),f=function(){},s=function(n){return function(){return n}},d=function(n){return n};function m(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.concat(e);return n.apply(null,o)}}var p,g,v,h=function(n){return function(t){return!n(t)}},b=s(!1),w=s(!0),y=function(){return C},C=(p=function(n){return n.isNone()},{fold:function(n,t){return n()},is:b,isSome:b,isNone:w,getOr:v=function(n){return n},getOrThunk:g=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:s(null),getOrUndefined:s(void 0),or:v,orThunk:g,map:y,each:f,bind:y,exists:b,forall:w,filter:y,equals:p,equals_:p,toArray:function(){return[]},toString:s("none()")}),x=function(n){var t=s(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:w,isNone:b,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return x(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:C},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(b,(function(t){return e(n,t)}))}};return o},S={some:x,none:y,from:function(n){return null==n?C:x(n)}},T=Array.prototype.slice,R=Array.prototype.indexOf,D=Array.prototype.push,O=function(n,t){return function(n,t){return R.call(n,t)}(n,t)>-1},A=function(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return!0;return!1},k=function(n,t){for(var e=[],r=0;r<n;r++)e.push(t(r));return e},B=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var u=n[o];r[o]=t(u,o)}return r},P=function(n,t){for(var e=0,r=n.length;e<r;e++)t(n[e],e)},E=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var u=n[r];t(u,r)&&e.push(u)}return e},I=function(n,t,e){return function(n,t){for(var e=n.length-1;e>=0;e--)t(n[e])}(n,(function(n){e=t(e,n)})),e},M=function(n,t,e){return P(n,(function(n){e=t(e,n)})),e},N=function(n,t){return function(n,t,e){for(var r=0,o=n.length;r<o;r++){var u=n[r];if(t(u,r))return S.some(u);if(e(u,r))break}return S.none()}(n,t,b)},W=function(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return S.some(e);return S.none()},L=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!o(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);D.apply(t,n[e])}return t},z=function(n,t){return L(B(n,t))},_=function(n,t){for(var e=0,r=n.length;e<r;++e)if(!0!==t(n[e],e))return!1;return!0},j=function(n,t){for(var e={},r=0,o=n.length;r<o;r++){var u=n[r];e[String(u)]=t(u,r)}return e},F=function(n){return[n]},H=function(n,t){return t>=0&&t<n.length?S.some(n[t]):S.none()},q=function(n){return H(n,0)},V=function(n){return H(n,n.length-1)},U=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return S.none()},K=function(){return(K=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)};function $(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),o=0;for(t=0;t<e;t++)for(var u=arguments[t],i=0,c=u.length;i<c;i++,o++)r[o]=u[i];return r}var G=function(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}},X=function(){return Y(0,0)},Y=function(n,t){return{major:n,minor:t}},J=function(n,t){var e=String(t).toLowerCase();return 0===n.length?X():function(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}}(n,t);if(!e)return{major:0,minor:0};var r=function(n){return Number(t.replace(e,"$"+n))};return Y(r(1),r(2))}(n,e)},Q=X,Z=function(n,t){var e=String(t).toLowerCase();return N(n,(function(n){return n.search(e)}))},nn=function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t},tn=function(n,t){return-1!==n.indexOf(t)},en=function(n,t){return nn(n,t,0)},rn=function(n,t){return nn(n,t,n.length-t.length)},on=function(n){return function(t){return t.replace(n,"")}}(/^\s+|\s+$/g),un=function(n){return n.length>0},cn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,an=function(n){return function(t){return tn(t,n)}},ln=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return tn(n,"edge/")&&tn(n,"chrome")&&tn(n,"safari")&&tn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,cn],search:function(n){return tn(n,"chrome")&&!tn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return tn(n,"msie")||tn(n,"trident")}},{name:"Opera",versionRegexes:[cn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:an("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:an("firefox")},{name:"Safari",versionRegexes:[cn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(tn(n,"safari")||tn(n,"mobile/"))&&tn(n,"applewebkit")}}],fn=[{name:"Windows",search:an("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return tn(n,"iphone")||tn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:an("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:an("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:an("linux"),versionRegexes:[]},{name:"Solaris",search:an("sunos"),versionRegexes:[]},{name:"FreeBSD",search:an("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:an("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],sn={browsers:s(ln),oses:s(fn)},dn="Edge",mn="Chrome",pn="Opera",gn="Firefox",vn="Safari",hn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:r(dn),isChrome:r(mn),isIE:r("IE"),isOpera:r(pn),isFirefox:r(gn),isSafari:r(vn)}},bn=function(){return hn({current:void 0,version:Q()})},wn=hn,yn=(s(dn),s(mn),s("IE"),s(pn),s(gn),s(vn),"Windows"),Cn="Android",xn="Linux",Sn="Solaris",Tn="FreeBSD",Rn="ChromeOS",Dn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:r(yn),isiOS:r("iOS"),isAndroid:r(Cn),isOSX:r("OSX"),isLinux:r(xn),isSolaris:r(Sn),isFreeBSD:r(Tn),isChromeOS:r(Rn)}},On=function(){return Dn({current:void 0,version:Q()})},An=Dn,kn=(s(yn),s("iOS"),s(Cn),s(xn),s("OSX"),s(Sn),s(Tn),s(Rn),function(n,t){var e=sn.browsers(),r=sn.oses(),o=function(n,t){return Z(n,t).map((function(n){var e=J(n.versionRegexes,t);return{current:n.name,version:e}}))}(e,n).fold(bn,wn),u=function(n,t){return Z(n,t).map((function(n){var e=J(n.versionRegexes,t);return{current:n.name,version:e}}))}(r,n).fold(On,An),i=function(n,t,e,r){var o=n.isiOS()&&!0===/ipad/i.test(e),u=n.isiOS()&&!o,i=n.isiOS()||n.isAndroid(),c=i||r("(pointer:coarse)"),a=o||!u&&i&&r("(min-device-width:768px)"),l=u||i&&!a,f=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),d=!l&&!a&&!f;return{isiPad:s(o),isiPhone:s(u),isTablet:s(a),isPhone:s(l),isTouch:s(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:s(f),isDesktop:s(d)}}(u,o,n,t);return{browser:o,os:u,deviceType:i}}),Bn=function(n){return window.matchMedia(n).matches},Pn=G((function(){return kn(navigator.userAgent,Bn)})),En=function(){return Pn()},In=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},Mn={fromHtml:function(n,t){var e=(t||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return In(e.childNodes[0])},fromTag:function(n,t){var e=(t||document).createElement(n);return In(e)},fromText:function(n,t){var e=(t||document).createTextNode(n);return In(e)},fromDom:In,fromPoint:function(n,t,e){return S.from(n.dom.elementFromPoint(t,e)).map(In)}},Nn=function(n,t){var e=n.dom;if(1!==e.nodeType)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Wn=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},Ln=function(n,t){return n.dom===t.dom},zn=function(n,t){return En().browser.isIE()?function(n,t){return e=n.dom,r=t.dom,o=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.compareDocumentPosition(r)&o);var e,r,o}(n,t):function(n,t){var e=n.dom,r=t.dom;return e!==r&&e.contains(r)}(n,t)},_n=Nn,jn=Object.keys,Fn=Object.hasOwnProperty,Hn=function(n,t){for(var e=jn(n),r=0,o=e.length;r<o;r++){var u=e[r];t(n[u],u)}},qn=function(n,t){return Vn(n,(function(n,e){return{k:e,v:t(n,e)}}))},Vn=function(n,t){var e={};return Hn(n,(function(n,r){var o=t(n,r);e[o.k]=o.v})),e},Un=function(n,t){var e={};return function(n,t,e,r){Hn(n,(function(n,o){(t(n,o)?e:r)(n,o)}))}(n,t,function(n){return function(t,e){n[e]=t}}(e),f),e},Kn=function(n,t){var e=[];return Hn(n,(function(n,r){e.push(t(n,r))})),e},$n=function(n){return jn(n).length},Gn=function(n,t){return Xn(n,t)?S.from(n[t]):S.none()},Xn=function(n,t){return Fn.call(n,t)},Yn=function(n,t){return Xn(n,t)&&void 0!==n[t]&&null!==n[t]},Jn=["tfoot","thead","tbody","colgroup"],Qn=function(n,t,e){return{element:n,rowspan:t,colspan:e}},Zn=function(n,t,e){return{element:n,cells:t,section:e}},nt=function(n,t,e){return{element:n,isNew:t,isLocked:e}},tt=function(n,t){return{cells:n,section:t}},et=("undefined"!=typeof window?window:Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),rt=function(n){return n.dom.nodeType},ot=function(n){return function(t){return rt(t)===n}},ut=function(n){return 8===rt(n)||"#comment"===et(n)},it=ot(1),ct=ot(3),at=ot(9),lt=ot(11),ft=function(n){return function(t){return it(t)&&et(t)===n}},st=function(n){return Mn.fromDom(n.dom.ownerDocument)},dt=function(n){return at(n)?n:st(n)},mt=function(n){return S.from(n.dom.parentNode).map(Mn.fromDom)},pt=function(n,t){for(var e=a(t)?t:b,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=Mn.fromDom(u);if(o.push(i),!0===e(i))break;r=u}return o},gt=function(n){return S.from(n.dom.previousSibling).map(Mn.fromDom)},vt=function(n){return S.from(n.dom.nextSibling).map(Mn.fromDom)},ht=function(n){return B(n.dom.childNodes,Mn.fromDom)},bt=function(n,t){var e=n.dom.childNodes;return S.from(e[t]).map(Mn.fromDom)},wt=a(Element.prototype.attachShadow)&&a(Node.prototype.getRootNode),yt=s(wt),Ct=wt?function(n){return Mn.fromDom(n.dom.getRootNode())}:dt,xt=function(n){return Mn.fromDom(n.dom.host)},St=function(n){var t=ct(n)?n.dom.parentNode:n.dom;if(null==t||null===t.ownerDocument)return!1;var e,r,o=t.ownerDocument;return function(n){var t,e=Ct(n);return lt(t=e)&&c(t.dom.host)?S.some(e):S.none()}(Mn.fromDom(t)).fold((function(){return o.body.contains(t)}),(e=St,r=xt,function(n){return e(r(n))}))},Tt=function(n){var t=n.dom.body;if(null==t)throw new Error("Body is not available yet");return Mn.fromDom(t)},Rt=function(n,t){var e=[];return P(ht(n),(function(n){t(n)&&(e=e.concat([n])),e=e.concat(Rt(n,t))})),e},Dt=function(n,t,e){return function(n,e,r){return E(pt(n,r),(function(n){return Nn(n,t)}))}(n,0,e)},Ot=function(n,t){return function(n,e){return E(ht(n),(function(n){return Nn(n,t)}))}(n)},At=function(n,t){return function(n,t){var e=void 0===t?document:t.dom;return Wn(e)?[]:B(e.querySelectorAll(n),Mn.fromDom)}(t,n)};function kt(n,t,e,r,o){return n(e,r)?S.some(e):a(o)&&o(e)?S.none():t(e,r,o)}var Bt=function(n,t,e){for(var r=n.dom,o=a(e)?e:b;r.parentNode;){r=r.parentNode;var u=Mn.fromDom(r);if(t(u))return S.some(u);if(o(u))break}return S.none()},Pt=function(n,t,e){return Bt(n,(function(n){return Nn(n,t)}),e)},Et=function(n,t){return function(n,e){return N(n.dom.childNodes,(function(n){return e=Mn.fromDom(n),Nn(e,t);var e})).map(Mn.fromDom)}(n)},It=function(n,t){return function(n,t){var e=void 0===t?document:t.dom;return Wn(e)?S.none():S.from(e.querySelector(n)).map(Mn.fromDom)}(t,n)},Mt=function(n,t,e){return kt((function(n,t){return Nn(n,t)}),Pt,n,t,e)},Nt=function(n,t,r){if(!(e(r)||u(r)||l(r)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,r+"")},Wt=function(n,t,e){Nt(n.dom,t,e)},Lt=function(n,t){var e=n.dom;Hn(t,(function(n,t){Nt(e,t,n)}))},zt=function(n,t){var e=n.dom.getAttribute(t);return null===e?void 0:e},_t=function(n,t){return S.from(zt(n,t))},jt=function(n,t){n.dom.removeAttribute(t)},Ft=function(n){return M(n.dom.attributes,(function(n,t){return n[t.name]=t.value,n}),{})},Ht=function(n){return void 0!==n.style&&a(n.style.getPropertyValue)},qt=function(n,t,r){if(!e(r))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);Ht(n)&&n.style.setProperty(t,r)},Vt=function(n,t,e){var r=n.dom;qt(r,t,e)},Ut=function(n,t){var e=n.dom;Hn(t,(function(n,t){qt(e,t,n)}))},Kt=function(n,t){var e=n.dom,r=window.getComputedStyle(e).getPropertyValue(t);return""!==r||St(n)?r:$t(e,t)},$t=function(n,t){return Ht(n)?n.style.getPropertyValue(t):""},Gt=function(n,t){var e=n.dom,r=$t(e,t);return S.from(r).filter((function(n){return n.length>0}))},Xt=function(n,t){!function(n,t){Ht(n)&&n.style.removeProperty(t)}(n.dom,t),_t(n,"style").map(on).is("")&&jt(n,"style")},Yt=function(n,t,e){return void 0===e&&(e=0),_t(n,t).map((function(n){return parseInt(n,10)})).getOr(e)},Jt=function(n,t){return Yt(n,t,1)},Qt=function(n){return Jt(n,"colspan")>1},Zt=function(n){return Jt(n,"rowspan")>1},ne=function(n,t){return parseInt(Kt(n,t),10)},te=s(10),ee=s(10),re=function(n,t){return oe(n,t,w)},oe=function(n,t,e){return z(ht(n),(function(n){return Nn(n,t)?e(n)?[n]:[]:oe(n,t,e)}))},ue=function(n,t){return function(n,t,e){return void 0===e&&(e=b),e(t)?S.none():O(n,et(t))?S.some(t):Pt(t,n.join(","),(function(n){return Nn(n,"table")||e(n)}))}(["td","th"],n,t)},ie=function(n){return re(n,"th,td")},ce=function(n){return Nn(n,"colgroup")?Ot(n,"col"):z(fe(n),(function(n){return Ot(n,"col")}))},ae=function(n,t){return Mt(n,"table",t)},le=function(n){return re(n,"tr")},fe=function(n){return ae(n).fold(s([]),(function(n){return Ot(n,"colgroup")}))},se=function(n,t){return B(n,(function(n){if("colgroup"===et(n)){var e=B(ce(n),(function(n){var t=Yt(n,"span",1);return Qn(n,1,t)}));return Zn(n,e,"colgroup")}return e=B(ie(n),(function(n){var t=Yt(n,"rowspan",1),e=Yt(n,"colspan",1);return Qn(n,t,e)})),Zn(n,e,t(n))}))},de=function(n){return mt(n).map((function(n){var t=et(n);return function(n){return O(Jn,n)}(t)?t:"tbody"})).getOr("tbody")},me=function(n){var t=le(n),e=$(fe(n),t);return se(e,de)},pe=function(n,t,e){var r=n.cells,o=r.slice(0,t),u=r.slice(t),i=o.concat(e).concat(u);return he(n,i)},ge=function(n,t,e){return pe(n,t,[e])},ve=function(n,t,e){n.cells[t]=e},he=function(n,t){return tt(t,n.section)},be=function(n,t){var e=n.cells,r=B(e,t);return tt(r,n.section)},we=function(n,t){return n.cells[t]},ye=function(n,t){return we(n,t).element},Ce=function(n){return n.cells.length},xe=function(n){var t=function(n,t){for(var e=[],r=[],o=0,u=n.length;o<u;o++){var i=n[o];(c=i,"colgroup"===c.section?e:r).push(i)}var c;return{pass:e,fail:r}}(n);return{rows:t.fail,cols:t.pass}},Se="data-snooker-locked-cols",Te=function(n){return _t(n,Se).bind((function(n){return S.from(n.match(/\d+/g))})).map((function(n){return j(n,w)}))},Re=function(n){var t,e,r=M(xe(n).rows,(function(n,t){return P(t.cells,(function(t,e){t.isLocked&&(n[e]=!0)})),n}),{});return t=Kn(r,(function(n,t){return parseInt(t,10)})),(e=T.call(t,0)).sort(void 0),e},De=function(n,t){return n+","+t},Oe=function(n,t){var e=z(n.all,(function(n){return n.cells}));return E(e,t)},Ae=function(n){var t={},e=[],r={},o=q(n).map((function(n){return n.element})).bind(ae).bind(Te).getOr({}),u=0,i=0,c=0;return P(n,(function(n){if("colgroup"===n.section)r=function(n){var t={},e=0;return P(n.cells,(function(n){var r=n.colspan;k(r,(function(o){var u=e+o;t[u]=function(n,t,e){return{element:n,colspan:t,column:e}}(n.element,r,u)})),e+=r})),t}(n);else{var a=[];P(n.cells,(function(n){for(var e=0;void 0!==t[De(c,e)];)e++;for(var r=Yn(o,e.toString()),u=function(n,t,e,r,o,u){return{element:n,rowspan:t,colspan:e,row:r,column:o,isLocked:u}}(n.element,n.rowspan,n.colspan,c,e,r),l=0;l<n.colspan;l++)for(var f=0;f<n.rowspan;f++){var s=e+l,d=De(c+f,s);t[d]=u,i=Math.max(i,s+1)}a.push(u)})),u++,e.push(Zn(n.element,a,n.section)),c++}})),{grid:function(n,t){return{rows:n,columns:t}}(u,i),access:t,all:e,columns:r}},ke=function(n){var t=me(n);return Ae(t)},Be=Ae,Pe=function(n,t,e){var r=n.access[De(t,e)];return void 0!==r?S.some(r):S.none()},Ee=function(n,t,e){var r=Oe(n,(function(n){return e(t,n.element)}));return r.length>0?S.some(r[0]):S.none()},Ie=Oe,Me=function(n){return z(n.all,(function(n){return n.cells}))},Ne=function(n){return t=n.columns,Kn(t,(function(n){return n}));var t},We=function(n){return jn(n.columns).length>0},Le=function(n,t){return S.from(n.columns[t])},ze=function(n,t){var e=t.column,r=t.column+t.colspan-1,o=t.row,u=t.row+t.rowspan-1;return e<=n.finishCol&&r>=n.startCol&&o<=n.finishRow&&u>=n.startRow},_e=function(n,t){return t.column>=n.startCol&&t.column+t.colspan-1<=n.finishCol&&t.row>=n.startRow&&t.row+t.rowspan-1<=n.finishRow},je=function(n,t,e){var r=Ee(n,t,Ln),o=Ee(n,e,Ln);return r.bind((function(n){return o.map((function(t){return e=n,r=t,{startRow:Math.min(e.row,r.row),startCol:Math.min(e.column,r.column),finishRow:Math.max(e.row+e.rowspan-1,r.row+r.rowspan-1),finishCol:Math.max(e.column+e.colspan-1,r.column+r.colspan-1)};var e,r}))}))},Fe=function(n,t,e){return je(n,t,e).map((function(t){var e=Ie(n,m(ze,t));return B(e,(function(n){return n.element}))}))},He=function(n,t){return Ee(n,t,(function(n,t){return zn(t,n)})).map((function(n){return n.element}))},qe=function(n,t,e){var r=Ue(n);return Fe(r,t,e)},Ve=function(n,t,e,r,o){var u=Ue(n),i=Ln(n,e)?S.some(t):He(u,t),c=Ln(n,o)?S.some(r):He(u,r);return i.bind((function(n){return c.bind((function(t){return Fe(u,n,t)}))}))},Ue=ke,Ke=function(n,t){mt(n).each((function(e){e.dom.insertBefore(t.dom,n.dom)}))},$e=function(n,t){vt(n).fold((function(){mt(n).each((function(n){Xe(n,t)}))}),(function(n){Ke(n,t)}))},Ge=function(n,t){(function(n){return bt(n,0)})(n).fold((function(){Xe(n,t)}),(function(e){n.dom.insertBefore(t.dom,e.dom)}))},Xe=function(n,t){n.dom.appendChild(t.dom)},Ye=function(n,t){Ke(n,t),Xe(t,n)},Je=function(n,t){P(t,(function(e,r){var o=0===r?n:t[r-1];$e(o,e)}))},Qe=function(n,t){P(t,(function(t){Xe(n,t)}))},Ze=function(n){n.dom.textContent="",P(ht(n),(function(n){nr(n)}))},nr=function(n){var t=n.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},tr=function(n){var t,e=ht(n);e.length>0&&(t=n,P(e,(function(n){Ke(t,n)}))),nr(n)},er=function(n,t){var e=function(t){return n(t)?S.from(t.dom.nodeValue):S.none()};return{get:function(t){if(!n(t))throw new Error("Can only get text value of a text node");return e(t).getOr("")},getOption:e,set:function(t,e){if(!n(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=e}}}(ct),rr=function(n){return er.get(n)},or=function(n){return er.getOption(n)},ur=function(n,t){return er.set(n,t)},ir=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function cr(){return{up:s({selector:Pt,closest:Mt,predicate:Bt,all:pt}),down:s({selector:At,predicate:Rt}),styles:s({get:Kt,getRaw:Gt,set:Vt,remove:Xt}),attrs:s({get:zt,set:Wt,remove:jt,copyTo:function(n,t){var e=Ft(n);Lt(t,e)}}),insert:s({before:Ke,after:$e,afterAll:Je,append:Xe,appendAll:Qe,prepend:Ge,wrap:Ye}),remove:s({unwrap:tr,remove:nr}),create:s({nu:Mn.fromTag,clone:function(n){return Mn.fromDom(n.dom.cloneNode(!1))},text:Mn.fromText}),query:s({comparePosition:function(n,t){return n.dom.compareDocumentPosition(t.dom)},prevSibling:gt,nextSibling:vt}),property:s({children:ht,name:et,parent:mt,document:function(n){return dt(n).dom},isText:ct,isComment:ut,isElement:it,isSpecial:function(n){var t=et(n);return O(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getText:rr,setText:ur,isBoundary:function(n){return!!it(n)&&("body"===et(n)||O(ir,et(n)))},isEmptyTag:function(n){return!!it(n)&&O(["br","img","hr","input"],et(n))},isNonEditable:function(n){return it(n)&&"false"===zt(n,"contenteditable")}}),eq:Ln,is:_n}}var ar,lr,fr,sr,dr=function(n,t,e,r){var o=t(n,e);return I(r,(function(e,r){var o=t(n,r);return mr(n,e,o)}),o)},mr=function(n,t,e){return t.bind((function(t){return e.filter(m(n.eq,t))}))},pr=cr(),gr=function(n,t){return function(n,t,e){return e.length>0?function(n,t,e,r){return r(n,t,e[0],e.slice(1))}(n,t,e,dr):S.none()}(pr,(function(t,e){return n(e)}),t)},vr=function(n){return Pt(n,"table")},hr=function(n,t,e){var r=function(n){return function(t){return void 0!==e&&e(t)||Ln(t,n)}};return Ln(n,t)?S.some({boxes:S.some([n]),start:n,finish:t}):vr(n).bind((function(o){return vr(t).bind((function(u){if(Ln(o,u))return S.some({boxes:qe(o,n,t),start:n,finish:t});if(zn(o,u)){var i=(c=Dt(t,"td,th",r(o))).length>0?c[c.length-1]:t;return S.some({boxes:Ve(o,n,o,t,u),start:n,finish:i})}if(zn(u,o)){var c,a=(c=Dt(n,"td,th",r(u))).length>0?c[c.length-1]:n;return S.some({boxes:Ve(u,n,o,t,u),start:n,finish:a})}return function(n,t,e){return function(n,t,e,r){void 0===r&&(r=b);var o=[t].concat(n.up().all(t)),u=[e].concat(n.up().all(e)),i=function(n){return W(n,r).fold((function(){return n}),(function(t){return n.slice(0,t+1)}))},c=i(o),a=i(u),l=N(c,(function(t){return A(a,function(n,t){return m(n.eq,t)}(n,t))}));return{firstpath:c,secondpath:a,shared:l}}(pr,n,t,void 0)}(n,t).shared.bind((function(i){return Mt(i,"table",e).bind((function(e){var i=Dt(t,"td,th",r(e)),c=i.length>0?i[i.length-1]:t,a=Dt(n,"td,th",r(e)),l=a.length>0?a[a.length-1]:n;return S.some({boxes:Ve(e,n,o,t,u),start:l,finish:c})}))}))}))}))},br=function(n,t){var e=At(n,t);return e.length>0?S.some(e):S.none()},wr=function(n,t,e){return It(n,t).bind((function(t){return It(n,e).bind((function(n){return gr(vr,[t,n]).map((function(e){return{first:t,last:n,table:e}}))}))}))},yr=function(n,t,e,r,o){return function(n,t){return N(n,(function(n){return Nn(n,t)}))}(n,o).bind((function(n){return function(n,t,e){return ae(n).bind((function(r){return function(n,t,e,r){return Ee(n,t,Ln).bind((function(t){var o=e>0?t.row+t.rowspan-1:t.row,u=r>0?t.column+t.colspan-1:t.column;return Pe(n,o+e,u+r).map((function(n){return n.element}))}))}(Ue(r),n,t,e)}))}(n,t,e).bind((function(n){return function(n,t){return Pt(n,"table").bind((function(e){return It(e,t).bind((function(t){return hr(t,n).bind((function(n){return n.boxes.map((function(t){return{boxes:t,start:n.start,finish:n.finish}}))}))}))}))}(n,r)}))}))},Cr=function(n,t){return br(n,t)},xr=function(n,t,e){return wr(n,t,e).bind((function(t){var e=function(t){return Ln(n,t)},r="thead,tfoot,tbody,table",o=Pt(t.first,r,e),u=Pt(t.last,r,e);return o.bind((function(n){return u.bind((function(e){return Ln(n,e)?function(n,t,e){return function(n,t,e){return je(n,t,e).bind((function(t){return function(n,t){for(var e=!0,r=m(_e,t),o=t.startRow;o<=t.finishRow;o++)for(var u=t.startCol;u<=t.finishCol;u++)e=e&&Pe(n,o,u).exists(r);return e?S.some(t):S.none()}(n,t)}))}(Ue(n),t,e)}(t.table,t.first,t.last):S.none()}))}))}))},Sr=function(n){if(!o(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var t=[],e={};return P(n,(function(r,u){var i=jn(r);if(1!==i.length)throw new Error("one and only one name per case");var c=i[0],a=r[c];if(void 0!==e[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!o(a))throw new Error("case arguments must be an array");t.push(c),e[c]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=e.length;if(o!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+o);var i=function(n){var r=jn(n);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!_(t,(function(n){return O(r,n)})))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return n[c].apply(null,e)};return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+t.length);var o=t[u];return o.apply(null,e)},match:i,log:function(n){console.log(n,{constructors:t,constructor:c,params:e})}}}})),e},Tr=Sr([{none:[]},{multiple:["elements"]},{single:["element"]}]),Rr=function(n,t,e,r){return n.fold(t,e,r)},Dr=Tr.none,Or=Tr.multiple,Ar=Tr.single,kr=tinymce.util.Tools.resolve("tinymce.PluginManager"),Br=function(n,t){return Mn.fromDom(n.dom.cloneNode(t))},Pr=function(n){return Br(n,!1)},Er=function(n){return Br(n,!0)},Ir=function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t},Mr=function(n,t){return n?S.some(t):S.none()},Nr=function(n,t){var e=function(e){var r=t(e);if(r<=0||null===r){var o=Kt(e,n);return parseFloat(o)||0}return r},r=function(n,t){return M(t,(function(t,e){var r=Kt(n,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,e){if(!l(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var r=t.dom;Ht(r)&&(r.style[n]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(n,t,e){var o=r(n,e);return t>o?t-o:0}}},Wr=Nr("width",(function(n){return n.dom.offsetWidth})),Lr=function(n){return Wr.get(n)},zr=function(n){return Wr.getOuter(n)},_r=function(n,t){void 0===t&&(t=w);var e=n.grid,r=k(e.columns,d),o=k(e.rows,d);return B(r,(function(e){return jr((function(){return z(o,(function(t){return Pe(n,t,e).filter((function(n){return n.column===e})).toArray()}))}),(function(n){return 1===n.colspan&&t(n.element)}),(function(){return Pe(n,0,e)}))}))},jr=function(n,t,e){var r=n();return N(r,t).orThunk((function(){return S.from(r[0]).orThunk(e)})).map((function(n){return n.element}))},Fr=function(n){var t=n.grid,e=k(t.rows,d),r=k(t.columns,d);return B(e,(function(t){return jr((function(){return z(r,(function(e){return Pe(n,t,e).filter((function(n){return n.row===t})).fold(s([]),(function(n){return[n]}))}))}),(function(n){return 1===n.rowspan}),(function(){return Pe(n,t,0)}))}))},Hr=function(n,t){return function(e){return"rtl"===qr(e)?t:n}},qr=function(n){return"rtl"===Kt(n,"direction")?"rtl":"ltr"},Vr=Nr("height",(function(n){var t=n.dom;return St(n)?t.getBoundingClientRect().height:t.offsetHeight})),Ur=function(n){return Vr.get(n)},Kr=function(n){return Vr.getOuter(n)},$r=function(n,t){return{left:n,top:t,translate:function(e,r){return $r(n+e,t+r)}}},Gr=$r,Xr=function(n,t){return void 0!==n?n:void 0!==t?t:0},Yr=function(n){var t=n.dom.ownerDocument,e=t.body,r=t.defaultView,o=t.documentElement;if(e===n.dom)return Gr(e.offsetLeft,e.offsetTop);var u=Xr(null==r?void 0:r.pageYOffset,o.scrollTop),i=Xr(null==r?void 0:r.pageXOffset,o.scrollLeft),c=Xr(o.clientTop,e.clientTop),a=Xr(o.clientLeft,e.clientLeft);return Jr(n).translate(i-a,u-c)},Jr=function(n){var t=n.dom,e=t.ownerDocument.body;return e===t?Gr(e.offsetLeft,e.offsetTop):St(n)?function(n){var t=n.getBoundingClientRect();return Gr(t.left,t.top)}(t):Gr(0,0)},Qr=function(n,t){return{row:n,y:t}},Zr=function(n,t){return{col:n,x:t}},no=function(n){return Yr(n).left+zr(n)},to=function(n){return Yr(n).left},eo=function(n,t){return Zr(n,to(t))},ro=function(n,t){return Zr(n,no(t))},oo=function(n){return Yr(n).top},uo=function(n,t){return Qr(n,oo(t))},io=function(n,t){return Qr(n,oo(t)+Kr(t))},co=function(n,t,e){if(0===e.length)return[];var r=B(e.slice(1),(function(t,e){return t.map((function(t){return n(e,t)}))})),o=e[e.length-1].map((function(n){return t(e.length-1,n)}));return r.concat([o])},ao={delta:d,positions:function(n){return co(uo,io,n)},edge:oo},lo={delta:d,edge:to,positions:function(n){return co(eo,ro,n)}},fo={delta:function(n){return-n},edge:no,positions:function(n){return co(ro,eo,n)}},so=Hr(lo,fo),mo={delta:function(n,t){return so(t).delta(n,t)},positions:function(n,t){return so(t).positions(n,t)},edge:function(n){return so(n).edge(n)}},po={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},go=(ar="[0-9]+",lr="[eE][+-]?[0-9]+",fr=function(n){return"(?:"+n+")?"},sr=["Infinity","[0-9]+\\."+fr(ar)+fr(lr),"\\.[0-9]+"+fr(lr),ar+fr(lr)].join("|"),new RegExp("^([+-]?(?:"+sr+"))(.*)$")),vo=function(){var n=En().browser;return n.isIE()||n.isEdge()},ho=function(n,t,e){return function(n,t){var e=parseFloat(n);return isNaN(e)?t:e}(Kt(n,t),e)},bo=function(n){return vo()?function(n){var t=n.dom.getBoundingClientRect().width;return"border-box"===Kt(n,"box-sizing")?t:t-ho(n,"padding-left",0)-ho(n,"padding-right",0)-(ho(n,"border-left-width",0)+ho(n,"border-right-width",0))}(n):ho(n,"width",Lr(n))},wo=/(\d+(\.\d+)?)%/,yo=/(\d+(\.\d+)?)px|em/,Co=function(n,t){Vt(n,"width",t+"px")},xo=function(n,t){Vt(n,"width",t+"%")},So=function(n,t){Vt(n,"height",t+"px")},To=function(n){var t=function(n){return Gt(n,"height").getOrThunk((function(){return function(n){return vo()?function(n){var t=n.dom.getBoundingClientRect().height;return"border-box"===Kt(n,"box-sizing")?t:t-ho(n,"padding-top",0)-ho(n,"padding-bottom",0)-(ho(n,"border-top-width",0)+ho(n,"border-bottom-width",0))}(n):ho(n,"height",Ur(n))}(n)+"px"}))}(n);return t?function(n,t,e,r){var o=parseInt(n,10);return rn(n,"%")&&"table"!==et(t)?function(n,t,e,r){var o=ae(n).map((function(n){var r=e(n);return Math.floor(t/100*r)})).getOr(t);return r(n,o),o}(t,o,e,r):o}(t,n,Ur,So):Ur(n)},Ro=function(n){return Gt(n,"width").fold((function(){return S.from(zt(n,"width"))}),(function(n){return S.some(n)}))},Do=function(n,t){return n/t.pixelWidth()*100},Oo=function(n,t){return Ro(n).fold((function(){var e=Lr(n);return Do(e,t)}),(function(e){return function(n,t,e){var r=wo.exec(t);if(null!==r)return parseFloat(r[1]);var o=bo(n);return Do(o,e)}(n,e,t)}))},Ao=function(n,t){return Ro(n).fold((function(){return bo(n)}),(function(e){return function(n,t,e){var r=yo.exec(t);if(null!==r)return parseInt(r[1],10);var o=wo.exec(t);return null!==o?function(n,t){return n/100*t.pixelWidth()}(parseFloat(o[1]),e):bo(n)}(n,e,t)}))},ko=function(n){return function(n,t,e){return e(n)/Jt(n,"rowspan")}(n,0,To)},Bo=function(n,t,e){Vt(n,"width",t+e)},Po=function(n){return e=Lr,o=(r=t=n,S.from(r.dom.offsetParent).map(Mn.fromDom)).getOr(Tt(st(t))),e(t)/e(o)*100+"%";var t,e,r,o},Eo=s(wo),Io=s(yo),Mo=ft("col"),No=function(n,t,e){return Gt(n,t).fold((function(){return e(n)+"px"}),(function(n){return n}))},Wo=function(n,t){return No(n,"width",(function(n){return Mo(n)?Lr(n):Ao(n,t)}))},Lo=function(n){return No(n,"height",ko)},zo=function(n,t){return Gt(n,t).isSome()},_o=function(n,t,e,r,o,u){return n.filter(r).fold((function(){return u(function(n,t){if(t<0||t>=n.length-1)return S.none();var e=n[t].fold((function(){var e=function(n){var t=T.call(n,0);return t.reverse(),t}(n.slice(0,t));return U(e,(function(n,t){return n.map((function(n){return{value:n,delta:t+1}}))}))}),(function(n){return S.some({value:n,delta:0})})),r=n[t+1].fold((function(){var e=n.slice(t+1);return U(e,(function(n,t){return n.map((function(n){return{value:n,delta:t+1}}))}))}),(function(n){return S.some({value:n,delta:1})}));return e.bind((function(n){return r.map((function(t){var e=t.delta+n.delta;return Math.abs(t.value-n.value)/e}))}))}(e,t))}),(function(n){return o(n)}))},jo=function(n,t,e,r,o){var u=_r(n,(function(n){return zo(n,"width")})),i=We(n)?function(n){return B(Ne(n),(function(n){return S.from(n.element)}))}(n):u,c=[S.some(mo.edge(t))].concat(B(mo.positions(u,t),(function(n){return n.map((function(n){return n.x}))}))),a=h(Qt);return B(i,(function(n,t){return _o(n,t,c,a,(function(n){if(function(n){return!Mo(n)||zo(n,"width")}(n))return e(n,o);var i,l=null!=(i=u[t])?d(i):S.none();return _o(l,t,c,a,(function(n){return r(S.some(Lr(n)))}),r)}),r)}))},Fo=function(n){return n.map((function(n){return n+"px"})).getOr("")},Ho=function(n,t,e){return jo(n,t,Ao,(function(n){return n.getOrThunk(e.minCellWidth)}),e)},qo=function(n,t,e,r,o){var u=Fr(n),i=[S.some(e.edge(t))].concat(B(e.positions(u,t),(function(n){return n.map((function(n){return n.y}))})));return B(u,(function(n,t){return _o(n,t,i,h(Zt),r,o)}))},Vo=function(n){var t=n;return{get:function(){return t},set:function(n){t=n}}},Uo=function(n,t){var e=Vo(parseFloat(n)),r=Vo(Lr(t));return{width:e.get,pixelWidth:r.get,getWidths:function(n,e){return function(n,t,e){return jo(n,t,Oo,(function(n){return n.fold((function(){return e.minCellWidth()}),(function(n){return n/e.pixelWidth()*100}))}),e)}(n,t,e)},getCellDelta:function(n){return n/r.get()*100},singleColumnWidth:function(n,t){return[100-n]},minCellWidth:function(){return te()/r.get()*100},setElementWidth:xo,adjustTableWidth:function(n){var o=e.get(),u=o+n/100*o;xo(t,u),e.set(u),r.set(Lr(t))},isRelative:!0,label:"percent"}},Ko=function(n,t){var e=Vo(n),r=e.get;return{width:r,pixelWidth:r,getWidths:function(n,e){return Ho(n,t,e)},getCellDelta:d,singleColumnWidth:function(n,t){return[Math.max(te(),n+t)-n]},minCellWidth:te,setElementWidth:Co,adjustTableWidth:function(n){var o=r()+n;Co(t,o),e.set(o)},isRelative:!1,label:"pixel"}},$o=function(n){return Ro(n).fold((function(){return function(n){var t=function(){return Lr(n)},e=s(0);return{width:t,pixelWidth:t,getWidths:function(t,e){return Ho(t,n,e)},getCellDelta:e,singleColumnWidth:s([0]),minCellWidth:e,setElementWidth:f,adjustTableWidth:f,isRelative:!0,label:"none"}}(n)}),(function(t){return function(n,t){var e=Eo().exec(t);if(null!==e)return Uo(e[1],n);var r=Io().exec(t);if(null!==r){var o=parseInt(r[1],10);return Ko(o,n)}var u=Lr(n);return Ko(u,n)}(n,t)}))},Go=Ko,Xo=Uo,Yo=function(n,t,e){var r=n[e].element,o=Mn.fromTag("td");Xe(o,Mn.fromTag("br")),(t?Xe:Ge)(r,o)},Jo=function(n){return"img"===et(n)?1:or(n).fold((function(){return ht(n).length}),(function(n){return n.length}))},Qo=["img","br"],Zo=function(n){return or(n).filter((function(n){return 0!==n.trim().length||n.indexOf("Â ")>-1})).isSome()||O(Qo,et(n))},nu=function(n){return t=Zo,(e=function(n){for(var r=0;r<n.childNodes.length;r++){var o=Mn.fromDom(n.childNodes[r]);if(t(o))return S.some(o);var u=e(n.childNodes[r]);if(u.isSome())return u}return S.none()})(n.dom);var t,e},tu=function(n){return eu(n,Zo)},eu=function(n,t){var e=function(n){for(var r=ht(n),o=r.length-1;o>=0;o--){var u=r[o];if(t(u))return S.some(u);var i=e(u);if(i.isSome())return i}return S.none()};return e(n)},ru={scope:["row","col"]},ou=function(){var n=Mn.fromTag("td");return Xe(n,Mn.fromTag("br")),n},uu=function(){return Mn.fromTag("col")},iu=function(){return Mn.fromTag("colgroup")},cu=function(n,t,e){var r=function(n,t){var e=function(n,t){var e=Mn.fromTag(t),r=Ft(n);return Lt(e,r),e}(n,t),r=ht(Er(n));return Qe(e,r),e}(n,t);return Hn(e,(function(n,t){null===n?jt(r,t):Wt(r,t,n)})),r},au=function(n){return n},lu=function(n){return function(){return Mn.fromTag("tr",n.dom)}},fu=function(n,t,e){var r=function(n,t){var e,r,o;e=t,r=n.element.dom,o=e.dom,Ht(r)&&Ht(o)&&(o.style.cssText=r.style.cssText),Xt(t,"height"),1!==n.colspan&&Xt(t,"width")};return{col:function(t){var e=st(t.element),o=Mn.fromTag(et(t.element),e.dom);return r(t,o),n(t.element,o),o},colgroup:iu,row:lu(t),cell:function(t){var o=st(t.element),u=Mn.fromTag(et(t.element),o.dom),i=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=i.length>0?function(n,t,e){return nu(n).map((function(r){var o=e.join(","),u=Dt(r,o,(function(t){return Ln(t,n)}));return I(u,(function(n,t){var e=Pr(t);return jt(e,"contenteditable"),Xe(n,e),e}),t)})).getOr(t)}(t.element,u,i):u;return Xe(c,Mn.fromTag("br")),r(t,u),function(n,t){Hn(ru,(function(e,r){return _t(n,r).filter((function(n){return O(e,n)})).each((function(n){return Wt(t,r,n)}))}))}(t.element,u),n(t.element,u),u},replace:cu,gap:ou}},su=function(n){return{col:uu,colgroup:iu,row:lu(n),cell:ou,replace:au,gap:ou}},du=function(n){return B(n,Mn.fromDom)},mu=function(n){return n.nodeName.toLowerCase()},pu=function(n){return Mn.fromDom(n.getBody())},gu=function(n){return n.getBoundingClientRect().width},vu=function(n){return n.getBoundingClientRect().height},hu=function(n){return function(t){return Ln(t,pu(n))}},bu=function(n){return/^\d+(\.\d+)?$/.test(n)?n+"px":n},wu=function(n){jt(n,"data-mce-style");var t=function(n){return jt(n,"data-mce-style")};P(ie(n),t),P(ce(n),t)},yu=function(n,t){var e=n.dom.getStyle(t,"width")||n.dom.getAttrib(t,"width");return S.from(e).filter(un)},Cu=function(n){return/^(\d+(\.\d+)?)%$/.test(n)},xu=function(n){return Mn.fromDom(n.selection.getStart())},Su=function(n){return Rr(n.get(),s([]),d,F)},Tu=function(n){var t=function(n,t){return _t(n,t).exists((function(n){return parseInt(n,10)>1}))},e=Su(n);return e.length>0&&_(e,(function(n){return t(n,"rowspan")||t(n,"colspan")}))?S.some(e):S.none()},Ru=function(n,t,e){return Rr(t.get(),S.none,(function(t){return t.length<=1?S.none():xr(n,e.firstSelectedSelector,e.lastSelectedSelector).map((function(n){return{bounds:n,cells:t}}))}),S.none)},Du={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Ou=function(n,t,e){return{element:e,mergable:Ru(t,n,Du),unmergable:Tu(n),selection:Su(n)}},Au=function(n,t,e,r){n.on("BeforeGetContent",(function(e){!0===e.selection&&Rr(t.get(),f,(function(t){e.preventDefault(),function(n){return ae(n[0]).map((function(n){var t=function(n,t){var e=function(n){return Nn(n.element,t)},r=Er(n),o=me(r),u=$o(n),i=Be(o),c=function(n,t){var e=n.grid.columns,r=n.grid.rows,o=e,u=0,i=0,c=[],a=[];return Hn(n.access,(function(n){if(c.push(n),t(n)){a.push(n);var e=n.row,l=e+n.rowspan-1,f=n.column,s=f+n.colspan-1;e<r?r=e:l>u&&(u=l),f<o?o=f:s>i&&(i=s)}})),function(n,t,e,r,o,u){return{minRow:n,minCol:t,maxRow:e,maxCol:r,allCells:o,selectedCells:u}}(r,o,u,i,c,a)}(i,e),a="th:not("+t+"),td:not("+t+")",l=oe(r,"th,td",(function(n){return Nn(n,a)}));return P(l,nr),function(n,t,e,r){for(var o=t.grid.columns,u=t.grid.rows,i=0;i<u;i++)for(var c=!1,a=0;a<o;a++)i<e.minRow||i>e.maxRow||a<e.minCol||a>e.maxCol||(Pe(t,i,a).filter(r).isNone()?Yo(n,c,i):c=!0)}(o,i,c,e),function(n,t,e,r){Hn(e.columns,(function(n){(n.column<t.minCol||n.column>t.maxCol)&&nr(n.element)}));var o=E(re(n,"tr"),(function(n){return 0===n.dom.childElementCount}));P(o,nr),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||P(re(n,"th,td"),(function(n){jt(n,"rowspan"),jt(n,"colspan")})),jt(n,Se),jt(n,"data-snooker-col-series"),$o(n).adjustTableWidth(r)}(r,c,i,function(n,t,e,r){if(0===r.minCol&&t.grid.columns===r.maxCol+1)return 0;var o=Ho(t,n,e),u=M(o,(function(n,t){return n+t}),0),i=M(o.slice(r.minCol,r.maxCol+1),(function(n,t){return n+t}),0)/u*e.pixelWidth()-e.pixelWidth();return e.getCellDelta(i)}(n,ke(n),u,c)),r}(n,"[data-mce-selected]");return wu(t),[t]}))}(t).each((function(t){e.content="text"===e.format?function(n){return B(n,(function(n){return n.dom.innerText})).join("")}(t):function(n,t){return B(t,(function(t){return n.selection.serializer.serialize(t.dom,{})})).join("")}(n,t)}))}),f)})),n.on("BeforeSetContent",(function(t){!0===t.selection&&!0===t.paste&&S.from(n.dom.getParent(n.selection.getStart(),"th,td")).each((function(o){var u=Mn.fromDom(o);ae(u).each((function(o){var i,c,a,l=E((i=t.content,(c=document.createElement("div")).innerHTML=i,ht(Mn.fromDom(c))),(function(n){return"meta"!==et(n)}));if(1===l.length&&(a=l[0],"table"===et(a))){t.preventDefault();var f=Mn.fromDom(n.getDoc()),s=su(f),d=function(n,t,e){return{element:n,clipboard:t,generators:e}}(u,l[0],s);e.pasteCells(o,d).each((function(t){n.selection.setRng(t.rng),n.focus(),r.clear(o)}))}}))}))}))},ku=Sr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Bu=K({},ku),Pu=function(n,t,e){for(var r=0,o=n;o<t;o++)r+=void 0!==e[o]?e[o]:0;return r},Eu=function(n,t){var e=Me(n);return B(e,(function(n){var e=Pu(n.row,n.row+n.rowspan,t);return{element:n.element,height:e,rowspan:n.rowspan}}))},Iu=function(n,t,e){var r=function(n,t){return We(n)?function(n,t){var e=Ne(n);return B(e,(function(n,e){return{element:n.element,width:t[e],colspan:n.colspan}}))}(n,t):function(n,t){var e=Me(n);return B(e,(function(n){var e=Pu(n.column,n.column+n.colspan,t);return{element:n.element,width:e,colspan:n.colspan}}))}(n,t)}(n,t);P(r,(function(n){e.setElementWidth(n.element,n.width)}))},Mu=function(n,t,e,r,o){var u=ke(n),i=o.getCellDelta(t),c=o.getWidths(u,o),a=e===u.grid.columns-1,l=r.clampTableDelta(c,e,i,o.minCellWidth(),a),f=function(n,t,e,r,o){var u=n.slice(0),i=function(n,t){return 0===n.length?Bu.none():1===n.length?Bu.only(0):0===t?Bu.left(0,1):t===n.length-1?Bu.right(t-1,t):t>0&&t<n.length-1?Bu.middle(t-1,t,t+1):Bu.none()}(n,t),c=s(B(u,s(0)));return i.fold(c,(function(n){return r.singleColumnWidth(u[n],e)}),(function(n,t){return o.calcLeftEdgeDeltas(u,n,t,e,r.minCellWidth(),r.isRelative)}),(function(n,t,i){return o.calcMiddleDeltas(u,n,t,i,e,r.minCellWidth(),r.isRelative)}),(function(n,t){return o.calcRightEdgeDeltas(u,n,t,e,r.minCellWidth(),r.isRelative)}))}(c,e,l,o,r),d=B(f,(function(n,t){return n+c[t]}));Iu(u,d,o),r.resizeTable(o.adjustTableWidth,l,a)},Nu=function(n){return B(n,s(0))},Wu=function(n,t,e,r,o){return o(n.slice(0,t)).concat(r).concat(o(n.slice(e)))},Lu=function(n){return function(t,e,r,o){if(n(r)){var u=Math.max(o,t[e]-Math.abs(r)),i=Math.abs(u-t[e]);return r>=0?i:-i}return r}},zu=Lu((function(n){return n<0})),_u=Lu(w),ju=function(){var n=function(n,t,e,r){var o=(100+e)/100,u=Math.max(r,(n[t]+e)/o);return B(n,(function(n,e){return(e===t?u:n/o)-n}))},t=function(t,e,r,o,u,i){return i?n(t,e,o,u):function(n,t,e,r,o){var u=zu(n,t,r,o);return Wu(n,t,e+1,[u,0],Nu)}(t,e,r,o,u)};return{resizeTable:function(n,t){return n(t)},clampTableDelta:zu,calcLeftEdgeDeltas:t,calcMiddleDeltas:function(n,e,r,o,u,i,c){return t(n,r,o,u,i,c)},calcRightEdgeDeltas:function(t,e,r,o,u,i){if(i)return n(t,r,o,u);var c=zu(t,r,o,u);return Nu(t.slice(0,r)).concat([c])},calcRedestributedWidths:function(n,t,e,r){if(r){var o=(t+e)/t,u=B(n,(function(n){return n/o}));return{delta:100*o-100,newSizes:u}}return{delta:e,newSizes:n}}}},Fu=function(){var n=function(n,t,e,r,o){var u=_u(n,r>=0?e:t,r,o);return Wu(n,t,e+1,[u,-u],Nu)};return{resizeTable:function(n,t,e){e&&n(t)},clampTableDelta:function(n,t,e,r,o){if(o){if(e>=0)return e;var u=M(n,(function(n,t){return n+t-r}),0);return Math.max(-u,e)}return zu(n,t,e,r)},calcLeftEdgeDeltas:n,calcMiddleDeltas:function(t,e,r,o,u,i){return n(t,r,o,u,i)},calcRightEdgeDeltas:function(n,t,e,r,o,u){if(u)return Nu(n);var i=r/n.length;return B(n,s(i))},calcRedestributedWidths:function(n,t,e,r){return{delta:0,newSizes:n}}}},Hu=function(n,t){var e=S.from(n.dom.documentElement).map(Mn.fromDom).getOr(n);return{parent:s(e),view:s(n),origin:s(Gr(0,0)),isResizable:t}},qu=Sr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Vu=function(n,t,e){var r=e.substring(0,e.length-n.length),o=parseFloat(r);return r===o.toString()?t(o):qu.invalid(e)},Uu=K(K({},qu),{from:function(n){return rn(n,"%")?Vu("%",qu.percent,n):rn(n,"px")?Vu("px",qu.pixels,n):qu.invalid(n)}}),Ku=function(n,t,e){var r=Uu.from(e),o=_(n,(function(n){return"0px"===n}))?function(n,t){var e=n.fold((function(){return s("")}),(function(n){return s(n/t+"px")}),(function(){return s(100/t+"%")}));return k(t,e)}(r,n.length):function(n,t,e){return n.fold((function(){return t}),(function(n){return function(n,t,e){var r=e/t;return B(n,(function(n){return Uu.from(n).fold((function(){return n}),(function(n){return n*r+"px"}),(function(n){return n/100*e+"px"}))}))}(t,e,n)}),(function(n){return function(n,t){return B(n,(function(n){return Uu.from(n).fold((function(){return n}),(function(n){return n/t*100+"%"}),(function(n){return n+"%"}))}))}(t,e)}))}(r,n,t);return Xu(o)},$u=function(n,t){return 0===n.length?t:I(n,(function(n,t){return Uu.from(t).fold(s(0),d,d)+n}),0)},Gu=function(n,t){return Uu.from(n).fold(s(n),(function(n){return n+t+"px"}),(function(n){return n+t+"%"}))},Xu=function(n){if(0===n.length)return n;var t=I(n,(function(n,t){var e=Uu.from(t).fold((function(){return{value:t,remainder:0}}),(function(n){return function(n,t){var e=Math.floor(n);return{value:e+"px",remainder:n-e}}(n)}),(function(n){return{value:n+"%",remainder:0}}));return{output:[e.value].concat(n.output),remainder:n.remainder+e.remainder}}),{output:[],remainder:0}),e=t.output;return e.slice(0,e.length-1).concat([Gu(e[e.length-1],Math.round(t.remainder))])},Yu=Uu.from,Ju=function(n){return Yu(n).fold(s("px"),s("px"),s("%"))},Qu=function(n,t,e,r){var o=ke(n),u=o.all,i=Me(o),c=Ne(o);t.each((function(t){var e=Ju(t),u=Lr(n),a=function(n,t,e){return jo(n,t,Wo,Fo,e)}(o,n,r),l=Ku(a,u,t);We(o)?function(n,t,e){P(t,(function(t,r){var o=$u([n[r]],te());Vt(t.element,"width",o+e)}))}(l,c,e):function(n,t,e){P(t,(function(t){var r=n.slice(t.column,t.colspan+t.column),o=$u(r,te());Vt(t.element,"width",o+e)}))}(l,i,e),Vt(n,"width",t)})),e.each((function(t){var e=Ju(t),r=Ur(n),c=function(n,t,e){return qo(n,t,e,Lo,Fo)}(o,n,ao);!function(n,t,e,r){P(e,(function(t){var e=n.slice(t.row,t.rowspan+t.row),o=$u(e,ee());Vt(t.element,"height",o+r)})),P(t,(function(t,e){Vt(t.element,"height",n[e])}))}(Ku(c,r,t),u,i,e),Vt(n,"height",t)}))},Zu=function(n){return Ro(n).exists((function(n){return wo.test(n)}))},ni=function(n){return Ro(n).exists((function(n){return yo.test(n)}))},ti=function(n){return Ro(n).isNone()},ei=Po,ri=function(n){return ke(n).grid},oi=function(n){var t=[];return{bind:function(n){if(void 0===n)throw new Error("Event bind error: undefined handler");t.push(n)},unbind:function(n){t=E(t,(function(t){return t!==n}))},trigger:function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o={};P(n,(function(n,t){o[n]=e[t]})),P(t,(function(n){n(o)}))}}},ui=function(n){return{registry:qn(n,(function(n){return{bind:n.bind,unbind:n.unbind}})),trigger:qn(n,(function(n){return n.trigger}))}},ii=function(n){return n.slice(0).sort()},ci=function(n,t){var e=E(t,(function(t){return!O(n,t)}));e.length>0&&function(n){throw new Error("Unsupported keys for object: "+ii(n).join(", "))}(e)},ai=function(n){return function(n,t){return function(n,t,r){if(0===t.length)throw new Error("You must specify at least one required field.");var u;return function(n,t){if(!o(t))throw new Error("The required fields must be an array. Was: "+t+".");P(t,(function(t){if(!e(t))throw new Error("The value "+t+" in the "+n+" fields was not a string.")}))}("required",t),u=ii(t),N(u,(function(n,t){return t<u.length-1&&n===u[t+1]})).each((function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+u.join(", ")+"].")})),function(e){var o=jn(e);_(t,(function(n){return O(o,n)}))||function(n,t){throw new Error("All required keys ("+ii(n).join(", ")+") were not specified. Specified keys were: "+ii(t).join(", ")+".")}(t,o),n(t,o);var u=E(t,(function(n){return!r.validate(e[n],n)}));return u.length>0&&function(n,t){throw new Error("All values need to be of type: "+t+". Keys ("+ii(n).join(", ")+") were not.")}(u,r.label),e}}(n,t,{validate:a,label:"function"})}(ci,n)},li=ai(["compare","extract","mutate","sink"]),fi=ai(["element","start","stop","destroy"]),si=ai(["forceDrop","drop","move","delayDrop"]),di=function(){var n,t=(n=ui({move:oi(["info"])}),{onEvent:f,reset:f,events:n.registry}),e=function(){var n=S.none(),t=ui({move:oi(["info"])});return{onEvent:function(e,r){r.extract(e).each((function(e){(function(t,e){var r=n.map((function(n){return t.compare(n,e)}));return n=S.some(e),r})(r,e).each((function(n){t.trigger.move(n)}))}))},reset:function(){n=S.none()},events:t.registry}}(),r=t;return{on:function(){r.reset(),r=e},off:function(){r.reset(),r=t},isOn:function(){return r===e},onEvent:function(n,t){r.onEvent(n,t)},events:e.events}},mi=function(n){var t,e,r=Mn.fromDom(function(n){if(yt()&&c(n.target)){var t=Mn.fromDom(n.target);if(it(t)&&c(t.dom.shadowRoot)&&n.composed&&n.composedPath){var e=n.composedPath();if(e)return q(e)}}return S.from(n.target)}(n).getOr(n.target)),o=function(){return n.stopPropagation()},u=function(){return n.preventDefault()},i=(t=u,e=o,function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))});return function(n,t,e,r,o,u,i){return{target:n,x:t,y:e,stop:r,prevent:o,kill:u,raw:i}}(r,n.clientX,n.clientY,o,u,i,n)},pi=function(n,t,e,r){n.dom.removeEventListener(t,e,r)},gi=w,vi=function(n,t,e){return function(n,t,e,r){return function(n,t,e,r,o){var u=function(n,t){return function(e){n(e)&&t(mi(e))}}(e,r);return n.dom.addEventListener(t,u,o),{unbind:m(pi,n,t,u,o)}}(n,t,e,r,!1)}(n,t,gi,e)},hi=mi,bi=function(n){return void 0!==n.dom.classList},wi=function(n,t){return function(n,t,e){var r=function(n,t){var e=zt(n,t);return void 0===e||""===e?[]:e.split(" ")}(n,t).concat([e]);return Wt(n,t,r.join(" ")),!0}(n,"class",t)},yi=function(n,t){bi(n)?n.dom.classList.add(t):wi(n,t)},Ci=function(n,t){return bi(n)&&n.dom.classList.contains(t)},xi=function(n){var t=n.replace(/\./g,"-");return{resolve:function(n){return t+"-"+n}}},Si=xi("ephox-dragster"),Ti=Si.resolve,Ri=li({compare:function(n,t){return Gr(t.left-n.left,t.top-n.top)},extract:function(n){return S.some(Gr(n.x,n.y))},sink:function(n,t){var e=function(n){var t=K({layerClass:Ti("blocker")},n),e=Mn.fromTag("div");return Wt(e,"role","presentation"),Ut(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),yi(e,Ti("blocker")),yi(e,t.layerClass),{element:function(){return e},destroy:function(){nr(e)}}}(t),r=vi(e.element(),"mousedown",n.forceDrop),o=vi(e.element(),"mouseup",n.drop),u=vi(e.element(),"mousemove",n.move),i=vi(e.element(),"mouseout",n.delayDrop);return fi({element:e.element,start:function(n){Xe(n,e.element())},stop:function(){nr(e.element())},destroy:function(){e.destroy(),o.unbind(),u.unbind(),i.unbind(),r.unbind()}})},mutate:function(n,t){n.mutate(t.left,t.top)}}),Di=function(n){return"true"===zt(n,"contenteditable")},Oi=xi("ephox-snooker"),Ai=Oi.resolve,ki=Ai("resizer-bar"),Bi=Ai("resizer-rows"),Pi=Ai("resizer-cols"),Ei=function(n){var t=At(n.parent(),"."+ki);P(t,nr)},Ii=function(n,t,e){var r=n.origin();P(t,(function(t){t.each((function(t){var o=e(r,t);yi(o,ki),Xe(n.parent(),o)}))}))},Mi=function(n,t,e,r,o){var u=Yr(e),i=t.isResizable,c=r.length>0?ao.positions(r,e):[],a=c.length>0?function(n,t){return z(n.all,(function(n,e){return t(n.element)?[e]:[]}))}(n,i):[];!function(n,t,e,r){Ii(n,t,(function(n,t){var o=function(n,t,e,r,o){var u=Mn.fromTag("div");return Ut(u,{position:"absolute",left:t+"px",top:e-3.5+"px",height:"7px",width:r+"px"}),Lt(u,{"data-row":n,role:"presentation"}),u}(t.row,e.left-n.left,t.y-n.top,r);return yi(o,Bi),o}))}(t,E(c,(function(n,t){return A(a,(function(n){return t===n}))})),u,zr(e));var l=o.length>0?mo.positions(o,e):[],f=l.length>0?function(n,t){var e=[];return k(n.grid.columns,(function(r){Le(n,r).map((function(n){return n.element})).forall(t)&&e.push(r)})),E(e,(function(e){var r=Ie(n,(function(n){return n.column===e}));return _(r,(function(n){return t(n.element)}))}))}(n,i):[];!function(n,t,e,r){Ii(n,t,(function(n,t){var o,u,i,c,a,l=(o=t.col,u=t.x-n.left,i=e.top-n.top,c=r,a=Mn.fromTag("div"),Ut(a,{position:"absolute",left:u-3.5+"px",top:i+"px",height:c+"px",width:"7px"}),Lt(a,{"data-column":o,role:"presentation"}),a);return yi(l,Pi),l}))}(t,E(l,(function(n,t){return A(f,(function(n){return t===n}))})),u,Kr(e))},Ni=function(n,t){if(Ei(n),n.isResizable(t)){var e=ke(t),r=Fr(e),o=_r(e);Mi(e,n,t,r,o)}},Wi=function(n,t){var e=At(n.parent(),"."+ki);P(e,t)},Li=function(n){Wi(n,(function(n){Vt(n,"display","none")}))},zi=function(n){Wi(n,(function(n){Vt(n,"display","block")}))},_i=Ai("resizer-bar-dragging"),ji=function(n){var t=function(){var n=ui({drag:oi(["xDelta","yDelta","target"])}),t=S.none(),e=function(){var n=ui({drag:oi(["xDelta","yDelta"])});return{mutate:function(t,e){n.trigger.drag(t,e)},events:n.registry}}();return e.events.drag.bind((function(e){t.each((function(t){n.trigger.drag(e.xDelta,e.yDelta,t)}))})),{assign:function(n){t=S.some(n)},get:function(){return t},mutate:e.mutate,events:n.registry}}(),e=function(n,t){return void 0===t&&(t={}),function(n,t,e){var r,o,u=!1,i=ui({start:oi([]),stop:oi([])}),c=di(),a=function(){s.stop(),c.isOn()&&(c.off(),i.trigger.stop())},l=(r=a,o=null,{cancel:function(){null!==o&&(clearTimeout(o),o=null)},throttle:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];null!==o&&clearTimeout(o),o=setTimeout((function(){r.apply(null,n),o=null}),200)}});c.events.move.bind((function(e){t.mutate(n,e.info)}));var f=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];u&&n.apply(null,t)}},s=t.sink(si({forceDrop:a,drop:f(a),move:f((function(n){l.cancel(),c.onEvent(n,t)})),delayDrop:f(l.throttle)}),e);return{element:s.element,go:function(n){s.start(n),c.on(),i.trigger.start()},on:function(){u=!0},off:function(){u=!1},destroy:function(){s.destroy()},events:i.registry}}(n,void 0!==t.mode?t.mode:Ri,t)}(t,{}),r=S.none(),o=function(n,t){return S.from(zt(n,t))};t.events.drag.bind((function(n){o(n.target,"data-row").each((function(t){var e=ne(n.target,"top");Vt(n.target,"top",e+n.yDelta+"px")})),o(n.target,"data-column").each((function(t){var e=ne(n.target,"left");Vt(n.target,"left",e+n.xDelta+"px")}))}));var u=function(n,t){return ne(n,t)-Yt(n,"data-initial-"+t,0)};e.events.stop.bind((function(){t.get().each((function(t){r.each((function(e){o(t,"data-row").each((function(n){var r=u(t,"top");jt(t,"data-initial-top"),f.trigger.adjustHeight(e,r,parseInt(n,10))})),o(t,"data-column").each((function(n){var r=u(t,"left");jt(t,"data-initial-left"),f.trigger.adjustWidth(e,r,parseInt(n,10))})),Ni(n,e)}))}))}));var i=function(r,o){f.trigger.startAdjust(),t.assign(r),Wt(r,"data-initial-"+o,ne(r,o)),yi(r,_i),Vt(r,"opacity","0.2"),e.go(n.parent())},c=vi(n.parent(),"mousedown",(function(n){var t;t=n.target,Ci(t,Bi)&&i(n.target,"top"),function(n){return Ci(n,Pi)}(n.target)&&i(n.target,"left")})),a=function(t){return Ln(t,n.view())},l=vi(n.view(),"mouseover",(function(t){var e;(e=t.target,Mt(e,"table",a).filter((function(n){return function(n,t){return Mt(n,"[contenteditable]",t)}(n,a).exists(Di)}))).fold((function(){St(t.target)&&Ei(n)}),(function(t){r=S.some(t),Ni(n,t)}))})),f=ui({adjustHeight:oi(["table","delta","row"]),adjustWidth:oi(["table","delta","column"]),startAdjust:oi([])});return{destroy:function(){c.unbind(),l.unbind(),e.destroy(),Ei(n)},refresh:function(t){Ni(n,t)},on:e.on,off:e.off,hideBars:m(Li,n),showBars:m(zi,n),events:f.registry}},Fi=function(n,t,e){var r=ao,o=mo,u=ji(n),i=ui({beforeResize:oi(["table","type"]),afterResize:oi(["table","type"]),startDrag:oi([])});return u.events.adjustHeight.bind((function(n){var t=n.table;i.trigger.beforeResize(t,"row"),function(n,t,e,r){var o=ke(n),u=function(n,t,e){return qo(n,t,e,ko,(function(n){return n.getOrThunk(ee)}))}(o,n,r),i=B(u,(function(n,r){return e===r?Math.max(t+n,ee()):n})),c=Eu(o,i),a=function(n,t){return B(n.all,(function(n,e){return{element:n.element,height:t[e]}}))}(o,i);P(a,(function(n){So(n.element,n.height)})),P(c,(function(n){So(n.element,n.height)}));var l=I(i,(function(n,t){return n+t}),0);So(n,l)}(t,r.delta(n.delta,t),n.row,r),i.trigger.afterResize(t,"row")})),u.events.startAdjust.bind((function(n){i.trigger.startDrag()})),u.events.adjustWidth.bind((function(n){var r=n.table;i.trigger.beforeResize(r,"col");var u=o.delta(n.delta,r),c=e(r);Mu(r,u,n.column,t,c),i.trigger.afterResize(r,"col")})),{on:u.on,off:u.off,hideBars:u.hideBars,showBars:u.showBars,destroy:u.destroy,events:i.registry}},Hi=function(n,t){return n.fire("newrow",{node:t})},qi=function(n,t){return n.fire("newcell",{node:t})},Vi=function(n,t,e){n.fire("TableModified",K(K({},e),{table:t}))},Ui={structure:!1,style:!0},Ki={structure:!0,style:!1},$i={"border-collapse":"collapse",width:"100%"},Gi={border:"1"},Xi="preservetable",Yi=function(n){return n.getParam("table_sizing_mode","auto")},Ji=function(n){return n.getParam("table_responsive_width")},Qi=function(n){return n.getParam("table_default_attributes",Gi,"object")},Zi=function(n){return n.getParam("table_default_styles",function(n){if(uc(n)){var t=n.getBody().offsetWidth;return K(K({},$i),{width:t+"px"})}return ic(n)?Un($i,(function(n,t){return"width"!==t})):$i}(n),"object")},nc=function(n){return n.getParam("table_cell_advtab",!0,"boolean")},tc=function(n){return n.getParam("table_row_advtab",!0,"boolean")},ec=function(n){return n.getParam("table_advtab",!0,"boolean")},rc=function(n){return n.getParam("table_style_by_css",!1,"boolean")},oc=function(n){return"relative"===Yi(n)||!0===Ji(n)},uc=function(n){return"fixed"===Yi(n)||!1===Ji(n)},ic=function(n){return"responsive"===Yi(n)},cc=function(n){return n.getParam("table_use_colgroups",!1,"boolean")},ac=function(n){var t="section",e=n.getParam("table_header_type",t,"string");return O(["section","cells","sectionCells","auto"],e)?e:t},lc=function(n){var t=n.getParam("table_column_resizing",Xi,"string");return N(["preservetable","resizetable"],(function(n){return n===t})).getOr(Xi)},fc=function(n){return"preservetable"===lc(n)},sc=function(n){return"resizetable"===lc(n)},dc=function(n){var t=n.getParam("table_clone_elements");return e(t)?S.some(t.split(/[ ,]/)):Array.isArray(t)?S.some(t):S.none()},mc=function(n,t){if(oc(n)){var e=yu(n,t.dom).filter(Cu).getOrThunk((function(){return ei(t)}));return Xo(e,t)}return uc(n)?Go(Lr(t),t):$o(t)},pc=function(n){jt(n,"width")},gc=function(n,t){!function(n,t){var e=Po(n);Qu(n,S.some(e),S.none(),t),pc(n)}(t,mc(n,t))},vc=function(n,t){!function(n,t){var e=function(n){return Lr(n)+"px"}(n);Qu(n,S.some(e),S.none(),t),pc(n)}(t,mc(n,t))},hc=function(n){Xt(n,"width");var t=ce(n),e=t.length>0?t:ie(n);P(e,(function(n){Xt(n,"width"),pc(n)})),pc(n)},bc="bar-",wc=function(n){return"false"!==zt(n,"data-mce-resize")},yc=function(n){var t,r,o=S.none(),u=S.none(),i=S.none(),c=function(n){return"TABLE"===n.nodeName},a=function(){return u},l=function(t){return mc(n,t)},f=function(){return fc(n)?Fu():ju()};return n.on("init",(function(){var t=function(n,t){return n.inline?function(n,t,e){return{parent:s(t),view:s(n),origin:s(Gr(0,0)),isResizable:e}}(pu(n),(e=Mn.fromTag("div"),Ut(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Xe(Tt(Mn.fromDom(document)),e),e),t):Hu(Mn.fromDom(n.getDoc()),t);var e}(n,wc);if(i=S.some(t),function(n){var t=n.getParam("object_resizing",!0);return e(t)?"table"===t:t}(n)&&function(n){return n.getParam("table_resize_bars",!0,"boolean")}(n)){var r=f(),c=Fi(t,r,l);c.on(),c.events.startDrag.bind((function(t){o=S.some(n.selection.getRng())})),c.events.beforeResize.bind((function(t){var e=t.table.dom;!function(n,t,e,r,o){n.fire("ObjectResizeStart",{target:t,width:e,height:r,origin:o})}(n,e,gu(e),vu(e),bc+t.type)})),c.events.afterResize.bind((function(t){var e=t.table,r=e.dom;wu(e),o.each((function(t){n.selection.setRng(t),n.focus()})),function(n,t,e,r,o){n.fire("ObjectResized",{target:t,width:e,height:r,origin:o})}(n,r,gu(r),vu(r),bc+t.type),n.undoManager.add()})),u=S.some(c)}})),n.on("ObjectResizeStart",(function(e){var o=e.target;if(c(o)){var u=Mn.fromDom(o);P(n.dom.select(".mce-clonedresizable"),(function(t){n.dom.addClass(t,"mce-"+lc(n)+"-columns")})),!ni(u)&&uc(n)?vc(n,u):!Zu(u)&&oc(n)&&gc(n,u),ti(u)&&en(e.origin,bc)&&gc(n,u),t=e.width,r=ic(n)?"":yu(n,o).getOr("")}})),n.on("ObjectResized",(function(e){var o=e.target;if(c(o)){var u=Mn.fromDom(o),i=e.origin;en(i,"corner-")&&function(e,o,u){var i=rn(o,"e");if(""===r&&gc(n,e),u!==t&&""!==r){Vt(e,"width",r);var c=f(),a=l(e),s=fc(n)||i?function(n){return ri(n).columns}(e)-1:0;Mu(e,u-t,s,c,a)}else if(Cu(r)){var d=parseFloat(r.replace("%",""));Vt(e,"width",u*d/t+"%")}(function(n){return/^(\d+(\.\d+)?)px$/.test(n)})(r)&&function(n){var t=ke(n);We(t)||P(ie(n),(function(n){var t=Kt(n,"width");Vt(n,"width",t),jt(n,"width")}))}(e)}(u,i,e.width),wu(u),Vi(n,u.dom,Ui)}})),n.on("SwitchMode",(function(){a().each((function(t){n.mode.isReadOnly()?t.hideBars():t.showBars()}))})),{lazyResize:a,lazyWire:function(){return i.getOr(Hu(Mn.fromDom(n.getBody()),wc))},destroy:function(){u.each((function(n){n.destroy()})),i.each((function(t){!function(n,t){n.inline&&nr(t.parent())}(n,t)}))}}},Cc=function(n,t){return{element:n,offset:t}},xc=function(n,t,e){return n.property().isText(t)&&0===n.property().getText(t).trim().length||n.property().isComment(t)?e(t).bind((function(t){return xc(n,t,e).orThunk((function(){return S.some(t)}))})):S.none()},Sc=function(n,t){return n.property().isText(t)?n.property().getText(t).length:n.property().children(t).length},Tc=function(n,t){var e=xc(n,t,n.query().prevSibling).getOr(t);if(n.property().isText(e))return Cc(e,Sc(n,e));var r=n.property().children(e);return r.length>0?Tc(n,r[r.length-1]):Cc(e,Sc(n,e))},Rc=Tc,Dc=cr(),Oc=function(n,t){1===Jt(n,"colspan")&&function(n){return Ro(n).bind((function(n){return t=n,e=["fixed","relative","empty"],S.from(go.exec(t)).bind((function(n){var t=Number(n[1]),r=n[2];return function(n,t){return A(t,(function(t){return A(po[t],(function(t){return n===t}))}))}(r,e)?S.some({value:t,unit:r}):S.none()}));var t,e}))}(n).each((function(e){var r=e.value/2;Bo(n,r,e.unit),Bo(t,r,e.unit)}))},Ac=function(n,t,e,r){e===r?jt(n,t):Wt(n,t,e)},kc=function(n,t,e){V(Ot(n,t)).fold((function(){return Ge(n,e)}),(function(n){return $e(n,e)}))},Bc=function(n,t){var e=[],r=[],o=function(n){return B(n,(function(n){n.isNew&&e.push(n.element);var t=n.element;return Ze(t),P(n.cells,(function(n){n.isNew&&r.push(n.element),Ac(n.element,"colspan",n.colspan,1),Ac(n.element,"rowspan",n.rowspan,1),Xe(t,n.element)})),t}))},u=function(n){return z(n,(function(n){return B(n.cells,(function(n){return Ac(n.element,"span",n.colspan,1),n.element}))}))},i=function(t,e){var r=function(n,t){var e=Et(n,t).getOrThunk((function(){var e=Mn.fromTag(t,st(n).dom);return"thead"===t?kc(n,"caption,colgroup",e):"colgroup"===t?kc(n,"caption",e):Xe(n,e),e}));return Ze(e),e}(n,e),i=("colgroup"===e?u:o)(t);Qe(r,i)},c=function(t,e){t.length>0?i(t,e):function(t){Et(n,t).each(nr)}(e)},a=[],l=[],f=[],s=[];return P(t,(function(n){switch(n.section){case"thead":a.push(n);break;case"tbody":l.push(n);break;case"tfoot":f.push(n);break;case"colgroup":s.push(n)}})),c(s,"colgroup"),c(a,"thead"),c(l,"tbody"),c(f,"tfoot"),{newRows:e,newCells:r}},Pc=function(n,t){if(0===n.length)return 0;var e=n[0];return W(n,(function(n){return!t(e.element,n.element)})).fold((function(){return n.length}),(function(n){return n}))},Ec=function(n,t){var e=B(n,(function(n){return B(n.cells,b)}));return B(n,(function(r,o){return u=z(r.cells,(function(r,u){if(!1===e[o][u]){var i=function(n,t,e,r){var o=function(n,t){return n[t]}(n,t).cells.slice(e),u=Pc(o,r),i=function(n,t){return B(n,(function(n){return we(n,t)}))}(n,e).slice(t);return{colspan:u,rowspan:Pc(i,r)}}(n,o,u,t);return function(n,t,r,o){for(var u=n;u<n+r;u++)for(var i=t;i<t+o;i++)e[u][i]=!0}(o,u,i.rowspan,i.colspan),[(c=r.element,a=i.rowspan,l=i.colspan,f=r.isNew,{element:c,rowspan:a,colspan:l,isNew:f})]}return[];var c,a,l,f})),i=r.section,{details:u,section:i};var u,i}))},Ic=function(n,t,e){var r=[];if(We(n)){var o=B(Ne(n),(function(n){return nt(n.element,e,!1)}));r.push(tt(o,"colgroup"))}for(var u=0;u<n.grid.rows;u++){for(var i=[],c=0;c<n.grid.columns;c++){var a=Pe(n,u,c).map((function(n){return nt(n.element,e,n.isLocked)})).getOrThunk((function(){return nt(t.gap(),!0,!1)}));i.push(a)}var l=tt(i,n.all[u].section);r.push(l)}return r},Mc=function(n,t){return function(n,t){return B(n,(function(n){var e=function(n){return U(n,(function(n){return mt(n.element).map((function(n){var t=mt(n).isNone();return nt(n,t,!1)}))})).getOrThunk((function(){return nt(t.row(),!0,!1)}))}(n.details);return function(n,t,e,r){return{element:n,cells:t,section:e,isNew:r}}(e.element,n.details,n.section,e.isNew)}))}(Ec(n,Ln),t)},Nc=function(n,t){return U(n.all,(function(n){return N(n.cells,(function(n){return Ln(t,n.element)}))}))},Wc=function(n,t,e){var r=B(t.selection,(function(t){return ue(t).bind((function(t){return Nc(n,t)})).filter(e)})),o=Ir(r);return Mr(o.length>0,o)},Lc=function(n,t,e,r,o){return function(u,i,c,a,l,f){var s=ke(i);return t(s,c).map((function(t){var e=function(n,t){return Ic(n,t,!1)}(s,a),r=n(e,t,Ln,o(a)),u=Re(r.grid);return{info:t,grid:Mc(r.grid,a),cursor:r.cursor,lockedColumns:u}})).bind((function(n){var t=Bc(i,n.grid),o=S.from(l).getOrThunk((function(){return $o(i)})),c=S.from(f).getOrThunk(Fu);return e(i,n.grid,n.info,o,c),r(i),Ni(u,i),jt(i,Se),n.lockedColumns.length>0&&Wt(i,Se,n.lockedColumns.join(",")),S.some({cursor:n.cursor,newRows:t.newRows,newCells:t.newCells})}))}},zc=function(n,t){return ue(t.element).bind((function(t){return Nc(n,t)}))},_c=function(n,t){return Wc(n,t,w).map((function(n){return{cells:n,generators:t.generators,clipboard:t.clipboard}}))},jc=function(n,t){return Wc(n,t,w)},Fc=function(n,t){return zc(n,t).filter((function(n){return!n.isLocked}))},Hc=function(n,t){return Wc(n,t,(function(n){return!n.isLocked}))},qc=function(n,t){return _(t,(function(t){return function(n,t){return Nc(n,t).exists((function(n){return!n.isLocked}))}(n,t)}))},Vc=function(n,t){return function(n,t){return t.mergable}(0,t).filter((function(t){return qc(n,t.cells)}))},Uc=function(n,t){return function(n,t){return t.unmergable}(0,t).filter((function(t){return qc(n,t)}))},Kc=function(n,t,e,r){for(var o=xe(n).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<Ce(o[0]);c++){var a=o[i],l=we(a,c),f=e(l.element,t);!0===f&&!1===u?ve(a,c,nt(r(),!0,l.isLocked)):!0===f&&(u=!1)}return n},$c=function(n){return{is:function(t){return n===t},isValue:w,isError:b,getOr:s(n),getOrThunk:s(n),getOrDie:s(n),or:function(t){return $c(n)},orThunk:function(t){return $c(n)},fold:function(t,e){return e(n)},map:function(t){return $c(t(n))},mapError:function(t){return $c(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOptional:function(){return S.some(n)}}},Gc=function(n){return{is:b,isValue:b,isError:w,getOr:d,getOrThunk:function(n){return n()},getOrDie:function(){return(t=String(n),function(){throw new Error(t)})();var t},or:function(n){return n},orThunk:function(n){return n()},fold:function(t,e){return t(n)},map:function(t){return Gc(n)},mapError:function(t){return Gc(t(n))},each:f,bind:function(t){return Gc(n)},exists:b,forall:w,toOptional:S.none}},Xc={value:$c,error:Gc,fromOption:function(n,t){return n.fold((function(){return Gc(t)}),$c)}},Yc=function(n,t){return{rowDelta:0,colDelta:Ce(n[0])-Ce(t[0])}},Jc=function(n,t){return{rowDelta:n.length-t.length,colDelta:0}},Qc=function(n,t,e,r){var o="colgroup"===t.section?e.col:e.cell;return k(n,(function(n){return nt(o(),!0,r(n))}))},Zc=function(n,t,e,r){return n.concat(k(t,(function(){var t=n[n.length-1],o=Qc(t.cells.length,t,e,(function(n){return Xn(r,n.toString())}));return he(t,o)})))},na=function(n,t,e,r){return B(n,(function(n){var o=Qc(t,n,e,b);return pe(n,r,o)}))},ta=function(n,t,e){var r=t.colDelta<0?na:d,o=t.rowDelta<0?Zc:d,u=Re(n),i=Ce(n[0]),c=A(u,(function(n){return n===i-1})),a=r(n,Math.abs(t.colDelta),e,c?i-1:i),l=Re(a);return o(a,Math.abs(t.rowDelta),e,j(l,w))},ea=function(n,t,e,r){var o=m(r,we(n[t],e).element),u=n[t];return n.length>1&&Ce(u)>1&&(e>0&&o(ye(u,e-1))||e<u.cells.length-1&&o(ye(u,e+1))||t>0&&o(ye(n[t-1],e))||t<n.length-1&&o(ye(n[t+1],e)))},ra=function(n,t,e){return E(e,(function(e){return e>=n.column&&e<=Ce(t[0])+n.column}))},oa=function(n,t,e,r,o){!function(n,t,e,r){t>0&&t<n[0].cells.length&&P(n,(function(n){var o=n.cells[t-1],u=n.cells[t];e(u.element,o.element)&&ve(n,t,nt(r(),!0,u.isLocked))}))}(t,n,o,r.cell);var u=Jc(e,t),i=ta(e,u,r),c=Jc(t,i),a=ta(t,c,r);return B(a,(function(t,e){return pe(t,n,i[e].cells)}))},ua=function(n,t,e,r,o){!function(n,t,e,r){var o=xe(n).rows;if(t>0&&t<o.length){var u=function(n,t){return M(n,(function(n,e){return A(n,(function(n){return t(n.element,e.element)}))?n:n.concat([e])}),[])}(o[t-1].cells,e);P(u,(function(n){for(var u=S.none(),i=t;i<o.length;i++)for(var c=function(t){var c=o[i],a=we(c,t);e(a.element,n.element)&&(u.isNone()&&(u=S.some(r())),u.each((function(n){ve(c,t,nt(n,!0,a.isLocked))})))},a=0;a<Ce(o[0]);a++)c(a)}))}}(t,n,o,r.cell);var u,i,c=Re(t),a=Yc(t,e),l=K(K({},a),{colDelta:a.colDelta-c.length}),f=ta(t,l,r),s=xe(f),d=s.cols,m=s.rows,p=Re(f),g=Yc(e,t),v=K(K({},g),{colDelta:g.colDelta+p.length}),h=(u=r,i=p,B(e,(function(n){return M(i,(function(t,e){var r=Qc(1,n,u,w)[0];return ge(t,e,r)}),n)}))),b=ta(h,v,r);return d.concat(m.slice(0,n)).concat(b).concat(m.slice(n,m.length))},ia=function(n,t,e,r,o){var u=xe(n),i=u.rows,c=u.cols,a=i.slice(0,t),l=i.slice(t),f=be(i[e],(function(n,e){return t>0&&t<i.length&&r(ye(i[t-1],e),ye(i[t],e))?we(i[t],e):nt(o(n.element,r),!0,n.isLocked)}));return c.concat(a).concat([f]).concat(l)},ca=function(n,t,e,r,o){return B(n,(function(n){var u=t>0&&t<Ce(n)&&r(ye(n,t-1),ye(n,t)),i=function(n,t,e,r,o,u,i){if("colgroup"!==e&&r)return we(n,t);var c=we(n,o);return nt(i(c.element,u),!0,!1)}(n,t,n.section,u,e,r,o);return ge(n,t,i)}))},aa=function(n,t,e,r){return B(n,(function(n){return be(n,(function(n){return function(n){return A(t,(function(t){return e(n.element,t.element)}))}(n)?nt(r(n.element,e),!0,n.isLocked):n}))}))},la=function(n,t,e,r){return void 0!==ye(n[t],e)&&t>0&&r(ye(n[t-1],e),ye(n[t],e))},fa=function(n,t,e){return t>0&&e(ye(n,t-1),ye(n,t))},sa=function(n,t,e,r){var o=xe(n).rows,u=z(o,(function(r,o){return la(n,o,t,e)||fa(r,t,e)?[]:[we(r,t)]}));return aa(n,u,e,r)},da=function(n,t,e,r){var o=xe(n).rows,u=o[t],i=z(u.cells,(function(n,r){return la(o,t,r,e)||fa(u,r,e)?[]:[n]}));return aa(n,i,e,r)},ma=function(n){return M(n,(function(n,t){return A(n,(function(n){return n.column===t.column}))?n:n.concat([t])}),[]).sort((function(n,t){return n.column-t.column}))},pa=function(n){return{element:n,colspan:Yt(n,"colspan",1),rowspan:Yt(n,"rowspan",1)}},ga=function(n){return _t(n,"scope").map((function(n){return n.substr(0,3)}))},va=function(n,t){void 0===t&&(t=pa);var e=Vo(S.none()),r=function(r){var u=function(e){return function(t){switch(et(t.element)){case"col":return n.col(t);default:return n.cell(t)}}(t(e))}(r);return e.get().isNone()&&e.set(S.some(u)),o=S.some({item:r,replacement:u}),u},o=S.none();return{getOrInit:function(n,t){return o.fold((function(){return r(n)}),(function(e){return t(n,e.item)?e.replacement:r(n)}))},cursor:e.get}},ha=function(n,t){return function(e){var r=Vo(S.none()),o=[],u=function(u){var i={scope:n},c=e.replace(u,t,i);return o.push({item:u,sub:c}),r.get().isNone()&&r.set(S.some(c)),c};return{replaceOrInit:function(n,t){return"col"===et(n)?n:function(n,t){return N(o,(function(e){return t(e.item,n)}))}(n,t).fold((function(){return u(n)}),(function(e){return t(n,e.item)?e.sub:u(n)}))},cursor:r.get}}},ba=function(n){var t=Vo(S.none());return{unmerge:function(e){t.get().isNone()&&t.set(S.some(e));var r=ga(e);return r.each((function(n){return Wt(e,"scope",n)})),function(){var t=n.cell({element:e,colspan:1,rowspan:1});return Xt(t,"width"),Xt(e,"width"),r.each((function(n){return Wt(t,"scope",n)})),t}},merge:function(n){return Xt(n[0],"width"),function(){var t=Ir(B(n,ga));if(0===t.length)return S.none();var e=t[0],r=["row","col"];return A(t,(function(n){return n!==e&&O(r,n)}))?S.none():S.from(e)}().fold((function(){return jt(n[0],"scope")}),(function(t){return Wt(n[0],"scope",t+"group")})),s(n[0])},cursor:t.get}},wa=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],ya=cr(),Ca=function(n){return function(n,t){var e=n.property().name(t);return O(wa,e)}(ya,n)},xa=function(n){return function(n,t){var e=n.property().name(t);return O(["ol","ul"],e)}(ya,n)},Sa=function(n){var t,e=function(n){return"br"===et(n)},r=function(n){return tu(n).bind((function(t){var r=vt(t).map((function(n){return!!Ca(n)||!!function(n,t){return O(["br","img","hr","input"],n.property().name(t))}(ya,n)&&"img"!==et(n)})).getOr(!1);return mt(t).map((function(o){return!0===r||("li"===et(u=o)||Bt(u,xa).isSome())||e(t)||Ca(o)&&!Ln(n,o)?[]:[Mn.fromTag("br")];var u}))})).getOr([])},o=0===(t=z(n,(function(n){var t=ht(n);return function(n){return _(n,(function(n){return e(n)||ct(n)&&0===rr(n).trim().length}))}(t)?[]:t.concat(r(n))}))).length?[Mn.fromTag("br")]:t;Ze(n[0]),Qe(n[0],o)},Ta=function(n){0===ie(n).length&&nr(n)},Ra=function(n,t){return{grid:n,cursor:t}},Da=function(n,t,e){var r=xe(n).rows;return Oa(r,t,e).orThunk((function(){return Oa(r,0,0)}))},Oa=function(n,t,e){return S.from(n[t]).bind((function(n){return S.from(n.cells[e]).bind((function(n){return S.from(n.element)}))}))},Aa=function(n,t,e){var r=xe(n).rows;return Ra(n,Oa(r,t,e))},ka=function(n){return M(n,(function(n,t){return A(n,(function(n){return n.row===t.row}))?n:n.concat([t])}),[]).sort((function(n,t){return n.row-t.row}))},Ba=function(n,t,e){var r,o,u=(r=n,o=e.section,se(r,(function(){return o}))),i=Be(u);return Ic(i,t,!0)},Pa=function(n,t){var e=E(n,t);return 0===e.length?S.some("td"):e.length===n.length?S.some("th"):S.none()},Ea=function(n,t,e,r){var o=Be(t),u=r.getWidths(o,r);Iu(o,u,r)},Ia=function(n,t,e,r,o){var u=Be(t),i=r.getWidths(u,r),c=r.pixelWidth(),a=o.calcRedestributedWidths(i,c,e.pixelDelta,r.isRelative),l=a.newSizes,f=a.delta;Iu(u,l,r),r.adjustTableWidth(f)},Ma=function(n,t){return A(t,(function(n){return 0===n.column&&n.isLocked}))},Na=function(n,t){return A(t,(function(t){return t.column+t.colspan>=n.grid.columns&&t.isLocked}))},Wa=function(n,t){var e=_r(n),r=ma(t);return M(r,(function(n,t){return n+e[t.column].map(zr).getOr(0)}),0)},La=function(n){return function(t,e){return jc(t,e).filter((function(e){return!(n?Ma:Na)(t,e)})).map((function(n){return{details:n,pixelDelta:Wa(t,n)}}))}},za=function(n){return function(t,e){return _c(t,e).filter((function(e){return!(n?Ma:Na)(t,e.cells)}))}},_a=Lc((function(n,t,e,r){var o=t[0].row,u=ka(t),i=I(u,(function(n,t){return{grid:ia(n.grid,o,t.row+n.delta,e,r.getOrInit),delta:n.delta+1}}),{grid:n,delta:0}).grid;return Aa(i,o,t[0].column)}),jc,f,f,va),ja=Lc((function(n,t,e,r){var o=ka(t),u=o[o.length-1],i=u.row+u.rowspan,c=I(o,(function(n,t){return ia(n,i,t.row,e,r.getOrInit)}),n);return Aa(c,i,t[0].column)}),jc,f,f,va),Fa=Lc((function(n,t,e,r){var o=t.details,u=ma(o),i=u[0].column,c=I(u,(function(n,t){return{grid:ca(n.grid,i,t.column+n.delta,e,r.getOrInit),delta:n.delta+1}}),{grid:n,delta:0}).grid;return Aa(c,o[0].row,i)}),La(!0),Ia,f,va),Ha=Lc((function(n,t,e,r){var o=t.details,u=o[o.length-1],i=u.column+u.colspan,c=ma(o),a=I(c,(function(n,t){return ca(n,i,t.column,e,r.getOrInit)}),n);return Aa(a,o[0].row,i)}),La(!1),Ia,f,va),qa=Lc((function(n,t,e,r){var o=ma(t.details),u=function(n,t){return z(n,(function(n){var e=n.cells,r=I(t,(function(n,t){return t>=0&&t<n.length?n.slice(0,t).concat(n.slice(t+1)):n}),e);return r.length>0?[tt(r,n.section)]:[]}))}(n,B(o,(function(n){return n.column}))),i=Da(u,o[0].row,o[0].column);return Ra(u,i)}),(function(n,t){return Hc(n,t).map((function(t){return{details:t,pixelDelta:-Wa(n,t)}}))}),Ia,Ta,va),Va=Lc((function(n,t,e,r){var o=ka(t),u=function(n,t,e){var r=xe(n),o=r.rows;return r.cols.concat(o.slice(0,t)).concat(o.slice(e+1))}(n,o[0].row,o[o.length-1].row),i=Da(u,t[0].row,t[0].column);return Ra(u,i)}),jc,f,Ta,va),Ua=(Lc((function(n,t,e,r){var o=sa(n,t.column,e,r.replaceOrInit);return Aa(o,t.row,t.column)}),Fc,f,f,ha("row","th")),Lc((function(n,t,e,r){var o=ma(t),u=M(o,(function(n,t){return sa(n,t.column,e,r.replaceOrInit)}),n);return Aa(u,t[0].row,t[0].column)}),Hc,f,f,ha("row","th"))),Ka=(Lc((function(n,t,e,r){var o=sa(n,t.column,e,r.replaceOrInit);return Aa(o,t.row,t.column)}),Fc,f,f,ha(null,"td")),Lc((function(n,t,e,r){var o=ma(t),u=M(o,(function(n,t){return sa(n,t.column,e,r.replaceOrInit)}),n);return Aa(u,t[0].row,t[0].column)}),Hc,f,f,ha(null,"td"))),$a=(Lc((function(n,t,e,r){var o=da(n,t.row,e,r.replaceOrInit);return Aa(o,t.row,t.column)}),zc,f,f,ha("col","th")),Lc((function(n,t,e,r){var o=ka(t),u=M(o,(function(n,t){return da(n,t.row,e,r.replaceOrInit)}),n);return Aa(u,t[0].row,t[0].column)}),jc,f,f,ha("col","th")),Lc((function(n,t,e,r){var o=da(n,t.row,e,r.replaceOrInit);return Aa(o,t.row,t.column)}),zc,f,f,ha(null,"td")),Lc((function(n,t,e,r){var o=ka(t),u=M(o,(function(n,t){return da(n,t.row,e,r.replaceOrInit)}),n);return Aa(u,t[0].row,t[0].column)}),jc,f,f,ha(null,"td")),Lc((function(n,t,e,r){var o=t.cells;Sa(o);var u=function(n,t,e,r){var o=xe(n).rows;if(0===o.length)return n;for(var u=t.startRow;u<=t.finishRow;u++)for(var i=t.startCol;i<=t.finishCol;i++){var c=o[u],a=we(c,i).isLocked;ve(c,i,nt(r(),!1,a))}return n}(n,t.bounds,0,r.merge(o));return Ra(u,S.from(o[0]))}),Vc,Ea,f,ba)),Ga=Lc((function(n,t,e,r){var o=I(t,(function(n,t){return Kc(n,t,e,r.unmerge(t))}),n);return Ra(o,S.from(t[0]))}),Uc,Ea,f,ba),Xa=Lc((function(n,t,e,r){var o,u,i=function(n,t){var e=ke(n);return Ic(e,t,!0)}(t.clipboard,t.generators);return function(n,t,e,r,o){var u=Re(t),i=function(n,t,e){var r=Ce(t[0]),o=k(r-n.column,(function(t){return t+n.column})),u=N(o,(function(n){return _(e,(function(t){return t!==n}))})).getOr(r-1);return K(K({},n),{column:u})}(n,t,u),c=ra(i,e,u);return function(n,t,e){if(n.row>=t.length||n.column>Ce(t[0]))return Xc.error("invalid start address out of table bounds, row: "+n.row+", column: "+n.column);var r=t.slice(n.row),o=r[0].cells.slice(n.column),u=Ce(e[0]),i=e.length;return Xc.value({rowDelta:r.length-i,colDelta:o.length-u})}(i,t,e).map((function(n){var u=K(K({},n),{colDelta:n.colDelta-c.length}),a=ta(t,u,r),l=Re(a),f=ra(i,e,l);return function(n,t,e,r,o,u){for(var i=n.row,c=n.column,a=i+e.length,l=c+Ce(e[0])+u.length,f=j(u,w),s=i;s<a;s++)for(var d=0,m=c;m<l;m++)if(f[m])d++;else{ea(t,s,m,o)&&Kc(t,ye(t[s],m),o,r.cell);var p=m-c-d,g=we(e[s-i],p),v=g.element,h=r.replace(v);ve(t[s],m,nt(h,!0,g.isLocked))}return t}(i,a,e,r,o,f)}))}((o=t.row,u=t.column,{row:o,column:u}),n,i,t.generators,e).fold((function(){return Ra(n,S.some(t.element))}),(function(n){var e=Da(n,t.row,t.column);return Ra(n,e)}))}),(function(n,t){return ue(t.element).bind((function(e){return Nc(n,e).map((function(n){return K(K({},n),{generators:t.generators,clipboard:t.clipboard})}))}))}),Ea,f,va),Ya=Lc((function(n,t,e,r){var o=xe(n).rows,u=t.cells[0].column,i=o[t.cells[0].row],c=Ba(t.clipboard,t.generators,i),a=oa(u,n,c,t.generators,e),l=Da(a,t.cells[0].row,t.cells[0].column);return Ra(a,l)}),za(!0),f,f,va),Ja=Lc((function(n,t,e,r){var o=xe(n).rows,u=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,i=o[t.cells[0].row],c=Ba(t.clipboard,t.generators,i),a=oa(u,n,c,t.generators,e),l=Da(a,t.cells[0].row,t.cells[0].column);return Ra(a,l)}),za(!1),f,f,va),Qa=Lc((function(n,t,e,r){var o=xe(n).rows,u=t.cells[0].row,i=o[u],c=Ba(t.clipboard,t.generators,i),a=ua(u,n,c,t.generators,e),l=Da(a,t.cells[0].row,t.cells[0].column);return Ra(a,l)}),_c,f,f,va),Za=Lc((function(n,t,e,r){var o=xe(n).rows,u=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,i=o[t.cells[0].row],c=Ba(t.clipboard,t.generators,i),a=ua(u,n,c,t.generators,e),l=Da(a,t.cells[0].row,t.cells[0].column);return Ra(a,l)}),_c,f,f,va),nl=function(n,t){var e=ke(n);return jc(e,t).bind((function(n){var t=n[n.length-1],r=n[0].column,o=t.column+t.colspan,u=L(B(e.all,(function(n){return E(n.cells,(function(n){return n.column>=r&&n.column<o}))})));return Pa(u,(function(n){return"th"===et(n.element)}))})).getOr("")},tl=function(n){return mu(n.parentNode)},el=function(n,t){var e="thead"===tl(t),r=!A(t.cells,(function(n){return"th"!==mu(n)}));return e||r?S.some({thead:e,ths:r}):S.none()},rl=function(n,t){return"thead"===(e=el(0,t).fold((function(){return tl(t)}),(function(n){return"thead"})))?"header":"tfoot"===e?"footer":"body";var e},ol=function(n,t,e){var r=n.getParent(t,"table"),o=t.parentNode,u=mu(o);if(e!==u){var i=n.select(e,r)[0];if(!i){i=n.create(e);var c=r.firstChild;"thead"===e?V(Ot(Mn.fromDom(r),"caption,colgroup")).fold((function(){return r.insertBefore(i,c)}),(function(t){return n.insertAfter(i,t.dom)})):r.appendChild(i)}"tbody"===e&&"thead"===u&&i.firstChild?i.insertBefore(t,i.firstChild):i.appendChild(t),o.hasChildNodes()||n.remove(o)}},ul=function(n,t,e,r){var o=n.dom,u=function(n,t,e){if(c(e)&&mu(t)!==e){var r=n.dom.rename(t,e);return qi(n,r),r}return t}(n,t,e);return i(r)||o.setAttrib(u,"scope",r),u},il=function(n,t,e,r){return P(t,(function(t){return ul(n,t,e,r)}))},cl=function(n,t,e){var r,o=n.dom;if("header"===e){var u=ac(n),i="auto"===u?(r=ae(Mn.fromDom(t.cells[0])).map((function(n){return le(n)})).getOr([]),U(r,(function(n){return el(0,n.dom)})).map((function(n){return n.thead&&n.ths?"sectionCells":n.thead?"section":"cells"})).getOr("section")):u;il(n,t.cells,"section"===i?"td":"th","col"),ol(o,t,"cells"===i?"tbody":"thead")}else il(n,t.cells,"td",null),ol(o,t,"footer"===e?"tfoot":"tbody")},al=function(n){return function(t,e){var r=et(t),o="col"===r||"colgroup"===r?function(n){return ae(n).bind((function(n){return Cr(n,Du.firstSelectedSelector)})).fold((function(){return n}),(function(n){return n[0]}))}(t):t;return Mt(o,n,e)}},ll=al("th,td"),fl=al("th,td,caption"),sl=function(n,t,e){return ll(n,e).map((function(n){return Su(t)})).getOr([])},dl=function(n,t){var e,r,o,u=ll(n),i=u.bind((function(n){return ae(n)})).map((function(n){return le(n)}));return(e=u,r=i,o=function(n,e){return E(e,(function(e){return A(du(e.dom.cells),(function(e){return"1"===zt(e,t)||Ln(e,n)}))}))},e.isSome()&&r.isSome()?S.some(o(e.getOrDie(),r.getOrDie())):S.none()).getOr([])},ml={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},pl=function(n,t,e,r){return k(n,(function(n){return function(n,t,e,r){for(var o=Mn.fromTag("tr"),u=0;u<n;u++){var i=Mn.fromTag(r<t||u<e?"th":"td");u<e&&Wt(i,"scope","row"),r<t&&Wt(i,"scope","col"),Xe(i,Mn.fromTag("br")),Xe(o,i)}return o}(t,e,r,n)}))},gl=function(n,t){n.selection.select(t.dom,!0),n.selection.collapse(!0)},vl=function(n,t,r,o,u){var i=Zi(n),c={styles:i,attributes:Qi(n),colGroups:cc(n)};return n.undoManager.ignore((function(){var e=function(n,t,e,r,o,u){void 0===u&&(u=ml);var i=Mn.fromTag("table"),c="cells"!==o;Ut(i,u.styles),Lt(i,u.attributes),u.colGroups&&Xe(i,function(n){var t=Mn.fromTag("colgroup");return k(n,(function(){return Xe(t,Mn.fromTag("col"))})),t}(t));var a=Math.min(n,e);if(c&&e>0){var l=Mn.fromTag("thead");Xe(i,l);var f=pl(e,t,"sectionCells"===o?a:0,r);Qe(l,f)}var s=Mn.fromTag("tbody");Xe(i,s);var d=pl(c?n-a:n,t,c?0:e,r);return Qe(s,d),i}(r,t,u,o,ac(n),c);Wt(e,"data-mce-id","__mce");var i=function(n){var t=Mn.fromTag("div"),e=Mn.fromDom(n.dom.cloneNode(!0));return Xe(t,e),function(n){return n.dom.innerHTML}(t)}(e);n.insertContent(i),n.addVisual()})),It(pu(n),'table[data-mce-id="__mce"]').map((function(t){return uc(n)?vc(n,t):ic(n)?hc(t):(oc(n)||function(n){return e(n)&&-1!==n.indexOf("%")}(i.width))&&gc(n,t),wu(t),jt(t,"data-mce-id"),function(n,t){P(At(t,"tr"),(function(t){Hi(n,t.dom),P(At(t,"th,td"),(function(t){qi(n,t.dom)}))}))}(n,t),function(n,t){It(t,"td,th").each(m(gl,n))}(n,t),t.dom})).getOr(null)},hl=function(n,t,e,r,o){void 0===r&&(r={});var u=function(n){return l(n)&&n>0};if(u(t)&&u(e)){var i=r.headerRows||0,c=r.headerColumns||0;return vl(n,e,t,c,i)}return console.error(o),null},bl=function(n){return function(){return n().fold((function(){return[]}),(function(n){return B(n,(function(n){return n.dom}))}))}},wl=function(n){return function(t){var e=t.length>0?S.some(du(t)):S.none();n(e)}},yl=function(n){return function(t,e,r){void 0===r&&(r={});var o=hl(n,e,t,r,"Invalid values for insertTable - rows and columns values are required to insert a table.");return n.undoManager.add(),o}},Cl=function(n,t,e){var r=Yt(n,t,1);1===e||r<=1?jt(n,t):Wt(n,t,Math.min(e,r))},xl=tinymce.util.Tools.resolve("tinymce.util.Tools"),Sl=function(n,t,e){return function(t,r){for(var o=0;o<r.length;o++){var u=n.getStyle(r[o],e);if(void 0===t&&(t=u),t!==u)return""}return t}(void 0,n.select("td,th",t))},Tl=function(n,t,e){e&&n.formatter.apply("align"+e,{},t)},Rl=function(n,t){xl.each("left center right".split(" "),(function(e){n.formatter.remove("align"+e,{},t)}))},Dl=function(n,t){return e=n,(t||[]).concat(B(e,(function(n){var t=n.text||n.title;return function(n){return Yn(n,"menu")}(n)?{text:t,items:Dl(n.menu)}:{text:t,value:n.value}})));var e},Ol=function(n){return function(t){return en(t,"rgb")?n.toHex(t):t}},Al=function(n,t){var e=Mn.fromDom(t);return{borderwidth:Gt(e,"border-width").getOr(""),borderstyle:Gt(e,"border-style").getOr(""),bordercolor:Gt(e,"border-color").map(Ol(n)).getOr(""),backgroundcolor:Gt(e,"background-color").map(Ol(n)).getOr("")}},kl=function(n){var t=n[0],e=n.slice(1);return P(e,(function(n){P(jn(t),(function(e){Hn(n,(function(n,r){var o=t[e];""!==o&&e===r&&o!==n&&(t[e]="")}))}))})),t},Bl=function(n){var t=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}},Pl=function(n,t,e,r){return N(n,(function(n){return e.formatter.matchNode(r,t+n)})).getOr("")},El=m(Pl,["left","center","right"],"align"),Il=m(Pl,["top","middle","bottom"],"valign"),Ml=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Nl=function(n){return Ml.concat(function(n){var t=Dl(function(n){return n.getParam("table_cell_class_list",[],"array")}(n));return t.length>0?S.some({name:"class",type:"listbox",label:"Class",items:t}):S.none()}(n).toArray())},Wl=function(n){return function(t,e){var r=t.dom;return{setAttrib:function(t,o){n&&!o||r.setAttrib(e,t,o)},setStyle:function(t,o){n&&!o||r.setStyle(e,t,o)},setFormat:function(r,o){n&&!o||(""===o?t.formatter.remove(r,{value:null},e,!0):t.formatter.apply(r,{value:o},e))}}}},Ll={normal:Wl(!1),ifTruthy:Wl(!0)},zl=function(n){return ae(n[0]).map((function(t){var e=ke(t),r=Me(e),o=E(r,(function(t){return A(n,(function(n){return Ln(t.element,n)}))}));return B(o,(function(n){return{element:n.element.dom,column:Le(e,n.column).map((function(n){return n.element.dom}))}}))}))},_l=function(n,t,e,r){var o=r.getData();r.close(),n.undoManager.transact((function(){(function(n,t,e,r){var o=1===t.length,u=Un(r,(function(n,t){return e[t]!==n}));if($n(u)>0&&t.length>=1){var i=ae(t[0]);zl(t).each((function(t){P(t,(function(t){var e=ul(n,t.element,r.celltype),u=o?Ll.normal(n,e):Ll.ifTruthy(n,e);!function(n,t,e){n.setAttrib("scope",e.scope),n.setAttrib("class",e.class),n.setStyle("height",bu(e.height)),t.setStyle("width",bu(e.width))}(u,t.column.map((function(t){return o?Ll.normal(n,t):Ll.ifTruthy(n,t)})).getOr(u),r),nc(n)&&function(n,t){n.setFormat("tablecellbackgroundcolor",t.backgroundcolor),n.setFormat("tablecellbordercolor",t.bordercolor),n.setFormat("tablecellborderstyle",t.borderstyle),n.setFormat("tablecellborderwidth",bu(t.borderwidth))}(u,r),o&&(Rl(n,e),function(n,t){xl.each("top middle bottom".split(" "),(function(e){n.formatter.remove("valign"+e,{},t)}))}(n,e)),r.halign&&Tl(n,e,r.halign),r.valign&&function(n,t,e){e&&n.formatter.apply("valign"+e,{},t)}(n,e,r.valign)}))}));var c=$n(Un(u,(function(n,t){return"scope"!==t&&"celltype"!==t})))>0;i.each((function(t){return Vi(n,t.dom,{structure:Xn(u,"celltype"),style:c})}))}})(n,t,e,o),n.focus()}))},jl=function(n,t){var e=sl(xu(n),t);if(0!==e.length){var r=function(n,t){var e=zl(t).map((function(t){return B(t,(function(t){return function(n,t,e,r){var o=n.dom,u=r.getOr(t),i=function(n,t){return o.getStyle(n,t)||o.getAttrib(n,t)};return K({width:i(u,"width"),height:i(t,"height"),scope:o.getAttrib(t,"scope"),celltype:mu(t),class:o.getAttrib(t,"class",""),halign:El(n,t),valign:Il(n,t)},e?Al(o,t):{})}(n,t.element,nc(n),t.column)}))}));return kl(e.getOrDie())}(n,e),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:Nl(n)},Bl("cell")]},u={type:"panel",items:[{type:"grid",columns:2,items:Nl(n)}]};n.windowManager.open({title:"Cell Properties",size:"normal",body:nc(n)?o:u,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:m(_l,n,e,r)})}},Fl=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Hl=function(n){return Fl.concat(function(n){var t=Dl(function(n){return n.getParam("table_row_class_list",[],"array")}(n));return t.length>0?S.some({name:"class",type:"listbox",label:"Class",items:t}):S.none()}(n).toArray())},ql=function(n,t,e,r){var o=r.getData();r.close(),n.undoManager.transact((function(){(function(n,t,e,r){var o=1===t.length,u=Un(r,(function(n,t){return e[t]!==n}));if($n(u)>0){P(t,(function(t){r.type!==mu(t.parentNode)&&cl(n,t,r.type);var u=o?Ll.normal(n,t):Ll.ifTruthy(n,t);!function(n,t){n.setAttrib("class",t.class),n.setStyle("height",bu(t.height))}(u,r),tc(n)&&function(n,t){n.setStyle("background-color",t.backgroundcolor),n.setStyle("border-color",t.bordercolor),n.setStyle("border-style",t.borderstyle)}(u,r),r.align!==e.align&&(Rl(n,t),Tl(n,t,r.align))}));var i=Xn(u,"type"),c=!i||$n(u)>1;ae(Mn.fromDom(t[0])).each((function(t){return Vi(n,t.dom,{structure:i,style:c})}))}})(n,t,e,o),n.focus()}))},Vl=function(n){var t=dl(xu(n),Du.selected);if(0!==t.length){var e=B(t,(function(t){return function(n,t,e){var r=n.dom;return K({height:r.getStyle(t,"height")||r.getAttrib(t,"height"),class:r.getAttrib(t,"class",""),type:rl(0,t),align:El(n,t)},e?Al(r,t):{})}(n,t.dom,tc(n))})),r=kl(e),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:Hl(n)},Bl("row")]},u={type:"panel",items:[{type:"grid",columns:2,items:Hl(n)}]};n.windowManager.open({title:"Row Properties",size:"normal",body:tc(n)?o:u,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:m(ql,n,B(t,(function(n){return n.dom})),r)})}},Ul=tinymce.util.Tools.resolve("tinymce.Env"),Kl=function(n,t,e){var r=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=function(n){return n.getParam("table_appearance_options",!0,"boolean")}(n)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],u=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(u)},$l=function(n,t,r,o){if("TD"===t.tagName||"TH"===t.tagName)e(r)?n.setStyle(t,r,o):n.setStyle(t,r);else if(t.children)for(var u=0;u<t.children.length;u++)$l(n,t.children[u],r,o)},Gl=function(n,t,e,r){var o,u=n.dom,i=r.getData(),c=Un(i,(function(n,t){return e[t]!==n}));r.close(),""===i.class&&delete i.class,n.undoManager.transact((function(){if(!t){var e=parseInt(i.cols,10)||1,r=parseInt(i.rows,10)||1;t=vl(n,e,r,0,0)}if($n(c)>0&&(function(n,t,e){var r=n.dom,o={},u={};if(o.class=e.class,u.height=bu(e.height),r.getAttrib(t,"width")&&!rc(n)?o.width=function(n){return n?n.replace(/px$/,""):""}(e.width):u.width=bu(e.width),rc(n)?(u["border-width"]=bu(e.border),u["border-spacing"]=bu(e.cellspacing)):(o.border=e.border,o.cellpadding=e.cellpadding,o.cellspacing=e.cellspacing),rc(n)&&t.children)for(var i=0;i<t.children.length;i++)$l(r,t.children[i],{"border-width":bu(e.border),padding:bu(e.cellpadding)}),ec(n)&&$l(r,t.children[i],{"border-color":e.bordercolor});ec(n)&&(u["background-color"]=e.backgroundcolor,u["border-color"]=e.bordercolor,u["border-style"]=e.borderstyle),o.style=r.serializeStyle(K(K({},Zi(n)),u)),r.setAttribs(t,K(K({},Qi(n)),o))}(n,t,i),(o=u.select("caption",t)[0])&&!i.caption&&u.remove(o),!o&&i.caption&&((o=u.create("caption")).innerHTML=Ul.ie?"Â ":'<br data-mce-bogus="1"/>',t.insertBefore(o,t.firstChild)),""===i.align?Rl(n,t):Tl(n,t,i.align)),n.focus(),n.addVisual(),$n(c)>0){var a=Xn(c,"caption"),l=!a||$n(c)>1;Vi(n,t,{structure:a,style:l})}}))},Xl=function(n,t){var e,r=n.dom,o=function(n,t){var e,r,o,u,i=Zi(n),c=Qi(n),a=t?(e=n.dom,{borderstyle:Gn(i,"border-style").getOr(""),bordercolor:Ol(e)(Gn(i,"border-color").getOr("")),backgroundcolor:Ol(e)(Gn(i,"background-color").getOr(""))}):{};return K(K(K(K(K(K({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),i),c),a),(u=i["border-width"],rc(n)&&u?{border:u}:Gn(c,"border").fold((function(){return{}}),(function(n){return{border:n}})))),(r=Gn(i,"border-spacing").or(Gn(c,"cellspacing")).fold((function(){return{}}),(function(n){return{cellspacing:n}})),o=Gn(i,"border-padding").or(Gn(c,"cellpadding")).fold((function(){return{}}),(function(n){return{cellpadding:n}})),K(K({},r),o)))}(n,ec(n));!1===t?(e=r.getParent(n.selection.getStart(),"table",n.getBody()))?o=function(n,t,e){var r=n.dom;return K({width:r.getStyle(t,"width")||r.getAttrib(t,"width"),height:r.getStyle(t,"height")||r.getAttrib(t,"height"),cellspacing:r.getStyle(t,"border-spacing")||r.getAttrib(t,"cellspacing"),cellpadding:r.getAttrib(t,"cellpadding")||Sl(n.dom,t,"padding"),border:function(t,e){var r=Gt(Mn.fromDom(e),"border-width");return rc(n)&&r.isSome()?r.getOr(""):t.getAttrib(e,"border")||Sl(n.dom,e,"border-width")||Sl(n.dom,e,"border")}(r,t),caption:!!r.select("caption",t)[0],class:r.getAttrib(t,"class",""),align:El(n,t)},e?Al(r,t):{})}(n,e,ec(n)):ec(n)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",ec(n)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var u=Dl(function(n){return n.getParam("table_class_list",[],"array")}(n));u.length>0&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var i={type:"grid",columns:2,items:Kl(n,u,t)},c=ec(n)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[i]},Bl("table")]}:{type:"panel",items:[i]};n.windowManager.open({title:"Table Properties",size:"normal",body:c,onSubmit:m(Gl,n,e,o),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},Yl=function(n){return fl(xu(n),hu(n))},Jl=function(n){return ll(xu(n),hu(n))},Ql=function(n,t,o,u,i){var c=hu(n),a=function(n){return ae(n,c)},l=function(t){return function(e){n.selection.setRng(e.rng),n.focus(),o.clear(t),wu(t),Vi(n,t.dom,e.effect)}},s=function(t){return Jl(n).each((function(n){a(n).each((function(e){var r=Ou(u,e,n);t(e,r).each(l(e))}))}))},d=function(){return Jl(n).map((function(t){return a(t).bind((function(e){return function(n,t,e){var r=ke(n);return jc(r,t).bind((function(n){var t=Ic(r,e,!1),o=xe(t).rows.slice(n[0].row,n[n.length-1].row+n[n.length-1].rowspan),u=z(o,(function(n){var t=E(n.cells,(function(n){return!n.isLocked}));return t.length>0?[K(K({},n),{cells:t})]:[]})),i=Mc(u,e);return Mr(i.length>0,i)})).map((function(n){return B(n,(function(n){var t=Pr(n.element);return P(n.cells,(function(n){var e=Er(n.element);Ac(e,"colspan",n.colspan,1),Ac(e,"rowspan",n.rowspan,1),Xe(t,e)})),t}))}))}(e,Ou(u,e,t),fu(f,Mn.fromDom(n.getDoc()),S.none()))}))}))},p=function(){return Jl(n).map((function(n){return a(n).bind((function(t){return function(n,t){var e=ke(n);return Hc(e,t).map((function(n){var t=n[n.length-1],r=n[0].column,o=t.column+t.colspan;return $(function(n,t,e){if(We(n)){var r=E(Ne(n),(function(n){return n.column>=t&&n.column<e})),o=B(r,(function(n){var r=Er(n.element);return Cl(r,"span",e-t),r})),u=Mn.fromTag("colgroup");return Qe(u,o),[u]}return[]}(e,r,o),function(n,t,e){return B(n.all,(function(n){var r=E(n.cells,(function(n){return n.column>=t&&n.column<e})),o=B(r,(function(n){var r=Er(n.element);return Cl(r,"colspan",e-t),r})),u=Mn.fromTag("tr");return Qe(u,o),u}))}(e,r,o))}))}(t,Ou(u,t,n))}))}))},g=function(t,e){return e().each((function(e){var r=B(e,(function(n){return Er(n)}));Jl(n).each((function(e){return a(e).each((function(e){var o=su(Mn.fromDom(n.getDoc())),i=function(n,t,e,r){return{selection:Su(n),clipboard:e,generators:r}}(u,0,r,o);t(e,i).each(l(e))}))}))}))};Hn({mceTableSplitCells:function(){return s(t.unmergeCells)},mceTableMergeCells:function(){return s(t.mergeCells)},mceTableInsertRowBefore:function(){return s(t.insertRowsBefore)},mceTableInsertRowAfter:function(){return s(t.insertRowsAfter)},mceTableInsertColBefore:function(){return s(t.insertColumnsBefore)},mceTableInsertColAfter:function(){return s(t.insertColumnsAfter)},mceTableDeleteCol:function(){return s(t.deleteColumn)},mceTableDeleteRow:function(){return s(t.deleteRow)},mceTableCutCol:function(n){return p().each((function(n){i.setColumns(n),s(t.deleteColumn)}))},mceTableCutRow:function(n){return d().each((function(n){i.setRows(n),s(t.deleteRow)}))},mceTableCopyCol:function(n){return p().each((function(n){return i.setColumns(n)}))},mceTableCopyRow:function(n){return d().each((function(n){return i.setRows(n)}))},mceTablePasteColBefore:function(n){return g(t.pasteColsBefore,i.getColumns)},mceTablePasteColAfter:function(n){return g(t.pasteColsAfter,i.getColumns)},mceTablePasteRowBefore:function(n){return g(t.pasteRowsBefore,i.getRows)},mceTablePasteRowAfter:function(n){return g(t.pasteRowsAfter,i.getRows)},mceTableDelete:function(){return Yl(n).each((function(t){ae(t,c).filter(h(c)).each((function(t){var e=Mn.fromText("");if($e(t,e),nr(t),n.dom.isEmpty(n.getBody()))n.setContent(""),n.selection.setCursorLocation();else{var r=n.dom.createRng();r.setStart(e.dom,0),r.setEnd(e.dom,0),n.selection.setRng(r),n.nodeChanged()}}))}))},mceTableSizingMode:function(t,e){return function(t){return Yl(n).each((function(e){ic(n)||uc(n)||oc(n)||ae(e,c).each((function(e){"relative"!==t||Zu(e)?"fixed"!==t||ni(e)?"responsive"!==t||ti(e)||hc(e):vc(n,e):gc(n,e),wu(e),Vi(n,e.dom,Ki)}))}))}(e)}},(function(t,e){return n.addCommand(e,t)}));var v=function(n,t){t.each((function(t){Vi(n,t.dom,Ki)}))};Hn({mceTableCellType:function(e,r){var o=ae(xu(n),c);t.setTableCellType(n,r),v(n,o)},mceTableRowType:function(e,r){var o=ae(xu(n),c);t.setTableRowType(n,r),v(n,o)}},(function(t,e){return n.addCommand(e,t)})),n.addCommand("mceTableColType",(function(n,e){return Gn(e,"type").each((function(n){return s("th"===n?t.makeColumnsHeader:t.unmakeColumnsHeader)}))})),Hn({mceTableProps:m(Xl,n,!1),mceTableRowProps:m(Vl,n),mceTableCellProps:m(jl,n,u)},(function(t,e){return n.addCommand(e,(function(){return t()}))})),n.addCommand("mceInsertTable",(function(t,e){r(e)&&jn(e).length>0?hl(n,e.rows,e.columns,e.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Xl(n,!0)})),n.addCommand("mceTableApplyCellStyle",(function(t,o){var i=function(n){return"tablecell"+n.toLowerCase().replace("-","")};if(r(o)){var l=sl(xu(n),u,c);if(0!==l.length){var f=Un(o,(function(t,r){return n.formatter.has(i(r))&&e(t)}));(function(n){for(var t in n)if(Fn.call(n,t))return!1;return!0})(f)||(Hn(f,(function(t,e){P(l,(function(r){Ll.normal(n,r.dom).setFormat(i(e),t)}))})),a(l[0]).each((function(t){return Vi(n,t.dom,Ui)})))}}}))},Zl={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},nf=Sr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),tf=K(K({},nf),{none:function(n){return void 0===n&&(n=void 0),nf.none(n)}}),ef=function(n,t){return ae(n,t).bind((function(t){var e=ie(t);return W(e,(function(t){return Ln(n,t)})).map((function(n){return{index:n,all:e}}))}))},rf=function(n,t,e,r){return{start:n,soffset:t,finish:e,foffset:r}},of=Sr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),uf={before:of.before,on:of.on,after:of.after,cata:function(n,t,e,r){return n.fold(t,e,r)},getStart:function(n){return n.fold(d,d,d)}},cf=Sr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),af={domRange:cf.domRange,relative:cf.relative,exact:cf.exact,exactFromRange:function(n){return cf.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var t=function(n){return n.match({domRange:function(n){return Mn.fromDom(n.startContainer)},relative:function(n,t){return uf.getStart(n)},exact:function(n,t,e,r){return n}})}(n);return Mn.fromDom(dt(t).dom.defaultView)},range:rf},lf=function(n,t,e){var r,o=n.document.createRange();return r=o,t.fold((function(n){r.setStartBefore(n.dom)}),(function(n,t){r.setStart(n.dom,t)}),(function(n){r.setStartAfter(n.dom)})),function(n,t){t.fold((function(t){n.setEndBefore(t.dom)}),(function(t,e){n.setEnd(t.dom,e)}),(function(t){n.setEndAfter(t.dom)}))}(o,e),o},ff=function(n,t,e,r,o){var u=n.document.createRange();return u.setStart(t.dom,e),u.setEnd(r.dom,o),u},sf=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},df=Sr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),mf=function(n,t,e){return t(Mn.fromDom(e.startContainer),e.startOffset,Mn.fromDom(e.endContainer),e.endOffset)},pf=function(n,t){return e=function(n,t){return t.match({domRange:function(n){return{ltr:s(n),rtl:S.none}},relative:function(t,e){return{ltr:G((function(){return lf(n,t,e)})),rtl:G((function(){return S.some(lf(n,e,t))}))}},exact:function(t,e,r,o){return{ltr:G((function(){return ff(n,t,e,r,o)})),rtl:G((function(){return S.some(ff(n,r,o,t,e))}))}}})}(n,t),(r=e.ltr()).collapsed?e.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return df.rtl(Mn.fromDom(n.endContainer),n.endOffset,Mn.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return mf(0,df.ltr,r)})):mf(0,df.ltr,r);var e,r},gf=function(n,t){return pf(n,t).match({ltr:function(t,e,r,o){var u=n.document.createRange();return u.setStart(t.dom,e),u.setEnd(r.dom,o),u},rtl:function(t,e,r,o){var u=n.document.createRange();return u.setStart(r.dom,o),u.setEnd(t.dom,e),u}})},vf=(df.ltr,df.rtl,function(n,t,e){return t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom}),hf=function(n,t,e,r){return ct(t)?function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var u=o.getClientRects();return U(u,(function(n){return vf(n,e,r)?S.some(n):S.none()})).map((function(o){return function(n,t,e,r,o){var u=function(e){var r=n.dom.createRange();return r.setStart(t.dom,e),r.collapse(!0),r},i=rr(t).length,c=function(n,t,e,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,c=1;c<o;c++){var a=u(c).getBoundingClientRect(),l=Math.abs(t-a.left);if(e<=a.bottom){if(e<a.top||l>i)return c-1;i=l}}return 0}(0,e,r,o.right,i);return u(c)}(n,t,e,r,o)}))}(n,t,e,r):function(n,t,e,r){var o=n.dom.createRange(),u=ht(t);return U(u,(function(t){return o.selectNode(t.dom),vf(o.getBoundingClientRect(),e,r)?hf(n,t,e,r):S.none()}))}(n,t,e,r)},bf=function(n,t){return t-n.left<n.right-t},wf=function(n,t,e){var r=n.dom.createRange();return r.selectNode(t.dom),r.collapse(e),r},yf=function(n,t,e){var r=n.dom.createRange();r.selectNode(t.dom);var o=r.getBoundingClientRect(),u=bf(o,e);return(!0===u?nu:tu)(t).map((function(t){return wf(n,t,u)}))},Cf=function(n,t,e){var r=t.dom.getBoundingClientRect(),o=bf(r,e);return S.some(wf(n,t,o))},xf=document.caretPositionFromPoint?function(n,t,e){return S.from(n.dom.caretPositionFromPoint(t,e)).bind((function(t){if(null===t.offsetNode)return S.none();var e=n.dom.createRange();return e.setStart(t.offsetNode,t.offset),e.collapse(),S.some(e)}))}:document.caretRangeFromPoint?function(n,t,e){return S.from(n.dom.caretRangeFromPoint(t,e))}:function(n,t,e){return Mn.fromPoint(n,t,e).bind((function(r){var o=function(){return function(n,t,e){return(0===ht(t).length?Cf:yf)(n,t,e)}(n,r,t)};return 0===ht(r).length?o():function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var u=o.getBoundingClientRect();return function(n,t,e,r){var o=n.dom.createRange();o.selectNode(t.dom);var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,e)),c=Math.max(u.top,Math.min(u.bottom,r));return hf(n,t,i,c)}(n,t,Math.max(u.left,Math.min(u.right,e)),Math.max(u.top,Math.min(u.bottom,r)))}(n,r,t,e).orThunk(o)}))},Sf=function(n,t){var e=et(n);return"input"===e?uf.after(n):O(["br","img"],e)?0===t?uf.before(n):uf.after(n):uf.on(n,t)},Tf=function(n,t){var e=n.fold(uf.before,Sf,uf.after),r=t.fold(uf.before,Sf,uf.after);return af.relative(e,r)},Rf=function(n,t,e,r){var o=Sf(n,t),u=Sf(e,r);return af.relative(o,u)},Df=function(n){return S.from(n.getSelection())},Of=function(n,t){Df(n).each((function(n){n.removeAllRanges(),n.addRange(t)}))},Af=function(n,t,e,r,o){var u=ff(n,t,e,r,o);Of(n,u)},kf=function(n,t){return pf(n,t).match({ltr:function(t,e,r,o){Af(n,t,e,r,o)},rtl:function(t,e,r,o){Df(n).each((function(u){if(u.setBaseAndExtent)u.setBaseAndExtent(t.dom,e,r.dom,o);else if(u.extend)try{!function(n,t,e,r,o,u){t.collapse(e.dom,r),t.extend(o.dom,u)}(0,u,t,e,r,o)}catch(u){Af(n,r,o,t,e)}else Af(n,r,o,t,e)}))}})},Bf=function(n,t,e,r,o){var u=Rf(t,e,r,o);kf(n,u)},Pf=function(n,t,e){var r=Tf(t,e);kf(n,r)},Ef=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return S.some(rf(Mn.fromDom(t.startContainer),t.startOffset,Mn.fromDom(e.endContainer),e.endOffset))}return S.none()},If=function(n){if(null===n.anchorNode||null===n.focusNode)return Ef(n);var t=Mn.fromDom(n.anchorNode),e=Mn.fromDom(n.focusNode);return function(n,t,e,r){var o=function(n,t,e,r){var o=st(n).dom.createRange();return o.setStart(n.dom,t),o.setEnd(e.dom,r),o}(n,t,e,r),u=Ln(n,e)&&t===r;return o.collapsed&&!u}(t,n.anchorOffset,e,n.focusOffset)?S.some(rf(t,n.anchorOffset,e,n.focusOffset)):Ef(n)},Mf=function(n){return function(n){return Df(n).filter((function(n){return n.rangeCount>0})).bind(If)}(n).map((function(n){return af.exact(n.start,n.soffset,n.finish,n.foffset)}))},Nf=tinymce.util.Tools.resolve("tinymce.util.VK"),Wf=function(n,t,e){return _f(n,t,ef(r=e,void 0).fold((function(){return tf.none(r)}),(function(n){return n.index+1<n.all.length?tf.middle(r,n.all[n.index+1]):tf.last(r)})));var r},Lf=function(n,t,e){return _f(n,t,ef(r=e,void 0).fold((function(){return tf.none()}),(function(n){return n.index-1>=0?tf.middle(r,n.all[n.index-1]):tf.first(r)})));var r},zf=function(n,t){return function(n){var t=af.getWin(n).dom,e=function(n,e,r,o){return ff(t,n,e,r,o)},r=function(n){return n.match({domRange:function(n){var t=Mn.fromDom(n.startContainer),e=Mn.fromDom(n.endContainer);return Rf(t,n.startOffset,e,n.endOffset)},relative:Tf,exact:Rf})}(n);return pf(t,r).match({ltr:e,rtl:e})}(af.exact(t,0,t,0))},_f=function(n,t,e){return e.fold(S.none,S.none,(function(n,t){return nu(t).map((function(n){return zf(0,n)}))}),(function(e){return ae(e,t).bind((function(t){return n.execCommand("mceTableInsertRowAfter"),function(n,t){var e=At(t,"tr");return V(e).bind((function(n){return It(n,"td,th").map((function(n){return zf(0,n)}))}))}(0,t)}))}))},jf=["table","li","dl"],Ff=function(n,t){return{selection:n,kill:t}},Hf=function(n,t,e,r){return{start:uf.on(n,t),finish:uf.on(e,r)}},qf=function(n,t){var e=gf(n,t);return rf(Mn.fromDom(e.startContainer),e.startOffset,Mn.fromDom(e.endContainer),e.endOffset)},Vf=Hf,Uf=function(n,t,e,r,o){return Ln(e,r)?S.none():hr(e,r,t).bind((function(t){var r=t.boxes.getOr([]);return r.length>0?(o(n,r,t.start,t.finish),S.some(Ff(S.some(Vf(e,0,e,Jo(e))),!0))):S.none()}))},Kf=function(n,t){return{item:n,mode:t}},$f=function(n,t,e,r){return void 0===r&&(r=Gf),n.property().parent(t).map((function(n){return Kf(n,r)}))},Gf=function(n,t,e,r){return void 0===r&&(r=Xf),e.sibling(n,t).map((function(n){return Kf(n,r)}))},Xf=function(n,t,e,r){void 0===r&&(r=Xf);var o=n.property().children(t);return e.first(o).map((function(n){return Kf(n,r)}))},Yf=[{current:$f,next:Gf,fallback:S.none()},{current:Gf,next:Xf,fallback:S.some($f)},{current:Xf,next:Xf,fallback:S.some(Gf)}],Jf=function(n,t,e,r,o){return void 0===o&&(o=Yf),N(o,(function(n){return n.current===e})).bind((function(e){return e.current(n,t,r,e.next).orThunk((function(){return e.fallback.bind((function(e){return Jf(n,t,e,r)}))}))}))},Qf=function(n,t,e,r,o,u){return Jf(n,t,r,o).bind((function(t){return u(t.item)?S.none():e(t.item)?S.some(t.item):Qf(n,t.item,e,t.mode,o,u)}))},Zf=function(n){return function(t){return 0===n.property().children(t).length}},ns=function(n,t,e,r){return Qf(n,t,e,Gf,{sibling:function(n,t){return n.query().prevSibling(t)},first:function(n){return n.length>0?S.some(n[n.length-1]):S.none()}},r)},ts=function(n,t,e,r){return Qf(n,t,e,Gf,{sibling:function(n,t){return n.query().nextSibling(t)},first:function(n){return n.length>0?S.some(n[0]):S.none()}},r)},es=cr(),rs=function(n,t){return function(n,t,e){return ns(n,t,Zf(n),e)}(es,n,t)},os=function(n,t){return function(n,t,e){return ts(n,t,Zf(n),e)}(es,n,t)},us=Sr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),is=function(n){return Mt(n,"tr")},cs=K(K({},us),{verify:function(n,t,e,r,o,u,i){return Mt(r,"td,th",i).bind((function(e){return Mt(t,"td,th",i).map((function(t){return Ln(e,t)?Ln(r,e)&&Jo(e)===o?u(t):us.none("in same cell"):gr(is,[e,t]).fold((function(){return function(n,t,e){var r=n.getRect(t),o=n.getRect(e);return o.right>r.left&&o.left<r.right}(n,t,e)?us.success():u(t)}),(function(n){return u(t)}))}))})).getOr(us.none("default"))},cata:function(n,t,e,r,o){return n.fold(t,e,r,o)}}),as=function(n){return"br"===et(n)},ls=function(n,t,e){return t(n,e).bind((function(n){return ct(n)&&0===rr(n).trim().length?ls(n,t,e):S.some(n)}))},fs=function(n,t,e,r){return function(n,t){return bt(n,t).filter(as).orThunk((function(){return bt(n,t-1).filter(as)}))}(t,e).bind((function(t){return r.traverse(t).fold((function(){return ls(t,r.gather,n).map(r.relative)}),(function(n){return function(n){return mt(n).bind((function(t){var e=ht(t);return function(n,t){return W(n,m(Ln,t))}(e,n).map((function(r){return function(n,t,e,r){return{parent:n,children:t,element:e,index:r}}(t,e,n,r)}))}))}(n).map((function(n){return uf.on(n.parent,n.index)}))}))}))},ss=function(n,t){return{left:n.left,top:n.top+t,right:n.right,bottom:n.bottom+t}},ds=function(n,t){return{left:n.left,top:n.top-t,right:n.right,bottom:n.bottom-t}},ms=function(n,t,e){return{left:n.left+t,top:n.top+e,right:n.right+t,bottom:n.bottom+e}},ps=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}},gs=function(n,t){return S.some(n.getRect(t))},vs=function(n,t,e){return it(t)?gs(n,t).map(ps):ct(t)?function(n,t,e){return e>=0&&e<Jo(t)?n.getRangedRect(t,e,t,e+1):e>0?n.getRangedRect(t,e-1,t,e):S.none()}(n,t,e).map(ps):S.none()},hs=function(n,t){return it(t)?gs(n,t).map(ps):ct(t)?n.getRangedRect(t,0,t,Jo(t)).map(ps):S.none()},bs=Sr([{none:[]},{retry:["caret"]}]),ws=function(n,t,e){return(r=t,o=Ca,kt((function(n,t){return t(n)}),Bt,r,o,undefined)).fold(b,(function(t){return hs(n,t).exists((function(n){return function(n,t){return n.left<t.left||Math.abs(t.right-n.left)<1||n.left>t.right}(e,n)}))}));var r,o},ys={point:function(n){return n.bottom},adjuster:function(n,t,e,r,o){var u=ss(o,5);return Math.abs(e.bottom-r.bottom)<1||e.top>o.bottom?bs.retry(u):e.top===o.bottom?bs.retry(ss(o,1)):ws(n,t,o)?bs.retry(ms(u,5,0)):bs.none()},move:ss,gather:os},Cs=function(n,t,e,r,o){return 0===o?S.some(r):function(n,t,e){return n.elementFromPoint(t,e).filter((function(n){return"table"===et(n)})).isSome()}(n,r.left,t.point(r))?function(n,t,e,r,o){return Cs(n,t,e,t.move(r,5),o)}(n,t,e,r,o-1):n.situsFromPoint(r.left,t.point(r)).bind((function(u){return u.start.fold(S.none,(function(u){return hs(n,u).bind((function(i){return t.adjuster(n,u,i,e,r).fold(S.none,(function(r){return Cs(n,t,e,r,o-1)}))})).orThunk((function(){return S.some(r)}))}),S.none)}))},xs=function(n,t,e){var r=n.move(e,5),o=Cs(t,n,e,r,100).getOr(r);return function(n,t,e){return n.point(t)>e.getInnerHeight()?S.some(n.point(t)-e.getInnerHeight()):n.point(t)<0?S.some(-n.point(t)):S.none()}(n,o,t).fold((function(){return t.situsFromPoint(o.left,n.point(o))}),(function(e){return t.scrollBy(0,e),t.situsFromPoint(o.left,n.point(o)-e)}))},Ss={tryUp:m(xs,{point:function(n){return n.top},adjuster:function(n,t,e,r,o){var u=ds(o,5);return Math.abs(e.top-r.top)<1||e.bottom<o.top?bs.retry(u):e.bottom===o.top?bs.retry(ds(o,1)):ws(n,t,o)?bs.retry(ms(u,5,0)):bs.none()},move:ds,gather:rs}),tryDown:m(xs,ys),ieTryUp:function(n,t){return n.situsFromPoint(t.left,t.top-5)},ieTryDown:function(n,t){return n.situsFromPoint(t.left,t.bottom+5)},getJumpSize:s(5)},Ts=function(n,t,e){return n.getSelection().bind((function(r){return function(n,t,e,r){return(as(t)?function(n,t,e){return e.traverse(t).orThunk((function(){return ls(t,e.gather,n)})).map(e.relative)}(n,t,r):fs(n,t,e,r)).map((function(n){return{start:n,finish:n}}))}(t,r.finish,r.foffset,e).fold((function(){return S.some(Cc(r.finish,r.foffset))}),(function(o){var u,i=n.fromSitus(o);return u=cs.verify(n,r.finish,r.foffset,i.finish,i.foffset,e.failure,t),cs.cata(u,(function(n){return S.none()}),(function(){return S.none()}),(function(n){return S.some(Cc(n,0))}),(function(n){return S.some(Cc(n,Jo(n)))}))}))}))},Rs=function(n,t,e,r,o,u){return 0===u?S.none():As(n,t,e,r,o).bind((function(i){var c=n.fromSitus(i),a=cs.verify(n,e,r,c.finish,c.foffset,o.failure,t);return cs.cata(a,(function(){return S.none()}),(function(){return S.some(i)}),(function(i){return Ln(e,i)&&0===r?Ds(n,e,r,ds,o):Rs(n,t,i,0,o,u-1)}),(function(i){return Ln(e,i)&&r===Jo(i)?Ds(n,e,r,ss,o):Rs(n,t,i,Jo(i),o,u-1)}))}))},Ds=function(n,t,e,r,o){return vs(n,t,e).bind((function(t){return Os(n,o,r(t,Ss.getJumpSize()))}))},Os=function(n,t,e){var r=En().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(n,e):r.isIE()?t.ieRetry(n,e):S.none()},As=function(n,t,e,r,o){return vs(n,e,r).bind((function(t){return Os(n,o,t)}))},ks=function(n,t,e,r,o){return Mt(r,"td,th",t).bind((function(r){return Mt(r,"table",t).bind((function(u){return function(n,t){return Bt(n,(function(n){return mt(n).exists((function(n){return Ln(n,t)}))}),void 0).isSome()}(o,u)?function(n,t,e){return Ts(n,t,e).bind((function(r){return Rs(n,t,r.element,r.offset,e,20).map(n.fromSitus)}))}(n,t,e).bind((function(n){return Mt(n.finish,"td,th",t).map((function(t){return{start:r,finish:t,range:n}}))})):S.none()}))}))},Bs=function(n,t,e,r,o,u){return En().browser.isIE()?S.none():u(r,t).orThunk((function(){return ks(n,t,e,r,o).map((function(n){var t=n.range;return Ff(S.some(Vf(t.start,t.soffset,t.finish,t.foffset)),!0)}))}))},Ps=function(n,t){return Mt(n,"tr",t).bind((function(n){return Mt(n,"table",t).bind((function(e){var r=At(e,"tr");return Ln(n,r[0])?function(n,t,e){return ns(es,n,(function(n){return tu(n).isSome()}),e)}(e,0,t).map((function(n){var t=Jo(n);return Ff(S.some(Vf(n,t,n,t)),!0)})):S.none()}))}))},Es=function(n,t){return Mt(n,"tr",t).bind((function(n){return Mt(n,"table",t).bind((function(e){var r=At(e,"tr");return Ln(n,r[r.length-1])?function(n,t,e){return ts(es,n,(function(n){return nu(n).isSome()}),e)}(e,0,t).map((function(n){return Ff(S.some(Vf(n,0,n,0)),!0)})):S.none()}))}))},Is=function(n,t,e,r,o,u,i){return ks(n,e,r,o,u).bind((function(n){return Uf(t,e,n.start,n.finish,i)}))},Ms=function(n,t){return Mt(n,"td,th",t)},Ns={traverse:vt,gather:os,relative:uf.before,otherRetry:Ss.tryDown,ieRetry:Ss.ieTryDown,failure:cs.failedDown},Ws={traverse:gt,gather:rs,relative:uf.before,otherRetry:Ss.tryUp,ieRetry:Ss.ieTryUp,failure:cs.failedUp},Ls=function(n){return function(t){return t===n}},zs=Ls(38),_s=Ls(40),js=function(n){return n>=37&&n<=40},Fs={isBackward:Ls(37),isForward:Ls(39)},Hs={isBackward:Ls(39),isForward:Ls(37)},qs=function(n){return{elementFromPoint:function(t,e){return Mn.fromPoint(Mn.fromDom(n.document),t,e)},getRect:function(n){return n.dom.getBoundingClientRect()},getRangedRect:function(t,e,r,o){var u=af.exact(t,e,r,o);return function(n,t){return e=gf(n,t),r=e.getClientRects(),(o=r.length>0?r[0]:e.getBoundingClientRect()).width>0||o.height>0?S.some(o).map(sf):S.none();var e,r,o}(n,u)},getSelection:function(){return Mf(n).map((function(t){return qf(n,t)}))},fromSitus:function(t){var e=af.relative(t.start,t.finish);return qf(n,e)},situsFromPoint:function(t,e){return function(n,t,e){return function(n,t,e){var r=Mn.fromDom(n.document);return xf(r,t,e).map((function(n){return rf(Mn.fromDom(n.startContainer),n.startOffset,Mn.fromDom(n.endContainer),n.endOffset)}))}(n,t,e)}(n,t,e).map((function(n){return Hf(n.start,n.soffset,n.finish,n.foffset)}))},clearSelection:function(){!function(n){Df(n).each((function(n){return n.removeAllRanges()}))}(n)},collapseSelection:function(t){void 0===t&&(t=!1),Mf(n).each((function(e){return e.fold((function(n){return n.collapse(t)}),(function(e,r){var o=t?e:r;Pf(n,o,o)}),(function(e,r,o,u){var i=t?e:o,c=t?r:u;Bf(n,i,c,i,c)}))}))},setSelection:function(t){Bf(n,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:function(t,e){Pf(n,t,e)},selectContents:function(t){!function(n,t){var e=function(n,t){var e=n.document.createRange();return function(n,t){n.selectNodeContents(t.dom)}(e,t),e}(n,t);Of(n,e)}(n,t)},getInnerHeight:function(){return n.innerHeight},getScrollY:function(){var t,e,r,o;return(t=Mn.fromDom(n.document),e=void 0!==t?t.dom:document,r=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop,Gr(r,o)).top},scrollBy:function(t,e){!function(n,t,e){var r=(void 0!==e?e.dom:document).defaultView;r&&r.scrollBy(n,t)}(t,e,Mn.fromDom(n.document))}}},Vs=function(n,t){return{rows:n,cols:t}},Us=function(n){return!1===Ci(Mn.fromDom(n.target),"ephox-snooker-resizer-bar")};function Ks(n,t,e){var r=function(n,t,e){var r=function(t){jt(t,n.selected),jt(t,n.firstSelected),jt(t,n.lastSelected)},o=function(t){Wt(t,n.selected,"1")},u=function(n){i(n),e()},i=function(t){var e=At(t,n.selectedSelector);P(e,r)};return{clearBeforeUpdate:i,clear:u,selectRange:function(e,r,i,c){u(e),P(r,o),Wt(i,n.firstSelected,"1"),Wt(c,n.lastSelected,"1"),t(r,i,c)},selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}}(Du,(function(t,r,o){e.targets().each((function(e){ae(r).each((function(u){var i=dc(n),c=fu(f,Mn.fromDom(n.getDoc()),i),a=function(n,t,e){var r=ke(n);return jc(r,t).map((function(n){var t=Ic(r,e,!1);return{upOrLeftCells:function(n,t,e){var r=n.slice(0,t[t.length-1].row+1),o=Mc(r,e);return z(o,(function(n){var e=n.cells.slice(0,t[t.length-1].column+1);return B(e,(function(n){return n.element}))}))}(t,n,e),downOrRightCells:function(n,t,e){var r=n.slice(t[0].row+t[0].rowspan-1,n.length),o=Mc(r,e);return z(o,(function(n){var e=n.cells.slice(t[0].column+t[0].colspan-1,n.cells.length);return B(e,(function(n){return n.element}))}))}(t,n,e)}}))}(u,e,c);!function(n,t,e,r,o){n.fire("TableSelectionChange",{cells:t,start:e,finish:r,otherCells:o})}(n,t,r,o,a)}))}))}),(function(){return function(n){n.fire("TableSelectionClear")}(n)}));return n.on("init",(function(e){var o=n.getWin(),u=pu(n),i=hu(n),c=function(n,t,e,r){var o=function(n,t,e,r){var o,u=(o=Vo(S.none()),{clear:function(){return o.set(S.none())},set:function(n){return o.set(S.some(n))},isSet:function(){return o.get().isSome()},on:function(n){return o.get().each(n)}}),i=u.clear,c=function(o){u.on((function(u){r.clearBeforeUpdate(t),Ms(o.target,e).each((function(o){hr(u,o,e).each((function(e){var i=e.boxes.getOr([]);(i.length>1||1===i.length&&!Ln(u,o))&&(r.selectRange(t,i,e.start,e.finish),n.selectContents(o))}))}))}))};return{clearstate:i,mousedown:function(n){r.clear(t),Ms(n.target,e).each(u.set)},mouseover:function(n){c(n)},mouseup:function(n){c(n),i()}}}(qs(n),t,e,r);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}}(o,u,i,r),a=function(n,t,e,r){var o=qs(n),u=function(){return r.clear(t),S.none()};return{keydown:function(n,i,c,a,l,f){var s=n.raw,d=s.which,p=!0===s.shiftKey;return br(t,r.selectedSelector).fold((function(){return _s(d)&&p?m(Is,o,t,e,Ns,a,i,r.selectRange):zs(d)&&p?m(Is,o,t,e,Ws,a,i,r.selectRange):_s(d)?m(Bs,o,e,Ns,a,i,Es):zs(d)?m(Bs,o,e,Ws,a,i,Ps):S.none}),(function(n){var e=function(e){return function(){return U(e,(function(e){return function(n,t,e,r,o){return yr(r,n,t,o.firstSelectedSelector,o.lastSelectedSelector).map((function(n){return o.clearBeforeUpdate(e),o.selectRange(e,n.boxes,n.start,n.finish),n.boxes}))}(e.rows,e.cols,t,n,r)})).fold((function(){return wr(t,r.firstSelectedSelector,r.lastSelectedSelector).map((function(n){var e=_s(d)||f.isForward(d)?uf.after:uf.before;return o.setRelativeSelection(uf.on(n.first,0),e(n.table)),r.clear(t),Ff(S.none(),!0)}))}),(function(n){return S.some(Ff(S.none(),!0))}))}};return _s(d)&&p?e([Vs(1,0)]):zs(d)&&p?e([Vs(-1,0)]):f.isBackward(d)&&p?e([Vs(0,-1),Vs(-1,0)]):f.isForward(d)&&p?e([Vs(0,1),Vs(1,0)]):js(d)&&!1===p?u:S.none}))()},keyup:function(n,o,u,i,c){return br(t,r.selectedSelector).fold((function(){var a=n.raw,l=a.which;return 0==(!0===a.shiftKey)?S.none():js(l)?function(n,t,e,r,o,u,i){return Ln(e,o)&&r===u?S.none():Mt(e,"td,th",t).bind((function(e){return Mt(o,"td,th",t).bind((function(r){return Uf(n,t,e,r,i)}))}))}(t,e,o,u,i,c,r.selectRange):S.none()}),S.none)}}}(o,u,i,r),l=function(n,t,e,r){var o=qs(n);return function(n,u){r.clearBeforeUpdate(t),hr(n,u,e).each((function(n){var e=n.boxes.getOr([]);r.selectRange(t,e,n.start,n.finish),o.selectContents(u),o.collapseSelection()}))}}(o,u,i,r);n.on("TableSelectorChange",(function(n){return l(n.start,n.finish)}));var s,d,p=function(t,e){(function(n){return!0===n.raw.shiftKey})(t)&&(e.kill&&t.kill(),e.selection.each((function(t){var e=af.relative(t.start,t.finish),r=gf(o,e);n.selection.setRng(r)})))},g=function(n){return 0===n.button},v=(s=Vo(Mn.fromDom(u)),d=Vo(0),{touchEnd:function(n){var t=Mn.fromDom(n.target);if("td"===et(t)||"th"===et(t)){var e=s.get(),r=d.get();Ln(e,t)&&n.timeStamp-r<300&&(n.preventDefault(),l(t,t))}s.set(t),d.set(n.timeStamp)}});n.on("dragstart",(function(n){c.clearstate()})),n.on("mousedown",(function(n){g(n)&&Us(n)&&c.mousedown(hi(n))})),n.on("mouseover",(function(n){var t;(void 0===(t=n).buttons||Ul.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&Us(n)&&c.mouseover(hi(n))})),n.on("mouseup",(function(n){g(n)&&Us(n)&&c.mouseup(hi(n))})),n.on("touchend",v.touchEnd),n.on("keyup",(function(t){var e=hi(t);if(e.raw.shiftKey&&js(e.raw.which)){var r=n.selection.getRng(),o=Mn.fromDom(r.startContainer),u=Mn.fromDom(r.endContainer);a.keyup(e,o,r.startOffset,u,r.endOffset).each((function(n){p(e,n)}))}})),n.on("keydown",(function(e){var r=hi(e);t().each((function(n){return n.hideBars()}));var o=n.selection.getRng(),u=Mn.fromDom(o.startContainer),i=Mn.fromDom(o.endContainer),c=Hr(Fs,Hs)(Mn.fromDom(n.selection.getStart()));a.keydown(r,u,o.startOffset,i,o.endOffset,c).each((function(n){p(r,n)})),t().each((function(n){return n.showBars()}))})),n.on("NodeChange",(function(){var t=n.selection,e=Mn.fromDom(t.getStart()),o=Mn.fromDom(t.getEnd());gr(ae,[e,o]).fold((function(){return r.clear(u)}),f)}))})),{clear:r.clear}}kr.add("table",(function(n){var t,e=(t=Du.selectedSelector,{get:function(){return Cr(pu(n),t).fold((function(){return fl(xu(n)).map(Ar).getOrThunk(Dr)}),(function(n){return Or(n)}))}}),r=function(n,t){var e=Vo(S.none()),r=Vo([]),o=S.none(),u=ft("caption"),i=function(n){return o.forall((function(t){return!t[n]}))},c=function(){return fl(xu(n),hu(n)).bind((function(n){return ae(n).map((function(e){return u(n)?function(n){return{element:n,mergable:S.none(),unmergable:S.none(),selection:[n]}}(n):Ou(t,e,n)}))}))},a=function(n){return ae(n.element).map((function(t){var e=ke(t),r=jc(e,n).getOr([]),o=M(r,(function(n,t){return t.isLocked&&(n.onAny=!0,0===t.column?n.onFirst=!0:t.column+t.colspan>=e.grid.columns&&(n.onLast=!0)),n}),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Vc(e,n).isSome(),unmergeable:Uc(e,n).isSome(),locked:o}}))},l=function(){e.set(G(c)()),o=e.get().bind(a),P(r.get(),(function(n){return n()}))},f=function(n,t){var o=function(){return e.get().fold((function(){n.setDisabled(!0)}),(function(e){n.setDisabled(t(e))}))};return o(),r.set(r.get().concat([o])),function(){r.set(E(r.get(),(function(n){return n!==o})))}},s=function(n){return o.exists((function(t){return t.locked[n]}))};return n.on("NodeChange ExecCommand TableSelectorChange",l),{onSetupTable:function(n){return f(n,(function(n){return!1}))},onSetupCellOrRow:function(n){return f(n,(function(n){return u(n.element)}))},onSetupColumn:function(n){return function(t){return f(t,(function(t){return u(t.element)||s(n)}))}},onSetupPasteable:function(n){return function(t){return f(t,(function(t){return u(t.element)||n().isNone()}))}},onSetupPasteableColumn:function(n,t){return function(e){return f(e,(function(e){return u(e.element)||n().isNone()||s(t)}))}},onSetupMergeable:function(n){return f(n,(function(n){return i("mergeable")}))},onSetupUnmergeable:function(n){return f(n,(function(n){return i("unmergeable")}))},resetTargets:l,targets:function(){return e.get()}}}(n,e),o=yc(n),u=Ks(n,o.lazyResize,r),i=function(n,t,e){var r=function(n){return"table"===et(pu(n))},o=dc(n),u=sc(n)?f:Oc,i=function(t,e,r,u,i){return function(c,a){wu(c);var l=u(),f=Mn.fromDom(n.getDoc()),s=fu(r,f,o),d=mc(n,c),m=sc(n)?ju():Fu();return e(c)?t(l,c,a,s,d,m).bind((function(t){return P(t.newRows,(function(t){Hi(n,t.dom)})),P(t.newCells,(function(t){qi(n,t.dom)})),t.cursor.map((function(t){var e=Rc(Dc,t),r=n.dom.createRng();return r.setStart(e.element.dom,e.offset),r.setEnd(e.element.dom,e.offset),{rng:r,effect:i}}))})):S.none()}},c=i(Va,(function(t){return!1===r(n)||ri(t).rows>1}),f,t,Ki),a=i(qa,(function(t){return!1===r(n)||ri(t).columns>1}),f,t,Ki),l=i(_a,w,f,t,Ki),s=i(ja,w,f,t,Ki),d=i(Fa,w,u,t,Ki),m=i(Ha,w,u,t,Ki),p=i($a,w,f,t,Ki),g=i(Ga,w,f,t,Ki),v=i(Ya,w,f,t,Ki),h=i(Ja,w,f,t,Ki),b=i(Qa,w,f,t,Ki),y=i(Za,w,f,t,Ki),C=i(Xa,w,f,t,Ki),x=function(n,t){return Gn(n,"type").filter((function(n){return O(t,n)}))};return{deleteRow:c,deleteColumn:a,insertRowsBefore:l,insertRowsAfter:s,insertColumnsBefore:d,insertColumnsAfter:m,mergeCells:p,unmergeCells:g,pasteColsBefore:v,pasteColsAfter:h,pasteRowsBefore:b,pasteRowsAfter:y,pasteCells:C,setTableCellType:function(n,t){return x(t,["td","th"]).each((function(t){var r=B(sl(xu(n),e),(function(n){return n.dom}));il(n,r,t,null)}))},setTableRowType:function(n,t){return x(t,["header","body","footer"]).each((function(t){B(dl(xu(n),Du.selected),(function(e){return cl(n,e.dom,t)}))}))},makeColumnsHeader:i(Ua,w,f,t,Ki),unmakeColumnsHeader:i(Ka,w,f,t,Ki),getTableRowType:function(n){var t=dl(xu(n),Du.selected);if(t.length>0){var e=B(t,(function(n){return rl(0,n.dom)})),r=O(e,"header"),o=O(e,"footer");if(r||o){var u=O(e,"body");return!r||u||o?r||u||!o?"":"footer":"header"}return"body"}},getTableCellType:function(n){return Pa(sl(xu(n),e),(function(n){return"th"===et(n)})).getOr("")},getTableColType:nl}}(n,o.lazyWire,e),c=function(){var n=Vo(S.none()),t=Vo(S.none()),e=function(n){n.set(S.none())};return{getRows:n.get,setRows:function(r){n.set(r),e(t)},clearRows:function(){return e(n)},getColumns:t.get,setColumns:function(r){t.set(r),e(n)},clearColumns:function(){return e(t)}}}();return Ql(n,i,u,e,c),function(n,t,e){var r=hu(n);Hn({mceTableRowType:function(){return t.getTableRowType(n)},mceTableCellType:function(){return t.getTableCellType(n)},mceTableColType:function(){return ll(xu(n)).bind((function(n){return function(n){return ae(n,r)}(n).map((function(r){var o=Ou(e,r,n);return t.getTableColType(r,o)}))})).getOr("")}},(function(t,e){return n.addQueryValueHandler(e,t)}))}(n,i,e),Au(n,e,i,u),function(n,t,e){var r=function(t){return function(){return n.execCommand(t)}},o=function(t){n.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},u={text:"Table properties",onSetup:t.onSetupTable,onAction:r("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:r("mceTableDelete")};n.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:t.onSetupColumn("onFirst")}),n.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:t.onSetupColumn("onLast")}),n.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onFirst")}),n.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onLast")}),n.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:t.onSetupMergeable}),n.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:t.onSetupUnmergeable}),!1===function(n){return n.getParam("table_grid",!0,"boolean")}(n)?n.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):n.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),n.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),n.ui.registry.addMenuItem("tableprops",u),n.ui.registry.addMenuItem("deletetable",i),n.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),n.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),n.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),n.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold((function(){return""}),(function(n){return"caption"===et(n.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})}(n,r,c),function(n,t,e){n.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(n){return n("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(t){return function(){return n.execCommand(t)}};n.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),n.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),n.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),n.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),n.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(e.getRows)}),n.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),n.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onFirst")}),n.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(e.getColumns,"onLast")}),n.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})}(n,r,c),function(n){var t=function(n){return n.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(n);t.length>0&&n.ui.registry.addContextToolbar("table",{predicate:function(t){return n.dom.is(t,"table")&&n.getBody().contains(t)},items:t,scope:"node",position:"node"})}(n),n.on("PreInit",(function(){n.serializer.addTempAttr(Du.firstSelected),n.serializer.addTempAttr(Du.lastSelected),function(n){n.formatter.register(Zl)}(n)})),function(n){return n.getParam("table_tab_navigation",!0,"boolean")}(n)&&n.on("keydown",(function(t){!function(n,t,e){if(n.keyCode===Nf.TAB){var r=pu(t),o=function(n){var t=et(n);return Ln(n,r)||O(jf,t)},u=t.selection.getRng(),i=Mn.fromDom(n.shiftKey?u.startContainer:u.endContainer);ue(i,o).each((function(r){n.preventDefault(),ae(r,o).each(e.clear),t.selection.collapse(n.shiftKey),(n.shiftKey?Lf:Wf)(t,o,r).each((function(n){t.selection.setRng(n)}))}))}}(t,n,u)})),n.on("remove",(function(){o.destroy()})),function(n,t,e,r){return{insertTable:yl(n),setClipboardRows:wl(t.setRows),getClipboardRows:bl(t.getRows),setClipboardCols:wl(t.setColumns),getClipboardCols:bl(t.getColumns),resizeHandler:e,selectionTargets:r}}(n,c,o,r)}))}()}}]);
//# sourceMappingURL=619.e7b9d000.chunk.js.map