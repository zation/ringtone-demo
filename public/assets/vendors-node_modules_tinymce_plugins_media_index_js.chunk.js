(self["webpackChunkringtone"] = self["webpackChunkringtone"] || []).push([["vendors-node_modules_tinymce_plugins_media_index_js"],{

/***/ "./node_modules/tinymce/plugins/media/index.js":
/*!*****************************************************!*\
  !*** ./node_modules/tinymce/plugins/media/index.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

// Exports the "media" plugin for usage with module loaders
// Usage:
//   CommonJS:
//     require('tinymce/plugins/media')
//   ES2015:
//     import 'tinymce/plugins/media'
__webpack_require__(/*! ./plugin.js */ "./node_modules/tinymce/plugins/media/plugin.js");

/***/ }),

/***/ "./node_modules/tinymce/plugins/media/plugin.js":
/*!******************************************************!*\
  !*** ./node_modules/tinymce/plugins/media/plugin.js ***!
  \******************************************************/
/***/ (() => {

/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.8.1 (2021-05-20)
 */
(function () {
    'use strict';

    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');

    var __assign = function () {
      __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
          s = arguments[i];
          for (var p in s)
            if (Object.prototype.hasOwnProperty.call(s, p))
              t[p] = s[p];
        }
        return t;
      };
      return __assign.apply(this, arguments);
    };

    var typeOf = function (x) {
      var t = typeof x;
      if (x === null) {
        return 'null';
      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {
        return 'array';
      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {
        return 'string';
      } else {
        return t;
      }
    };
    var isType = function (type) {
      return function (value) {
        return typeOf(value) === type;
      };
    };
    var isString = isType('string');
    var isObject = isType('object');
    var isArray = isType('array');
    var isNullable = function (a) {
      return a === null || a === undefined;
    };
    var isNonNullable = function (a) {
      return !isNullable(a);
    };

    var noop = function () {
    };
    var constant = function (value) {
      return function () {
        return value;
      };
    };
    var never = constant(false);
    var always = constant(true);

    var none = function () {
      return NONE;
    };
    var NONE = function () {
      var eq = function (o) {
        return o.isNone();
      };
      var call = function (thunk) {
        return thunk();
      };
      var id = function (n) {
        return n;
      };
      var me = {
        fold: function (n, _s) {
          return n();
        },
        is: never,
        isSome: never,
        isNone: always,
        getOr: id,
        getOrThunk: call,
        getOrDie: function (msg) {
          throw new Error(msg || 'error: getOrDie called on none.');
        },
        getOrNull: constant(null),
        getOrUndefined: constant(undefined),
        or: id,
        orThunk: call,
        map: none,
        each: noop,
        bind: none,
        exists: never,
        forall: always,
        filter: none,
        equals: eq,
        equals_: eq,
        toArray: function () {
          return [];
        },
        toString: constant('none()')
      };
      return me;
    }();
    var some = function (a) {
      var constant_a = constant(a);
      var self = function () {
        return me;
      };
      var bind = function (f) {
        return f(a);
      };
      var me = {
        fold: function (n, s) {
          return s(a);
        },
        is: function (v) {
          return a === v;
        },
        isSome: always,
        isNone: never,
        getOr: constant_a,
        getOrThunk: constant_a,
        getOrDie: constant_a,
        getOrNull: constant_a,
        getOrUndefined: constant_a,
        or: self,
        orThunk: self,
        map: function (f) {
          return some(f(a));
        },
        each: function (f) {
          f(a);
        },
        bind: bind,
        exists: bind,
        forall: bind,
        filter: function (f) {
          return f(a) ? me : NONE;
        },
        toArray: function () {
          return [a];
        },
        toString: function () {
          return 'some(' + a + ')';
        },
        equals: function (o) {
          return o.is(a);
        },
        equals_: function (o, elementEq) {
          return o.fold(never, function (b) {
            return elementEq(a, b);
          });
        }
      };
      return me;
    };
    var from = function (value) {
      return value === null || value === undefined ? NONE : some(value);
    };
    var Optional = {
      some: some,
      none: none,
      from: from
    };

    var nativePush = Array.prototype.push;
    var each = function (xs, f) {
      for (var i = 0, len = xs.length; i < len; i++) {
        var x = xs[i];
        f(x, i);
      }
    };
    var flatten = function (xs) {
      var r = [];
      for (var i = 0, len = xs.length; i < len; ++i) {
        if (!isArray(xs[i])) {
          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);
        }
        nativePush.apply(r, xs[i]);
      }
      return r;
    };

    var Cell = function (initial) {
      var value = initial;
      var get = function () {
        return value;
      };
      var set = function (v) {
        value = v;
      };
      return {
        get: get,
        set: set
      };
    };

    var keys = Object.keys;
    var hasOwnProperty = Object.hasOwnProperty;
    var each$1 = function (obj, f) {
      var props = keys(obj);
      for (var k = 0, len = props.length; k < len; k++) {
        var i = props[k];
        var x = obj[i];
        f(x, i);
      }
    };
    var get = function (obj, key) {
      return has(obj, key) ? Optional.from(obj[key]) : Optional.none();
    };
    var has = function (obj, key) {
      return hasOwnProperty.call(obj, key);
    };

    var getScripts = function (editor) {
      return editor.getParam('media_scripts');
    };
    var getAudioTemplateCallback = function (editor) {
      return editor.getParam('audio_template_callback');
    };
    var getVideoTemplateCallback = function (editor) {
      return editor.getParam('video_template_callback');
    };
    var hasLiveEmbeds = function (editor) {
      return editor.getParam('media_live_embeds', true);
    };
    var shouldFilterHtml = function (editor) {
      return editor.getParam('media_filter_html', true);
    };
    var getUrlResolver = function (editor) {
      return editor.getParam('media_url_resolver');
    };
    var hasAltSource = function (editor) {
      return editor.getParam('media_alt_source', true);
    };
    var hasPoster = function (editor) {
      return editor.getParam('media_poster', true);
    };
    var hasDimensions = function (editor) {
      return editor.getParam('media_dimensions', true);
    };

    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');

    var global$2 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');

    var global$3 = tinymce.util.Tools.resolve('tinymce.html.SaxParser');

    var getVideoScriptMatch = function (prefixes, src) {
      if (prefixes) {
        for (var i = 0; i < prefixes.length; i++) {
          if (src.indexOf(prefixes[i].filter) !== -1) {
            return prefixes[i];
          }
        }
      }
    };

    var DOM = global$2.DOM;
    var trimPx = function (value) {
      return value.replace(/px$/, '');
    };
    var getEphoxEmbedData = function (attrs) {
      var style = attrs.map.style;
      var styles = style ? DOM.parseStyle(style) : {};
      return {
        type: 'ephox-embed-iri',
        source: attrs.map['data-ephox-embed-iri'],
        altsource: '',
        poster: '',
        width: get(styles, 'max-width').map(trimPx).getOr(''),
        height: get(styles, 'max-height').map(trimPx).getOr('')
      };
    };
    var htmlToData = function (prefixes, html) {
      var isEphoxEmbed = Cell(false);
      var data = {};
      global$3({
        validate: false,
        allow_conditional_comments: true,
        start: function (name, attrs) {
          if (isEphoxEmbed.get()) ; else if (has(attrs.map, 'data-ephox-embed-iri')) {
            isEphoxEmbed.set(true);
            data = getEphoxEmbedData(attrs);
          } else {
            if (!data.source && name === 'param') {
              data.source = attrs.map.movie;
            }
            if (name === 'iframe' || name === 'object' || name === 'embed' || name === 'video' || name === 'audio') {
              if (!data.type) {
                data.type = name;
              }
              data = global$1.extend(attrs.map, data);
            }
            if (name === 'script') {
              var videoScript = getVideoScriptMatch(prefixes, attrs.map.src);
              if (!videoScript) {
                return;
              }
              data = {
                type: 'script',
                source: attrs.map.src,
                width: String(videoScript.width),
                height: String(videoScript.height)
              };
            }
            if (name === 'source') {
              if (!data.source) {
                data.source = attrs.map.src;
              } else if (!data.altsource) {
                data.altsource = attrs.map.src;
              }
            }
            if (name === 'img' && !data.poster) {
              data.poster = attrs.map.src;
            }
          }
        }
      }).parse(html);
      data.source = data.source || data.src || data.data;
      data.altsource = data.altsource || '';
      data.poster = data.poster || '';
      return data;
    };

    var guess = function (url) {
      var mimes = {
        mp3: 'audio/mpeg',
        m4a: 'audio/x-m4a',
        wav: 'audio/wav',
        mp4: 'video/mp4',
        webm: 'video/webm',
        ogg: 'video/ogg',
        swf: 'application/x-shockwave-flash'
      };
      var fileEnd = url.toLowerCase().split('.').pop();
      var mime = mimes[fileEnd];
      return mime ? mime : '';
    };

    var global$4 = tinymce.util.Tools.resolve('tinymce.html.Schema');

    var global$5 = tinymce.util.Tools.resolve('tinymce.html.Writer');

    var DOM$1 = global$2.DOM;
    var addPx = function (value) {
      return /^[0-9.]+$/.test(value) ? value + 'px' : value;
    };
    var setAttributes = function (attrs, updatedAttrs) {
      each$1(updatedAttrs, function (val, name) {
        var value = '' + val;
        if (attrs.map[name]) {
          var i = attrs.length;
          while (i--) {
            var attr = attrs[i];
            if (attr.name === name) {
              if (value) {
                attrs.map[name] = value;
                attr.value = value;
              } else {
                delete attrs.map[name];
                attrs.splice(i, 1);
              }
            }
          }
        } else if (value) {
          attrs.push({
            name: name,
            value: value
          });
          attrs.map[name] = value;
        }
      });
    };
    var updateEphoxEmbed = function (data, attrs) {
      var style = attrs.map.style;
      var styleMap = style ? DOM$1.parseStyle(style) : {};
      styleMap['max-width'] = addPx(data.width);
      styleMap['max-height'] = addPx(data.height);
      setAttributes(attrs, { style: DOM$1.serializeStyle(styleMap) });
    };
    var sources = [
      'source',
      'altsource'
    ];
    var updateHtml = function (html, data, updateAll) {
      var writer = global$5();
      var isEphoxEmbed = Cell(false);
      var sourceCount = 0;
      var hasImage;
      global$3({
        validate: false,
        allow_conditional_comments: true,
        comment: function (text) {
          writer.comment(text);
        },
        cdata: function (text) {
          writer.cdata(text);
        },
        text: function (text, raw) {
          writer.text(text, raw);
        },
        start: function (name, attrs, empty) {
          if (isEphoxEmbed.get()) ; else if (has(attrs.map, 'data-ephox-embed-iri')) {
            isEphoxEmbed.set(true);
            updateEphoxEmbed(data, attrs);
          } else {
            switch (name) {
            case 'video':
            case 'object':
            case 'embed':
            case 'img':
            case 'iframe':
              if (data.height !== undefined && data.width !== undefined) {
                setAttributes(attrs, {
                  width: data.width,
                  height: data.height
                });
              }
              break;
            }
            if (updateAll) {
              switch (name) {
              case 'video':
                setAttributes(attrs, {
                  poster: data.poster,
                  src: ''
                });
                if (data.altsource) {
                  setAttributes(attrs, { src: '' });
                }
                break;
              case 'iframe':
                setAttributes(attrs, { src: data.source });
                break;
              case 'source':
                if (sourceCount < 2) {
                  setAttributes(attrs, {
                    src: data[sources[sourceCount]],
                    type: data[sources[sourceCount] + 'mime']
                  });
                  if (!data[sources[sourceCount]]) {
                    return;
                  }
                }
                sourceCount++;
                break;
              case 'img':
                if (!data.poster) {
                  return;
                }
                hasImage = true;
                break;
              }
            }
          }
          writer.start(name, attrs, empty);
        },
        end: function (name) {
          if (!isEphoxEmbed.get()) {
            if (name === 'video' && updateAll) {
              for (var index = 0; index < 2; index++) {
                if (data[sources[index]]) {
                  var attrs = [];
                  attrs.map = {};
                  if (sourceCount <= index) {
                    setAttributes(attrs, {
                      src: data[sources[index]],
                      type: data[sources[index] + 'mime']
                    });
                    writer.start('source', attrs, true);
                  }
                }
              }
            }
            if (data.poster && name === 'object' && updateAll && !hasImage) {
              var imgAttrs = [];
              imgAttrs.map = {};
              setAttributes(imgAttrs, {
                src: data.poster,
                width: data.width,
                height: data.height
              });
              writer.start('img', imgAttrs, true);
            }
          }
          writer.end(name);
        }
      }, global$4({})).parse(html);
      return writer.getContent();
    };

    var urlPatterns = [
      {
        regex: /youtu\.be\/([\w\-_\?&=.]+)/i,
        type: 'iframe',
        w: 560,
        h: 314,
        url: 'www.youtube.com/embed/$1',
        allowFullscreen: true
      },
      {
        regex: /youtube\.com(.+)v=([^&]+)(&([a-z0-9&=\-_]+))?/i,
        type: 'iframe',
        w: 560,
        h: 314,
        url: 'www.youtube.com/embed/$2?$4',
        allowFullscreen: true
      },
      {
        regex: /youtube.com\/embed\/([a-z0-9\?&=\-_]+)/i,
        type: 'iframe',
        w: 560,
        h: 314,
        url: 'www.youtube.com/embed/$1',
        allowFullscreen: true
      },
      {
        regex: /vimeo\.com\/([0-9]+)/,
        type: 'iframe',
        w: 425,
        h: 350,
        url: 'player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc',
        allowFullscreen: true
      },
      {
        regex: /vimeo\.com\/(.*)\/([0-9]+)/,
        type: 'iframe',
        w: 425,
        h: 350,
        url: 'player.vimeo.com/video/$2?title=0&amp;byline=0',
        allowFullscreen: true
      },
      {
        regex: /maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/,
        type: 'iframe',
        w: 425,
        h: 350,
        url: 'maps.google.com/maps/ms?msid=$2&output=embed"',
        allowFullscreen: false
      },
      {
        regex: /dailymotion\.com\/video\/([^_]+)/,
        type: 'iframe',
        w: 480,
        h: 270,
        url: 'www.dailymotion.com/embed/video/$1',
        allowFullscreen: true
      },
      {
        regex: /dai\.ly\/([^_]+)/,
        type: 'iframe',
        w: 480,
        h: 270,
        url: 'www.dailymotion.com/embed/video/$1',
        allowFullscreen: true
      }
    ];
    var getProtocol = function (url) {
      var protocolMatches = url.match(/^(https?:\/\/|www\.)(.+)$/i);
      if (protocolMatches && protocolMatches.length > 1) {
        return protocolMatches[1] === 'www.' ? 'https://' : protocolMatches[1];
      } else {
        return 'https://';
      }
    };
    var getUrl = function (pattern, url) {
      var protocol = getProtocol(url);
      var match = pattern.regex.exec(url);
      var newUrl = protocol + pattern.url;
      var _loop_1 = function (i) {
        newUrl = newUrl.replace('$' + i, function () {
          return match[i] ? match[i] : '';
        });
      };
      for (var i = 0; i < match.length; i++) {
        _loop_1(i);
      }
      return newUrl.replace(/\?$/, '');
    };
    var matchPattern = function (url) {
      var patterns = urlPatterns.filter(function (pattern) {
        return pattern.regex.test(url);
      });
      if (patterns.length > 0) {
        return global$1.extend({}, patterns[0], { url: getUrl(patterns[0], url) });
      } else {
        return null;
      }
    };

    var getIframeHtml = function (data) {
      var allowFullscreen = data.allowfullscreen ? ' allowFullscreen="1"' : '';
      return '<iframe src="' + data.source + '" width="' + data.width + '" height="' + data.height + '"' + allowFullscreen + '></iframe>';
    };
    var getFlashHtml = function (data) {
      var html = '<object data="' + data.source + '" width="' + data.width + '" height="' + data.height + '" type="application/x-shockwave-flash">';
      if (data.poster) {
        html += '<img src="' + data.poster + '" width="' + data.width + '" height="' + data.height + '" />';
      }
      html += '</object>';
      return html;
    };
    var getAudioHtml = function (data, audioTemplateCallback) {
      if (audioTemplateCallback) {
        return audioTemplateCallback(data);
      } else {
        return '<audio controls="controls" src="' + data.source + '">' + (data.altsource ? '\n<source src="' + data.altsource + '"' + (data.altsourcemime ? ' type="' + data.altsourcemime + '"' : '') + ' />\n' : '') + '</audio>';
      }
    };
    var getVideoHtml = function (data, videoTemplateCallback) {
      if (videoTemplateCallback) {
        return videoTemplateCallback(data);
      } else {
        return '<video width="' + data.width + '" height="' + data.height + '"' + (data.poster ? ' poster="' + data.poster + '"' : '') + ' controls="controls">\n' + '<source src="' + data.source + '"' + (data.sourcemime ? ' type="' + data.sourcemime + '"' : '') + ' />\n' + (data.altsource ? '<source src="' + data.altsource + '"' + (data.altsourcemime ? ' type="' + data.altsourcemime + '"' : '') + ' />\n' : '') + '</video>';
      }
    };
    var getScriptHtml = function (data) {
      return '<script src="' + data.source + '"></script>';
    };
    var dataToHtml = function (editor, dataIn) {
      var data = global$1.extend({}, dataIn);
      if (!data.source) {
        global$1.extend(data, htmlToData(getScripts(editor), data.embed));
        if (!data.source) {
          return '';
        }
      }
      if (!data.altsource) {
        data.altsource = '';
      }
      if (!data.poster) {
        data.poster = '';
      }
      data.source = editor.convertURL(data.source, 'source');
      data.altsource = editor.convertURL(data.altsource, 'source');
      data.sourcemime = guess(data.source);
      data.altsourcemime = guess(data.altsource);
      data.poster = editor.convertURL(data.poster, 'poster');
      var pattern = matchPattern(data.source);
      if (pattern) {
        data.source = pattern.url;
        data.type = pattern.type;
        data.allowfullscreen = pattern.allowFullscreen;
        data.width = data.width || String(pattern.w);
        data.height = data.height || String(pattern.h);
      }
      if (data.embed) {
        return updateHtml(data.embed, data, true);
      } else {
        var videoScript = getVideoScriptMatch(getScripts(editor), data.source);
        if (videoScript) {
          data.type = 'script';
          data.width = String(videoScript.width);
          data.height = String(videoScript.height);
        }
        var audioTemplateCallback = getAudioTemplateCallback(editor);
        var videoTemplateCallback = getVideoTemplateCallback(editor);
        data.width = data.width || '300';
        data.height = data.height || '150';
        global$1.each(data, function (value, key) {
          data[key] = editor.dom.encode('' + value);
        });
        if (data.type === 'iframe') {
          return getIframeHtml(data);
        } else if (data.sourcemime === 'application/x-shockwave-flash') {
          return getFlashHtml(data);
        } else if (data.sourcemime.indexOf('audio') !== -1) {
          return getAudioHtml(data, audioTemplateCallback);
        } else if (data.type === 'script') {
          return getScriptHtml(data);
        } else {
          return getVideoHtml(data, videoTemplateCallback);
        }
      }
    };

    var global$6 = tinymce.util.Tools.resolve('tinymce.util.Promise');

    var cache = {};
    var embedPromise = function (data, dataToHtml, handler) {
      return new global$6(function (res, rej) {
        var wrappedResolve = function (response) {
          if (response.html) {
            cache[data.source] = response;
          }
          return res({
            url: data.source,
            html: response.html ? response.html : dataToHtml(data)
          });
        };
        if (cache[data.source]) {
          wrappedResolve(cache[data.source]);
        } else {
          handler({ url: data.source }, wrappedResolve, rej);
        }
      });
    };
    var defaultPromise = function (data, dataToHtml) {
      return new global$6(function (res) {
        res({
          html: dataToHtml(data),
          url: data.source
        });
      });
    };
    var loadedData = function (editor) {
      return function (data) {
        return dataToHtml(editor, data);
      };
    };
    var getEmbedHtml = function (editor, data) {
      var embedHandler = getUrlResolver(editor);
      return embedHandler ? embedPromise(data, loadedData(editor), embedHandler) : defaultPromise(data, loadedData(editor));
    };
    var isCached = function (url) {
      return cache.hasOwnProperty(url);
    };

    var extractMeta = function (sourceInput, data) {
      return get(data, sourceInput).bind(function (mainData) {
        return get(mainData, 'meta');
      });
    };
    var getValue = function (data, metaData, sourceInput) {
      return function (prop) {
        var _a;
        var getFromData = function () {
          return get(data, prop);
        };
        var getFromMetaData = function () {
          return get(metaData, prop);
        };
        var getNonEmptyValue = function (c) {
          return get(c, 'value').bind(function (v) {
            return v.length > 0 ? Optional.some(v) : Optional.none();
          });
        };
        var getFromValueFirst = function () {
          return getFromData().bind(function (child) {
            return isObject(child) ? getNonEmptyValue(child).orThunk(getFromMetaData) : getFromMetaData().orThunk(function () {
              return Optional.from(child);
            });
          });
        };
        var getFromMetaFirst = function () {
          return getFromMetaData().orThunk(function () {
            return getFromData().bind(function (child) {
              return isObject(child) ? getNonEmptyValue(child) : Optional.from(child);
            });
          });
        };
        return _a = {}, _a[prop] = (prop === sourceInput ? getFromValueFirst() : getFromMetaFirst()).getOr(''), _a;
      };
    };
    var getDimensions = function (data, metaData) {
      var dimensions = {};
      get(data, 'dimensions').each(function (dims) {
        each([
          'width',
          'height'
        ], function (prop) {
          get(metaData, prop).orThunk(function () {
            return get(dims, prop);
          }).each(function (value) {
            return dimensions[prop] = value;
          });
        });
      });
      return dimensions;
    };
    var unwrap = function (data, sourceInput) {
      var metaData = sourceInput ? extractMeta(sourceInput, data).getOr({}) : {};
      var get = getValue(data, metaData, sourceInput);
      return __assign(__assign(__assign(__assign(__assign({}, get('source')), get('altsource')), get('poster')), get('embed')), getDimensions(data, metaData));
    };
    var wrap = function (data) {
      var wrapped = __assign(__assign({}, data), {
        source: { value: get(data, 'source').getOr('') },
        altsource: { value: get(data, 'altsource').getOr('') },
        poster: { value: get(data, 'poster').getOr('') }
      });
      each([
        'width',
        'height'
      ], function (prop) {
        get(data, prop).each(function (value) {
          var dimensions = wrapped.dimensions || {};
          dimensions[prop] = value;
          wrapped.dimensions = dimensions;
        });
      });
      return wrapped;
    };
    var handleError = function (editor) {
      return function (error) {
        var errorMessage = error && error.msg ? 'Media embed handler error: ' + error.msg : 'Media embed handler threw unknown error.';
        editor.notificationManager.open({
          type: 'error',
          text: errorMessage
        });
      };
    };
    var snippetToData = function (editor, embedSnippet) {
      return htmlToData(getScripts(editor), embedSnippet);
    };
    var isMediaElement = function (element) {
      return element.getAttribute('data-mce-object') || element.getAttribute('data-ephox-embed-iri');
    };
    var getEditorData = function (editor) {
      var element = editor.selection.getNode();
      var snippet = isMediaElement(element) ? editor.serializer.serialize(element, { selection: true }) : '';
      return __assign({ embed: snippet }, htmlToData(getScripts(editor), snippet));
    };
    var addEmbedHtml = function (api, editor) {
      return function (response) {
        if (isString(response.url) && response.url.trim().length > 0) {
          var html = response.html;
          var snippetData = snippetToData(editor, html);
          var nuData = __assign(__assign({}, snippetData), {
            source: response.url,
            embed: html
          });
          api.setData(wrap(nuData));
        }
      };
    };
    var selectPlaceholder = function (editor, beforeObjects) {
      var afterObjects = editor.dom.select('*[data-mce-object]');
      for (var i = 0; i < beforeObjects.length; i++) {
        for (var y = afterObjects.length - 1; y >= 0; y--) {
          if (beforeObjects[i] === afterObjects[y]) {
            afterObjects.splice(y, 1);
          }
        }
      }
      editor.selection.select(afterObjects[0]);
    };
    var handleInsert = function (editor, html) {
      var beforeObjects = editor.dom.select('*[data-mce-object]');
      editor.insertContent(html);
      selectPlaceholder(editor, beforeObjects);
      editor.nodeChanged();
    };
    var submitForm = function (prevData, newData, editor) {
      newData.embed = updateHtml(newData.embed, newData);
      if (newData.embed && (prevData.source === newData.source || isCached(newData.source))) {
        handleInsert(editor, newData.embed);
      } else {
        getEmbedHtml(editor, newData).then(function (response) {
          handleInsert(editor, response.html);
        }).catch(handleError(editor));
      }
    };
    var showDialog = function (editor) {
      var editorData = getEditorData(editor);
      var currentData = Cell(editorData);
      var initialData = wrap(editorData);
      var handleSource = function (prevData, api) {
        var serviceData = unwrap(api.getData(), 'source');
        if (prevData.source !== serviceData.source) {
          addEmbedHtml(win, editor)({
            url: serviceData.source,
            html: ''
          });
          getEmbedHtml(editor, serviceData).then(addEmbedHtml(win, editor)).catch(handleError(editor));
        }
      };
      var handleEmbed = function (api) {
        var data = unwrap(api.getData());
        var dataFromEmbed = snippetToData(editor, data.embed);
        api.setData(wrap(dataFromEmbed));
      };
      var handleUpdate = function (api, sourceInput) {
        var data = unwrap(api.getData(), sourceInput);
        var embed = dataToHtml(editor, data);
        api.setData(wrap(__assign(__assign({}, data), { embed: embed })));
      };
      var mediaInput = [{
          name: 'source',
          type: 'urlinput',
          filetype: 'media',
          label: 'Source'
        }];
      var sizeInput = !hasDimensions(editor) ? [] : [{
          type: 'sizeinput',
          name: 'dimensions',
          label: 'Constrain proportions',
          constrain: true
        }];
      var generalTab = {
        title: 'General',
        name: 'general',
        items: flatten([
          mediaInput,
          sizeInput
        ])
      };
      var embedTextarea = {
        type: 'textarea',
        name: 'embed',
        label: 'Paste your embed code below:'
      };
      var embedTab = {
        title: 'Embed',
        items: [embedTextarea]
      };
      var advancedFormItems = [];
      if (hasAltSource(editor)) {
        advancedFormItems.push({
          name: 'altsource',
          type: 'urlinput',
          filetype: 'media',
          label: 'Alternative source URL'
        });
      }
      if (hasPoster(editor)) {
        advancedFormItems.push({
          name: 'poster',
          type: 'urlinput',
          filetype: 'image',
          label: 'Media poster (Image URL)'
        });
      }
      var advancedTab = {
        title: 'Advanced',
        name: 'advanced',
        items: advancedFormItems
      };
      var tabs = [
        generalTab,
        embedTab
      ];
      if (advancedFormItems.length > 0) {
        tabs.push(advancedTab);
      }
      var body = {
        type: 'tabpanel',
        tabs: tabs
      };
      var win = editor.windowManager.open({
        title: 'Insert/Edit Media',
        size: 'normal',
        body: body,
        buttons: [
          {
            type: 'cancel',
            name: 'cancel',
            text: 'Cancel'
          },
          {
            type: 'submit',
            name: 'save',
            text: 'Save',
            primary: true
          }
        ],
        onSubmit: function (api) {
          var serviceData = unwrap(api.getData());
          submitForm(currentData.get(), serviceData, editor);
          api.close();
        },
        onChange: function (api, detail) {
          switch (detail.name) {
          case 'source':
            handleSource(currentData.get(), api);
            break;
          case 'embed':
            handleEmbed(api);
            break;
          case 'dimensions':
          case 'altsource':
          case 'poster':
            handleUpdate(api, detail.name);
            break;
          }
          currentData.set(unwrap(api.getData()));
        },
        initialData: initialData
      });
    };

    var get$1 = function (editor) {
      var showDialog$1 = function () {
        showDialog(editor);
      };
      return { showDialog: showDialog$1 };
    };

    var register = function (editor) {
      var showDialog$1 = function () {
        showDialog(editor);
      };
      editor.addCommand('mceMedia', showDialog$1);
    };

    var global$7 = tinymce.util.Tools.resolve('tinymce.html.Node');

    var global$8 = tinymce.util.Tools.resolve('tinymce.Env');

    var global$9 = tinymce.util.Tools.resolve('tinymce.html.DomParser');

    var sanitize = function (editor, html) {
      if (shouldFilterHtml(editor) === false) {
        return html;
      }
      var writer = global$5();
      var blocked;
      global$3({
        validate: false,
        allow_conditional_comments: false,
        comment: function (text) {
          if (!blocked) {
            writer.comment(text);
          }
        },
        cdata: function (text) {
          if (!blocked) {
            writer.cdata(text);
          }
        },
        text: function (text, raw) {
          if (!blocked) {
            writer.text(text, raw);
          }
        },
        start: function (name, attrs, empty) {
          blocked = true;
          if (name === 'script' || name === 'noscript' || name === 'svg') {
            return;
          }
          for (var i = attrs.length - 1; i >= 0; i--) {
            var attrName = attrs[i].name;
            if (attrName.indexOf('on') === 0) {
              delete attrs.map[attrName];
              attrs.splice(i, 1);
            }
            if (attrName === 'style') {
              attrs[i].value = editor.dom.serializeStyle(editor.dom.parseStyle(attrs[i].value), name);
            }
          }
          writer.start(name, attrs, empty);
          blocked = false;
        },
        end: function (name) {
          if (blocked) {
            return;
          }
          writer.end(name);
        }
      }, global$4({})).parse(html);
      return writer.getContent();
    };

    var isLiveEmbedNode = function (node) {
      var name = node.name;
      return name === 'iframe' || name === 'video' || name === 'audio';
    };
    var getDimension = function (node, styles, dimension, defaultValue) {
      if (defaultValue === void 0) {
        defaultValue = null;
      }
      var value = node.attr(dimension);
      if (isNonNullable(value)) {
        return value;
      } else if (!has(styles, dimension)) {
        return defaultValue;
      } else {
        return null;
      }
    };
    var setDimensions = function (node, previewNode, styles) {
      var useDefaults = previewNode.name === 'img' || node.name === 'video';
      var defaultWidth = useDefaults ? '300' : null;
      var fallbackHeight = node.name === 'audio' ? '30' : '150';
      var defaultHeight = useDefaults ? fallbackHeight : null;
      previewNode.attr({
        width: getDimension(node, styles, 'width', defaultWidth),
        height: getDimension(node, styles, 'height', defaultHeight)
      });
    };
    var appendNodeContent = function (editor, nodeName, previewNode, html) {
      var newNode = global$9({
        forced_root_block: false,
        validate: false
      }, editor.schema).parse(html, { context: nodeName });
      while (newNode.firstChild) {
        previewNode.append(newNode.firstChild);
      }
    };
    var createPlaceholderNode = function (editor, node) {
      var name = node.name;
      var placeHolder = new global$7('img', 1);
      placeHolder.shortEnded = true;
      retainAttributesAndInnerHtml(editor, node, placeHolder);
      setDimensions(node, placeHolder, {});
      placeHolder.attr({
        'style': node.attr('style'),
        'src': global$8.transparentSrc,
        'data-mce-object': name,
        'class': 'mce-object mce-object-' + name
      });
      return placeHolder;
    };
    var createPreviewNode = function (editor, node) {
      var name = node.name;
      var previewWrapper = new global$7('span', 1);
      previewWrapper.attr({
        'contentEditable': 'false',
        'style': node.attr('style'),
        'data-mce-object': name,
        'class': 'mce-preview-object mce-object-' + name
      });
      retainAttributesAndInnerHtml(editor, node, previewWrapper);
      var styles = editor.dom.parseStyle(node.attr('style'));
      var previewNode = new global$7(name, 1);
      setDimensions(node, previewNode, styles);
      previewNode.attr({
        src: node.attr('src'),
        style: node.attr('style'),
        class: node.attr('class')
      });
      if (name === 'iframe') {
        previewNode.attr({
          allowfullscreen: node.attr('allowfullscreen'),
          frameborder: '0'
        });
      } else {
        var attrs = [
          'controls',
          'crossorigin',
          'currentTime',
          'loop',
          'muted',
          'poster',
          'preload'
        ];
        each(attrs, function (attrName) {
          previewNode.attr(attrName, node.attr(attrName));
        });
        var sanitizedHtml = previewWrapper.attr('data-mce-html');
        if (isNonNullable(sanitizedHtml)) {
          appendNodeContent(editor, name, previewNode, sanitizedHtml);
        }
      }
      var shimNode = new global$7('span', 1);
      shimNode.attr('class', 'mce-shim');
      previewWrapper.append(previewNode);
      previewWrapper.append(shimNode);
      return previewWrapper;
    };
    var retainAttributesAndInnerHtml = function (editor, sourceNode, targetNode) {
      var attribs = sourceNode.attributes;
      var ai = attribs.length;
      while (ai--) {
        var attrName = attribs[ai].name;
        var attrValue = attribs[ai].value;
        if (attrName !== 'width' && attrName !== 'height' && attrName !== 'style') {
          if (attrName === 'data' || attrName === 'src') {
            attrValue = editor.convertURL(attrValue, attrName);
          }
          targetNode.attr('data-mce-p-' + attrName, attrValue);
        }
      }
      var innerHtml = sourceNode.firstChild && sourceNode.firstChild.value;
      if (innerHtml) {
        targetNode.attr('data-mce-html', escape(sanitize(editor, innerHtml)));
        targetNode.firstChild = null;
      }
    };
    var isPageEmbedWrapper = function (node) {
      var nodeClass = node.attr('class');
      return nodeClass && /\btiny-pageembed\b/.test(nodeClass);
    };
    var isWithinEmbedWrapper = function (node) {
      while (node = node.parent) {
        if (node.attr('data-ephox-embed-iri') || isPageEmbedWrapper(node)) {
          return true;
        }
      }
      return false;
    };
    var placeHolderConverter = function (editor) {
      return function (nodes) {
        var i = nodes.length;
        var node;
        var videoScript;
        while (i--) {
          node = nodes[i];
          if (!node.parent) {
            continue;
          }
          if (node.parent.attr('data-mce-object')) {
            continue;
          }
          if (node.name === 'script') {
            videoScript = getVideoScriptMatch(getScripts(editor), node.attr('src'));
            if (!videoScript) {
              continue;
            }
          }
          if (videoScript) {
            if (videoScript.width) {
              node.attr('width', videoScript.width.toString());
            }
            if (videoScript.height) {
              node.attr('height', videoScript.height.toString());
            }
          }
          if (isLiveEmbedNode(node) && hasLiveEmbeds(editor) && global$8.ceFalse) {
            if (!isWithinEmbedWrapper(node)) {
              node.replace(createPreviewNode(editor, node));
            }
          } else {
            if (!isWithinEmbedWrapper(node)) {
              node.replace(createPlaceholderNode(editor, node));
            }
          }
        }
      };
    };

    var setup = function (editor) {
      editor.on('preInit', function () {
        var specialElements = editor.schema.getSpecialElements();
        global$1.each('video audio iframe object'.split(' '), function (name) {
          specialElements[name] = new RegExp('</' + name + '[^>]*>', 'gi');
        });
        var boolAttrs = editor.schema.getBoolAttrs();
        global$1.each('webkitallowfullscreen mozallowfullscreen allowfullscreen'.split(' '), function (name) {
          boolAttrs[name] = {};
        });
        editor.parser.addNodeFilter('iframe,video,audio,object,embed,script', placeHolderConverter(editor));
        editor.serializer.addAttributeFilter('data-mce-object', function (nodes, name) {
          var i = nodes.length;
          var node;
          var realElm;
          var ai;
          var attribs;
          var innerHtml;
          var innerNode;
          var realElmName;
          var className;
          while (i--) {
            node = nodes[i];
            if (!node.parent) {
              continue;
            }
            realElmName = node.attr(name);
            realElm = new global$7(realElmName, 1);
            if (realElmName !== 'audio' && realElmName !== 'script') {
              className = node.attr('class');
              if (className && className.indexOf('mce-preview-object') !== -1) {
                realElm.attr({
                  width: node.firstChild.attr('width'),
                  height: node.firstChild.attr('height')
                });
              } else {
                realElm.attr({
                  width: node.attr('width'),
                  height: node.attr('height')
                });
              }
            }
            realElm.attr({ style: node.attr('style') });
            attribs = node.attributes;
            ai = attribs.length;
            while (ai--) {
              var attrName = attribs[ai].name;
              if (attrName.indexOf('data-mce-p-') === 0) {
                realElm.attr(attrName.substr(11), attribs[ai].value);
              }
            }
            if (realElmName === 'script') {
              realElm.attr('type', 'text/javascript');
            }
            innerHtml = node.attr('data-mce-html');
            if (innerHtml) {
              innerNode = new global$7('#text', 3);
              innerNode.raw = true;
              innerNode.value = sanitize(editor, unescape(innerHtml));
              realElm.append(innerNode);
            }
            node.replace(realElm);
          }
        });
      });
      editor.on('SetContent', function () {
        editor.$('span.mce-preview-object').each(function (index, elm) {
          var $elm = editor.$(elm);
          if ($elm.find('span.mce-shim').length === 0) {
            $elm.append('<span class="mce-shim"></span>');
          }
        });
      });
    };

    var setup$1 = function (editor) {
      editor.on('ResolveName', function (e) {
        var name;
        if (e.target.nodeType === 1 && (name = e.target.getAttribute('data-mce-object'))) {
          e.name = name;
        }
      });
    };

    var setup$2 = function (editor) {
      editor.on('click keyup touchend', function () {
        var selectedNode = editor.selection.getNode();
        if (selectedNode && editor.dom.hasClass(selectedNode, 'mce-preview-object')) {
          if (editor.dom.getAttrib(selectedNode, 'data-mce-selected')) {
            selectedNode.setAttribute('data-mce-selected', '2');
          }
        }
      });
      editor.on('ObjectSelected', function (e) {
        var objectType = e.target.getAttribute('data-mce-object');
        if (objectType === 'script') {
          e.preventDefault();
        }
      });
      editor.on('ObjectResized', function (e) {
        var target = e.target;
        var html;
        if (target.getAttribute('data-mce-object')) {
          html = target.getAttribute('data-mce-html');
          if (html) {
            html = unescape(html);
            target.setAttribute('data-mce-html', escape(updateHtml(html, {
              width: String(e.width),
              height: String(e.height)
            })));
          }
        }
      });
    };

    var stateSelectorAdapter = function (editor, selector) {
      return function (buttonApi) {
        return editor.selection.selectorChangedWithUnbind(selector.join(','), buttonApi.setActive).unbind;
      };
    };
    var register$1 = function (editor) {
      editor.ui.registry.addToggleButton('media', {
        tooltip: 'Insert/edit media',
        icon: 'embed',
        onAction: function () {
          editor.execCommand('mceMedia');
        },
        onSetup: stateSelectorAdapter(editor, [
          'img[data-mce-object]',
          'span[data-mce-object]',
          'div[data-ephox-embed-iri]'
        ])
      });
      editor.ui.registry.addMenuItem('media', {
        icon: 'embed',
        text: 'Media...',
        onAction: function () {
          editor.execCommand('mceMedia');
        }
      });
    };

    function Plugin () {
      global.add('media', function (editor) {
        register(editor);
        register$1(editor);
        setup$1(editor);
        setup(editor);
        setup$2(editor);
        return get$1(editor);
      });
    }

    Plugin();

}());


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfdGlueW1jZV9wbHVnaW5zX21lZGlhX2luZGV4X2pzLmNodW5rLmpzIiwic291cmNlcyI6WyIvVXNlcnMvbGl1eWFuZy9wcm9qZWN0cy9yaW5ndG9uZV9uZXcvbm9kZV9tb2R1bGVzL3RpbnltY2UvcGx1Z2lucy9tZWRpYS9pbmRleC5qcyIsIi9Vc2Vycy9saXV5YW5nL3Byb2plY3RzL3Jpbmd0b25lX25ldy9ub2RlX21vZHVsZXMvdGlueW1jZS9wbHVnaW5zL21lZGlhL3BsdWdpbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBFeHBvcnRzIHRoZSBcIm1lZGlhXCIgcGx1Z2luIGZvciB1c2FnZSB3aXRoIG1vZHVsZSBsb2FkZXJzXG4vLyBVc2FnZTpcbi8vICAgQ29tbW9uSlM6XG4vLyAgICAgcmVxdWlyZSgndGlueW1jZS9wbHVnaW5zL21lZGlhJylcbi8vICAgRVMyMDE1OlxuLy8gICAgIGltcG9ydCAndGlueW1jZS9wbHVnaW5zL21lZGlhJ1xucmVxdWlyZSgnLi9wbHVnaW4uanMnKTsiLCIvKipcbiAqIENvcHlyaWdodCAoYykgVGlueSBUZWNobm9sb2dpZXMsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBMR1BMIG9yIGEgY29tbWVyY2lhbCBsaWNlbnNlLlxuICogRm9yIExHUEwgc2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKiBGb3IgY29tbWVyY2lhbCBsaWNlbnNlcyBzZWUgaHR0cHM6Ly93d3cudGlueS5jbG91ZC9cbiAqXG4gKiBWZXJzaW9uOiA1LjguMSAoMjAyMS0wNS0yMClcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgZ2xvYmFsID0gdGlueW1jZS51dGlsLlRvb2xzLnJlc29sdmUoJ3RpbnltY2UuUGx1Z2luTWFuYWdlcicpO1xuXG4gICAgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24gKCkge1xuICAgICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICBmb3IgKHZhciBwIGluIHMpXG4gICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKVxuICAgICAgICAgICAgICB0W3BdID0gc1twXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuXG4gICAgdmFyIHR5cGVPZiA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB2YXIgdCA9IHR5cGVvZiB4O1xuICAgICAgaWYgKHggPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuICdudWxsJztcbiAgICAgIH0gZWxzZSBpZiAodCA9PT0gJ29iamVjdCcgJiYgKEFycmF5LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKHgpIHx8IHguY29uc3RydWN0b3IgJiYgeC5jb25zdHJ1Y3Rvci5uYW1lID09PSAnQXJyYXknKSkge1xuICAgICAgICByZXR1cm4gJ2FycmF5JztcbiAgICAgIH0gZWxzZSBpZiAodCA9PT0gJ29iamVjdCcgJiYgKFN0cmluZy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZih4KSB8fCB4LmNvbnN0cnVjdG9yICYmIHguY29uc3RydWN0b3IubmFtZSA9PT0gJ1N0cmluZycpKSB7XG4gICAgICAgIHJldHVybiAnc3RyaW5nJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0O1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIGlzVHlwZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0eXBlT2YodmFsdWUpID09PSB0eXBlO1xuICAgICAgfTtcbiAgICB9O1xuICAgIHZhciBpc1N0cmluZyA9IGlzVHlwZSgnc3RyaW5nJyk7XG4gICAgdmFyIGlzT2JqZWN0ID0gaXNUeXBlKCdvYmplY3QnKTtcbiAgICB2YXIgaXNBcnJheSA9IGlzVHlwZSgnYXJyYXknKTtcbiAgICB2YXIgaXNOdWxsYWJsZSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICByZXR1cm4gYSA9PT0gbnVsbCB8fCBhID09PSB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICB2YXIgaXNOb25OdWxsYWJsZSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICByZXR1cm4gIWlzTnVsbGFibGUoYSk7XG4gICAgfTtcblxuICAgIHZhciBub29wID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgdmFyIGNvbnN0YW50ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9O1xuICAgIH07XG4gICAgdmFyIG5ldmVyID0gY29uc3RhbnQoZmFsc2UpO1xuICAgIHZhciBhbHdheXMgPSBjb25zdGFudCh0cnVlKTtcblxuICAgIHZhciBub25lID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIE5PTkU7XG4gICAgfTtcbiAgICB2YXIgTk9ORSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBlcSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIHJldHVybiBvLmlzTm9uZSgpO1xuICAgICAgfTtcbiAgICAgIHZhciBjYWxsID0gZnVuY3Rpb24gKHRodW5rKSB7XG4gICAgICAgIHJldHVybiB0aHVuaygpO1xuICAgICAgfTtcbiAgICAgIHZhciBpZCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHJldHVybiBuO1xuICAgICAgfTtcbiAgICAgIHZhciBtZSA9IHtcbiAgICAgICAgZm9sZDogZnVuY3Rpb24gKG4sIF9zKSB7XG4gICAgICAgICAgcmV0dXJuIG4oKTtcbiAgICAgICAgfSxcbiAgICAgICAgaXM6IG5ldmVyLFxuICAgICAgICBpc1NvbWU6IG5ldmVyLFxuICAgICAgICBpc05vbmU6IGFsd2F5cyxcbiAgICAgICAgZ2V0T3I6IGlkLFxuICAgICAgICBnZXRPclRodW5rOiBjYWxsLFxuICAgICAgICBnZXRPckRpZTogZnVuY3Rpb24gKG1zZykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cgfHwgJ2Vycm9yOiBnZXRPckRpZSBjYWxsZWQgb24gbm9uZS4nKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0T3JOdWxsOiBjb25zdGFudChudWxsKSxcbiAgICAgICAgZ2V0T3JVbmRlZmluZWQ6IGNvbnN0YW50KHVuZGVmaW5lZCksXG4gICAgICAgIG9yOiBpZCxcbiAgICAgICAgb3JUaHVuazogY2FsbCxcbiAgICAgICAgbWFwOiBub25lLFxuICAgICAgICBlYWNoOiBub29wLFxuICAgICAgICBiaW5kOiBub25lLFxuICAgICAgICBleGlzdHM6IG5ldmVyLFxuICAgICAgICBmb3JhbGw6IGFsd2F5cyxcbiAgICAgICAgZmlsdGVyOiBub25lLFxuICAgICAgICBlcXVhbHM6IGVxLFxuICAgICAgICBlcXVhbHNfOiBlcSxcbiAgICAgICAgdG9BcnJheTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfSxcbiAgICAgICAgdG9TdHJpbmc6IGNvbnN0YW50KCdub25lKCknKVxuICAgICAgfTtcbiAgICAgIHJldHVybiBtZTtcbiAgICB9KCk7XG4gICAgdmFyIHNvbWUgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgdmFyIGNvbnN0YW50X2EgPSBjb25zdGFudChhKTtcbiAgICAgIHZhciBzZWxmID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbWU7XG4gICAgICB9O1xuICAgICAgdmFyIGJpbmQgPSBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZihhKTtcbiAgICAgIH07XG4gICAgICB2YXIgbWUgPSB7XG4gICAgICAgIGZvbGQ6IGZ1bmN0aW9uIChuLCBzKSB7XG4gICAgICAgICAgcmV0dXJuIHMoYSk7XG4gICAgICAgIH0sXG4gICAgICAgIGlzOiBmdW5jdGlvbiAodikge1xuICAgICAgICAgIHJldHVybiBhID09PSB2O1xuICAgICAgICB9LFxuICAgICAgICBpc1NvbWU6IGFsd2F5cyxcbiAgICAgICAgaXNOb25lOiBuZXZlcixcbiAgICAgICAgZ2V0T3I6IGNvbnN0YW50X2EsXG4gICAgICAgIGdldE9yVGh1bms6IGNvbnN0YW50X2EsXG4gICAgICAgIGdldE9yRGllOiBjb25zdGFudF9hLFxuICAgICAgICBnZXRPck51bGw6IGNvbnN0YW50X2EsXG4gICAgICAgIGdldE9yVW5kZWZpbmVkOiBjb25zdGFudF9hLFxuICAgICAgICBvcjogc2VsZixcbiAgICAgICAgb3JUaHVuazogc2VsZixcbiAgICAgICAgbWFwOiBmdW5jdGlvbiAoZikge1xuICAgICAgICAgIHJldHVybiBzb21lKGYoYSkpO1xuICAgICAgICB9LFxuICAgICAgICBlYWNoOiBmdW5jdGlvbiAoZikge1xuICAgICAgICAgIGYoYSk7XG4gICAgICAgIH0sXG4gICAgICAgIGJpbmQ6IGJpbmQsXG4gICAgICAgIGV4aXN0czogYmluZCxcbiAgICAgICAgZm9yYWxsOiBiaW5kLFxuICAgICAgICBmaWx0ZXI6IGZ1bmN0aW9uIChmKSB7XG4gICAgICAgICAgcmV0dXJuIGYoYSkgPyBtZSA6IE5PTkU7XG4gICAgICAgIH0sXG4gICAgICAgIHRvQXJyYXk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gW2FdO1xuICAgICAgICB9LFxuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiAnc29tZSgnICsgYSArICcpJztcbiAgICAgICAgfSxcbiAgICAgICAgZXF1YWxzOiBmdW5jdGlvbiAobykge1xuICAgICAgICAgIHJldHVybiBvLmlzKGEpO1xuICAgICAgICB9LFxuICAgICAgICBlcXVhbHNfOiBmdW5jdGlvbiAobywgZWxlbWVudEVxKSB7XG4gICAgICAgICAgcmV0dXJuIG8uZm9sZChuZXZlciwgZnVuY3Rpb24gKGIpIHtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50RXEoYSwgYik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICByZXR1cm4gbWU7XG4gICAgfTtcbiAgICB2YXIgZnJvbSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgPyBOT05FIDogc29tZSh2YWx1ZSk7XG4gICAgfTtcbiAgICB2YXIgT3B0aW9uYWwgPSB7XG4gICAgICBzb21lOiBzb21lLFxuICAgICAgbm9uZTogbm9uZSxcbiAgICAgIGZyb206IGZyb21cbiAgICB9O1xuXG4gICAgdmFyIG5hdGl2ZVB1c2ggPSBBcnJheS5wcm90b3R5cGUucHVzaDtcbiAgICB2YXIgZWFjaCA9IGZ1bmN0aW9uICh4cywgZikge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHhzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIHZhciB4ID0geHNbaV07XG4gICAgICAgIGYoeCwgaSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgZmxhdHRlbiA9IGZ1bmN0aW9uICh4cykge1xuICAgICAgdmFyIHIgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB4cy5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuICAgICAgICBpZiAoIWlzQXJyYXkoeHNbaV0pKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBcnIuZmxhdHRlbiBpdGVtICcgKyBpICsgJyB3YXMgbm90IGFuIGFycmF5LCBpbnB1dDogJyArIHhzKTtcbiAgICAgICAgfVxuICAgICAgICBuYXRpdmVQdXNoLmFwcGx5KHIsIHhzW2ldKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByO1xuICAgIH07XG5cbiAgICB2YXIgQ2VsbCA9IGZ1bmN0aW9uIChpbml0aWFsKSB7XG4gICAgICB2YXIgdmFsdWUgPSBpbml0aWFsO1xuICAgICAgdmFyIGdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfTtcbiAgICAgIHZhciBzZXQgPSBmdW5jdGlvbiAodikge1xuICAgICAgICB2YWx1ZSA9IHY7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0OiBnZXQsXG4gICAgICAgIHNldDogc2V0XG4gICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzO1xuICAgIHZhciBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5oYXNPd25Qcm9wZXJ0eTtcbiAgICB2YXIgZWFjaCQxID0gZnVuY3Rpb24gKG9iaiwgZikge1xuICAgICAgdmFyIHByb3BzID0ga2V5cyhvYmopO1xuICAgICAgZm9yICh2YXIgayA9IDAsIGxlbiA9IHByb3BzLmxlbmd0aDsgayA8IGxlbjsgaysrKSB7XG4gICAgICAgIHZhciBpID0gcHJvcHNba107XG4gICAgICAgIHZhciB4ID0gb2JqW2ldO1xuICAgICAgICBmKHgsIGkpO1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIGdldCA9IGZ1bmN0aW9uIChvYmosIGtleSkge1xuICAgICAgcmV0dXJuIGhhcyhvYmosIGtleSkgPyBPcHRpb25hbC5mcm9tKG9ialtrZXldKSA6IE9wdGlvbmFsLm5vbmUoKTtcbiAgICB9O1xuICAgIHZhciBoYXMgPSBmdW5jdGlvbiAob2JqLCBrZXkpIHtcbiAgICAgIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcbiAgICB9O1xuXG4gICAgdmFyIGdldFNjcmlwdHMgPSBmdW5jdGlvbiAoZWRpdG9yKSB7XG4gICAgICByZXR1cm4gZWRpdG9yLmdldFBhcmFtKCdtZWRpYV9zY3JpcHRzJyk7XG4gICAgfTtcbiAgICB2YXIgZ2V0QXVkaW9UZW1wbGF0ZUNhbGxiYWNrID0gZnVuY3Rpb24gKGVkaXRvcikge1xuICAgICAgcmV0dXJuIGVkaXRvci5nZXRQYXJhbSgnYXVkaW9fdGVtcGxhdGVfY2FsbGJhY2snKTtcbiAgICB9O1xuICAgIHZhciBnZXRWaWRlb1RlbXBsYXRlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZWRpdG9yKSB7XG4gICAgICByZXR1cm4gZWRpdG9yLmdldFBhcmFtKCd2aWRlb190ZW1wbGF0ZV9jYWxsYmFjaycpO1xuICAgIH07XG4gICAgdmFyIGhhc0xpdmVFbWJlZHMgPSBmdW5jdGlvbiAoZWRpdG9yKSB7XG4gICAgICByZXR1cm4gZWRpdG9yLmdldFBhcmFtKCdtZWRpYV9saXZlX2VtYmVkcycsIHRydWUpO1xuICAgIH07XG4gICAgdmFyIHNob3VsZEZpbHRlckh0bWwgPSBmdW5jdGlvbiAoZWRpdG9yKSB7XG4gICAgICByZXR1cm4gZWRpdG9yLmdldFBhcmFtKCdtZWRpYV9maWx0ZXJfaHRtbCcsIHRydWUpO1xuICAgIH07XG4gICAgdmFyIGdldFVybFJlc29sdmVyID0gZnVuY3Rpb24gKGVkaXRvcikge1xuICAgICAgcmV0dXJuIGVkaXRvci5nZXRQYXJhbSgnbWVkaWFfdXJsX3Jlc29sdmVyJyk7XG4gICAgfTtcbiAgICB2YXIgaGFzQWx0U291cmNlID0gZnVuY3Rpb24gKGVkaXRvcikge1xuICAgICAgcmV0dXJuIGVkaXRvci5nZXRQYXJhbSgnbWVkaWFfYWx0X3NvdXJjZScsIHRydWUpO1xuICAgIH07XG4gICAgdmFyIGhhc1Bvc3RlciA9IGZ1bmN0aW9uIChlZGl0b3IpIHtcbiAgICAgIHJldHVybiBlZGl0b3IuZ2V0UGFyYW0oJ21lZGlhX3Bvc3RlcicsIHRydWUpO1xuICAgIH07XG4gICAgdmFyIGhhc0RpbWVuc2lvbnMgPSBmdW5jdGlvbiAoZWRpdG9yKSB7XG4gICAgICByZXR1cm4gZWRpdG9yLmdldFBhcmFtKCdtZWRpYV9kaW1lbnNpb25zJywgdHJ1ZSk7XG4gICAgfTtcblxuICAgIHZhciBnbG9iYWwkMSA9IHRpbnltY2UudXRpbC5Ub29scy5yZXNvbHZlKCd0aW55bWNlLnV0aWwuVG9vbHMnKTtcblxuICAgIHZhciBnbG9iYWwkMiA9IHRpbnltY2UudXRpbC5Ub29scy5yZXNvbHZlKCd0aW55bWNlLmRvbS5ET01VdGlscycpO1xuXG4gICAgdmFyIGdsb2JhbCQzID0gdGlueW1jZS51dGlsLlRvb2xzLnJlc29sdmUoJ3RpbnltY2UuaHRtbC5TYXhQYXJzZXInKTtcblxuICAgIHZhciBnZXRWaWRlb1NjcmlwdE1hdGNoID0gZnVuY3Rpb24gKHByZWZpeGVzLCBzcmMpIHtcbiAgICAgIGlmIChwcmVmaXhlcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByZWZpeGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKHNyYy5pbmRleE9mKHByZWZpeGVzW2ldLmZpbHRlcikgIT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJlZml4ZXNbaV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHZhciBET00gPSBnbG9iYWwkMi5ET007XG4gICAgdmFyIHRyaW1QeCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoL3B4JC8sICcnKTtcbiAgICB9O1xuICAgIHZhciBnZXRFcGhveEVtYmVkRGF0YSA9IGZ1bmN0aW9uIChhdHRycykge1xuICAgICAgdmFyIHN0eWxlID0gYXR0cnMubWFwLnN0eWxlO1xuICAgICAgdmFyIHN0eWxlcyA9IHN0eWxlID8gRE9NLnBhcnNlU3R5bGUoc3R5bGUpIDoge307XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnZXBob3gtZW1iZWQtaXJpJyxcbiAgICAgICAgc291cmNlOiBhdHRycy5tYXBbJ2RhdGEtZXBob3gtZW1iZWQtaXJpJ10sXG4gICAgICAgIGFsdHNvdXJjZTogJycsXG4gICAgICAgIHBvc3RlcjogJycsXG4gICAgICAgIHdpZHRoOiBnZXQoc3R5bGVzLCAnbWF4LXdpZHRoJykubWFwKHRyaW1QeCkuZ2V0T3IoJycpLFxuICAgICAgICBoZWlnaHQ6IGdldChzdHlsZXMsICdtYXgtaGVpZ2h0JykubWFwKHRyaW1QeCkuZ2V0T3IoJycpXG4gICAgICB9O1xuICAgIH07XG4gICAgdmFyIGh0bWxUb0RhdGEgPSBmdW5jdGlvbiAocHJlZml4ZXMsIGh0bWwpIHtcbiAgICAgIHZhciBpc0VwaG94RW1iZWQgPSBDZWxsKGZhbHNlKTtcbiAgICAgIHZhciBkYXRhID0ge307XG4gICAgICBnbG9iYWwkMyh7XG4gICAgICAgIHZhbGlkYXRlOiBmYWxzZSxcbiAgICAgICAgYWxsb3dfY29uZGl0aW9uYWxfY29tbWVudHM6IHRydWUsXG4gICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAobmFtZSwgYXR0cnMpIHtcbiAgICAgICAgICBpZiAoaXNFcGhveEVtYmVkLmdldCgpKSA7IGVsc2UgaWYgKGhhcyhhdHRycy5tYXAsICdkYXRhLWVwaG94LWVtYmVkLWlyaScpKSB7XG4gICAgICAgICAgICBpc0VwaG94RW1iZWQuc2V0KHRydWUpO1xuICAgICAgICAgICAgZGF0YSA9IGdldEVwaG94RW1iZWREYXRhKGF0dHJzKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKCFkYXRhLnNvdXJjZSAmJiBuYW1lID09PSAncGFyYW0nKSB7XG4gICAgICAgICAgICAgIGRhdGEuc291cmNlID0gYXR0cnMubWFwLm1vdmllO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdpZnJhbWUnIHx8IG5hbWUgPT09ICdvYmplY3QnIHx8IG5hbWUgPT09ICdlbWJlZCcgfHwgbmFtZSA9PT0gJ3ZpZGVvJyB8fCBuYW1lID09PSAnYXVkaW8nKSB7XG4gICAgICAgICAgICAgIGlmICghZGF0YS50eXBlKSB7XG4gICAgICAgICAgICAgICAgZGF0YS50eXBlID0gbmFtZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBkYXRhID0gZ2xvYmFsJDEuZXh0ZW5kKGF0dHJzLm1hcCwgZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gJ3NjcmlwdCcpIHtcbiAgICAgICAgICAgICAgdmFyIHZpZGVvU2NyaXB0ID0gZ2V0VmlkZW9TY3JpcHRNYXRjaChwcmVmaXhlcywgYXR0cnMubWFwLnNyYyk7XG4gICAgICAgICAgICAgIGlmICghdmlkZW9TY3JpcHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnc2NyaXB0JyxcbiAgICAgICAgICAgICAgICBzb3VyY2U6IGF0dHJzLm1hcC5zcmMsXG4gICAgICAgICAgICAgICAgd2lkdGg6IFN0cmluZyh2aWRlb1NjcmlwdC53aWR0aCksXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBTdHJpbmcodmlkZW9TY3JpcHQuaGVpZ2h0KVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdzb3VyY2UnKSB7XG4gICAgICAgICAgICAgIGlmICghZGF0YS5zb3VyY2UpIHtcbiAgICAgICAgICAgICAgICBkYXRhLnNvdXJjZSA9IGF0dHJzLm1hcC5zcmM7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWRhdGEuYWx0c291cmNlKSB7XG4gICAgICAgICAgICAgICAgZGF0YS5hbHRzb3VyY2UgPSBhdHRycy5tYXAuc3JjO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gJ2ltZycgJiYgIWRhdGEucG9zdGVyKSB7XG4gICAgICAgICAgICAgIGRhdGEucG9zdGVyID0gYXR0cnMubWFwLnNyYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLnBhcnNlKGh0bWwpO1xuICAgICAgZGF0YS5zb3VyY2UgPSBkYXRhLnNvdXJjZSB8fCBkYXRhLnNyYyB8fCBkYXRhLmRhdGE7XG4gICAgICBkYXRhLmFsdHNvdXJjZSA9IGRhdGEuYWx0c291cmNlIHx8ICcnO1xuICAgICAgZGF0YS5wb3N0ZXIgPSBkYXRhLnBvc3RlciB8fCAnJztcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH07XG5cbiAgICB2YXIgZ3Vlc3MgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgICB2YXIgbWltZXMgPSB7XG4gICAgICAgIG1wMzogJ2F1ZGlvL21wZWcnLFxuICAgICAgICBtNGE6ICdhdWRpby94LW00YScsXG4gICAgICAgIHdhdjogJ2F1ZGlvL3dhdicsXG4gICAgICAgIG1wNDogJ3ZpZGVvL21wNCcsXG4gICAgICAgIHdlYm06ICd2aWRlby93ZWJtJyxcbiAgICAgICAgb2dnOiAndmlkZW8vb2dnJyxcbiAgICAgICAgc3dmOiAnYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2gnXG4gICAgICB9O1xuICAgICAgdmFyIGZpbGVFbmQgPSB1cmwudG9Mb3dlckNhc2UoKS5zcGxpdCgnLicpLnBvcCgpO1xuICAgICAgdmFyIG1pbWUgPSBtaW1lc1tmaWxlRW5kXTtcbiAgICAgIHJldHVybiBtaW1lID8gbWltZSA6ICcnO1xuICAgIH07XG5cbiAgICB2YXIgZ2xvYmFsJDQgPSB0aW55bWNlLnV0aWwuVG9vbHMucmVzb2x2ZSgndGlueW1jZS5odG1sLlNjaGVtYScpO1xuXG4gICAgdmFyIGdsb2JhbCQ1ID0gdGlueW1jZS51dGlsLlRvb2xzLnJlc29sdmUoJ3RpbnltY2UuaHRtbC5Xcml0ZXInKTtcblxuICAgIHZhciBET00kMSA9IGdsb2JhbCQyLkRPTTtcbiAgICB2YXIgYWRkUHggPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiAvXlswLTkuXSskLy50ZXN0KHZhbHVlKSA/IHZhbHVlICsgJ3B4JyA6IHZhbHVlO1xuICAgIH07XG4gICAgdmFyIHNldEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoYXR0cnMsIHVwZGF0ZWRBdHRycykge1xuICAgICAgZWFjaCQxKHVwZGF0ZWRBdHRycywgZnVuY3Rpb24gKHZhbCwgbmFtZSkge1xuICAgICAgICB2YXIgdmFsdWUgPSAnJyArIHZhbDtcbiAgICAgICAgaWYgKGF0dHJzLm1hcFtuYW1lXSkge1xuICAgICAgICAgIHZhciBpID0gYXR0cnMubGVuZ3RoO1xuICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgIHZhciBhdHRyID0gYXR0cnNbaV07XG4gICAgICAgICAgICBpZiAoYXR0ci5uYW1lID09PSBuYW1lKSB7XG4gICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGF0dHJzLm1hcFtuYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF0dHIudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgYXR0cnMubWFwW25hbWVdO1xuICAgICAgICAgICAgICAgIGF0dHJzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSkge1xuICAgICAgICAgIGF0dHJzLnB1c2goe1xuICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGF0dHJzLm1hcFtuYW1lXSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHZhciB1cGRhdGVFcGhveEVtYmVkID0gZnVuY3Rpb24gKGRhdGEsIGF0dHJzKSB7XG4gICAgICB2YXIgc3R5bGUgPSBhdHRycy5tYXAuc3R5bGU7XG4gICAgICB2YXIgc3R5bGVNYXAgPSBzdHlsZSA/IERPTSQxLnBhcnNlU3R5bGUoc3R5bGUpIDoge307XG4gICAgICBzdHlsZU1hcFsnbWF4LXdpZHRoJ10gPSBhZGRQeChkYXRhLndpZHRoKTtcbiAgICAgIHN0eWxlTWFwWydtYXgtaGVpZ2h0J10gPSBhZGRQeChkYXRhLmhlaWdodCk7XG4gICAgICBzZXRBdHRyaWJ1dGVzKGF0dHJzLCB7IHN0eWxlOiBET00kMS5zZXJpYWxpemVTdHlsZShzdHlsZU1hcCkgfSk7XG4gICAgfTtcbiAgICB2YXIgc291cmNlcyA9IFtcbiAgICAgICdzb3VyY2UnLFxuICAgICAgJ2FsdHNvdXJjZSdcbiAgICBdO1xuICAgIHZhciB1cGRhdGVIdG1sID0gZnVuY3Rpb24gKGh0bWwsIGRhdGEsIHVwZGF0ZUFsbCkge1xuICAgICAgdmFyIHdyaXRlciA9IGdsb2JhbCQ1KCk7XG4gICAgICB2YXIgaXNFcGhveEVtYmVkID0gQ2VsbChmYWxzZSk7XG4gICAgICB2YXIgc291cmNlQ291bnQgPSAwO1xuICAgICAgdmFyIGhhc0ltYWdlO1xuICAgICAgZ2xvYmFsJDMoe1xuICAgICAgICB2YWxpZGF0ZTogZmFsc2UsXG4gICAgICAgIGFsbG93X2NvbmRpdGlvbmFsX2NvbW1lbnRzOiB0cnVlLFxuICAgICAgICBjb21tZW50OiBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICAgIHdyaXRlci5jb21tZW50KHRleHQpO1xuICAgICAgICB9LFxuICAgICAgICBjZGF0YTogZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgICAgICB3cml0ZXIuY2RhdGEodGV4dCk7XG4gICAgICAgIH0sXG4gICAgICAgIHRleHQ6IGZ1bmN0aW9uICh0ZXh0LCByYXcpIHtcbiAgICAgICAgICB3cml0ZXIudGV4dCh0ZXh0LCByYXcpO1xuICAgICAgICB9LFxuICAgICAgICBzdGFydDogZnVuY3Rpb24gKG5hbWUsIGF0dHJzLCBlbXB0eSkge1xuICAgICAgICAgIGlmIChpc0VwaG94RW1iZWQuZ2V0KCkpIDsgZWxzZSBpZiAoaGFzKGF0dHJzLm1hcCwgJ2RhdGEtZXBob3gtZW1iZWQtaXJpJykpIHtcbiAgICAgICAgICAgIGlzRXBob3hFbWJlZC5zZXQodHJ1ZSk7XG4gICAgICAgICAgICB1cGRhdGVFcGhveEVtYmVkKGRhdGEsIGF0dHJzKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3dpdGNoIChuYW1lKSB7XG4gICAgICAgICAgICBjYXNlICd2aWRlbyc6XG4gICAgICAgICAgICBjYXNlICdvYmplY3QnOlxuICAgICAgICAgICAgY2FzZSAnZW1iZWQnOlxuICAgICAgICAgICAgY2FzZSAnaW1nJzpcbiAgICAgICAgICAgIGNhc2UgJ2lmcmFtZSc6XG4gICAgICAgICAgICAgIGlmIChkYXRhLmhlaWdodCAhPT0gdW5kZWZpbmVkICYmIGRhdGEud2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNldEF0dHJpYnV0ZXMoYXR0cnMsIHtcbiAgICAgICAgICAgICAgICAgIHdpZHRoOiBkYXRhLndpZHRoLFxuICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBkYXRhLmhlaWdodFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHVwZGF0ZUFsbCkge1xuICAgICAgICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcbiAgICAgICAgICAgICAgY2FzZSAndmlkZW8nOlxuICAgICAgICAgICAgICAgIHNldEF0dHJpYnV0ZXMoYXR0cnMsIHtcbiAgICAgICAgICAgICAgICAgIHBvc3RlcjogZGF0YS5wb3N0ZXIsXG4gICAgICAgICAgICAgICAgICBzcmM6ICcnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuYWx0c291cmNlKSB7XG4gICAgICAgICAgICAgICAgICBzZXRBdHRyaWJ1dGVzKGF0dHJzLCB7IHNyYzogJycgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlICdpZnJhbWUnOlxuICAgICAgICAgICAgICAgIHNldEF0dHJpYnV0ZXMoYXR0cnMsIHsgc3JjOiBkYXRhLnNvdXJjZSB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSAnc291cmNlJzpcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlQ291bnQgPCAyKSB7XG4gICAgICAgICAgICAgICAgICBzZXRBdHRyaWJ1dGVzKGF0dHJzLCB7XG4gICAgICAgICAgICAgICAgICAgIHNyYzogZGF0YVtzb3VyY2VzW3NvdXJjZUNvdW50XV0sXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IGRhdGFbc291cmNlc1tzb3VyY2VDb3VudF0gKyAnbWltZSddXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIGlmICghZGF0YVtzb3VyY2VzW3NvdXJjZUNvdW50XV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzb3VyY2VDb3VudCsrO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlICdpbWcnOlxuICAgICAgICAgICAgICAgIGlmICghZGF0YS5wb3N0ZXIpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaGFzSW1hZ2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHdyaXRlci5zdGFydChuYW1lLCBhdHRycywgZW1wdHkpO1xuICAgICAgICB9LFxuICAgICAgICBlbmQ6IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgaWYgKCFpc0VwaG94RW1iZWQuZ2V0KCkpIHtcbiAgICAgICAgICAgIGlmIChuYW1lID09PSAndmlkZW8nICYmIHVwZGF0ZUFsbCkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgMjsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhW3NvdXJjZXNbaW5kZXhdXSkge1xuICAgICAgICAgICAgICAgICAgdmFyIGF0dHJzID0gW107XG4gICAgICAgICAgICAgICAgICBhdHRycy5tYXAgPSB7fTtcbiAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VDb3VudCA8PSBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBzZXRBdHRyaWJ1dGVzKGF0dHJzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgc3JjOiBkYXRhW3NvdXJjZXNbaW5kZXhdXSxcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBkYXRhW3NvdXJjZXNbaW5kZXhdICsgJ21pbWUnXVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVyLnN0YXJ0KCdzb3VyY2UnLCBhdHRycywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGF0YS5wb3N0ZXIgJiYgbmFtZSA9PT0gJ29iamVjdCcgJiYgdXBkYXRlQWxsICYmICFoYXNJbWFnZSkge1xuICAgICAgICAgICAgICB2YXIgaW1nQXR0cnMgPSBbXTtcbiAgICAgICAgICAgICAgaW1nQXR0cnMubWFwID0ge307XG4gICAgICAgICAgICAgIHNldEF0dHJpYnV0ZXMoaW1nQXR0cnMsIHtcbiAgICAgICAgICAgICAgICBzcmM6IGRhdGEucG9zdGVyLFxuICAgICAgICAgICAgICAgIHdpZHRoOiBkYXRhLndpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodDogZGF0YS5oZWlnaHRcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHdyaXRlci5zdGFydCgnaW1nJywgaW1nQXR0cnMsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB3cml0ZXIuZW5kKG5hbWUpO1xuICAgICAgICB9XG4gICAgICB9LCBnbG9iYWwkNCh7fSkpLnBhcnNlKGh0bWwpO1xuICAgICAgcmV0dXJuIHdyaXRlci5nZXRDb250ZW50KCk7XG4gICAgfTtcblxuICAgIHZhciB1cmxQYXR0ZXJucyA9IFtcbiAgICAgIHtcbiAgICAgICAgcmVnZXg6IC95b3V0dVxcLmJlXFwvKFtcXHdcXC1fXFw/Jj0uXSspL2ksXG4gICAgICAgIHR5cGU6ICdpZnJhbWUnLFxuICAgICAgICB3OiA1NjAsXG4gICAgICAgIGg6IDMxNCxcbiAgICAgICAgdXJsOiAnd3d3LnlvdXR1YmUuY29tL2VtYmVkLyQxJyxcbiAgICAgICAgYWxsb3dGdWxsc2NyZWVuOiB0cnVlXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICByZWdleDogL3lvdXR1YmVcXC5jb20oLispdj0oW14mXSspKCYoW2EtejAtOSY9XFwtX10rKSk/L2ksXG4gICAgICAgIHR5cGU6ICdpZnJhbWUnLFxuICAgICAgICB3OiA1NjAsXG4gICAgICAgIGg6IDMxNCxcbiAgICAgICAgdXJsOiAnd3d3LnlvdXR1YmUuY29tL2VtYmVkLyQyPyQ0JyxcbiAgICAgICAgYWxsb3dGdWxsc2NyZWVuOiB0cnVlXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICByZWdleDogL3lvdXR1YmUuY29tXFwvZW1iZWRcXC8oW2EtejAtOVxcPyY9XFwtX10rKS9pLFxuICAgICAgICB0eXBlOiAnaWZyYW1lJyxcbiAgICAgICAgdzogNTYwLFxuICAgICAgICBoOiAzMTQsXG4gICAgICAgIHVybDogJ3d3dy55b3V0dWJlLmNvbS9lbWJlZC8kMScsXG4gICAgICAgIGFsbG93RnVsbHNjcmVlbjogdHJ1ZVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgcmVnZXg6IC92aW1lb1xcLmNvbVxcLyhbMC05XSspLyxcbiAgICAgICAgdHlwZTogJ2lmcmFtZScsXG4gICAgICAgIHc6IDQyNSxcbiAgICAgICAgaDogMzUwLFxuICAgICAgICB1cmw6ICdwbGF5ZXIudmltZW8uY29tL3ZpZGVvLyQxP3RpdGxlPTAmYnlsaW5lPTAmcG9ydHJhaXQ9MCZjb2xvcj04ZGM3ZGMnLFxuICAgICAgICBhbGxvd0Z1bGxzY3JlZW46IHRydWVcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHJlZ2V4OiAvdmltZW9cXC5jb21cXC8oLiopXFwvKFswLTldKykvLFxuICAgICAgICB0eXBlOiAnaWZyYW1lJyxcbiAgICAgICAgdzogNDI1LFxuICAgICAgICBoOiAzNTAsXG4gICAgICAgIHVybDogJ3BsYXllci52aW1lby5jb20vdmlkZW8vJDI/dGl0bGU9MCZhbXA7YnlsaW5lPTAnLFxuICAgICAgICBhbGxvd0Z1bGxzY3JlZW46IHRydWVcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHJlZ2V4OiAvbWFwc1xcLmdvb2dsZVxcLihbYS16XXsyLDN9KVxcL21hcHNcXC8oLispbXNpZD0oLispLyxcbiAgICAgICAgdHlwZTogJ2lmcmFtZScsXG4gICAgICAgIHc6IDQyNSxcbiAgICAgICAgaDogMzUwLFxuICAgICAgICB1cmw6ICdtYXBzLmdvb2dsZS5jb20vbWFwcy9tcz9tc2lkPSQyJm91dHB1dD1lbWJlZFwiJyxcbiAgICAgICAgYWxsb3dGdWxsc2NyZWVuOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgcmVnZXg6IC9kYWlseW1vdGlvblxcLmNvbVxcL3ZpZGVvXFwvKFteX10rKS8sXG4gICAgICAgIHR5cGU6ICdpZnJhbWUnLFxuICAgICAgICB3OiA0ODAsXG4gICAgICAgIGg6IDI3MCxcbiAgICAgICAgdXJsOiAnd3d3LmRhaWx5bW90aW9uLmNvbS9lbWJlZC92aWRlby8kMScsXG4gICAgICAgIGFsbG93RnVsbHNjcmVlbjogdHJ1ZVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgcmVnZXg6IC9kYWlcXC5seVxcLyhbXl9dKykvLFxuICAgICAgICB0eXBlOiAnaWZyYW1lJyxcbiAgICAgICAgdzogNDgwLFxuICAgICAgICBoOiAyNzAsXG4gICAgICAgIHVybDogJ3d3dy5kYWlseW1vdGlvbi5jb20vZW1iZWQvdmlkZW8vJDEnLFxuICAgICAgICBhbGxvd0Z1bGxzY3JlZW46IHRydWVcbiAgICAgIH1cbiAgICBdO1xuICAgIHZhciBnZXRQcm90b2NvbCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgIHZhciBwcm90b2NvbE1hdGNoZXMgPSB1cmwubWF0Y2goL14oaHR0cHM/OlxcL1xcL3x3d3dcXC4pKC4rKSQvaSk7XG4gICAgICBpZiAocHJvdG9jb2xNYXRjaGVzICYmIHByb3RvY29sTWF0Y2hlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgIHJldHVybiBwcm90b2NvbE1hdGNoZXNbMV0gPT09ICd3d3cuJyA/ICdodHRwczovLycgOiBwcm90b2NvbE1hdGNoZXNbMV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ2h0dHBzOi8vJztcbiAgICAgIH1cbiAgICB9O1xuICAgIHZhciBnZXRVcmwgPSBmdW5jdGlvbiAocGF0dGVybiwgdXJsKSB7XG4gICAgICB2YXIgcHJvdG9jb2wgPSBnZXRQcm90b2NvbCh1cmwpO1xuICAgICAgdmFyIG1hdGNoID0gcGF0dGVybi5yZWdleC5leGVjKHVybCk7XG4gICAgICB2YXIgbmV3VXJsID0gcHJvdG9jb2wgKyBwYXR0ZXJuLnVybDtcbiAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgbmV3VXJsID0gbmV3VXJsLnJlcGxhY2UoJyQnICsgaSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBtYXRjaFtpXSA/IG1hdGNoW2ldIDogJyc7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF0Y2gubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgX2xvb3BfMShpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuZXdVcmwucmVwbGFjZSgvXFw/JC8sICcnKTtcbiAgICB9O1xuICAgIHZhciBtYXRjaFBhdHRlcm4gPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgICB2YXIgcGF0dGVybnMgPSB1cmxQYXR0ZXJucy5maWx0ZXIoZnVuY3Rpb24gKHBhdHRlcm4pIHtcbiAgICAgICAgcmV0dXJuIHBhdHRlcm4ucmVnZXgudGVzdCh1cmwpO1xuICAgICAgfSk7XG4gICAgICBpZiAocGF0dGVybnMubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZ2xvYmFsJDEuZXh0ZW5kKHt9LCBwYXR0ZXJuc1swXSwgeyB1cmw6IGdldFVybChwYXR0ZXJuc1swXSwgdXJsKSB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgZ2V0SWZyYW1lSHRtbCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICB2YXIgYWxsb3dGdWxsc2NyZWVuID0gZGF0YS5hbGxvd2Z1bGxzY3JlZW4gPyAnIGFsbG93RnVsbHNjcmVlbj1cIjFcIicgOiAnJztcbiAgICAgIHJldHVybiAnPGlmcmFtZSBzcmM9XCInICsgZGF0YS5zb3VyY2UgKyAnXCIgd2lkdGg9XCInICsgZGF0YS53aWR0aCArICdcIiBoZWlnaHQ9XCInICsgZGF0YS5oZWlnaHQgKyAnXCInICsgYWxsb3dGdWxsc2NyZWVuICsgJz48L2lmcmFtZT4nO1xuICAgIH07XG4gICAgdmFyIGdldEZsYXNoSHRtbCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICB2YXIgaHRtbCA9ICc8b2JqZWN0IGRhdGE9XCInICsgZGF0YS5zb3VyY2UgKyAnXCIgd2lkdGg9XCInICsgZGF0YS53aWR0aCArICdcIiBoZWlnaHQ9XCInICsgZGF0YS5oZWlnaHQgKyAnXCIgdHlwZT1cImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoXCI+JztcbiAgICAgIGlmIChkYXRhLnBvc3Rlcikge1xuICAgICAgICBodG1sICs9ICc8aW1nIHNyYz1cIicgKyBkYXRhLnBvc3RlciArICdcIiB3aWR0aD1cIicgKyBkYXRhLndpZHRoICsgJ1wiIGhlaWdodD1cIicgKyBkYXRhLmhlaWdodCArICdcIiAvPic7XG4gICAgICB9XG4gICAgICBodG1sICs9ICc8L29iamVjdD4nO1xuICAgICAgcmV0dXJuIGh0bWw7XG4gICAgfTtcbiAgICB2YXIgZ2V0QXVkaW9IdG1sID0gZnVuY3Rpb24gKGRhdGEsIGF1ZGlvVGVtcGxhdGVDYWxsYmFjaykge1xuICAgICAgaWYgKGF1ZGlvVGVtcGxhdGVDYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gYXVkaW9UZW1wbGF0ZUNhbGxiYWNrKGRhdGEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICc8YXVkaW8gY29udHJvbHM9XCJjb250cm9sc1wiIHNyYz1cIicgKyBkYXRhLnNvdXJjZSArICdcIj4nICsgKGRhdGEuYWx0c291cmNlID8gJ1xcbjxzb3VyY2Ugc3JjPVwiJyArIGRhdGEuYWx0c291cmNlICsgJ1wiJyArIChkYXRhLmFsdHNvdXJjZW1pbWUgPyAnIHR5cGU9XCInICsgZGF0YS5hbHRzb3VyY2VtaW1lICsgJ1wiJyA6ICcnKSArICcgLz5cXG4nIDogJycpICsgJzwvYXVkaW8+JztcbiAgICAgIH1cbiAgICB9O1xuICAgIHZhciBnZXRWaWRlb0h0bWwgPSBmdW5jdGlvbiAoZGF0YSwgdmlkZW9UZW1wbGF0ZUNhbGxiYWNrKSB7XG4gICAgICBpZiAodmlkZW9UZW1wbGF0ZUNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiB2aWRlb1RlbXBsYXRlQ2FsbGJhY2soZGF0YSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJzx2aWRlbyB3aWR0aD1cIicgKyBkYXRhLndpZHRoICsgJ1wiIGhlaWdodD1cIicgKyBkYXRhLmhlaWdodCArICdcIicgKyAoZGF0YS5wb3N0ZXIgPyAnIHBvc3Rlcj1cIicgKyBkYXRhLnBvc3RlciArICdcIicgOiAnJykgKyAnIGNvbnRyb2xzPVwiY29udHJvbHNcIj5cXG4nICsgJzxzb3VyY2Ugc3JjPVwiJyArIGRhdGEuc291cmNlICsgJ1wiJyArIChkYXRhLnNvdXJjZW1pbWUgPyAnIHR5cGU9XCInICsgZGF0YS5zb3VyY2VtaW1lICsgJ1wiJyA6ICcnKSArICcgLz5cXG4nICsgKGRhdGEuYWx0c291cmNlID8gJzxzb3VyY2Ugc3JjPVwiJyArIGRhdGEuYWx0c291cmNlICsgJ1wiJyArIChkYXRhLmFsdHNvdXJjZW1pbWUgPyAnIHR5cGU9XCInICsgZGF0YS5hbHRzb3VyY2VtaW1lICsgJ1wiJyA6ICcnKSArICcgLz5cXG4nIDogJycpICsgJzwvdmlkZW8+JztcbiAgICAgIH1cbiAgICB9O1xuICAgIHZhciBnZXRTY3JpcHRIdG1sID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgIHJldHVybiAnPHNjcmlwdCBzcmM9XCInICsgZGF0YS5zb3VyY2UgKyAnXCI+PC9zY3JpcHQ+JztcbiAgICB9O1xuICAgIHZhciBkYXRhVG9IdG1sID0gZnVuY3Rpb24gKGVkaXRvciwgZGF0YUluKSB7XG4gICAgICB2YXIgZGF0YSA9IGdsb2JhbCQxLmV4dGVuZCh7fSwgZGF0YUluKTtcbiAgICAgIGlmICghZGF0YS5zb3VyY2UpIHtcbiAgICAgICAgZ2xvYmFsJDEuZXh0ZW5kKGRhdGEsIGh0bWxUb0RhdGEoZ2V0U2NyaXB0cyhlZGl0b3IpLCBkYXRhLmVtYmVkKSk7XG4gICAgICAgIGlmICghZGF0YS5zb3VyY2UpIHtcbiAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghZGF0YS5hbHRzb3VyY2UpIHtcbiAgICAgICAgZGF0YS5hbHRzb3VyY2UgPSAnJztcbiAgICAgIH1cbiAgICAgIGlmICghZGF0YS5wb3N0ZXIpIHtcbiAgICAgICAgZGF0YS5wb3N0ZXIgPSAnJztcbiAgICAgIH1cbiAgICAgIGRhdGEuc291cmNlID0gZWRpdG9yLmNvbnZlcnRVUkwoZGF0YS5zb3VyY2UsICdzb3VyY2UnKTtcbiAgICAgIGRhdGEuYWx0c291cmNlID0gZWRpdG9yLmNvbnZlcnRVUkwoZGF0YS5hbHRzb3VyY2UsICdzb3VyY2UnKTtcbiAgICAgIGRhdGEuc291cmNlbWltZSA9IGd1ZXNzKGRhdGEuc291cmNlKTtcbiAgICAgIGRhdGEuYWx0c291cmNlbWltZSA9IGd1ZXNzKGRhdGEuYWx0c291cmNlKTtcbiAgICAgIGRhdGEucG9zdGVyID0gZWRpdG9yLmNvbnZlcnRVUkwoZGF0YS5wb3N0ZXIsICdwb3N0ZXInKTtcbiAgICAgIHZhciBwYXR0ZXJuID0gbWF0Y2hQYXR0ZXJuKGRhdGEuc291cmNlKTtcbiAgICAgIGlmIChwYXR0ZXJuKSB7XG4gICAgICAgIGRhdGEuc291cmNlID0gcGF0dGVybi51cmw7XG4gICAgICAgIGRhdGEudHlwZSA9IHBhdHRlcm4udHlwZTtcbiAgICAgICAgZGF0YS5hbGxvd2Z1bGxzY3JlZW4gPSBwYXR0ZXJuLmFsbG93RnVsbHNjcmVlbjtcbiAgICAgICAgZGF0YS53aWR0aCA9IGRhdGEud2lkdGggfHwgU3RyaW5nKHBhdHRlcm4udyk7XG4gICAgICAgIGRhdGEuaGVpZ2h0ID0gZGF0YS5oZWlnaHQgfHwgU3RyaW5nKHBhdHRlcm4uaCk7XG4gICAgICB9XG4gICAgICBpZiAoZGF0YS5lbWJlZCkge1xuICAgICAgICByZXR1cm4gdXBkYXRlSHRtbChkYXRhLmVtYmVkLCBkYXRhLCB0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciB2aWRlb1NjcmlwdCA9IGdldFZpZGVvU2NyaXB0TWF0Y2goZ2V0U2NyaXB0cyhlZGl0b3IpLCBkYXRhLnNvdXJjZSk7XG4gICAgICAgIGlmICh2aWRlb1NjcmlwdCkge1xuICAgICAgICAgIGRhdGEudHlwZSA9ICdzY3JpcHQnO1xuICAgICAgICAgIGRhdGEud2lkdGggPSBTdHJpbmcodmlkZW9TY3JpcHQud2lkdGgpO1xuICAgICAgICAgIGRhdGEuaGVpZ2h0ID0gU3RyaW5nKHZpZGVvU2NyaXB0LmhlaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF1ZGlvVGVtcGxhdGVDYWxsYmFjayA9IGdldEF1ZGlvVGVtcGxhdGVDYWxsYmFjayhlZGl0b3IpO1xuICAgICAgICB2YXIgdmlkZW9UZW1wbGF0ZUNhbGxiYWNrID0gZ2V0VmlkZW9UZW1wbGF0ZUNhbGxiYWNrKGVkaXRvcik7XG4gICAgICAgIGRhdGEud2lkdGggPSBkYXRhLndpZHRoIHx8ICczMDAnO1xuICAgICAgICBkYXRhLmhlaWdodCA9IGRhdGEuaGVpZ2h0IHx8ICcxNTAnO1xuICAgICAgICBnbG9iYWwkMS5lYWNoKGRhdGEsIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgZGF0YVtrZXldID0gZWRpdG9yLmRvbS5lbmNvZGUoJycgKyB2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoZGF0YS50eXBlID09PSAnaWZyYW1lJykge1xuICAgICAgICAgIHJldHVybiBnZXRJZnJhbWVIdG1sKGRhdGEpO1xuICAgICAgICB9IGVsc2UgaWYgKGRhdGEuc291cmNlbWltZSA9PT0gJ2FwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoJykge1xuICAgICAgICAgIHJldHVybiBnZXRGbGFzaEh0bWwoZGF0YSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5zb3VyY2VtaW1lLmluZGV4T2YoJ2F1ZGlvJykgIT09IC0xKSB7XG4gICAgICAgICAgcmV0dXJuIGdldEF1ZGlvSHRtbChkYXRhLCBhdWRpb1RlbXBsYXRlQ2FsbGJhY2spO1xuICAgICAgICB9IGVsc2UgaWYgKGRhdGEudHlwZSA9PT0gJ3NjcmlwdCcpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0U2NyaXB0SHRtbChkYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gZ2V0VmlkZW9IdG1sKGRhdGEsIHZpZGVvVGVtcGxhdGVDYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGdsb2JhbCQ2ID0gdGlueW1jZS51dGlsLlRvb2xzLnJlc29sdmUoJ3RpbnltY2UudXRpbC5Qcm9taXNlJyk7XG5cbiAgICB2YXIgY2FjaGUgPSB7fTtcbiAgICB2YXIgZW1iZWRQcm9taXNlID0gZnVuY3Rpb24gKGRhdGEsIGRhdGFUb0h0bWwsIGhhbmRsZXIpIHtcbiAgICAgIHJldHVybiBuZXcgZ2xvYmFsJDYoZnVuY3Rpb24gKHJlcywgcmVqKSB7XG4gICAgICAgIHZhciB3cmFwcGVkUmVzb2x2ZSA9IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5odG1sKSB7XG4gICAgICAgICAgICBjYWNoZVtkYXRhLnNvdXJjZV0gPSByZXNwb25zZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlcyh7XG4gICAgICAgICAgICB1cmw6IGRhdGEuc291cmNlLFxuICAgICAgICAgICAgaHRtbDogcmVzcG9uc2UuaHRtbCA/IHJlc3BvbnNlLmh0bWwgOiBkYXRhVG9IdG1sKGRhdGEpXG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChjYWNoZVtkYXRhLnNvdXJjZV0pIHtcbiAgICAgICAgICB3cmFwcGVkUmVzb2x2ZShjYWNoZVtkYXRhLnNvdXJjZV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGhhbmRsZXIoeyB1cmw6IGRhdGEuc291cmNlIH0sIHdyYXBwZWRSZXNvbHZlLCByZWopO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHZhciBkZWZhdWx0UHJvbWlzZSA9IGZ1bmN0aW9uIChkYXRhLCBkYXRhVG9IdG1sKSB7XG4gICAgICByZXR1cm4gbmV3IGdsb2JhbCQ2KGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgcmVzKHtcbiAgICAgICAgICBodG1sOiBkYXRhVG9IdG1sKGRhdGEpLFxuICAgICAgICAgIHVybDogZGF0YS5zb3VyY2VcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHZhciBsb2FkZWREYXRhID0gZnVuY3Rpb24gKGVkaXRvcikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHJldHVybiBkYXRhVG9IdG1sKGVkaXRvciwgZGF0YSk7XG4gICAgICB9O1xuICAgIH07XG4gICAgdmFyIGdldEVtYmVkSHRtbCA9IGZ1bmN0aW9uIChlZGl0b3IsIGRhdGEpIHtcbiAgICAgIHZhciBlbWJlZEhhbmRsZXIgPSBnZXRVcmxSZXNvbHZlcihlZGl0b3IpO1xuICAgICAgcmV0dXJuIGVtYmVkSGFuZGxlciA/IGVtYmVkUHJvbWlzZShkYXRhLCBsb2FkZWREYXRhKGVkaXRvciksIGVtYmVkSGFuZGxlcikgOiBkZWZhdWx0UHJvbWlzZShkYXRhLCBsb2FkZWREYXRhKGVkaXRvcikpO1xuICAgIH07XG4gICAgdmFyIGlzQ2FjaGVkID0gZnVuY3Rpb24gKHVybCkge1xuICAgICAgcmV0dXJuIGNhY2hlLmhhc093blByb3BlcnR5KHVybCk7XG4gICAgfTtcblxuICAgIHZhciBleHRyYWN0TWV0YSA9IGZ1bmN0aW9uIChzb3VyY2VJbnB1dCwgZGF0YSkge1xuICAgICAgcmV0dXJuIGdldChkYXRhLCBzb3VyY2VJbnB1dCkuYmluZChmdW5jdGlvbiAobWFpbkRhdGEpIHtcbiAgICAgICAgcmV0dXJuIGdldChtYWluRGF0YSwgJ21ldGEnKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdmFyIGdldFZhbHVlID0gZnVuY3Rpb24gKGRhdGEsIG1ldGFEYXRhLCBzb3VyY2VJbnB1dCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChwcm9wKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGdldEZyb21EYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBnZXQoZGF0YSwgcHJvcCk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBnZXRGcm9tTWV0YURhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIGdldChtZXRhRGF0YSwgcHJvcCk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBnZXROb25FbXB0eVZhbHVlID0gZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0KGMsICd2YWx1ZScpLmJpbmQoZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIHJldHVybiB2Lmxlbmd0aCA+IDAgPyBPcHRpb25hbC5zb21lKHYpIDogT3B0aW9uYWwubm9uZSgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZ2V0RnJvbVZhbHVlRmlyc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIGdldEZyb21EYXRhKCkuYmluZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIHJldHVybiBpc09iamVjdChjaGlsZCkgPyBnZXROb25FbXB0eVZhbHVlKGNoaWxkKS5vclRodW5rKGdldEZyb21NZXRhRGF0YSkgOiBnZXRGcm9tTWV0YURhdGEoKS5vclRodW5rKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIE9wdGlvbmFsLmZyb20oY2hpbGQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBnZXRGcm9tTWV0YUZpcnN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBnZXRGcm9tTWV0YURhdGEoKS5vclRodW5rKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRGcm9tRGF0YSgpLmJpbmQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICAgIHJldHVybiBpc09iamVjdChjaGlsZCkgPyBnZXROb25FbXB0eVZhbHVlKGNoaWxkKSA6IE9wdGlvbmFsLmZyb20oY2hpbGQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfYSA9IHt9LCBfYVtwcm9wXSA9IChwcm9wID09PSBzb3VyY2VJbnB1dCA/IGdldEZyb21WYWx1ZUZpcnN0KCkgOiBnZXRGcm9tTWV0YUZpcnN0KCkpLmdldE9yKCcnKSwgX2E7XG4gICAgICB9O1xuICAgIH07XG4gICAgdmFyIGdldERpbWVuc2lvbnMgPSBmdW5jdGlvbiAoZGF0YSwgbWV0YURhdGEpIHtcbiAgICAgIHZhciBkaW1lbnNpb25zID0ge307XG4gICAgICBnZXQoZGF0YSwgJ2RpbWVuc2lvbnMnKS5lYWNoKGZ1bmN0aW9uIChkaW1zKSB7XG4gICAgICAgIGVhY2goW1xuICAgICAgICAgICd3aWR0aCcsXG4gICAgICAgICAgJ2hlaWdodCdcbiAgICAgICAgXSwgZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgICBnZXQobWV0YURhdGEsIHByb3ApLm9yVGh1bmsoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGdldChkaW1zLCBwcm9wKTtcbiAgICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGRpbWVuc2lvbnNbcHJvcF0gPSB2YWx1ZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkaW1lbnNpb25zO1xuICAgIH07XG4gICAgdmFyIHVud3JhcCA9IGZ1bmN0aW9uIChkYXRhLCBzb3VyY2VJbnB1dCkge1xuICAgICAgdmFyIG1ldGFEYXRhID0gc291cmNlSW5wdXQgPyBleHRyYWN0TWV0YShzb3VyY2VJbnB1dCwgZGF0YSkuZ2V0T3Ioe30pIDoge307XG4gICAgICB2YXIgZ2V0ID0gZ2V0VmFsdWUoZGF0YSwgbWV0YURhdGEsIHNvdXJjZUlucHV0KTtcbiAgICAgIHJldHVybiBfX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZ2V0KCdzb3VyY2UnKSksIGdldCgnYWx0c291cmNlJykpLCBnZXQoJ3Bvc3RlcicpKSwgZ2V0KCdlbWJlZCcpKSwgZ2V0RGltZW5zaW9ucyhkYXRhLCBtZXRhRGF0YSkpO1xuICAgIH07XG4gICAgdmFyIHdyYXAgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgdmFyIHdyYXBwZWQgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZGF0YSksIHtcbiAgICAgICAgc291cmNlOiB7IHZhbHVlOiBnZXQoZGF0YSwgJ3NvdXJjZScpLmdldE9yKCcnKSB9LFxuICAgICAgICBhbHRzb3VyY2U6IHsgdmFsdWU6IGdldChkYXRhLCAnYWx0c291cmNlJykuZ2V0T3IoJycpIH0sXG4gICAgICAgIHBvc3RlcjogeyB2YWx1ZTogZ2V0KGRhdGEsICdwb3N0ZXInKS5nZXRPcignJykgfVxuICAgICAgfSk7XG4gICAgICBlYWNoKFtcbiAgICAgICAgJ3dpZHRoJyxcbiAgICAgICAgJ2hlaWdodCdcbiAgICAgIF0sIGZ1bmN0aW9uIChwcm9wKSB7XG4gICAgICAgIGdldChkYXRhLCBwcm9wKS5lYWNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgIHZhciBkaW1lbnNpb25zID0gd3JhcHBlZC5kaW1lbnNpb25zIHx8IHt9O1xuICAgICAgICAgIGRpbWVuc2lvbnNbcHJvcF0gPSB2YWx1ZTtcbiAgICAgICAgICB3cmFwcGVkLmRpbWVuc2lvbnMgPSBkaW1lbnNpb25zO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHdyYXBwZWQ7XG4gICAgfTtcbiAgICB2YXIgaGFuZGxlRXJyb3IgPSBmdW5jdGlvbiAoZWRpdG9yKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBlcnJvciAmJiBlcnJvci5tc2cgPyAnTWVkaWEgZW1iZWQgaGFuZGxlciBlcnJvcjogJyArIGVycm9yLm1zZyA6ICdNZWRpYSBlbWJlZCBoYW5kbGVyIHRocmV3IHVua25vd24gZXJyb3IuJztcbiAgICAgICAgZWRpdG9yLm5vdGlmaWNhdGlvbk1hbmFnZXIub3Blbih7XG4gICAgICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgICAgICB0ZXh0OiBlcnJvck1lc3NhZ2VcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH07XG4gICAgdmFyIHNuaXBwZXRUb0RhdGEgPSBmdW5jdGlvbiAoZWRpdG9yLCBlbWJlZFNuaXBwZXQpIHtcbiAgICAgIHJldHVybiBodG1sVG9EYXRhKGdldFNjcmlwdHMoZWRpdG9yKSwgZW1iZWRTbmlwcGV0KTtcbiAgICB9O1xuICAgIHZhciBpc01lZGlhRWxlbWVudCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICByZXR1cm4gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbWNlLW9iamVjdCcpIHx8IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWVwaG94LWVtYmVkLWlyaScpO1xuICAgIH07XG4gICAgdmFyIGdldEVkaXRvckRhdGEgPSBmdW5jdGlvbiAoZWRpdG9yKSB7XG4gICAgICB2YXIgZWxlbWVudCA9IGVkaXRvci5zZWxlY3Rpb24uZ2V0Tm9kZSgpO1xuICAgICAgdmFyIHNuaXBwZXQgPSBpc01lZGlhRWxlbWVudChlbGVtZW50KSA/IGVkaXRvci5zZXJpYWxpemVyLnNlcmlhbGl6ZShlbGVtZW50LCB7IHNlbGVjdGlvbjogdHJ1ZSB9KSA6ICcnO1xuICAgICAgcmV0dXJuIF9fYXNzaWduKHsgZW1iZWQ6IHNuaXBwZXQgfSwgaHRtbFRvRGF0YShnZXRTY3JpcHRzKGVkaXRvciksIHNuaXBwZXQpKTtcbiAgICB9O1xuICAgIHZhciBhZGRFbWJlZEh0bWwgPSBmdW5jdGlvbiAoYXBpLCBlZGl0b3IpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKGlzU3RyaW5nKHJlc3BvbnNlLnVybCkgJiYgcmVzcG9uc2UudXJsLnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdmFyIGh0bWwgPSByZXNwb25zZS5odG1sO1xuICAgICAgICAgIHZhciBzbmlwcGV0RGF0YSA9IHNuaXBwZXRUb0RhdGEoZWRpdG9yLCBodG1sKTtcbiAgICAgICAgICB2YXIgbnVEYXRhID0gX19hc3NpZ24oX19hc3NpZ24oe30sIHNuaXBwZXREYXRhKSwge1xuICAgICAgICAgICAgc291cmNlOiByZXNwb25zZS51cmwsXG4gICAgICAgICAgICBlbWJlZDogaHRtbFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGFwaS5zZXREYXRhKHdyYXAobnVEYXRhKSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfTtcbiAgICB2YXIgc2VsZWN0UGxhY2Vob2xkZXIgPSBmdW5jdGlvbiAoZWRpdG9yLCBiZWZvcmVPYmplY3RzKSB7XG4gICAgICB2YXIgYWZ0ZXJPYmplY3RzID0gZWRpdG9yLmRvbS5zZWxlY3QoJypbZGF0YS1tY2Utb2JqZWN0XScpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiZWZvcmVPYmplY3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvciAodmFyIHkgPSBhZnRlck9iamVjdHMubGVuZ3RoIC0gMTsgeSA+PSAwOyB5LS0pIHtcbiAgICAgICAgICBpZiAoYmVmb3JlT2JqZWN0c1tpXSA9PT0gYWZ0ZXJPYmplY3RzW3ldKSB7XG4gICAgICAgICAgICBhZnRlck9iamVjdHMuc3BsaWNlKHksIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWRpdG9yLnNlbGVjdGlvbi5zZWxlY3QoYWZ0ZXJPYmplY3RzWzBdKTtcbiAgICB9O1xuICAgIHZhciBoYW5kbGVJbnNlcnQgPSBmdW5jdGlvbiAoZWRpdG9yLCBodG1sKSB7XG4gICAgICB2YXIgYmVmb3JlT2JqZWN0cyA9IGVkaXRvci5kb20uc2VsZWN0KCcqW2RhdGEtbWNlLW9iamVjdF0nKTtcbiAgICAgIGVkaXRvci5pbnNlcnRDb250ZW50KGh0bWwpO1xuICAgICAgc2VsZWN0UGxhY2Vob2xkZXIoZWRpdG9yLCBiZWZvcmVPYmplY3RzKTtcbiAgICAgIGVkaXRvci5ub2RlQ2hhbmdlZCgpO1xuICAgIH07XG4gICAgdmFyIHN1Ym1pdEZvcm0gPSBmdW5jdGlvbiAocHJldkRhdGEsIG5ld0RhdGEsIGVkaXRvcikge1xuICAgICAgbmV3RGF0YS5lbWJlZCA9IHVwZGF0ZUh0bWwobmV3RGF0YS5lbWJlZCwgbmV3RGF0YSk7XG4gICAgICBpZiAobmV3RGF0YS5lbWJlZCAmJiAocHJldkRhdGEuc291cmNlID09PSBuZXdEYXRhLnNvdXJjZSB8fCBpc0NhY2hlZChuZXdEYXRhLnNvdXJjZSkpKSB7XG4gICAgICAgIGhhbmRsZUluc2VydChlZGl0b3IsIG5ld0RhdGEuZW1iZWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZ2V0RW1iZWRIdG1sKGVkaXRvciwgbmV3RGF0YSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICBoYW5kbGVJbnNlcnQoZWRpdG9yLCByZXNwb25zZS5odG1sKTtcbiAgICAgICAgfSkuY2F0Y2goaGFuZGxlRXJyb3IoZWRpdG9yKSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgc2hvd0RpYWxvZyA9IGZ1bmN0aW9uIChlZGl0b3IpIHtcbiAgICAgIHZhciBlZGl0b3JEYXRhID0gZ2V0RWRpdG9yRGF0YShlZGl0b3IpO1xuICAgICAgdmFyIGN1cnJlbnREYXRhID0gQ2VsbChlZGl0b3JEYXRhKTtcbiAgICAgIHZhciBpbml0aWFsRGF0YSA9IHdyYXAoZWRpdG9yRGF0YSk7XG4gICAgICB2YXIgaGFuZGxlU291cmNlID0gZnVuY3Rpb24gKHByZXZEYXRhLCBhcGkpIHtcbiAgICAgICAgdmFyIHNlcnZpY2VEYXRhID0gdW53cmFwKGFwaS5nZXREYXRhKCksICdzb3VyY2UnKTtcbiAgICAgICAgaWYgKHByZXZEYXRhLnNvdXJjZSAhPT0gc2VydmljZURhdGEuc291cmNlKSB7XG4gICAgICAgICAgYWRkRW1iZWRIdG1sKHdpbiwgZWRpdG9yKSh7XG4gICAgICAgICAgICB1cmw6IHNlcnZpY2VEYXRhLnNvdXJjZSxcbiAgICAgICAgICAgIGh0bWw6ICcnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ2V0RW1iZWRIdG1sKGVkaXRvciwgc2VydmljZURhdGEpLnRoZW4oYWRkRW1iZWRIdG1sKHdpbiwgZWRpdG9yKSkuY2F0Y2goaGFuZGxlRXJyb3IoZWRpdG9yKSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB2YXIgaGFuZGxlRW1iZWQgPSBmdW5jdGlvbiAoYXBpKSB7XG4gICAgICAgIHZhciBkYXRhID0gdW53cmFwKGFwaS5nZXREYXRhKCkpO1xuICAgICAgICB2YXIgZGF0YUZyb21FbWJlZCA9IHNuaXBwZXRUb0RhdGEoZWRpdG9yLCBkYXRhLmVtYmVkKTtcbiAgICAgICAgYXBpLnNldERhdGEod3JhcChkYXRhRnJvbUVtYmVkKSk7XG4gICAgICB9O1xuICAgICAgdmFyIGhhbmRsZVVwZGF0ZSA9IGZ1bmN0aW9uIChhcGksIHNvdXJjZUlucHV0KSB7XG4gICAgICAgIHZhciBkYXRhID0gdW53cmFwKGFwaS5nZXREYXRhKCksIHNvdXJjZUlucHV0KTtcbiAgICAgICAgdmFyIGVtYmVkID0gZGF0YVRvSHRtbChlZGl0b3IsIGRhdGEpO1xuICAgICAgICBhcGkuc2V0RGF0YSh3cmFwKF9fYXNzaWduKF9fYXNzaWduKHt9LCBkYXRhKSwgeyBlbWJlZDogZW1iZWQgfSkpKTtcbiAgICAgIH07XG4gICAgICB2YXIgbWVkaWFJbnB1dCA9IFt7XG4gICAgICAgICAgbmFtZTogJ3NvdXJjZScsXG4gICAgICAgICAgdHlwZTogJ3VybGlucHV0JyxcbiAgICAgICAgICBmaWxldHlwZTogJ21lZGlhJyxcbiAgICAgICAgICBsYWJlbDogJ1NvdXJjZSdcbiAgICAgICAgfV07XG4gICAgICB2YXIgc2l6ZUlucHV0ID0gIWhhc0RpbWVuc2lvbnMoZWRpdG9yKSA/IFtdIDogW3tcbiAgICAgICAgICB0eXBlOiAnc2l6ZWlucHV0JyxcbiAgICAgICAgICBuYW1lOiAnZGltZW5zaW9ucycsXG4gICAgICAgICAgbGFiZWw6ICdDb25zdHJhaW4gcHJvcG9ydGlvbnMnLFxuICAgICAgICAgIGNvbnN0cmFpbjogdHJ1ZVxuICAgICAgICB9XTtcbiAgICAgIHZhciBnZW5lcmFsVGFiID0ge1xuICAgICAgICB0aXRsZTogJ0dlbmVyYWwnLFxuICAgICAgICBuYW1lOiAnZ2VuZXJhbCcsXG4gICAgICAgIGl0ZW1zOiBmbGF0dGVuKFtcbiAgICAgICAgICBtZWRpYUlucHV0LFxuICAgICAgICAgIHNpemVJbnB1dFxuICAgICAgICBdKVxuICAgICAgfTtcbiAgICAgIHZhciBlbWJlZFRleHRhcmVhID0ge1xuICAgICAgICB0eXBlOiAndGV4dGFyZWEnLFxuICAgICAgICBuYW1lOiAnZW1iZWQnLFxuICAgICAgICBsYWJlbDogJ1Bhc3RlIHlvdXIgZW1iZWQgY29kZSBiZWxvdzonXG4gICAgICB9O1xuICAgICAgdmFyIGVtYmVkVGFiID0ge1xuICAgICAgICB0aXRsZTogJ0VtYmVkJyxcbiAgICAgICAgaXRlbXM6IFtlbWJlZFRleHRhcmVhXVxuICAgICAgfTtcbiAgICAgIHZhciBhZHZhbmNlZEZvcm1JdGVtcyA9IFtdO1xuICAgICAgaWYgKGhhc0FsdFNvdXJjZShlZGl0b3IpKSB7XG4gICAgICAgIGFkdmFuY2VkRm9ybUl0ZW1zLnB1c2goe1xuICAgICAgICAgIG5hbWU6ICdhbHRzb3VyY2UnLFxuICAgICAgICAgIHR5cGU6ICd1cmxpbnB1dCcsXG4gICAgICAgICAgZmlsZXR5cGU6ICdtZWRpYScsXG4gICAgICAgICAgbGFiZWw6ICdBbHRlcm5hdGl2ZSBzb3VyY2UgVVJMJ1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChoYXNQb3N0ZXIoZWRpdG9yKSkge1xuICAgICAgICBhZHZhbmNlZEZvcm1JdGVtcy5wdXNoKHtcbiAgICAgICAgICBuYW1lOiAncG9zdGVyJyxcbiAgICAgICAgICB0eXBlOiAndXJsaW5wdXQnLFxuICAgICAgICAgIGZpbGV0eXBlOiAnaW1hZ2UnLFxuICAgICAgICAgIGxhYmVsOiAnTWVkaWEgcG9zdGVyIChJbWFnZSBVUkwpJ1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHZhciBhZHZhbmNlZFRhYiA9IHtcbiAgICAgICAgdGl0bGU6ICdBZHZhbmNlZCcsXG4gICAgICAgIG5hbWU6ICdhZHZhbmNlZCcsXG4gICAgICAgIGl0ZW1zOiBhZHZhbmNlZEZvcm1JdGVtc1xuICAgICAgfTtcbiAgICAgIHZhciB0YWJzID0gW1xuICAgICAgICBnZW5lcmFsVGFiLFxuICAgICAgICBlbWJlZFRhYlxuICAgICAgXTtcbiAgICAgIGlmIChhZHZhbmNlZEZvcm1JdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRhYnMucHVzaChhZHZhbmNlZFRhYik7XG4gICAgICB9XG4gICAgICB2YXIgYm9keSA9IHtcbiAgICAgICAgdHlwZTogJ3RhYnBhbmVsJyxcbiAgICAgICAgdGFiczogdGFic1xuICAgICAgfTtcbiAgICAgIHZhciB3aW4gPSBlZGl0b3Iud2luZG93TWFuYWdlci5vcGVuKHtcbiAgICAgICAgdGl0bGU6ICdJbnNlcnQvRWRpdCBNZWRpYScsXG4gICAgICAgIHNpemU6ICdub3JtYWwnLFxuICAgICAgICBib2R5OiBib2R5LFxuICAgICAgICBidXR0b25zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogJ2NhbmNlbCcsXG4gICAgICAgICAgICBuYW1lOiAnY2FuY2VsJyxcbiAgICAgICAgICAgIHRleHQ6ICdDYW5jZWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0eXBlOiAnc3VibWl0JyxcbiAgICAgICAgICAgIG5hbWU6ICdzYXZlJyxcbiAgICAgICAgICAgIHRleHQ6ICdTYXZlJyxcbiAgICAgICAgICAgIHByaW1hcnk6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIG9uU3VibWl0OiBmdW5jdGlvbiAoYXBpKSB7XG4gICAgICAgICAgdmFyIHNlcnZpY2VEYXRhID0gdW53cmFwKGFwaS5nZXREYXRhKCkpO1xuICAgICAgICAgIHN1Ym1pdEZvcm0oY3VycmVudERhdGEuZ2V0KCksIHNlcnZpY2VEYXRhLCBlZGl0b3IpO1xuICAgICAgICAgIGFwaS5jbG9zZSgpO1xuICAgICAgICB9LFxuICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gKGFwaSwgZGV0YWlsKSB7XG4gICAgICAgICAgc3dpdGNoIChkZXRhaWwubmFtZSkge1xuICAgICAgICAgIGNhc2UgJ3NvdXJjZSc6XG4gICAgICAgICAgICBoYW5kbGVTb3VyY2UoY3VycmVudERhdGEuZ2V0KCksIGFwaSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdlbWJlZCc6XG4gICAgICAgICAgICBoYW5kbGVFbWJlZChhcGkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnZGltZW5zaW9ucyc6XG4gICAgICAgICAgY2FzZSAnYWx0c291cmNlJzpcbiAgICAgICAgICBjYXNlICdwb3N0ZXInOlxuICAgICAgICAgICAgaGFuZGxlVXBkYXRlKGFwaSwgZGV0YWlsLm5hbWUpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGN1cnJlbnREYXRhLnNldCh1bndyYXAoYXBpLmdldERhdGEoKSkpO1xuICAgICAgICB9LFxuICAgICAgICBpbml0aWFsRGF0YTogaW5pdGlhbERhdGFcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgZ2V0JDEgPSBmdW5jdGlvbiAoZWRpdG9yKSB7XG4gICAgICB2YXIgc2hvd0RpYWxvZyQxID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzaG93RGlhbG9nKGVkaXRvcik7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIHsgc2hvd0RpYWxvZzogc2hvd0RpYWxvZyQxIH07XG4gICAgfTtcblxuICAgIHZhciByZWdpc3RlciA9IGZ1bmN0aW9uIChlZGl0b3IpIHtcbiAgICAgIHZhciBzaG93RGlhbG9nJDEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNob3dEaWFsb2coZWRpdG9yKTtcbiAgICAgIH07XG4gICAgICBlZGl0b3IuYWRkQ29tbWFuZCgnbWNlTWVkaWEnLCBzaG93RGlhbG9nJDEpO1xuICAgIH07XG5cbiAgICB2YXIgZ2xvYmFsJDcgPSB0aW55bWNlLnV0aWwuVG9vbHMucmVzb2x2ZSgndGlueW1jZS5odG1sLk5vZGUnKTtcblxuICAgIHZhciBnbG9iYWwkOCA9IHRpbnltY2UudXRpbC5Ub29scy5yZXNvbHZlKCd0aW55bWNlLkVudicpO1xuXG4gICAgdmFyIGdsb2JhbCQ5ID0gdGlueW1jZS51dGlsLlRvb2xzLnJlc29sdmUoJ3RpbnltY2UuaHRtbC5Eb21QYXJzZXInKTtcblxuICAgIHZhciBzYW5pdGl6ZSA9IGZ1bmN0aW9uIChlZGl0b3IsIGh0bWwpIHtcbiAgICAgIGlmIChzaG91bGRGaWx0ZXJIdG1sKGVkaXRvcikgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybiBodG1sO1xuICAgICAgfVxuICAgICAgdmFyIHdyaXRlciA9IGdsb2JhbCQ1KCk7XG4gICAgICB2YXIgYmxvY2tlZDtcbiAgICAgIGdsb2JhbCQzKHtcbiAgICAgICAgdmFsaWRhdGU6IGZhbHNlLFxuICAgICAgICBhbGxvd19jb25kaXRpb25hbF9jb21tZW50czogZmFsc2UsXG4gICAgICAgIGNvbW1lbnQ6IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgICAgaWYgKCFibG9ja2VkKSB7XG4gICAgICAgICAgICB3cml0ZXIuY29tbWVudCh0ZXh0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNkYXRhOiBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICAgIGlmICghYmxvY2tlZCkge1xuICAgICAgICAgICAgd3JpdGVyLmNkYXRhKHRleHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdGV4dDogZnVuY3Rpb24gKHRleHQsIHJhdykge1xuICAgICAgICAgIGlmICghYmxvY2tlZCkge1xuICAgICAgICAgICAgd3JpdGVyLnRleHQodGV4dCwgcmF3KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAobmFtZSwgYXR0cnMsIGVtcHR5KSB7XG4gICAgICAgICAgYmxvY2tlZCA9IHRydWU7XG4gICAgICAgICAgaWYgKG5hbWUgPT09ICdzY3JpcHQnIHx8IG5hbWUgPT09ICdub3NjcmlwdCcgfHwgbmFtZSA9PT0gJ3N2ZycpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yICh2YXIgaSA9IGF0dHJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgYXR0ck5hbWUgPSBhdHRyc1tpXS5uYW1lO1xuICAgICAgICAgICAgaWYgKGF0dHJOYW1lLmluZGV4T2YoJ29uJykgPT09IDApIHtcbiAgICAgICAgICAgICAgZGVsZXRlIGF0dHJzLm1hcFthdHRyTmFtZV07XG4gICAgICAgICAgICAgIGF0dHJzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhdHRyTmFtZSA9PT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgICBhdHRyc1tpXS52YWx1ZSA9IGVkaXRvci5kb20uc2VyaWFsaXplU3R5bGUoZWRpdG9yLmRvbS5wYXJzZVN0eWxlKGF0dHJzW2ldLnZhbHVlKSwgbmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHdyaXRlci5zdGFydChuYW1lLCBhdHRycywgZW1wdHkpO1xuICAgICAgICAgIGJsb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW5kOiBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgIGlmIChibG9ja2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHdyaXRlci5lbmQobmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH0sIGdsb2JhbCQ0KHt9KSkucGFyc2UoaHRtbCk7XG4gICAgICByZXR1cm4gd3JpdGVyLmdldENvbnRlbnQoKTtcbiAgICB9O1xuXG4gICAgdmFyIGlzTGl2ZUVtYmVkTm9kZSA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICB2YXIgbmFtZSA9IG5vZGUubmFtZTtcbiAgICAgIHJldHVybiBuYW1lID09PSAnaWZyYW1lJyB8fCBuYW1lID09PSAndmlkZW8nIHx8IG5hbWUgPT09ICdhdWRpbyc7XG4gICAgfTtcbiAgICB2YXIgZ2V0RGltZW5zaW9uID0gZnVuY3Rpb24gKG5vZGUsIHN0eWxlcywgZGltZW5zaW9uLCBkZWZhdWx0VmFsdWUpIHtcbiAgICAgIGlmIChkZWZhdWx0VmFsdWUgPT09IHZvaWQgMCkge1xuICAgICAgICBkZWZhdWx0VmFsdWUgPSBudWxsO1xuICAgICAgfVxuICAgICAgdmFyIHZhbHVlID0gbm9kZS5hdHRyKGRpbWVuc2lvbik7XG4gICAgICBpZiAoaXNOb25OdWxsYWJsZSh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfSBlbHNlIGlmICghaGFzKHN0eWxlcywgZGltZW5zaW9uKSkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgc2V0RGltZW5zaW9ucyA9IGZ1bmN0aW9uIChub2RlLCBwcmV2aWV3Tm9kZSwgc3R5bGVzKSB7XG4gICAgICB2YXIgdXNlRGVmYXVsdHMgPSBwcmV2aWV3Tm9kZS5uYW1lID09PSAnaW1nJyB8fCBub2RlLm5hbWUgPT09ICd2aWRlbyc7XG4gICAgICB2YXIgZGVmYXVsdFdpZHRoID0gdXNlRGVmYXVsdHMgPyAnMzAwJyA6IG51bGw7XG4gICAgICB2YXIgZmFsbGJhY2tIZWlnaHQgPSBub2RlLm5hbWUgPT09ICdhdWRpbycgPyAnMzAnIDogJzE1MCc7XG4gICAgICB2YXIgZGVmYXVsdEhlaWdodCA9IHVzZURlZmF1bHRzID8gZmFsbGJhY2tIZWlnaHQgOiBudWxsO1xuICAgICAgcHJldmlld05vZGUuYXR0cih7XG4gICAgICAgIHdpZHRoOiBnZXREaW1lbnNpb24obm9kZSwgc3R5bGVzLCAnd2lkdGgnLCBkZWZhdWx0V2lkdGgpLFxuICAgICAgICBoZWlnaHQ6IGdldERpbWVuc2lvbihub2RlLCBzdHlsZXMsICdoZWlnaHQnLCBkZWZhdWx0SGVpZ2h0KVxuICAgICAgfSk7XG4gICAgfTtcbiAgICB2YXIgYXBwZW5kTm9kZUNvbnRlbnQgPSBmdW5jdGlvbiAoZWRpdG9yLCBub2RlTmFtZSwgcHJldmlld05vZGUsIGh0bWwpIHtcbiAgICAgIHZhciBuZXdOb2RlID0gZ2xvYmFsJDkoe1xuICAgICAgICBmb3JjZWRfcm9vdF9ibG9jazogZmFsc2UsXG4gICAgICAgIHZhbGlkYXRlOiBmYWxzZVxuICAgICAgfSwgZWRpdG9yLnNjaGVtYSkucGFyc2UoaHRtbCwgeyBjb250ZXh0OiBub2RlTmFtZSB9KTtcbiAgICAgIHdoaWxlIChuZXdOb2RlLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgcHJldmlld05vZGUuYXBwZW5kKG5ld05vZGUuZmlyc3RDaGlsZCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgY3JlYXRlUGxhY2Vob2xkZXJOb2RlID0gZnVuY3Rpb24gKGVkaXRvciwgbm9kZSkge1xuICAgICAgdmFyIG5hbWUgPSBub2RlLm5hbWU7XG4gICAgICB2YXIgcGxhY2VIb2xkZXIgPSBuZXcgZ2xvYmFsJDcoJ2ltZycsIDEpO1xuICAgICAgcGxhY2VIb2xkZXIuc2hvcnRFbmRlZCA9IHRydWU7XG4gICAgICByZXRhaW5BdHRyaWJ1dGVzQW5kSW5uZXJIdG1sKGVkaXRvciwgbm9kZSwgcGxhY2VIb2xkZXIpO1xuICAgICAgc2V0RGltZW5zaW9ucyhub2RlLCBwbGFjZUhvbGRlciwge30pO1xuICAgICAgcGxhY2VIb2xkZXIuYXR0cih7XG4gICAgICAgICdzdHlsZSc6IG5vZGUuYXR0cignc3R5bGUnKSxcbiAgICAgICAgJ3NyYyc6IGdsb2JhbCQ4LnRyYW5zcGFyZW50U3JjLFxuICAgICAgICAnZGF0YS1tY2Utb2JqZWN0JzogbmFtZSxcbiAgICAgICAgJ2NsYXNzJzogJ21jZS1vYmplY3QgbWNlLW9iamVjdC0nICsgbmFtZVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcGxhY2VIb2xkZXI7XG4gICAgfTtcbiAgICB2YXIgY3JlYXRlUHJldmlld05vZGUgPSBmdW5jdGlvbiAoZWRpdG9yLCBub2RlKSB7XG4gICAgICB2YXIgbmFtZSA9IG5vZGUubmFtZTtcbiAgICAgIHZhciBwcmV2aWV3V3JhcHBlciA9IG5ldyBnbG9iYWwkNygnc3BhbicsIDEpO1xuICAgICAgcHJldmlld1dyYXBwZXIuYXR0cih7XG4gICAgICAgICdjb250ZW50RWRpdGFibGUnOiAnZmFsc2UnLFxuICAgICAgICAnc3R5bGUnOiBub2RlLmF0dHIoJ3N0eWxlJyksXG4gICAgICAgICdkYXRhLW1jZS1vYmplY3QnOiBuYW1lLFxuICAgICAgICAnY2xhc3MnOiAnbWNlLXByZXZpZXctb2JqZWN0IG1jZS1vYmplY3QtJyArIG5hbWVcbiAgICAgIH0pO1xuICAgICAgcmV0YWluQXR0cmlidXRlc0FuZElubmVySHRtbChlZGl0b3IsIG5vZGUsIHByZXZpZXdXcmFwcGVyKTtcbiAgICAgIHZhciBzdHlsZXMgPSBlZGl0b3IuZG9tLnBhcnNlU3R5bGUobm9kZS5hdHRyKCdzdHlsZScpKTtcbiAgICAgIHZhciBwcmV2aWV3Tm9kZSA9IG5ldyBnbG9iYWwkNyhuYW1lLCAxKTtcbiAgICAgIHNldERpbWVuc2lvbnMobm9kZSwgcHJldmlld05vZGUsIHN0eWxlcyk7XG4gICAgICBwcmV2aWV3Tm9kZS5hdHRyKHtcbiAgICAgICAgc3JjOiBub2RlLmF0dHIoJ3NyYycpLFxuICAgICAgICBzdHlsZTogbm9kZS5hdHRyKCdzdHlsZScpLFxuICAgICAgICBjbGFzczogbm9kZS5hdHRyKCdjbGFzcycpXG4gICAgICB9KTtcbiAgICAgIGlmIChuYW1lID09PSAnaWZyYW1lJykge1xuICAgICAgICBwcmV2aWV3Tm9kZS5hdHRyKHtcbiAgICAgICAgICBhbGxvd2Z1bGxzY3JlZW46IG5vZGUuYXR0cignYWxsb3dmdWxsc2NyZWVuJyksXG4gICAgICAgICAgZnJhbWVib3JkZXI6ICcwJ1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBhdHRycyA9IFtcbiAgICAgICAgICAnY29udHJvbHMnLFxuICAgICAgICAgICdjcm9zc29yaWdpbicsXG4gICAgICAgICAgJ2N1cnJlbnRUaW1lJyxcbiAgICAgICAgICAnbG9vcCcsXG4gICAgICAgICAgJ211dGVkJyxcbiAgICAgICAgICAncG9zdGVyJyxcbiAgICAgICAgICAncHJlbG9hZCdcbiAgICAgICAgXTtcbiAgICAgICAgZWFjaChhdHRycywgZnVuY3Rpb24gKGF0dHJOYW1lKSB7XG4gICAgICAgICAgcHJldmlld05vZGUuYXR0cihhdHRyTmFtZSwgbm9kZS5hdHRyKGF0dHJOYW1lKSk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgc2FuaXRpemVkSHRtbCA9IHByZXZpZXdXcmFwcGVyLmF0dHIoJ2RhdGEtbWNlLWh0bWwnKTtcbiAgICAgICAgaWYgKGlzTm9uTnVsbGFibGUoc2FuaXRpemVkSHRtbCkpIHtcbiAgICAgICAgICBhcHBlbmROb2RlQ29udGVudChlZGl0b3IsIG5hbWUsIHByZXZpZXdOb2RlLCBzYW5pdGl6ZWRIdG1sKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdmFyIHNoaW1Ob2RlID0gbmV3IGdsb2JhbCQ3KCdzcGFuJywgMSk7XG4gICAgICBzaGltTm9kZS5hdHRyKCdjbGFzcycsICdtY2Utc2hpbScpO1xuICAgICAgcHJldmlld1dyYXBwZXIuYXBwZW5kKHByZXZpZXdOb2RlKTtcbiAgICAgIHByZXZpZXdXcmFwcGVyLmFwcGVuZChzaGltTm9kZSk7XG4gICAgICByZXR1cm4gcHJldmlld1dyYXBwZXI7XG4gICAgfTtcbiAgICB2YXIgcmV0YWluQXR0cmlidXRlc0FuZElubmVySHRtbCA9IGZ1bmN0aW9uIChlZGl0b3IsIHNvdXJjZU5vZGUsIHRhcmdldE5vZGUpIHtcbiAgICAgIHZhciBhdHRyaWJzID0gc291cmNlTm9kZS5hdHRyaWJ1dGVzO1xuICAgICAgdmFyIGFpID0gYXR0cmlicy5sZW5ndGg7XG4gICAgICB3aGlsZSAoYWktLSkge1xuICAgICAgICB2YXIgYXR0ck5hbWUgPSBhdHRyaWJzW2FpXS5uYW1lO1xuICAgICAgICB2YXIgYXR0clZhbHVlID0gYXR0cmlic1thaV0udmFsdWU7XG4gICAgICAgIGlmIChhdHRyTmFtZSAhPT0gJ3dpZHRoJyAmJiBhdHRyTmFtZSAhPT0gJ2hlaWdodCcgJiYgYXR0ck5hbWUgIT09ICdzdHlsZScpIHtcbiAgICAgICAgICBpZiAoYXR0ck5hbWUgPT09ICdkYXRhJyB8fCBhdHRyTmFtZSA9PT0gJ3NyYycpIHtcbiAgICAgICAgICAgIGF0dHJWYWx1ZSA9IGVkaXRvci5jb252ZXJ0VVJMKGF0dHJWYWx1ZSwgYXR0ck5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0YXJnZXROb2RlLmF0dHIoJ2RhdGEtbWNlLXAtJyArIGF0dHJOYW1lLCBhdHRyVmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgaW5uZXJIdG1sID0gc291cmNlTm9kZS5maXJzdENoaWxkICYmIHNvdXJjZU5vZGUuZmlyc3RDaGlsZC52YWx1ZTtcbiAgICAgIGlmIChpbm5lckh0bWwpIHtcbiAgICAgICAgdGFyZ2V0Tm9kZS5hdHRyKCdkYXRhLW1jZS1odG1sJywgZXNjYXBlKHNhbml0aXplKGVkaXRvciwgaW5uZXJIdG1sKSkpO1xuICAgICAgICB0YXJnZXROb2RlLmZpcnN0Q2hpbGQgPSBudWxsO1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIGlzUGFnZUVtYmVkV3JhcHBlciA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICB2YXIgbm9kZUNsYXNzID0gbm9kZS5hdHRyKCdjbGFzcycpO1xuICAgICAgcmV0dXJuIG5vZGVDbGFzcyAmJiAvXFxidGlueS1wYWdlZW1iZWRcXGIvLnRlc3Qobm9kZUNsYXNzKTtcbiAgICB9O1xuICAgIHZhciBpc1dpdGhpbkVtYmVkV3JhcHBlciA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICB3aGlsZSAobm9kZSA9IG5vZGUucGFyZW50KSB7XG4gICAgICAgIGlmIChub2RlLmF0dHIoJ2RhdGEtZXBob3gtZW1iZWQtaXJpJykgfHwgaXNQYWdlRW1iZWRXcmFwcGVyKG5vZGUpKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIHZhciBwbGFjZUhvbGRlckNvbnZlcnRlciA9IGZ1bmN0aW9uIChlZGl0b3IpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAobm9kZXMpIHtcbiAgICAgICAgdmFyIGkgPSBub2Rlcy5sZW5ndGg7XG4gICAgICAgIHZhciBub2RlO1xuICAgICAgICB2YXIgdmlkZW9TY3JpcHQ7XG4gICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICBub2RlID0gbm9kZXNbaV07XG4gICAgICAgICAgaWYgKCFub2RlLnBhcmVudCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChub2RlLnBhcmVudC5hdHRyKCdkYXRhLW1jZS1vYmplY3QnKSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChub2RlLm5hbWUgPT09ICdzY3JpcHQnKSB7XG4gICAgICAgICAgICB2aWRlb1NjcmlwdCA9IGdldFZpZGVvU2NyaXB0TWF0Y2goZ2V0U2NyaXB0cyhlZGl0b3IpLCBub2RlLmF0dHIoJ3NyYycpKTtcbiAgICAgICAgICAgIGlmICghdmlkZW9TY3JpcHQpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh2aWRlb1NjcmlwdCkge1xuICAgICAgICAgICAgaWYgKHZpZGVvU2NyaXB0LndpZHRoKSB7XG4gICAgICAgICAgICAgIG5vZGUuYXR0cignd2lkdGgnLCB2aWRlb1NjcmlwdC53aWR0aC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2aWRlb1NjcmlwdC5oZWlnaHQpIHtcbiAgICAgICAgICAgICAgbm9kZS5hdHRyKCdoZWlnaHQnLCB2aWRlb1NjcmlwdC5oZWlnaHQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChpc0xpdmVFbWJlZE5vZGUobm9kZSkgJiYgaGFzTGl2ZUVtYmVkcyhlZGl0b3IpICYmIGdsb2JhbCQ4LmNlRmFsc2UpIHtcbiAgICAgICAgICAgIGlmICghaXNXaXRoaW5FbWJlZFdyYXBwZXIobm9kZSkpIHtcbiAgICAgICAgICAgICAgbm9kZS5yZXBsYWNlKGNyZWF0ZVByZXZpZXdOb2RlKGVkaXRvciwgbm9kZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIWlzV2l0aGluRW1iZWRXcmFwcGVyKG5vZGUpKSB7XG4gICAgICAgICAgICAgIG5vZGUucmVwbGFjZShjcmVhdGVQbGFjZWhvbGRlck5vZGUoZWRpdG9yLCBub2RlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIgc2V0dXAgPSBmdW5jdGlvbiAoZWRpdG9yKSB7XG4gICAgICBlZGl0b3Iub24oJ3ByZUluaXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzcGVjaWFsRWxlbWVudHMgPSBlZGl0b3Iuc2NoZW1hLmdldFNwZWNpYWxFbGVtZW50cygpO1xuICAgICAgICBnbG9iYWwkMS5lYWNoKCd2aWRlbyBhdWRpbyBpZnJhbWUgb2JqZWN0Jy5zcGxpdCgnICcpLCBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgIHNwZWNpYWxFbGVtZW50c1tuYW1lXSA9IG5ldyBSZWdFeHAoJzwvJyArIG5hbWUgKyAnW14+XSo+JywgJ2dpJyk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgYm9vbEF0dHJzID0gZWRpdG9yLnNjaGVtYS5nZXRCb29sQXR0cnMoKTtcbiAgICAgICAgZ2xvYmFsJDEuZWFjaCgnd2Via2l0YWxsb3dmdWxsc2NyZWVuIG1vemFsbG93ZnVsbHNjcmVlbiBhbGxvd2Z1bGxzY3JlZW4nLnNwbGl0KCcgJyksIGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgYm9vbEF0dHJzW25hbWVdID0ge307XG4gICAgICAgIH0pO1xuICAgICAgICBlZGl0b3IucGFyc2VyLmFkZE5vZGVGaWx0ZXIoJ2lmcmFtZSx2aWRlbyxhdWRpbyxvYmplY3QsZW1iZWQsc2NyaXB0JywgcGxhY2VIb2xkZXJDb252ZXJ0ZXIoZWRpdG9yKSk7XG4gICAgICAgIGVkaXRvci5zZXJpYWxpemVyLmFkZEF0dHJpYnV0ZUZpbHRlcignZGF0YS1tY2Utb2JqZWN0JywgZnVuY3Rpb24gKG5vZGVzLCBuYW1lKSB7XG4gICAgICAgICAgdmFyIGkgPSBub2Rlcy5sZW5ndGg7XG4gICAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgICAgdmFyIHJlYWxFbG07XG4gICAgICAgICAgdmFyIGFpO1xuICAgICAgICAgIHZhciBhdHRyaWJzO1xuICAgICAgICAgIHZhciBpbm5lckh0bWw7XG4gICAgICAgICAgdmFyIGlubmVyTm9kZTtcbiAgICAgICAgICB2YXIgcmVhbEVsbU5hbWU7XG4gICAgICAgICAgdmFyIGNsYXNzTmFtZTtcbiAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBub2RlID0gbm9kZXNbaV07XG4gICAgICAgICAgICBpZiAoIW5vZGUucGFyZW50KSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVhbEVsbU5hbWUgPSBub2RlLmF0dHIobmFtZSk7XG4gICAgICAgICAgICByZWFsRWxtID0gbmV3IGdsb2JhbCQ3KHJlYWxFbG1OYW1lLCAxKTtcbiAgICAgICAgICAgIGlmIChyZWFsRWxtTmFtZSAhPT0gJ2F1ZGlvJyAmJiByZWFsRWxtTmFtZSAhPT0gJ3NjcmlwdCcpIHtcbiAgICAgICAgICAgICAgY2xhc3NOYW1lID0gbm9kZS5hdHRyKCdjbGFzcycpO1xuICAgICAgICAgICAgICBpZiAoY2xhc3NOYW1lICYmIGNsYXNzTmFtZS5pbmRleE9mKCdtY2UtcHJldmlldy1vYmplY3QnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZWFsRWxtLmF0dHIoe1xuICAgICAgICAgICAgICAgICAgd2lkdGg6IG5vZGUuZmlyc3RDaGlsZC5hdHRyKCd3aWR0aCcpLFxuICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBub2RlLmZpcnN0Q2hpbGQuYXR0cignaGVpZ2h0JylcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWFsRWxtLmF0dHIoe1xuICAgICAgICAgICAgICAgICAgd2lkdGg6IG5vZGUuYXR0cignd2lkdGgnKSxcbiAgICAgICAgICAgICAgICAgIGhlaWdodDogbm9kZS5hdHRyKCdoZWlnaHQnKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWFsRWxtLmF0dHIoeyBzdHlsZTogbm9kZS5hdHRyKCdzdHlsZScpIH0pO1xuICAgICAgICAgICAgYXR0cmlicyA9IG5vZGUuYXR0cmlidXRlcztcbiAgICAgICAgICAgIGFpID0gYXR0cmlicy5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoYWktLSkge1xuICAgICAgICAgICAgICB2YXIgYXR0ck5hbWUgPSBhdHRyaWJzW2FpXS5uYW1lO1xuICAgICAgICAgICAgICBpZiAoYXR0ck5hbWUuaW5kZXhPZignZGF0YS1tY2UtcC0nKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJlYWxFbG0uYXR0cihhdHRyTmFtZS5zdWJzdHIoMTEpLCBhdHRyaWJzW2FpXS52YWx1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZWFsRWxtTmFtZSA9PT0gJ3NjcmlwdCcpIHtcbiAgICAgICAgICAgICAgcmVhbEVsbS5hdHRyKCd0eXBlJywgJ3RleHQvamF2YXNjcmlwdCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5uZXJIdG1sID0gbm9kZS5hdHRyKCdkYXRhLW1jZS1odG1sJyk7XG4gICAgICAgICAgICBpZiAoaW5uZXJIdG1sKSB7XG4gICAgICAgICAgICAgIGlubmVyTm9kZSA9IG5ldyBnbG9iYWwkNygnI3RleHQnLCAzKTtcbiAgICAgICAgICAgICAgaW5uZXJOb2RlLnJhdyA9IHRydWU7XG4gICAgICAgICAgICAgIGlubmVyTm9kZS52YWx1ZSA9IHNhbml0aXplKGVkaXRvciwgdW5lc2NhcGUoaW5uZXJIdG1sKSk7XG4gICAgICAgICAgICAgIHJlYWxFbG0uYXBwZW5kKGlubmVyTm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub2RlLnJlcGxhY2UocmVhbEVsbSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgZWRpdG9yLm9uKCdTZXRDb250ZW50JywgZnVuY3Rpb24gKCkge1xuICAgICAgICBlZGl0b3IuJCgnc3Bhbi5tY2UtcHJldmlldy1vYmplY3QnKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxtKSB7XG4gICAgICAgICAgdmFyICRlbG0gPSBlZGl0b3IuJChlbG0pO1xuICAgICAgICAgIGlmICgkZWxtLmZpbmQoJ3NwYW4ubWNlLXNoaW0nKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICRlbG0uYXBwZW5kKCc8c3BhbiBjbGFzcz1cIm1jZS1zaGltXCI+PC9zcGFuPicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmFyIHNldHVwJDEgPSBmdW5jdGlvbiAoZWRpdG9yKSB7XG4gICAgICBlZGl0b3Iub24oJ1Jlc29sdmVOYW1lJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIG5hbWU7XG4gICAgICAgIGlmIChlLnRhcmdldC5ub2RlVHlwZSA9PT0gMSAmJiAobmFtZSA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1tY2Utb2JqZWN0JykpKSB7XG4gICAgICAgICAgZS5uYW1lID0gbmFtZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZhciBzZXR1cCQyID0gZnVuY3Rpb24gKGVkaXRvcikge1xuICAgICAgZWRpdG9yLm9uKCdjbGljayBrZXl1cCB0b3VjaGVuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGVjdGVkTm9kZSA9IGVkaXRvci5zZWxlY3Rpb24uZ2V0Tm9kZSgpO1xuICAgICAgICBpZiAoc2VsZWN0ZWROb2RlICYmIGVkaXRvci5kb20uaGFzQ2xhc3Moc2VsZWN0ZWROb2RlLCAnbWNlLXByZXZpZXctb2JqZWN0JykpIHtcbiAgICAgICAgICBpZiAoZWRpdG9yLmRvbS5nZXRBdHRyaWIoc2VsZWN0ZWROb2RlLCAnZGF0YS1tY2Utc2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgc2VsZWN0ZWROb2RlLnNldEF0dHJpYnV0ZSgnZGF0YS1tY2Utc2VsZWN0ZWQnLCAnMicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBlZGl0b3Iub24oJ09iamVjdFNlbGVjdGVkJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIG9iamVjdFR5cGUgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbWNlLW9iamVjdCcpO1xuICAgICAgICBpZiAob2JqZWN0VHlwZSA9PT0gJ3NjcmlwdCcpIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgZWRpdG9yLm9uKCdPYmplY3RSZXNpemVkJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICB2YXIgaHRtbDtcbiAgICAgICAgaWYgKHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbWNlLW9iamVjdCcpKSB7XG4gICAgICAgICAgaHRtbCA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbWNlLWh0bWwnKTtcbiAgICAgICAgICBpZiAoaHRtbCkge1xuICAgICAgICAgICAgaHRtbCA9IHVuZXNjYXBlKGh0bWwpO1xuICAgICAgICAgICAgdGFyZ2V0LnNldEF0dHJpYnV0ZSgnZGF0YS1tY2UtaHRtbCcsIGVzY2FwZSh1cGRhdGVIdG1sKGh0bWwsIHtcbiAgICAgICAgICAgICAgd2lkdGg6IFN0cmluZyhlLndpZHRoKSxcbiAgICAgICAgICAgICAgaGVpZ2h0OiBTdHJpbmcoZS5oZWlnaHQpXG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZhciBzdGF0ZVNlbGVjdG9yQWRhcHRlciA9IGZ1bmN0aW9uIChlZGl0b3IsIHNlbGVjdG9yKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKGJ1dHRvbkFwaSkge1xuICAgICAgICByZXR1cm4gZWRpdG9yLnNlbGVjdGlvbi5zZWxlY3RvckNoYW5nZWRXaXRoVW5iaW5kKHNlbGVjdG9yLmpvaW4oJywnKSwgYnV0dG9uQXBpLnNldEFjdGl2ZSkudW5iaW5kO1xuICAgICAgfTtcbiAgICB9O1xuICAgIHZhciByZWdpc3RlciQxID0gZnVuY3Rpb24gKGVkaXRvcikge1xuICAgICAgZWRpdG9yLnVpLnJlZ2lzdHJ5LmFkZFRvZ2dsZUJ1dHRvbignbWVkaWEnLCB7XG4gICAgICAgIHRvb2x0aXA6ICdJbnNlcnQvZWRpdCBtZWRpYScsXG4gICAgICAgIGljb246ICdlbWJlZCcsXG4gICAgICAgIG9uQWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZWRpdG9yLmV4ZWNDb21tYW5kKCdtY2VNZWRpYScpO1xuICAgICAgICB9LFxuICAgICAgICBvblNldHVwOiBzdGF0ZVNlbGVjdG9yQWRhcHRlcihlZGl0b3IsIFtcbiAgICAgICAgICAnaW1nW2RhdGEtbWNlLW9iamVjdF0nLFxuICAgICAgICAgICdzcGFuW2RhdGEtbWNlLW9iamVjdF0nLFxuICAgICAgICAgICdkaXZbZGF0YS1lcGhveC1lbWJlZC1pcmldJ1xuICAgICAgICBdKVxuICAgICAgfSk7XG4gICAgICBlZGl0b3IudWkucmVnaXN0cnkuYWRkTWVudUl0ZW0oJ21lZGlhJywge1xuICAgICAgICBpY29uOiAnZW1iZWQnLFxuICAgICAgICB0ZXh0OiAnTWVkaWEuLi4nLFxuICAgICAgICBvbkFjdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZCgnbWNlTWVkaWEnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFBsdWdpbiAoKSB7XG4gICAgICBnbG9iYWwuYWRkKCdtZWRpYScsIGZ1bmN0aW9uIChlZGl0b3IpIHtcbiAgICAgICAgcmVnaXN0ZXIoZWRpdG9yKTtcbiAgICAgICAgcmVnaXN0ZXIkMShlZGl0b3IpO1xuICAgICAgICBzZXR1cCQxKGVkaXRvcik7XG4gICAgICAgIHNldHVwKGVkaXRvcik7XG4gICAgICAgIHNldHVwJDIoZWRpdG9yKTtcbiAgICAgICAgcmV0dXJuIGdldCQxKGVkaXRvcik7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBQbHVnaW4oKTtcblxufSgpKTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0E7Ozs7Ozs7O0FDUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QTs7QSIsInNvdXJjZVJvb3QiOiIifQ==